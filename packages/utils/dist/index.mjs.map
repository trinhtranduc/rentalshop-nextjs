{"version":3,"sources":["../src/config/api.ts","../../database/node_modules/.prisma/client/default.js","../../database/node_modules/@prisma/client/default.js","../src/core/string-utils.ts","../src/core/function-utils.ts","../src/core/common.ts","../src/core/errors.ts","../src/core/pricing-calculator.ts","../../database/src/client.ts","../../database/src/subscription.ts","../../database/src/order-number-generator.ts","../../database/src/audit.ts","../src/core/subscription-manager.ts","../src/core/proration.ts","../src/core/badge-utils.tsx","../../../node_modules/lucide-react/src/defaultAttributes.ts","../../../node_modules/lucide-react/src/createLucideIcon.ts","../../../node_modules/lucide-react/src/icons/alert-triangle.ts","../../../node_modules/lucide-react/src/icons/building-2.ts","../../../node_modules/lucide-react/src/icons/check-circle.ts","../../../node_modules/lucide-react/src/icons/dollar-sign.ts","../../../node_modules/lucide-react/src/icons/file-text.ts","../../../node_modules/lucide-react/src/icons/map-pin.ts","../../../node_modules/lucide-react/src/icons/package.ts","../../../node_modules/lucide-react/src/icons/shield.ts","../../../node_modules/lucide-react/src/icons/shopping-cart.ts","../../../node_modules/lucide-react/src/icons/store.ts","../../../node_modules/lucide-react/src/icons/trending-down.ts","../../../node_modules/lucide-react/src/icons/trending-up.ts","../../../node_modules/lucide-react/src/icons/user-check.ts","../../../node_modules/lucide-react/src/icons/user-x.ts","../../../node_modules/lucide-react/src/icons/user.ts","../../../node_modules/lucide-react/src/icons/x-circle.ts","../src/core/customer-utils.tsx","../src/core/product-utils.tsx","../src/core/user-utils.tsx","../src/core/validation.ts","../src/core/currency.ts","../src/core/payment-gateways/index.ts","../src/core/order-number-manager.ts","../src/core/date.ts","../src/core/audit-config.ts","../src/core/audit-helper.ts","../src/api/auth.ts","../src/api/products.ts","../src/api/customers.ts","../src/api/orders.ts","../src/api/outlets.ts","../src/api/merchants.ts","../src/api/analytics.ts","../src/api/categories.ts","../src/api/notifications.ts","../src/api/profile.ts","../src/api/users.ts","../src/api/plans.ts","../src/api/billing-cycles.ts","../src/api/payments.ts","../src/api/audit-logs.ts","../src/api/settings.ts","../src/api/subscriptions.ts","../src/api/system.ts","../src/api/calendar.ts","../src/api/upload.ts","../src/config/database.ts","../src/config/environment.ts","../src/performance.ts"],"names":["__defProp","__getOwnPropDesc","__getOwnPropNames","__hasOwnProp","__export","__copyProps","__toCommonJS","PrismaClient","prisma","require_default","timeout","delay","CONSTANTS","ErrorCode","API","apiUrls","result","format","generateRandomString","checkSubscriptionStatus","formatDate","React","isValid","publicFetch"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAuQA,SAAS,iBAA8B;AAErC,QAAM,cAAc,QAAQ,IAAI,uBAAuB,QAAQ,IAAI;AACnE,MAAI,gBAAgB,WAAW,gBAAgB,iBAAiB,gBAAgB,cAAc;AAC5F,WAAO;AAAA,EACT;AAGA,MAAI,QAAQ,IAAI,aAAa,cAAc;AACzC,WAAO;AAAA,EACT;AAGA,SAAO;AACT;AAKA,SAAS,wBAAgC;AACvC,QAAM,MAAM,eAAe;AAE3B,UAAQ,KAAK;AAAA,IACX,KAAK;AACH,aAAO,QAAQ,IAAI,uBAAuB;AAAA,IAE5C,KAAK;AACH,aAAO,QAAQ,IAAI,uBAAuB;AAAA,IAE5C,KAAK;AACH,aAAO,QAAQ,IAAI,uBAAuB;AAAA,IAE5C;AACE,aAAO;AAAA,EACX;AACF;AAKA,SAAS,eAA0B;AACjC,QAAM,cAAc,eAAe;AAGnC,QAAM,aAAiC;AAAA,IACrC,MAAM;AAAA,MACJ,SAAS,CAAC;AAAA,IACZ;AAAA,IACA,UAAU;AAAA,MACR,mBAAmB;AAAA,MACnB,WAAW;AAAA,MACX,cAAc;AAAA,IAChB;AAAA,IACA,SAAS;AAAA,MACP,OAAO;AAAA,MACP,QAAQ;AAAA,IACV;AAAA,IACA,UAAU;AAAA,MACR,cAAc;AAAA,MACd,iBAAiB;AAAA,IACnB;AAAA,EACF;AAGA,UAAQ,aAAa;AAAA,IACnB,KAAK;AACH,aAAO;AAAA,QACL,GAAG;AAAA,QACH,UAAU;AAAA,UACR,KAAK,QAAQ,IAAI,gBAAgB;AAAA,UACjC,MAAM;AAAA,QACR;AAAA,QACA,MAAM;AAAA,UACJ,WAAW,QAAQ,IAAI,cAAc;AAAA,UACrC,WAAW,QAAQ,IAAI,kBAAkB;AAAA,QAC3C;AAAA,QACA,MAAM;AAAA,UACJ,SAAS;AAAA,YACP;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,YACA;AAAA;AAAA,UACF;AAAA,QACF;AAAA,QACA,UAAU;AAAA,UACR,mBAAmB;AAAA,UACnB,WAAW;AAAA,UACX,cAAc;AAAA,QAChB;AAAA,QACA,MAAM;AAAA,UACJ,QAAQ,QAAQ,IAAI,cAAc;AAAA,UAClC,OAAO,QAAQ,IAAI,aAAa;AAAA,UAChC,KAAK,QAAQ,IAAI,WAAW;AAAA,UAC5B,QAAQ,QAAQ,IAAI,cAAc;AAAA,QACpC;AAAA,QACA,SAAS;AAAA,UACP,OAAO,QAAQ,IAAI,aAAa;AAAA,UAChC,QAAQ,QAAQ,IAAI,cAAc;AAAA,QACpC;AAAA,QACA,UAAU;AAAA,UACR,cAAc,SAAS,QAAQ,IAAI,kBAAkB,MAAM;AAAA,UAC3D,iBAAiB,QAAQ,IAAI,qBAAqB;AAAA,QACpD;AAAA,MACF;AAAA,IAEF,KAAK;AACH,aAAO;AAAA,QACL,GAAG;AAAA,QACH,UAAU;AAAA,UACR,KAAK,QAAQ,IAAI,gBAAgB;AAAA,UACjC,MAAM;AAAA,QACR;AAAA,QACA,MAAM;AAAA,UACJ,WAAW,QAAQ,IAAI,cAAc;AAAA,UACrC,WAAW,QAAQ,IAAI,kBAAkB;AAAA,QAC3C;AAAA,QACA,MAAM;AAAA,UACJ,SAAS;AAAA,YACP;AAAA,YACA;AAAA,YACA;AAAA,UACF;AAAA,QACF;AAAA,QACA,UAAU;AAAA,UACR,mBAAmB;AAAA,UACnB,WAAW;AAAA,UACX,cAAc;AAAA,QAChB;AAAA,QACA,MAAM;AAAA,UACJ,QAAQ,QAAQ,IAAI,cAAc;AAAA,UAClC,OAAO,QAAQ,IAAI,aAAa;AAAA,UAChC,KAAK,QAAQ,IAAI,WAAW;AAAA,UAC5B,QAAQ,QAAQ,IAAI,cAAc;AAAA,QACpC;AAAA,QACA,SAAS;AAAA,UACP,OAAO,QAAQ,IAAI,aAAa;AAAA,UAChC,QAAQ,QAAQ,IAAI,cAAc;AAAA,QACpC;AAAA,QACA,UAAU;AAAA,UACR,cAAc,SAAS,QAAQ,IAAI,kBAAkB,KAAK;AAAA,UAC1D,iBAAiB,QAAQ,IAAI,qBAAqB;AAAA,QACpD;AAAA,MACF;AAAA,IAEF,KAAK;AACH,aAAO;AAAA,QACL,GAAG;AAAA,QACH,UAAU;AAAA,UACR,KAAK,QAAQ,IAAI,gBAAgB;AAAA,UACjC,MAAM;AAAA,QACR;AAAA,QACA,MAAM;AAAA,UACJ,WAAW,QAAQ,IAAI,cAAc;AAAA,UACrC,WAAW,QAAQ,IAAI,kBAAkB;AAAA,QAC3C;AAAA,QACA,MAAM;AAAA,UACJ,SAAS;AAAA,YACP;AAAA,YACA;AAAA,YACA;AAAA,UACF;AAAA,QACF;AAAA,QACA,UAAU;AAAA,UACR,mBAAmB;AAAA,UACnB,WAAW;AAAA,UACX,cAAc;AAAA,QAChB;AAAA,QACA,MAAM;AAAA,UACJ,QAAQ,QAAQ,IAAI,cAAc;AAAA,UAClC,OAAO,QAAQ,IAAI,aAAa;AAAA,UAChC,KAAK,QAAQ,IAAI,WAAW;AAAA,UAC5B,QAAQ,QAAQ,IAAI,cAAc;AAAA,QACpC;AAAA,QACA,SAAS;AAAA,UACP,OAAO,QAAQ,IAAI,aAAa;AAAA,UAChC,QAAQ,QAAQ,IAAI,cAAc;AAAA,QACpC;AAAA,QACA,UAAU;AAAA,UACR,cAAc,SAAS,QAAQ,IAAI,kBAAkB,KAAK;AAAA,UAC1D,iBAAiB,QAAQ,IAAI,qBAAqB;AAAA,QACpD;AAAA,MACF;AAAA,IAEF;AACE,YAAM,IAAI,MAAM,wBAAwB,WAAW,EAAE;AAAA,EACzD;AACF;AAKA,SAAS,gBAAyB;AAChC,QAAM,OAAO,sBAAsB;AAEnC,SAAO;AAAA,IACL;AAAA,IACA,MAAM;AAAA,MACJ,OAAO,GAAG,IAAI;AAAA,MACd,UAAU,GAAG,IAAI;AAAA,MACjB,QAAQ,GAAG,IAAI;AAAA,MACf,SAAS,GAAG,IAAI;AAAA,MAChB,QAAQ,GAAG,IAAI;AAAA,MACf,gBAAgB,GAAG,IAAI;AAAA,MACvB,eAAe,GAAG,IAAI;AAAA,MACtB,gBAAgB,GAAG,IAAI;AAAA,IACzB;AAAA,IACA,YAAY;AAAA,MACV,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,QAAQ,CAAC,OAAe,GAAG,IAAI,mBAAmB,EAAE;AAAA,MACpD,QAAQ,CAAC,OAAe,GAAG,IAAI,mBAAmB,EAAE;AAAA,IACtD;AAAA,IACA,UAAU;AAAA,MACR,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,QAAQ,CAAC,OAAe,GAAG,IAAI,iBAAiB,EAAE;AAAA,MAClD,QAAQ,CAAC,OAAe,GAAG,IAAI,iBAAiB,EAAE;AAAA,MAClD,aAAa,CAAC,OAAe,GAAG,IAAI,iBAAiB,EAAE;AAAA,MACvD,YAAY,GAAG,IAAI;AAAA,IACrB;AAAA,IACA,QAAQ;AAAA,MACN,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,QAAQ,CAAC,OAAe,GAAG,IAAI,eAAe,EAAE;AAAA,MAChD,QAAQ,CAAC,OAAe,GAAG,IAAI,eAAe,EAAE;AAAA,MAChD,aAAa,CAAC,gBAAwB,GAAG,IAAI,yBAAyB,WAAW;AAAA,MACjF,cAAc,CAAC,OAAe,GAAG,IAAI,eAAe,EAAE;AAAA,MACtD,OAAO,GAAG,IAAI;AAAA,IAChB;AAAA,IACA,WAAW;AAAA,MACT,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,QAAQ,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MACnD,QAAQ,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MACnD,OAAO,GAAG,IAAI;AAAA,IAChB;AAAA,IACA,SAAS;AAAA,MACP,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,KAAK,CAAC,OAAe,GAAG,IAAI,gBAAgB,EAAE;AAAA,MAC9C,QAAQ,CAAC,OAAe,GAAG,IAAI,yBAAyB,EAAE;AAAA,MAC1D,QAAQ,CAAC,OAAe,GAAG,IAAI,yBAAyB,EAAE;AAAA,MAC1D,OAAO,GAAG,IAAI;AAAA,IAChB;AAAA,IACA,OAAO;AAAA,MACL,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,QAAQ,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MAC/C,QAAQ,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MAC/C,YAAY,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MACnD,cAAc,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MACrD,cAAc,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MACrD,eAAe,GAAG,IAAI;AAAA,MACtB,kBAAkB,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MACzD,oBAAoB,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MAC3D,sBAAsB,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MAC7D,kBAAkB,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,IAC3D;AAAA,IACA,OAAO;AAAA,MACL,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,KAAK,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MAC5C,QAAQ,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MAC/C,QAAQ,CAAC,OAAe,GAAG,IAAI,cAAc,EAAE;AAAA,MAC/C,OAAO,GAAG,IAAI;AAAA,MACd,QAAQ,GAAG,IAAI;AAAA,IACjB;AAAA,IACA,cAAc;AAAA,MACZ,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,KAAK,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACpD,QAAQ,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACvD,QAAQ,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACvD,MAAM,GAAG,IAAI;AAAA,MACb,SAAS,GAAG,IAAI;AAAA,MAChB,SAAS,CAAC,OAAe,GAAG,IAAI,8BAA8B,EAAE;AAAA,MAChE,OAAO,GAAG,IAAI;AAAA,IAChB;AAAA,IACA,eAAe;AAAA,MACb,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,KAAK,CAAC,OAAe,GAAG,IAAI,uBAAuB,EAAE;AAAA,MACrD,QAAQ,CAAC,OAAe,GAAG,IAAI,uBAAuB,EAAE;AAAA,MACxD,QAAQ,CAAC,OAAe,GAAG,IAAI,uBAAuB,EAAE;AAAA,IAC1D;AAAA,IACA,UAAU;AAAA,MACR,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,QAAQ,GAAG,IAAI;AAAA,MACf,KAAK,CAAC,OAAe,GAAG,IAAI,iBAAiB,EAAE;AAAA,MAC/C,QAAQ,CAAC,OAAe,GAAG,IAAI,iBAAiB,EAAE;AAAA,MAClD,QAAQ,CAAC,OAAe,GAAG,IAAI,iBAAiB,EAAE;AAAA,MAClD,SAAS,CAAC,OAAe,GAAG,IAAI,iBAAiB,EAAE;AAAA,MACnD,QAAQ,CAAC,OAAe,GAAG,IAAI,iBAAiB,EAAE;AAAA,MAClD,OAAO,GAAG,IAAI;AAAA,MACd,QAAQ,GAAG,IAAI;AAAA,IACjB;AAAA,IACA,eAAe;AAAA,MACb,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,KAAK,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACpD,QAAQ,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACvD,QAAQ,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACvD,QAAQ,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACvD,QAAQ,GAAG,IAAI;AAAA,MACf,OAAO,GAAG,IAAI;AAAA,IAChB;AAAA,IACA,WAAW;AAAA,MACT,WAAW,GAAG,IAAI;AAAA,MAClB,QAAQ,GAAG,IAAI;AAAA,MACf,SAAS,GAAG,IAAI;AAAA,MAChB,QAAQ,GAAG,IAAI;AAAA,MACf,QAAQ,GAAG,IAAI;AAAA,MACf,aAAa,GAAG,IAAI;AAAA,MACpB,cAAc,GAAG,IAAI;AAAA,MACrB,cAAc,GAAG,IAAI;AAAA,MACrB,kBAAkB,GAAG,IAAI;AAAA,MACzB,WAAW,GAAG,IAAI;AAAA,MAClB,mBAAmB,GAAG,IAAI;AAAA,MAC1B,gBAAgB,GAAG,IAAI;AAAA,MACvB,QAAQ,GAAG,IAAI;AAAA,MACf,cAAc,GAAG,IAAI;AAAA,MACrB,eAAe,GAAG,IAAI;AAAA,MACtB,mBAAmB,GAAG,IAAI;AAAA,IAC5B;AAAA,IACA,WAAW;AAAA,MACT,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,UAAU,GAAG,IAAI;AAAA,MACjB,KAAK,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MAChD,QAAQ,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MACnD,QAAQ,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MACnD,YAAY,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MACvD,SAAS,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MACpD,YAAY,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MACvD,YAAY,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MACvD,SAAS;AAAA,QACP,KAAK,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,QAChD,QAAQ,CAAC,OAAe,GAAG,IAAI,kBAAkB,EAAE;AAAA,MACrD;AAAA,MACA,UAAU;AAAA,QACR,MAAM,CAAC,eAAuB,GAAG,IAAI,kBAAkB,UAAU;AAAA,QACjE,KAAK,CAAC,YAAoB,cAAsB,GAAG,IAAI,kBAAkB,UAAU,aAAa,SAAS;AAAA,QACzG,QAAQ,CAAC,eAAuB,GAAG,IAAI,kBAAkB,UAAU;AAAA,QACnE,QAAQ,CAAC,YAAoB,cAAsB,GAAG,IAAI,kBAAkB,UAAU,aAAa,SAAS;AAAA,QAC5G,QAAQ,CAAC,YAAoB,cAAsB,GAAG,IAAI,kBAAkB,UAAU,aAAa,SAAS;AAAA,MAC9G;AAAA,MACA,QAAQ;AAAA,QACN,MAAM,CAAC,eAAuB,GAAG,IAAI,kBAAkB,UAAU;AAAA,QACjE,KAAK,CAAC,YAAoB,YAAoB,GAAG,IAAI,kBAAkB,UAAU,WAAW,OAAO;AAAA,QACnG,QAAQ,CAAC,eAAuB,GAAG,IAAI,kBAAkB,UAAU;AAAA,QACnE,QAAQ,CAAC,YAAoB,YAAoB,GAAG,IAAI,kBAAkB,UAAU,WAAW,OAAO;AAAA,QACtG,QAAQ,CAAC,YAAoB,YAAoB,GAAG,IAAI,kBAAkB,UAAU,WAAW,OAAO;AAAA,MACxG;AAAA,MACA,OAAO;AAAA,QACL,MAAM,CAAC,eAAuB,GAAG,IAAI,kBAAkB,UAAU;AAAA,QACjE,KAAK,CAAC,YAAoB,WAAmB,GAAG,IAAI,kBAAkB,UAAU,UAAU,MAAM;AAAA,QAChG,QAAQ,CAAC,eAAuB,GAAG,IAAI,kBAAkB,UAAU;AAAA,QACnE,QAAQ,CAAC,YAAoB,WAAmB,GAAG,IAAI,kBAAkB,UAAU,UAAU,MAAM;AAAA,QACnG,QAAQ,CAAC,YAAoB,WAAmB,GAAG,IAAI,kBAAkB,UAAU,UAAU,MAAM;AAAA,MACrG;AAAA,MACA,SAAS;AAAA,QACP,MAAM,CAAC,eAAuB,GAAG,IAAI,kBAAkB,UAAU;AAAA,QACjE,KAAK,CAAC,YAAoB,aAAqB,GAAG,IAAI,kBAAkB,UAAU,YAAY,QAAQ;AAAA,QACtG,QAAQ,CAAC,eAAuB,GAAG,IAAI,kBAAkB,UAAU;AAAA,QACnE,QAAQ,CAAC,YAAoB,aAAqB,GAAG,IAAI,kBAAkB,UAAU,YAAY,QAAQ;AAAA,QACzG,QAAQ,CAAC,YAAoB,aAAqB,GAAG,IAAI,kBAAkB,UAAU,YAAY,QAAQ;AAAA,MAC3G;AAAA,IACF;AAAA,IACF,UAAU;AAAA,MACR,UAAU,GAAG,IAAI;AAAA,MACjB,MAAM,GAAG,IAAI;AAAA,MACb,QAAQ,GAAG,IAAI;AAAA,MACf,SAAS,GAAG,IAAI;AAAA,MAChB,gBAAgB,GAAG,IAAI;AAAA,MACvB,eAAe,GAAG,IAAI;AAAA,MACtB,eAAe,GAAG,IAAI;AAAA,MACtB,aAAa,GAAG,IAAI;AAAA,MACpB,aAAa,GAAG,IAAI;AAAA,MACpB,sBAAsB,GAAG,IAAI;AAAA,MAC7B,sBAAsB,CAAC,OAAe,GAAG,IAAI,8BAA8B,EAAE;AAAA,MAC7E,0BAA0B,GAAG,IAAI;AAAA,IACnC;AAAA,IACA,QAAQ;AAAA,MACN,QAAQ,GAAG,IAAI;AAAA,MACf,gBAAgB,GAAG,IAAI;AAAA,MACvB,cAAc,GAAG,IAAI;AAAA,MACrB,OAAO,GAAG,IAAI;AAAA,MACd,QAAQ,GAAG,IAAI;AAAA,MACf,MAAM,GAAG,IAAI;AAAA,IACf;AAAA,IACE,eAAe;AAAA,MACb,MAAM,GAAG,IAAI;AAAA,MACb,KAAK,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACpD,UAAU,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACzD,YAAY,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MAC3D,aAAa,GAAG,IAAI;AAAA,MACpB,QAAQ,CAAC,OAAe,GAAG,IAAI,sBAAsB,EAAE;AAAA,MACvD,eAAe,GAAG,IAAI;AAAA,MACtB,aAAa,GAAG,IAAI;AAAA,MACpB,aAAa,GAAG,IAAI;AAAA,MACpB,MAAM,GAAG,IAAI;AAAA,IACf;AAAA,IACA,WAAW;AAAA,MACT,MAAM,GAAG,IAAI;AAAA,MACb,OAAO,GAAG,IAAI;AAAA,MACd,QAAQ,GAAG,IAAI;AAAA,IACjB;AAAA,IACA,UAAU;AAAA,MACR,QAAQ,GAAG,IAAI;AAAA,IACjB;AAAA,EACF;AACF;AAnqBA,IA0qBa,WACA,gBAGA,SAGA,uBACA,SACA,eACA,cAGA,eAGA,aAOA,WAGA,cAGA,mBACA,iBACA;AAzsBb;AAAA;AAAA;AA0qBO,IAAM,YAAY,aAAa;AAC/B,IAAM,iBAAiB,eAAe;AAGtC,IAAM,UAAU,cAAc;AAG9B,IAAM,wBAAwB,MAAmB,eAAe;AAChE,IAAM,UAAU,MAAe,eAAe,MAAM;AACpD,IAAM,gBAAgB,MAAe,eAAe,MAAM;AAC1D,IAAM,eAAe,MAAe,eAAe,MAAM;AAGzD,IAAM,gBAAgB,MAAc,sBAAsB;AAG1D,IAAM,cAAc,CAAC,aAA6B;AACvD,YAAM,OAAO,cAAc;AAC3B,YAAM,gBAAgB,SAAS,WAAW,GAAG,IAAI,SAAS,MAAM,CAAC,IAAI;AACrE,aAAO,GAAG,IAAI,IAAI,aAAa;AAAA,IACjC;AAGO,IAAM,YAAY,MAAc,cAAc;AAG9C,IAAM,eAAe,cAAc;AAGnC,IAAM,oBAAoB,MAAM,UAAU,SAAS;AACnD,IAAM,kBAAkB,MAAM,UAAU,KAAK;AAC7C,IAAM,oBAAoB,MAAM,UAAU,KAAK;AAAA;AAAA;;;ACzsBtD;AAAA;AAAA;AACA,QAAIA,aAAY,OAAO;AACvB,QAAIC,oBAAmB,OAAO;AAC9B,QAAIC,qBAAoB,OAAO;AAC/B,QAAIC,gBAAe,OAAO,UAAU;AACpC,QAAIC,YAAW,CAAC,QAAQ,QAAQ;AAC9B,eAAS,QAAQ;AACf,QAAAJ,WAAU,QAAQ,MAAM,EAAE,KAAK,IAAI,IAAI,GAAG,YAAY,KAAK,CAAC;AAAA,IAChE;AACA,QAAIK,eAAc,CAAC,IAAI,MAAM,QAAQ,SAAS;AAC5C,UAAI,QAAQ,OAAO,SAAS,YAAY,OAAO,SAAS,YAAY;AAClE,iBAAS,OAAOH,mBAAkB,IAAI;AACpC,cAAI,CAACC,cAAa,KAAK,IAAI,GAAG,KAAK,QAAQ;AACzC,YAAAH,WAAU,IAAI,KAAK,EAAE,KAAK,MAAM,KAAK,GAAG,GAAG,YAAY,EAAE,OAAOC,kBAAiB,MAAM,GAAG,MAAM,KAAK,WAAW,CAAC;AAAA,MACvH;AACA,aAAO;AAAA,IACT;AACA,QAAIK,gBAAe,CAAC,QAAQD,aAAYL,WAAU,CAAC,GAAG,cAAc,EAAE,OAAO,KAAK,CAAC,GAAG,GAAG;AAGzF,QAAI,wBAAwB,CAAC;AAC7B,IAAAI,UAAS,uBAAuB;AAAA,MAC9B,QAAQ,MAAM;AAAA,MACd,cAAc,MAAMG;AAAA,MACpB,SAAS,MAAM;AAAA,IACjB,CAAC;AACD,WAAO,UAAUD,cAAa,qBAAqB;AAGnD,QAAIE,UAAS;AAAA,MACX,gBAAgB;AAAA,IAClB;AAGA,QAAI,UAAU;AAGd,QAAI,gBAAgB;AAGpB,QAAID,gBAAe,MAAM;AAAA,MACvB,cAAc;AACZ,cAAM,IAAI,MAAM,iGAAiG;AAAA,MACnH;AAAA,IACF;AACA,aAAS,gBAAgB,KAAK;AAC5B,UAAI,OAAO,QAAQ,YAAY;AAC7B,eAAO;AAAA,MACT;AACA,aAAO,CAAC,WAAW,OAAO,SAAS,GAAG;AAAA,IACxC;AACA,aAAS,oBAAoB,MAAM;AACjC,aAAO;AAAA,IACT;AACA,QAAI,SAAS;AAAA,MACX;AAAA,MACA;AAAA,MACA,eAAe,EAAE,QAAQ,eAAe,QAAQC,QAAO,eAAe;AAAA,IACxE;AACA,QAAI,wBAAwB,EAAE,OAAO;AAAA;AAAA;;;AC3DrC,IAAAC,mBAAA;AAAA;AAAA;AAAA,WAAO,UAAU;AAAA,MACf,GAAG;AAAA,IACL;AAAA;AAAA;;;ACOO,IAAM,oBAAoB,CAAC,UAA0B;AAE1D,QAAM,UAAU,MAAM,QAAQ,OAAO,EAAE;AAGvC,MAAI,QAAQ,WAAW,IAAI;AACzB,WAAO,GAAG,QAAQ,MAAM,GAAG,CAAC,CAAC,IAAI,QAAQ,MAAM,GAAG,CAAC,CAAC,IAAI,QAAQ,MAAM,CAAC,CAAC;AAAA,EAC1E,WAAW,QAAQ,WAAW,IAAI;AAChC,WAAO,GAAG,QAAQ,MAAM,GAAG,CAAC,CAAC,IAAI,QAAQ,MAAM,GAAG,CAAC,CAAC,IAAI,QAAQ,MAAM,CAAC,CAAC;AAAA,EAC1E;AAEA,SAAO;AACT;AAKO,IAAM,eAAe,CAAC,SAAyB;AACpD,SAAO,KACJ,YAAY,EACZ,QAAQ,aAAa,EAAE,EACvB,QAAQ,YAAY,GAAG,EACvB,QAAQ,YAAY,EAAE;AAC3B;AAKO,IAAM,eAAe,CAAC,MAAc,cAA8B;AACvE,MAAI,KAAK,UAAU;AAAW,WAAO;AACrC,SAAO,KAAK,MAAM,GAAG,SAAS,IAAI;AACpC;AAKO,IAAM,eAAe,CAAC,UAA2B;AACtD,QAAM,aAAa;AACnB,SAAO,WAAW,KAAK,KAAK;AAC9B;AAKO,IAAM,eAAe,CAAC,UAA2B;AACtD,QAAM,aAAa;AACnB,SAAO,WAAW,KAAK,MAAM,QAAQ,OAAO,EAAE,CAAC;AACjD;AAKO,IAAM,kBAAkB,CAAC,SAAyB;AACvD,SAAO,KACJ,YAAY,EACZ,MAAM,GAAG,EACT,IAAI,UAAQ,KAAK,OAAO,CAAC,EAAE,YAAY,IAAI,KAAK,MAAM,CAAC,CAAC,EACxD,KAAK,GAAG;AACb;AAKO,IAAM,sBAAsB,CAAC,SAAyB;AAC3D,SAAO,KAAK,QAAQ,QAAQ,GAAG,EAAE,KAAK;AACxC;AAKO,IAAM,uBAAuB,CAAC,WAA2B;AAC9D,QAAM,QAAQ;AACd,MAAI,SAAS;AACb,WAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC/B,cAAU,MAAM,OAAO,KAAK,MAAM,KAAK,OAAO,IAAI,MAAM,MAAM,CAAC;AAAA,EACjE;AACA,SAAO;AACT;AAKO,IAAM,UAAU,CAAC,SAA0B;AAChD,SAAO,CAAC,QAAQ,KAAK,KAAK,EAAE,WAAW;AACzC;AAKO,IAAM,cAAc,CAAC,SAAyB;AACnD,SAAO,KACJ,MAAM,GAAG,EACT,IAAI,UAAQ,KAAK,OAAO,CAAC,EAAE,YAAY,CAAC,EACxC,KAAK,EAAE,EACP,MAAM,GAAG,CAAC;AACf;;;AC9FO,IAAM,WAAW,CACtB,MACA,SACuC;AACvC,MAAIC;AACJ,SAAO,IAAI,SAAwB;AACjC,iBAAaA,QAAO;AACpB,IAAAA,WAAU,WAAW,MAAM,KAAK,GAAG,IAAI,GAAG,IAAI;AAAA,EAChD;AACF;AAMO,IAAM,WAAW,CACtB,MACA,UACuC;AACvC,MAAI;AACJ,SAAO,IAAI,SAAwB;AACjC,QAAI,CAAC,YAAY;AACf,WAAK,GAAG,IAAI;AACZ,mBAAa;AACb,iBAAW,MAAO,aAAa,OAAQ,KAAK;AAAA,IAC9C;AAAA,EACF;AACF;AAMO,IAAM,UAAU,CACrB,MACA,iBACM;AACN,QAAM,QAAQ,oBAAI,IAA2B;AAE7C,SAAQ,IAAI,SAAwB;AAClC,UAAM,MAAM,eAAe,aAAa,GAAG,IAAI,IAAI,KAAK,UAAU,IAAI;AAEtE,QAAI,MAAM,IAAI,GAAG,GAAG;AAClB,aAAO,MAAM,IAAI,GAAG;AAAA,IACtB;AAEA,UAAM,SAAS,KAAK,GAAG,IAAI;AAC3B,UAAM,IAAI,KAAK,MAAM;AACrB,WAAO;AAAA,EACT;AACF;AAKO,IAAM,QAAQ,OACnB,IACA,cAAsB,GACtB,YAAoB,QACL;AACf,MAAI;AAEJ,WAAS,UAAU,GAAG,WAAW,aAAa,WAAW;AACvD,QAAI;AACF,aAAO,MAAM,GAAG;AAAA,IAClB,SAAS,OAAO;AACd,kBAAY;AAEZ,UAAI,YAAY,aAAa;AAC3B,cAAM;AAAA,MACR;AAEA,YAAMC,SAAQ,YAAY,KAAK,IAAI,GAAG,UAAU,CAAC;AACjD,YAAM,IAAI,QAAQ,aAAW,WAAW,SAASA,MAAK,CAAC;AAAA,IACzD;AAAA,EACF;AAEA,QAAM;AACR;AAKO,IAAM,OAAO,CAAoC,SAAe;AACrE,MAAI,SAAS;AACb,MAAI;AAEJ,SAAQ,IAAI,SAAwB;AAClC,QAAI,CAAC,QAAQ;AACX,eAAS;AACT,eAAS,KAAK,GAAG,IAAI;AAAA,IACvB;AACA,WAAO;AAAA,EACT;AACF;AAKO,IAAM,QAAQ,CAAC,OAA8B;AAClD,SAAO,IAAI,QAAQ,aAAW,WAAW,SAAS,EAAE,CAAC;AACvD;AAKO,IAAM,UAAU,CAAI,SAAqB,OAA2B;AACzE,SAAO,QAAQ,KAAK;AAAA,IAClB;AAAA,IACA,IAAI;AAAA,MAAe,CAAC,GAAG,WACrB,WAAW,MAAM,OAAO,IAAI,MAAM,qBAAqB,CAAC,GAAG,EAAE;AAAA,IAC/D;AAAA,EACF,CAAC;AACH;;;AC3HA,OAAOC,gBAAe;;;ACEtB,OAAO,eAAe;AAEtB,IAAM,MAAM,UAAU;AASf,IAAK,YAAL,kBAAKC,eAAL;AAEL,EAAAA,WAAA,kBAAe;AACf,EAAAA,WAAA,eAAY;AACZ,EAAAA,WAAA,mBAAgB;AAChB,EAAAA,WAAA,mBAAgB;AAChB,EAAAA,WAAA,yBAAsB;AAGtB,EAAAA,WAAA,sBAAmB;AACnB,EAAAA,WAAA,mBAAgB;AAChB,EAAAA,WAAA,4BAAyB;AAGzB,EAAAA,WAAA,oBAAiB;AACjB,EAAAA,WAAA,qBAAkB;AAClB,EAAAA,WAAA,4BAAyB;AACzB,EAAAA,WAAA,eAAY;AAGZ,EAAAA,WAAA,yBAAsB;AACtB,EAAAA,WAAA,8BAA2B;AAC3B,EAAAA,WAAA,6BAA0B;AAC1B,EAAAA,WAAA,yBAAsB;AACtB,EAAAA,WAAA,0BAAuB;AACvB,EAAAA,WAAA,4BAAyB;AACzB,EAAAA,WAAA,yBAAsB;AACtB,EAAAA,WAAA,mBAAgB;AAChB,EAAAA,WAAA,0BAAuB;AACvB,EAAAA,WAAA,0BAAuB;AACvB,EAAAA,WAAA,0BAAuB;AACvB,EAAAA,WAAA,oBAAiB;AACjB,EAAAA,WAAA,4BAAyB;AAGzB,EAAAA,WAAA,kBAAe;AACf,EAAAA,WAAA,kBAAe;AACf,EAAAA,WAAA,oBAAiB;AACjB,EAAAA,WAAA,wBAAqB;AACrB,EAAAA,WAAA,sBAAmB;AACnB,EAAAA,WAAA,uBAAoB;AACpB,EAAAA,WAAA,qBAAkB;AAClB,EAAAA,WAAA,wBAAqB;AACrB,EAAAA,WAAA,wBAAqB;AACrB,EAAAA,WAAA,oBAAiB;AACjB,EAAAA,WAAA,4BAAyB;AACzB,EAAAA,WAAA,uBAAoB;AACpB,EAAAA,WAAA,yBAAsB;AACtB,EAAAA,WAAA,6BAA0B;AAC1B,EAAAA,WAAA,4BAAyB;AAGzB,EAAAA,WAAA,2BAAwB;AACxB,EAAAA,WAAA,yBAAsB;AACtB,EAAAA,WAAA,mBAAgB;AAGhB,EAAAA,WAAA,oBAAiB;AACjB,EAAAA,WAAA,uBAAoB;AACpB,EAAAA,WAAA,mBAAgB;AA3DN,SAAAA;AAAA,GAAA;AAsFL,SAAS,kBAAqB,UAA6D;AAChG,SAAO,SAAS,YAAY;AAC9B;AAEO,SAAS,gBAAgB,UAA0D;AACxF,SAAO,SAAS,YAAY;AAC9B;AAMO,IAAM,iBAA4C;AAAA;AAAA,EAEvD,CAAC,iCAAsB,GAAG;AAAA,EAC1B,CAAC,2BAAmB,GAAG;AAAA,EACvB,CAAC,mCAAuB,GAAG;AAAA,EAC3B,CAAC,mCAAuB,GAAG;AAAA,EAC3B,CAAC,+CAA6B,GAAG;AAAA;AAAA,EAGjC,CAAC,yCAA0B,GAAG;AAAA,EAC9B,CAAC,mCAAuB,GAAG;AAAA,EAC3B,CAAC,qDAAgC,GAAG;AAAA;AAAA,EAGpC,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,uCAAyB,GAAG;AAAA,EAC7B,CAAC,qDAAgC,GAAG;AAAA,EACpC,CAAC,2BAAmB,GAAG;AAAA;AAAA,EAGvB,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,yDAAkC,GAAG;AAAA,EACtC,CAAC,uDAAiC,GAAG;AAAA,EACrC,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,iDAA8B,GAAG;AAAA,EAClC,CAAC,qDAAgC,GAAG;AAAA,EACpC,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,mCAAuB,GAAG;AAAA,EAC3B,CAAC,iDAA8B,GAAG;AAAA,EAClC,CAAC,iDAA8B,GAAG;AAAA,EAClC,CAAC,iDAA8B,GAAG;AAAA,EAClC,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,qDAAgC,GAAG;AAAA;AAAA,EAGpC,CAAC,iCAAsB,GAAG;AAAA,EAC1B,CAAC,iCAAsB,GAAG;AAAA,EAC1B,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,6CAA4B,GAAG;AAAA,EAChC,CAAC,yCAA0B,GAAG;AAAA,EAC9B,CAAC,2CAA2B,GAAG;AAAA,EAC/B,CAAC,uCAAyB,GAAG;AAAA,EAC7B,CAAC,6CAA4B,GAAG;AAAA,EAChC,CAAC,6CAA4B,GAAG;AAAA,EAChC,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,qDAAgC,GAAG;AAAA,EACpC,CAAC,2CAA2B,GAAG;AAAA,EAC/B,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,uDAAiC,GAAG;AAAA,EACrC,CAAC,qDAAgC,GAAG;AAAA;AAAA,EAGpC,CAAC,mDAA+B,GAAG;AAAA,EACnC,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,mCAAuB,GAAG;AAAA;AAAA,EAG3B,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,2CAA2B,GAAG;AAAA,EAC/B,CAAC,mCAAuB,GAAG;AAC7B;AAMO,IAAM,qBAAgD;AAAA;AAAA,EAE3D,CAAC,iCAAsB,GAAG;AAAA,EAC1B,CAAC,2BAAmB,GAAG;AAAA,EACvB,CAAC,mCAAuB,GAAG;AAAA,EAC3B,CAAC,mCAAuB,GAAG;AAAA,EAC3B,CAAC,+CAA6B,GAAG;AAAA;AAAA,EAGjC,CAAC,yCAA0B,GAAG;AAAA,EAC9B,CAAC,mCAAuB,GAAG;AAAA,EAC3B,CAAC,qDAAgC,GAAG;AAAA;AAAA,EAGpC,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,uCAAyB,GAAG;AAAA,EAC7B,CAAC,qDAAgC,GAAG;AAAA,EACpC,CAAC,2BAAmB,GAAG;AAAA;AAAA,EAGvB,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,yDAAkC,GAAG;AAAA,EACtC,CAAC,uDAAiC,GAAG;AAAA,EACrC,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,iDAA8B,GAAG;AAAA,EAClC,CAAC,qDAAgC,GAAG;AAAA,EACpC,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,mCAAuB,GAAG;AAAA,EAC3B,CAAC,iDAA8B,GAAG;AAAA,EAClC,CAAC,iDAA8B,GAAG;AAAA,EAClC,CAAC,iDAA8B,GAAG;AAAA,EAClC,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,qDAAgC,GAAG;AAAA;AAAA,EAGpC,CAAC,iCAAsB,GAAG;AAAA,EAC1B,CAAC,iCAAsB,GAAG;AAAA,EAC1B,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,6CAA4B,GAAG;AAAA,EAChC,CAAC,yCAA0B,GAAG;AAAA,EAC9B,CAAC,2CAA2B,GAAG;AAAA,EAC/B,CAAC,uCAAyB,GAAG;AAAA,EAC7B,CAAC,6CAA4B,GAAG;AAAA,EAChC,CAAC,6CAA4B,GAAG;AAAA,EAChC,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,qDAAgC,GAAG;AAAA,EACpC,CAAC,2CAA2B,GAAG;AAAA,EAC/B,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,uDAAiC,GAAG;AAAA,EACrC,CAAC,qDAAgC,GAAG;AAAA;AAAA,EAGpC,CAAC,mDAA+B,GAAG;AAAA,EACnC,CAAC,+CAA6B,GAAG;AAAA,EACjC,CAAC,mCAAuB,GAAG;AAAA;AAAA,EAG3B,CAAC,qCAAwB,GAAG;AAAA,EAC5B,CAAC,2CAA2B,GAAG;AAAA,EAC/B,CAAC,mCAAuB,GAAG;AAC7B;AAMO,IAAM,WAAN,cAAuB,MAAM;AAAA,EAMlC,YACE,MACA,SACA,SACA,OACA;AACA,UAAM,eAAe,WAAW,eAAe,IAAI;AACnD,UAAM,YAAY;AAElB,SAAK,OAAO;AACZ,SAAK,OAAO;AACZ,SAAK,aAAa,mBAAmB,IAAI;AACzC,SAAK,UAAU;AACf,SAAK,QAAQ;AAAA,EACf;AAAA,EAEA,aAA+B;AAC7B,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS,KAAK;AAAA,MACd,OAAO,KAAK;AAAA,MACZ,SAAS,KAAK;AAAA,MACd,OAAO,KAAK;AAAA,IACd;AAAA,EACF;AACF;AAMO,IAAM,kBAAN,cAA8B,SAAS;AAAA,EAC5C,YAAY,SAAiB,SAAkB,OAAgB;AAC7D,UAAM,2CAA4B,SAAS,SAAS,KAAK;AACzD,SAAK,OAAO;AAAA,EACd;AACF;AAEO,IAAM,iBAAN,cAA6B,SAAS;AAAA,EAC3C,YAAY,MAAiB,SAAkB,SAAkB,OAAgB;AAC/E,UAAM,MAAM,SAAS,SAAS,KAAK;AACnC,SAAK,OAAO;AAAA,EACd;AACF;AAEO,IAAM,gBAAN,cAA4B,SAAS;AAAA,EAC1C,YAAY,MAAiB,SAAkB,SAAkB;AAC/D,UAAM,MAAM,SAAS,OAAO;AAC5B,SAAK,OAAO;AAAA,EACd;AACF;AAEO,IAAM,oBAAN,cAAgC,SAAS;AAAA,EAC9C,YAAY,SAAkB,SAAkB;AAC9C,UAAM,mCAAwB,SAAS,OAAO;AAC9C,SAAK,OAAO;AAAA,EACd;AACF;AAEO,IAAM,iBAAN,cAA6B,SAAS;AAAA,EAC3C,YAAY,SAAkB,SAAkB;AAC9C,UAAM,6BAAqB,SAAS,OAAO;AAC3C,SAAK,OAAO;AAAA,EACd;AACF;AAEO,IAAM,iBAAN,cAA6B,SAAS;AAAA,EAC3C,YAAY,SAAkB,SAAkB;AAC9C,UAAM,iDAA+B,SAAS,OAAO;AACrD,SAAK,OAAO;AAAA,EACd;AACF;AAMO,SAAS,oBACd,MACA,SACA,SACA,OACkB;AAClB,SAAO;AAAA,IACL,SAAS;AAAA,IACT,SAAS,WAAW,eAAe,IAAI;AAAA,IACvC,OAAO;AAAA,IACP;AAAA,IACA;AAAA,EACF;AACF;AAEO,SAAS,sBACd,MACA,SACuB;AACvB,SAAO;AAAA,IACL,SAAS;AAAA,IACT;AAAA,IACA;AAAA,EACF;AACF;AAMO,SAAS,kBAAkB,OAAsB;AACtD,UAAQ,MAAM,mCAA4B;AAAA,IACxC,MAAM,MAAM;AAAA,IACZ,SAAS,MAAM;AAAA,IACf,MAAM,MAAM;AAAA,EACd,CAAC;AAED,UAAQ,MAAM,MAAM;AAAA,IAClB,KAAK,SAAS;AAEZ,YAAM,SAAS,MAAM,MAAM;AAC3B,YAAM,QAAQ,MAAM,QAAQ,MAAM,IAAI,OAAO,CAAC,IAAI;AAElD,UAAI,OAAO,SAAS,OAAO,GAAG;AAC5B,eAAO,IAAI;AAAA,UACT;AAAA,UACA;AAAA,UACA,UAAU,KAAK;AAAA,UACf;AAAA,QACF;AAAA,MACF;AAEA,UAAI,OAAO,SAAS,OAAO,GAAG;AAC5B,eAAO,IAAI;AAAA,UACT;AAAA,UACA;AAAA,UACA,UAAU,KAAK;AAAA,UACf;AAAA,QACF;AAAA,MACF;AAEA,aAAO,IAAI;AAAA,QACT;AAAA,QACA;AAAA,QACA,UAAU,KAAK;AAAA,MACjB;AAAA,IACF;AAAA,IAEA,KAAK,SAAS;AAEZ,YAAM,YAAY,MAAM,MAAM;AAC9B,aAAO,IAAI;AAAA,QACT;AAAA,QACA,sBAAsB,SAAS;AAAA,QAC/B,UAAU,SAAS;AAAA,MACrB;AAAA,IACF;AAAA,IAEA,KAAK,SAAS;AAEZ,aAAO,IAAI;AAAA,QACT;AAAA,QACA;AAAA,QACA,MAAM;AAAA,MACR;AAAA,IACF;AAAA,IAEA,KAAK,SAAS;AAEZ,aAAO,IAAI;AAAA,QACT;AAAA,QACA;AAAA,QACA,MAAM;AAAA,MACR;AAAA,IACF;AAAA,IAEA,SAAS;AACP,aAAO,IAAI;AAAA,QACT;AAAA,QACA;AAAA,QACA,MAAM;AAAA,MACR;AAAA,IACF;AAAA,EACF;AACF;AAMO,SAAS,sBAAsB,OAAsB;AAC1D,MAAI,MAAM,SAAS,YAAY;AAC7B,UAAM,aAAa,MAAM,OAAO,CAAC;AACjC,UAAM,QAAQ,WAAW,KAAK,KAAK,GAAG;AAEtC,WAAO,IAAI;AAAA,MACT;AAAA,MACA,WAAW;AAAA,MACX,UAAU,KAAK;AAAA,MACf;AAAA,IACF;AAAA,EACF;AAEA,SAAO,IAAI;AAAA,IACT;AAAA,IACA,MAAM,WAAW;AAAA,EACnB;AACF;AAMO,SAAS,oBAAoB,OAAsB;AACxD,MAAI,iBAAiB,UAAU;AAC7B,WAAO;AAAA,EACT;AAEA,MAAI,MAAM,SAAS,SAAS,WAAW,GAAG;AACxC,QAAI,MAAM,QAAQ,SAAS,UAAU,GAAG;AACtC,aAAO,IAAI,SAAS,+CAA8B,MAAM,OAAO;AAAA,IACjE;AACA,QAAI,MAAM,QAAQ,SAAS,QAAQ,GAAG;AACpC,aAAO,IAAI,SAAS,2CAA4B,MAAM,OAAO;AAAA,IAC/D;AACA,QAAI,MAAM,QAAQ,SAAS,MAAM,GAAG;AAClC,aAAO,IAAI,SAAS,uCAA0B,MAAM,OAAO;AAAA,IAC7D;AACA,QAAI,MAAM,QAAQ,SAAS,SAAS,GAAG;AACrC,aAAO,IAAI,SAAS,6CAA6B,MAAM,OAAO;AAAA,IAChE;AACA,QAAI,MAAM,QAAQ,SAAS,OAAO,GAAG;AACnC,aAAO,IAAI,SAAS,yCAA2B,MAAM,OAAO;AAAA,IAC9D;AACA,QAAI,MAAM,QAAQ,SAAS,UAAU,GAAG;AACtC,aAAO,IAAI,SAAS,+CAA8B,MAAM,OAAO;AAAA,IACjE;AACA,QAAI,MAAM,QAAQ,SAAS,UAAU,GAAG;AACtC,aAAO,IAAI,SAAS,+CAA8B,MAAM,OAAO;AAAA,IACjE;AACA,QAAI,MAAM,QAAQ,SAAS,MAAM,GAAG;AAClC,aAAO,IAAI,SAAS,uCAA0B,MAAM,OAAO;AAAA,IAC7D;AACA,QAAI,MAAM,QAAQ,SAAS,cAAc,GAAG;AAC1C,aAAO,IAAI,SAAS,uDAAkC,MAAM,OAAO;AAAA,IACrE;AACA,QAAI,MAAM,QAAQ,SAAS,SAAS,GAAG;AACrC,aAAO,IAAI,SAAS,6CAA6B,MAAM,OAAO;AAAA,IAChE;AACA,QAAI,MAAM,QAAQ,SAAS,WAAW,GAAG;AACvC,aAAO,IAAI,SAAS,iDAA+B,MAAM,OAAO;AAAA,IAClE;AACA,QAAI,MAAM,QAAQ,SAAS,eAAe,GAAG;AAC3C,aAAO,IAAI,SAAS,yDAAmC,MAAM,OAAO;AAAA,IACtE;AACA,QAAI,MAAM,QAAQ,SAAS,cAAc,GAAG;AAC1C,aAAO,IAAI,SAAS,uDAAkC,MAAM,OAAO;AAAA,IACrE;AAAA,EACF;AAEA,MAAI,MAAM,SAAS,SAAS,oBAAoB,GAAG;AACjD,QAAI,MAAM,QAAQ,SAAS,OAAO,GAAG;AACnC,aAAO,IAAI,SAAS,mCAAwB,MAAM,OAAO;AAAA,IAC3D;AACA,QAAI,MAAM,QAAQ,SAAS,OAAO,GAAG;AACnC,aAAO,IAAI,SAAS,mCAAwB,MAAM,OAAO;AAAA,IAC3D;AAAA,EACF;AAEA,MAAI,MAAM,SAAS,SAAS,gBAAgB,GAAG;AAC7C,QAAI,MAAM,QAAQ,SAAS,OAAO,GAAG;AACnC,aAAO,IAAI,SAAS,mDAAgC,MAAM,OAAO;AAAA,IACnE;AAAA,EACF;AAEA,MAAI,MAAM,SAAS,SAAS,YAAY,GAAG;AACzC,WAAO,IAAI,SAAS,iDAA+B,MAAM,OAAO;AAAA,EAClE;AAEA,MAAI,MAAM,SAAS,SAAS,YAAY,GAAG;AACzC,WAAO,IAAI,SAAS,2DAAoC,MAAM,OAAO;AAAA,EACvE;AAEA,MAAI,MAAM,SAAS,SAAS,aAAa,GAAG;AAC1C,WAAO,IAAI,SAAS,iDAA+B,MAAM,OAAO;AAAA,EAClE;AAEA,MAAI,MAAM,SAAS,SAAS,cAAc,GAAG;AAC3C,QAAI,MAAM,QAAQ,SAAS,SAAS,GAAG;AACrC,aAAO,IAAI,SAAS,mDAAgC,MAAM,OAAO;AAAA,IACnE;AACA,QAAI,MAAM,QAAQ,SAAS,WAAW,GAAG;AACvC,aAAO,IAAI,SAAS,uDAAkC,MAAM,OAAO;AAAA,IACrE;AACA,QAAI,MAAM,QAAQ,SAAS,QAAQ,GAAG;AACpC,aAAO,IAAI,SAAS,iDAA+B,MAAM,OAAO;AAAA,IAClE;AAAA,EACF;AAEA,MAAI,MAAM,SAAS,SAAS,OAAO,GAAG;AACpC,QAAI,MAAM,QAAQ,SAAS,SAAS,GAAG;AACrC,aAAO,IAAI,SAAS,qCAAyB,MAAM,OAAO;AAAA,IAC5D;AAAA,EACF;AAEA,MAAI,MAAM,SAAS,SAAS,cAAc,GAAG;AAC3C,WAAO,IAAI,SAAS,mDAAgC,MAAM,OAAO;AAAA,EACnE;AAEA,MAAI,MAAM,SAAS,SAAS,SAAS,GAAG;AACtC,QAAI,MAAM,QAAQ,SAAS,QAAQ,GAAG;AACpC,aAAO,IAAI,SAAS,uCAA0B,MAAM,OAAO;AAAA,IAC7D;AACA,QAAI,MAAM,QAAQ,SAAS,SAAS,GAAG;AACrC,aAAO,IAAI,SAAS,uDAAkC,MAAM,OAAO;AAAA,IACrE;AAAA,EACF;AAEA,MAAI,MAAM,SAAS,SAAS,sBAAsB,GAAG;AACnD,WAAO,IAAI,SAAS,mDAAgC,MAAM,OAAO;AAAA,EACnE;AAEA,SAAO,IAAI;AAAA,IACT;AAAA,IACA,MAAM,WAAW;AAAA,EACnB;AACF;AAMO,SAAS,eAAe,OAG7B;AACA,UAAQ,MAAM,wBAAiB,KAAK;AAEpC,MAAI;AAGJ,MAAI,iBAAiB,UAAU;AAC7B,eAAW;AAAA,EACb,WAAW,MAAM,QAAQ,MAAM,KAAK,WAAW,GAAG,GAAG;AAEnD,eAAW,kBAAkB,KAAK;AAAA,EACpC,WAAW,MAAM,SAAS,YAAY;AAEpC,eAAW,sBAAsB,KAAK;AAAA,EACxC,OAAO;AAEL,eAAW,oBAAoB,KAAK;AAAA,EACtC;AAEA,QAAM,WAAW;AAAA,IACf,SAAS;AAAA,IACT,SAAS;AAAA,IACT,SAAS;AAAA,IACT,SAAS;AAAA,EACX;AAEA,SAAO;AAAA,IACL;AAAA,IACA,YAAY,SAAS;AAAA,EACvB;AACF;AAyBO,IAAM,cAAc,CAAC,UAAwB;AAClD,SACE,OAAO,SAAS,SAAS,yBAAyB,KAClD,OAAO,SAAS,SAAS,cAAc,KACvC,OAAO,SAAS,SAAS,eAAe,KACxC,OAAO,SAAS,SAAS,eAAe,KACxC,OAAO,WAAW,IAAI,OAAO,gBAC7B,OAAO,WAAW;AAEtB;AAKO,IAAM,oBAAoB,CAAC,UAAwB;AACxD,SACE,OAAO,SAAS,SAAS,WAAW,KACpC,OAAO,SAAS,SAAS,eAAe,KACxC,OAAO,SAAS,SAAS,0BAA0B,KACnD,OAAO,WAAW,IAAI,OAAO,aAC7B,OAAO,WAAW;AAEtB;AAKA,IAAM,yBAAyB,CAAC,UAAwB;AACtD,MAAI,CAAC;AAAO,WAAO;AAEnB,QAAM,UAAU,MAAM,WAAW,MAAM,SAAS;AAChD,QAAM,OAAO,MAAM,QAAQ;AAE3B,SACE,SAAS,yBACT,QAAQ,YAAY,EAAE,SAAS,cAAc,KAC7C,QAAQ,YAAY,EAAE,SAAS,YAAY,KAC3C,QAAQ,YAAY,EAAE,SAAS,eAAe,KAC9C,QAAQ,YAAY,EAAE,SAAS,WAAW,KAC1C,QAAQ,YAAY,EAAE,SAAS,SAAS,KACxC,QAAQ,YAAY,EAAE,SAAS,WAAW,KAC1C,QAAQ,YAAY,EAAE,SAAS,UAAU,KACzC,QAAQ,YAAY,EAAE,SAAS,QAAQ;AAE3C;AAKO,IAAM,iBAAiB,CAAC,UAAwB;AACrD,SACE,OAAO,SAAS,SAAS,eAAe,KACxC,OAAO,SAAS,SAAS,iBAAiB,KAC1C,OAAO,SAAS,SAAS,mBAAmB,KAC5C,OAAO,WAAW,IAAI,OAAO,uBAC7B,OAAO,WAAW;AAEtB;AAKO,IAAM,oBAAoB,CAAC,UAAwB;AACxD,SACE,OAAO,SAAS,SAAS,mBAAmB,KAC5C,OAAO,SAAS,SAAS,eAAe,KACxC,OAAO,SAAS,SAAS,gBAAgB,KACzC,OAAO,WAAW,IAAI,OAAO,eAC7B,OAAO,WAAW;AAEtB;AAKO,IAAM,eAAe,CAAC,UAA0B;AACrD,UAAQ,IAAI,uCAAgC,KAAK;AAGjD,MAAI,YAAY,KAAK,GAAG;AACtB,YAAQ,IAAI,iEAA0D;AACtE,kBAAc;AAEd,WAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS;AAAA,MACT,OAAO;AAAA,MACP,iBAAiB;AAAA,MACjB,eAAe;AAAA,IACjB;AAAA,EACF;AAGA,MAAI,kBAAkB,KAAK,GAAG;AAC5B,WAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS;AAAA,MACT,OAAO;AAAA,MACP,iBAAiB;AAAA,MACjB,eAAe;AAAA,IACjB;AAAA,EACF;AAGA,MAAI,uBAAuB,KAAK,GAAG;AACjC,WAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS;AAAA,MACT,OAAO;AAAA,MACP,iBAAiB;AAAA,MACjB,eAAe;AAAA,IACjB;AAAA,EACF;AAGA,MAAI,eAAe,KAAK,GAAG;AACzB,WAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS;AAAA,MACT,OAAO;AAAA,MACP,iBAAiB;AAAA,MACjB,eAAe;AAAA,IACjB;AAAA,EACF;AAGA,MAAI,kBAAkB,KAAK,GAAG;AAC5B,WAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS;AAAA,MACT,OAAO;AAAA,MACP,iBAAiB;AAAA,MACjB,eAAe;AAAA,IACjB;AAAA,EACF;AAGA,SAAO;AAAA,IACL,MAAM;AAAA,IACN,SAAS;AAAA,IACT,OAAO;AAAA,IACP,iBAAiB;AAAA,IACjB,eAAe;AAAA,EACjB;AACF;;;ADvwBA,IAAMC,OAAMF,WAAU;AAiBf,IAAM,eAAe,CAAC,aAA6B;AAExD,QAAM,gBAAgB,SAAS,WAAW,GAAG,IAAI,SAAS,MAAM,CAAC,IAAI;AAGrE,MAAI,cAAc,WAAW,SAAS,KAAK,cAAc,WAAW,UAAU,GAAG;AAC/E,WAAO;AAAA,EACT;AAGA,MAAI,cAAc,WAAW,MAAM,GAAG;AAEpC,QAAI;AACF,YAAM,EAAE,SAAAG,SAAQ,IAAI;AACpB,aAAO,GAAGA,SAAQ,IAAI,IAAI,aAAa;AAAA,IACzC,QAAQ;AAEN,YAAM,UAAU,QAAQ,IAAI,uBAAuB;AACnD,aAAO,GAAG,OAAO,IAAI,aAAa;AAAA,IACpC;AAAA,EACF;AAGA,SAAO,QAAQ,aAAa;AAC9B;AAUO,IAAM,cAAc,OACzB,KACA,UAAuB,CAAC,MACF;AACtB,UAAQ,IAAI,oDAA6C,GAAG;AAC5D,UAAQ,IAAI,4CAAqC,OAAO;AAGxD,MAAI,CAAC,OAAO,OAAO,QAAQ,UAAU;AACnC,YAAQ,IAAI,2CAAoC;AAChD,UAAM,IAAI,MAAM,sCAAsC;AAAA,EACxD;AAGA,QAAM,UAAkC;AAAA,IACtC,CAACD,KAAI,QAAQ,YAAY,GAAGA,KAAI,cAAc;AAAA,IAC9C,CAACA,KAAI,QAAQ,MAAM,GAAGA,KAAI,cAAc;AAAA,EAC1C;AAGA,QAAM,UAAU,aAAa,GAAG;AAGhC,QAAM,iBAA8B;AAAA,IAClC,GAAG;AAAA,IACH,SAAS;AAAA,MACP,GAAG;AAAA,MACH,GAAG,QAAQ;AAAA,IACb;AAAA,EACF;AAEA,UAAQ,IAAI,6BAAsB,eAAe,UAAU,KAAK,IAAI,OAAO,EAAE;AAE7E,MAAI;AACF,UAAM,WAAW,MAAM,MAAM,SAAS,cAAc;AACpD,YAAQ,IAAI,2BAAsB,SAAS,MAAM,IAAI,SAAS,UAAU,EAAE;AAC1E,WAAO;AAAA,EACT,SAAS,OAAO;AACd,YAAQ,MAAM,iCAA4B,KAAK;AAC/C,UAAM;AAAA,EACR;AACF;AAWO,IAAM,qBAAqB,OAChC,KACA,UAAuB,CAAC,MACF;AACtB,UAAQ,IAAI,2DAAoD,GAAG;AACnE,UAAQ,IAAI,mDAA4C,OAAO;AAG/D,MAAI,CAAC,OAAO,OAAO,QAAQ,UAAU;AACnC,YAAQ,IAAI,2CAAoC;AAChD,UAAM,IAAI,MAAM,sCAAsC;AAAA,EACxD;AAGA,QAAM,QAAQ,aAAa;AAC3B,UAAQ,IAAI,gDAAyC,QAAQ,GAAG,MAAM,UAAU,GAAG,EAAE,CAAC,QAAQ,UAAU;AAGxG,MAAI,SAAS,OAAO,WAAW,aAAa;AAC1C,QAAI;AACF,YAAM,QAAQ,MAAM,MAAM,GAAG;AAC7B,UAAI,MAAM,WAAW,GAAG;AACtB,cAAM,UAAU,KAAK,MAAM,KAAK,MAAM,CAAC,CAAC,CAAC;AACzC,cAAM,MAAM,KAAK,MAAM,KAAK,IAAI,IAAI,GAAI;AACxC,gBAAQ,IAAI,oCAA6B;AAAA,UACvC,QAAQ,QAAQ;AAAA,UAChB,OAAO,QAAQ;AAAA,UACf,MAAM,QAAQ;AAAA,UACd,KAAK,QAAQ;AAAA,UACb;AAAA,UACA,SAAS,QAAQ,MAAM;AAAA,UACvB,iBAAiB,QAAQ,MAAM;AAAA,QACjC,CAAC;AAGD,YAAI,QAAQ,MAAM,KAAK;AACrB,kBAAQ,IAAI,0DAAmD;AAC/D,wBAAc;AACd,gBAAM,IAAI,MAAM,qCAAqC;AAAA,QACvD;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,cAAQ,IAAI,gDAAyC,KAAK;AAC1D,oBAAc;AACd,YAAM,IAAI,MAAM,qCAAqC;AAAA,IACvD;AAAA,EACF;AAGA,MAAI,CAAC,SAAS,OAAO,WAAW,aAAa;AAC3C,YAAQ,IAAI,0EAAmE;AAE/E,kBAAc;AAEd,eAAW,MAAM;AAAA,IAEjB,GAAG,GAAG;AACN,UAAM,IAAI,MAAM,yBAAyB;AAAA,EAC3C;AAGA,QAAM,UAAkC;AAAA,IACtC,CAACA,KAAI,QAAQ,YAAY,GAAGA,KAAI,cAAc;AAAA,IAC9C,CAACA,KAAI,QAAQ,MAAM,GAAGA,KAAI,cAAc;AAAA,IACxC,GAAI,QAAQ;AAAA,EACd;AAGA,MAAI,OAAO;AACT,YAAQA,KAAI,QAAQ,aAAa,IAAI,UAAU,KAAK;AACpD,YAAQ,IAAI,iDAA0C,UAAU,MAAM,UAAU,GAAG,EAAE,CAAC,KAAK;AAAA,EAC7F;AAEA,UAAQ,IAAI,sCAA+B,OAAO;AAGlD,QAAM,iBAA8B;AAAA,IAClC,QAAQA,KAAI,QAAQ;AAAA,IACpB;AAAA,IACA,GAAG;AAAA,EACL;AAEA,UAAQ,IAAI,8CAAuC,cAAc;AAEjE,MAAI;AACF,YAAQ,IAAI,gDAAyC,GAAG;AACxD,YAAQ,IAAI,qCAA8B,QAAQ,IAAI;AACtD,UAAM,WAAW,MAAM,MAAM,KAAK,cAAc;AAChD,YAAQ,IAAI,0CAAmC;AAAA,MAC7C,QAAQ,SAAS;AAAA,MACjB,YAAY,SAAS;AAAA,MACrB,IAAI,SAAS;AAAA,MACb,KAAK,SAAS;AAAA,MACd,SAAS,OAAO,YAAY,SAAS,QAAQ,QAAQ,CAAC;AAAA,IACxD,CAAC;AAGD,QAAI,SAAS,WAAWA,KAAI,OAAO,kBAAkB;AACnD,cAAQ,IAAI,iFAA0E;AAEtF,UAAI;AACF,cAAM,YAAY,MAAM,SAAS,MAAM,EAAE,KAAK;AAC9C,gBAAQ,IAAI,0CAAmC,SAAS;AAGxD,cAAM,IAAI,MAAM,UAAU,WAAW,6BAA6B;AAAA,MACpE,SAAS,YAAY;AACnB,gBAAQ,IAAI,wDAAiD;AAC7D,cAAM,IAAI,MAAM,6BAA6B;AAAA,MAC/C;AAAA,IACF;AAGA,QAAI,SAAS,WAAWA,KAAI,OAAO,cAAc;AAC/C,cAAQ,IAAI,wDAAiD;AAG7D,UAAI,OAAO,WAAW,aAAa;AACjC,gBAAQ,IAAI,oEAA6D;AACzE,sBAAc;AAEd,eAAO,SAAS,OAAO;AAAA,MACzB;AACA,YAAM,IAAI,MAAM,4CAA4C;AAAA,IAC9D;AAEA,QAAI,SAAS,WAAWA,KAAI,OAAO,WAAW;AAC5C,YAAM,IAAI,MAAM,6CAA6C;AAAA,IAC/D;AAEA,QAAI,SAAS,UAAU,KAAK;AAC1B,YAAM,IAAI,MAAM,uCAAuC;AAAA,IACzD;AAEA,QAAI,SAAS,UAAUA,KAAI,OAAO,uBAAuB;AACvD,YAAM,IAAI,MAAM,uBAAuB;AAAA,IACzC;AAEA,WAAO;AAAA,EACT,SAAS,OAAO;AAEd,QAAI,iBAAiB,aAAa,MAAM,QAAQ,SAAS,OAAO,GAAG;AACjE,YAAM,IAAI,MAAMA,KAAI,YAAY,aAAa;AAAA,IAC/C;AACA,UAAM;AAAA,EACR;AACF;AAeO,IAAM,mBAAmB,OAAU,aAAgD;AACxF,UAAQ,IAAI,yDAAkD,SAAS,MAAM;AAC7E,UAAQ,IAAI,iCAA0B,SAAS,EAAE;AACjD,UAAQ,IAAI,kCAA2B,SAAS,GAAG;AAInD,MAAI,CAAC,SAAS,IAAI;AAChB,YAAQ,MAAM,6DAAwD,SAAS,MAAM;AACrF,YAAQ,MAAM,yDAAoD,SAAS,UAAU;AACrF,YAAQ,MAAM,kDAA6C,SAAS,GAAG;AAGvE,QAAI,SAAS,WAAWA,KAAI,OAAO,cAAc;AAC/C,UAAI,OAAO,WAAW,aAAa;AACjC,gBAAQ,MAAM,4DAAqD;AACnE,gBAAQ,MAAM,iEAA0D;AACxE,gBAAQ,MAAM,mFAA4E;AAC1F,gBAAQ,MAAM,gDAAyC,SAAS,MAAM;AACtE,gBAAQ,MAAM,6CAAsC,SAAS,GAAG;AAGhE,YAAI;AACF,gBAAM,eAAe,MAAM,SAAS,MAAM,EAAE,KAAK;AACjD,kBAAQ,MAAM,+CAAwC,YAAY;AAAA,QACpE,SAAS,GAAG;AACV,kBAAQ,MAAM,8DAAuD,CAAC;AAAA,QACxE;AAEA,sBAAc;AAEd,gBAAQ,MAAM,oEAA6D;AAAA,MAE7E;AACA,YAAM,IAAI,MAAM,4CAA4C;AAAA,IAC9D;AAEA,UAAM,YAAY,MAAM,SAAS,KAAK;AACtC,YAAQ,IAAI,oDAA6C,SAAS;AAElE,QAAI;AACF,YAAM,YAAY,KAAK,MAAM,SAAS;AACtC,cAAQ,IAAI,kDAA2C,SAAS;AAGhE,UAAI,UAAU,YAAY,SAAS,UAAU,WAAW,UAAU,OAAO;AACvE,gBAAQ,IAAI,gEAAyD;AACrE,cAAME,UAAS;AAAA,UACb,SAAS;AAAA,UACT,SAAS,UAAU;AAAA;AAAA,UACnB,OAAO,UAAU;AAAA;AAAA,QACnB;AACA,gBAAQ,IAAI,2DAAoDA,OAAM;AACtE,eAAOA;AAAA,MACT;AAGA,UAAI,UAAU,YAAY,SAAS,UAAU,OAAO;AAClD,gBAAQ,IAAI,yDAAkD;AAG9D,cAAM,6BACJ,UAAU,UAAU;AAAA,SAElB,UAAU,sBAAsB,QAChC,UAAU,YAAY,kBACtB,UAAU,YAAY,UACtB,UAAU,uBAAuB,eACjC,UAAU,uBAAuB;AAAA,QAEjC,SAAS,IAAI,SAAS,eAAe,KACrC,SAAS,IAAI,SAAS,OAAO,KAC7B,SAAS,IAAI,SAAS,UAAU;AAAA,QAEhC,UAAU,cAAc,4BACxB,UAAU,cAAc,oBACxB,UAAU,cAAc;AAI5B,cAAMA,UAAS;AAAA,UACb,SAAS;AAAA,UACT,SAAS,UAAU;AAAA;AAAA,UACnB,OAAO,UAAU,aAA0B;AAAA;AAAA,UAE3C,GAAI,8BAA8B;AAAA,YAChC,SAAS;AAAA,UACX;AAAA,QACF;AACA,gBAAQ,IAAI,oDAA6CA,OAAM;AAC/D,eAAOA;AAAA,MACT;AAGA,cAAQ,IAAI,4DAAqD;AAGjE,YAAM,oCACJ,UAAU,YAAY;AAAA,OAEpB,UAAU,sBAAsB,QAChC,UAAU,YAAY,kBACtB,UAAU,YAAY,UACtB,UAAU,uBAAuB,eACjC,UAAU,uBAAuB;AAAA,MAEjC,SAAS,IAAI,SAAS,eAAe,KACrC,SAAS,IAAI,SAAS,OAAO,KAC7B,SAAS,IAAI,SAAS,UAAU;AAAA,MAEhC,UAAU,cAAc,4BACxB,UAAU,cAAc,oBACxB,UAAU,cAAc;AAI5B,YAAM,SAAS;AAAA,QACb,SAAS;AAAA,QACT,SAAS,UAAU,WAAW,QAAQ,SAAS,MAAM,KAAK,SAAS,UAAU;AAAA,QAC7E,OAAO,UAAU,aAA0B;AAAA;AAAA,QAE3C,GAAI,qCAAqC;AAAA,UACvC,SAAS;AAAA,QACX;AAAA,MACF;AACA,cAAQ,IAAI,uDAAgD,MAAM;AAClE,aAAO;AAAA,IACT,QAAQ;AACN,cAAQ,IAAI,wEAAiE;AAC7E,YAAM,SAAS;AAAA,QACb,SAAS;AAAA,QACT,SAAS,QAAQ,SAAS,MAAM,KAAK,SAAS,UAAU;AAAA,QACxD,OAAO;AAAA,MACT;AACA,cAAQ,IAAI,yDAAkD,MAAM;AACpE,aAAO;AAAA,IACT;AAAA,EACF;AAEA,MAAI;AACF,UAAM,eAAe,MAAM,SAAS,KAAK;AAKzC,QAAI,aAAa,WAAW,aAAa,SAAS,QAAW;AAC3D,aAAO;AAAA,QACL,SAAS;AAAA,QACT,MAAM,aAAa;AAAA;AAAA,MACrB;AAAA,IACF;AAGA,WAAO;AAAA,MACL,SAAS;AAAA,MACT,MAAM;AAAA,IACR;AAAA,EACF,SAAS,OAAO;AACd,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,OAAO;AAAA,IACT;AAAA,EACF;AACF;AA0BO,IAAM,kBAAkB,MAAe;AAC5C,MAAI,OAAO,WAAW;AAAa,WAAO;AAE1C,QAAM,QAAQ,aAAa;AAC3B,SAAO,CAAC,CAAC;AACX;AA0CO,IAAM,eAAe,MAAqB;AAC/C,MAAI,OAAO,WAAW;AAAa,WAAO;AAG1C,QAAM,WAAW,aAAa,QAAQ,UAAU;AAChD,MAAI,UAAU;AACZ,QAAI;AACF,YAAM,SAAS,KAAK,MAAM,QAAQ;AAClC,UAAI,OAAO,SAAS,OAAO,WAAW;AAEpC,YAAI,KAAK,IAAI,IAAI,OAAO,WAAW;AACjC,kBAAQ,IAAI,gDAAyC;AACrD,wBAAc;AACd,iBAAO;AAAA,QACT;AACA,eAAO,OAAO;AAAA,MAChB;AAAA,IACF,SAAS,OAAO;AACd,cAAQ,KAAK,6BAA6B,KAAK;AAC/C,oBAAc;AACd,aAAO;AAAA,IACT;AAAA,EACF;AAGA,QAAM,QAAQ,aAAa,QAAQ,WAAW;AAC9C,MAAI,OAAO;AAET,QAAI;AACF,YAAM,QAAQ,MAAM,MAAM,GAAG;AAC7B,UAAI,MAAM,WAAW,GAAG;AACtB,cAAM,UAAU,KAAK,MAAM,KAAK,MAAM,CAAC,CAAC,CAAC;AACzC,YAAI,QAAQ,KAAK;AACf,gBAAM,MAAM,KAAK,MAAM,KAAK,IAAI,IAAI,GAAI;AACxC,cAAI,QAAQ,MAAM,KAAK;AACrB,oBAAQ,IAAI,gDAAyC;AACrD,0BAAc;AACd,mBAAO;AAAA,UACT;AAAA,QACF;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,cAAQ,KAAK,oDAAoD,KAAK;AACtE,oBAAc;AACd,aAAO;AAAA,IACT;AACA,WAAO;AAAA,EACT;AAEA,SAAO;AACT;AAKO,IAAM,gBAAgB,MAAyB;AACpD,MAAI,OAAO,WAAW;AAAa,WAAO;AAE1C,MAAI;AAEF,UAAM,WAAW,aAAa,QAAQ,UAAU;AAChD,QAAI,UAAU;AACZ,YAAM,SAAS,KAAK,MAAM,QAAQ;AAClC,UAAI,OAAO,MAAM;AAEf,YAAI,OAAO,aAAa,KAAK,IAAI,IAAI,OAAO,WAAW;AACrD,wBAAc;AACd,iBAAO;AAAA,QACT;AACA,eAAO,OAAO;AAAA,MAChB;AAAA,IACF;AAGA,UAAM,WAAW,aAAa,QAAQ,UAAU;AAChD,QAAI,UAAU;AACZ,YAAM,OAAO,KAAK,MAAM,QAAQ;AAGhC,UAAI,KAAK,aAAa,KAAK,IAAI,IAAI,KAAK,WAAW;AACjD,sBAAc;AACd,eAAO;AAAA,MACT;AAEA,aAAO;AAAA,IACT;AAEA,WAAO;AAAA,EACT,SAAS,OAAO;AACd,YAAQ,MAAM,qCAAqC,KAAK;AACxD,kBAAc;AACd,WAAO;AAAA,EACT;AACF;AAMO,IAAM,gBAAgB,CAAC,OAAe,SAAqB;AAChE,MAAI,OAAO,WAAW;AAAa;AAGnC,MAAI,YAAY,KAAK,IAAI,IAAK,KAAK,KAAK,KAAK;AAC7C,MAAI;AACF,UAAM,QAAQ,MAAM,MAAM,GAAG;AAC7B,QAAI,MAAM,WAAW,GAAG;AACtB,YAAM,UAAU,KAAK,MAAM,KAAK,MAAM,CAAC,CAAC,CAAC;AACzC,UAAI,QAAQ,KAAK;AACf,oBAAY,QAAQ,MAAM;AAAA,MAC5B;AAAA,IACF;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,KAAK,mDAAmD,KAAK;AAAA,EACvE;AAEA,QAAM,WAAW;AAAA,IACf;AAAA,IACA,MAAM;AAAA,MACJ,IAAI,KAAK;AAAA,MACT,WAAW,KAAK;AAAA,MAChB,UAAU,KAAK;AAAA,MACf,MAAM,KAAK;AAAA,MACX,OAAO,KAAK;AAAA,MACZ,OAAO,KAAK;AAAA,MACZ,MAAM,KAAK;AAAA,MACX,UAAU,KAAK;AAAA,MACf,WAAW,KAAK;AAAA,MAChB,eAAe,KAAK;AAAA,MACpB,WAAW,KAAK;AAAA,MAChB,YAAY,KAAK,aAAa,OAAO,KAAK,UAAU,IAAI;AAAA,MACxD,UAAU,KAAK,WAAW,OAAO,KAAK,QAAQ,IAAI;AAAA,IACpD;AAAA,IACA;AAAA;AAAA,EACF;AAGA,eAAa,QAAQ,YAAY,KAAK,UAAU,QAAQ,CAAC;AAGzD,eAAa,WAAW,WAAW;AACnC,eAAa,WAAW,MAAM;AAC9B,eAAa,WAAW,UAAU;AAElC,UAAQ,IAAI,gDAA2C;AACzD;AAKO,IAAM,gBAAgB,MAAY;AACvC,MAAI,OAAO,WAAW;AAAa;AAEnC,UAAQ,IAAI,gDAAyC;AAGrD,eAAa,WAAW,UAAU;AAGlC,eAAa,WAAW,WAAW;AACnC,eAAa,WAAW,MAAM;AAC9B,eAAa,WAAW,UAAU;AAElC,UAAQ,IAAI,8BAAyB;AACvC;AAKO,IAAM,iBAAiB,MAAyB;AACrD,SAAO,cAAc;AACvB;AAmBO,IAAM,oBAAoB,OAAU,aAAgD;AACzF,SAAO,MAAM,iBAAoB,QAAQ;AAC3C;AAmCO,IAAM,eAAe,CAAC,cAA2H;AACtJ,UAAQ,WAAW;AAAA,IACjB,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT;AACE,aAAO;AAAA,EACX;AACF;AAKO,IAAM,yBAAyB,OACpC,YACuC;AACvC,MAAI;AACF,UAAM,OAAO,MAAM,QAAQ;AAC3B,WAAO,EAAE,KAAK;AAAA,EAChB,SAAS,OAAO;AACd,WAAO,EAAE,MAAM;AAAA,EACjB;AACF;AAKO,IAAM,sBAAsB,CAAC,UAAkD;AACpF,QAAM,YAAY,aAAa,KAAK;AACpC,SAAO;AAAA,IACL,SAAS,UAAU;AAAA,IACnB,MAAM,UAAU;AAAA,EAClB;AACF;;;AEtrBO,IAAM,qBAAN,MAAyB;AAAA,EAG9B,YAAY,QAAuB;AACjC,SAAK,SAAS;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKA,kBAAkB,YAAoB,iBAGpC;AACA,UAAM,qBAAqB,KAAK,sBAAsB,eAAe;AACrE,UAAM,iBAAkB,aAAa,qBAAsB;AAE3D,WAAO;AAAA,MACL,UAAU;AAAA,MACV;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,sBAAsB,iBAA0C;AACtE,WAAO,KAAK,OAAO,UAAU,eAAe,KAAK;AAAA,EACnD;AACF;AAMO,IAAM,4BAAN,MAAgC;AAAA,EAGrC,YAAY,QAAuB;AACjC,SAAK,SAAS;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,iBAA0C;AACvD,UAAM,cAAc;AAAA,MAClB,OAAO;AAAA,MACP,SAAS;AAAA,MACT,YAAY;AAAA,MACZ,MAAM;AAAA,IACR;AAEA,WAAO,YAAY,eAAe,KAAK;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA,EAKA,kBAAqC;AACnC,WAAO,CAAC,SAAS,WAAW,cAAc,MAAM;AAAA,EAClD;AACF;AAMO,IAAM,sBAAN,MAA0B;AAAA,EAI/B,YAAY,QAAuB;AACjC,SAAK,qBAAqB,IAAI,mBAAmB,MAAM;AACvD,SAAK,qBAAqB,IAAI,0BAA0B,MAAM;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA,EAKA,wBACE,aACA,SACA,iBACA,eAKA;AAEA,UAAM,cAAc,KAAK,mBAAmB,eAAe,eAAe;AAG1E,UAAM,mBAAoB,YAAY,YAAY,eAAgB,cAAc;AAChF,UAAM,eAAgB,QAAQ,YAAY,eAAgB,cAAc;AAGxE,UAAM,oBAAoB,mBAAmB;AAG7C,UAAM,gBAAgB,eAAe;AAGrC,UAAM,YAAY,gBAAgB;AAElC,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AACF;AA+CO,IAAM,0BAAN,MAA8B;AAAA,EAInC,YAAY,QAAuB;AACjC,SAAK,qBAAqB,IAAI,mBAAmB,MAAM;AACvD,SAAK,qBAAqB,IAAI,0BAA0B,MAAM;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA,EAKA,qBACE,OACA,OACA,iBAMA;AACA,UAAM,eAAe,KAAK,0BAA0B,OAAO,eAAe;AAC1E,UAAM,eAAe,KAAK,0BAA0B,OAAO,eAAe;AAC1E,UAAM,aAAa,aAAa,aAAa,aAAa;AAC1D,UAAM,UAAU,KAAK,IAAI,UAAU;AAEnC,WAAO;AAAA,MACL,OAAO;AAAA,MACP,OAAO;AAAA,MACP;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,0BAA0B,MAAY,iBAAoD;AAChG,UAAM,cAAc,KAAK,mBAAmB,eAAe,eAAe;AAC1E,UAAM,aAAa,KAAK,YAAY;AACpC,UAAM,eAAe,KAAK,mBAAmB,kBAAkB,YAAY,eAAe;AAC1F,UAAM,aAAa,aAAa,aAAa;AAC7C,UAAM,oBAAoB,aAAa;AAEvC,WAAO;AAAA,MACL,WAAW,KAAK;AAAA,MAChB;AAAA,MACA,UAAU,aAAa;AAAA,MACvB,gBAAgB,aAAa;AAAA,MAC7B;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AACF;AAMO,IAAM,oBAAN,MAAwB;AAAA,EAO7B,YAAY,SAAwB,wBAAwB;AAC1D,SAAK,SAAS;AACd,SAAK,qBAAqB,IAAI,mBAAmB,MAAM;AACvD,SAAK,qBAAqB,IAAI,0BAA0B,MAAM;AAC9D,SAAK,sBAAsB,IAAI,oBAAoB,MAAM;AACzD,SAAK,mBAAmB,IAAI,wBAAwB,MAAM;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA,EAKA,2BAA2B,MAAY,iBAA0C;AAC/E,UAAM,YAAY,KAAK,oBAAoB,MAAM,eAAe;AAChE,WAAO,UAAU;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA,EAKA,oBAAoB,MAAY,iBAAoD;AAClF,UAAM,cAAc,KAAK,mBAAmB,eAAe,eAAe;AAC1E,UAAM,aAAa,KAAK,YAAY;AACpC,UAAM,eAAe,KAAK,mBAAmB,kBAAkB,YAAY,eAAe;AAC1F,UAAM,aAAa,aAAa,aAAa;AAC7C,UAAM,oBAAoB,aAAa;AAEvC,WAAO;AAAA,MACL,WAAW,KAAK;AAAA,MAChB;AAAA,MACA,UAAU,aAAa;AAAA,MACvB,gBAAgB,aAAa;AAAA,MAC7B;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,qBAAqB,MAAuD;AAC1E,UAAM,YAAY,KAAK,mBAAmB,gBAAgB;AAC1D,UAAM,UAAqD,CAAC;AAE5D,eAAW,YAAY,WAAW;AAChC,cAAQ,QAAQ,IAAI,KAAK,oBAAoB,MAAM,QAAQ;AAAA,IAC7D;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,qBAAqB,OAAa,OAAa,iBAAkC;AAC/E,WAAO,KAAK,iBAAiB,qBAAqB,OAAO,OAAO,eAAe;AAAA,EACjF;AAAA;AAAA;AAAA;AAAA,EAKA,wBACE,aACA,SACA,iBACA,eACA;AACA,WAAO,KAAK,oBAAoB;AAAA,MAC9B;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,WAAgC;AAC3C,SAAK,SAAS;AACd,SAAK,qBAAqB,IAAI,mBAAmB,SAAS;AAC1D,SAAK,qBAAqB,IAAI,0BAA0B,SAAS;AACjE,SAAK,sBAAsB,IAAI,oBAAoB,SAAS;AAC5D,SAAK,mBAAmB,IAAI,wBAAwB,SAAS;AAAA,EAC/D;AAAA,EAEA,YAA2B;AACzB,WAAO,EAAE,GAAG,KAAK,OAAO;AAAA,EAC1B;AACF;AA8BO,IAAM,yBAAwC;AAAA,EACnD,WAAW;AAAA,IACT,OAAO;AAAA;AAAA,IACP,SAAS;AAAA;AAAA,IACT,YAAY;AAAA;AAAA,IACZ,MAAM;AAAA;AAAA,EACR;AAAA,EACA,WAAW;AAAA,IACT,OAAO,EAAE,UAAU,SAAkB,eAAe,EAAE;AAAA,IACtD,SAAS,EAAE,UAAU,SAAkB,eAAe,EAAE;AAAA,IACxD,YAAY,EAAE,UAAU,SAAkB,eAAe,EAAE;AAAA,IAC3D,MAAM,EAAE,UAAU,QAAiB,eAAe,EAAE;AAAA,EACtD;AACF;AAOO,IAAM,oBAAoB,IAAI,kBAAkB;AAGhD,IAAM,6BAA6B,CAAC,MAAY,oBACrD,kBAAkB,2BAA2B,MAAM,eAAe;AAE7D,IAAM,sBAAsB,CAAC,MAAY,oBAC9C,kBAAkB,oBAAoB,MAAM,eAAe;AAEtD,IAAM,uBAAuB,CAAC,SACnC,kBAAkB,qBAAqB,IAAI;AAEtC,IAAM,uBAAuB,CAAC,OAAa,OAAa,oBAC7D,kBAAkB,qBAAqB,OAAO,OAAO,eAAe;AAE/D,IAAM,0BAA0B,CACrC,aACA,SACA,iBACA,kBACG,kBAAkB,wBAAwB,aAAa,SAAS,iBAAiB,aAAa;AAS5F,IAAM,qBAAqB,CAAC,oBAA6C;AAC9E,UAAQ,iBAAiB;AAAA,IACvB,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT;AACE,aAAO;AAAA,EACX;AACF;AAKO,IAAM,0BAA0B,CAAC,oBAA6C;AACnF,SAAO,uBAAuB,UAAU,eAAe,KAAK;AAC9D;AAKO,IAAM,wBAAwB,CAAC,MAAY,oBAA6C;AAC7F,SAAO,2BAA2B,MAAM,eAAe;AACzD;AAKO,IAAM,mBAAmB,CAAC,eAAuB,oBAAoC;AAC1F,SAAO,KAAK,IAAI,GAAG,gBAAgB,eAAe;AACpD;AAKO,IAAM,wBAAwB,CAAC,oBAA6C;AACjF,SAAO,uBAAuB,UAAU,eAAe,KAAK;AAC9D;AAKO,IAAM,2BAA2B,CAAC,eAAuB,uBAAuC;AACrG,QAAM,iBAAiB,iBAAiB,qBAAqB;AAC7D,SAAO,KAAK,IAAI,GAAG,gBAAgB,cAAc;AACnD;AAMO,IAAM,kBAAN,MAAsB;AAAA;AAAA;AAAA;AAAA;AAAA,EAK3B,OAAO,mBACL,SACA,UACa;AAEb,WAAQ,SAAS,eAA+B;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,0BACL,SACA,UACa;AACb,UAAM,cAAc,KAAK,mBAAmB,SAAS,QAAQ;AAE7D,WAAO;AAAA,MACL;AAAA,MACA,cAAc,QAAQ,aAAa;AAAA,MACnC,aAAa;AAAA,MACb,aAAa;AAAA,MACb,oBAAoB;AAAA,MACpB,oBAAoB;AAAA,IACtB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,iBACL,SACA,UACA,UACA,WAAmB,GACA;AACnB,UAAM,SAAS,KAAK,0BAA0B,SAAS,QAAQ;AAC/D,UAAM,YAAY,OAAO;AACzB,UAAM,aAAa,YAAY,YAAY,YAAY;AAEvD,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA,SAAS,QAAQ,WAAW;AAAA,MAC5B,aAAa,OAAO;AAAA,MACpB;AAAA,MACA,cAAc;AAAA,IAChB;AAAA,EACF;AACF;AAMO,IAAM,mBAAN,MAAuB;AAAA;AAAA;AAAA;AAAA,EAI5B,OAAO,qBACL,SACA,UACA,eACA,aACA,WAAmB,GACK;AACxB,UAAM,SAAmB,CAAC;AAC1B,UAAM,WAAqB,CAAC;AAC5B,UAAM,cAAwB,CAAC;AAG/B,UAAM,cAAc,SAAS,eAAe;AAC5C,UAAM,eAAe,SAAS,gBAAgB;AAG9C,QAAI,iBAAiB,aAAa;AAChC,aAAO,KAAK,2CAA2C;AAAA,IACzD;AAGA,UAAM,aAAa,YAAY,QAAQ,IAAI,cAAc,QAAQ;AACjE,UAAM,eAAe,KAAK,KAAK,cAAc,MAAO,KAAK,KAAK,GAAG;AAGjE,UAAM,cAAc;AACpB,UAAM,cAAc;AAEpB,QAAI,eAAe,aAAa;AAC9B,aAAO,KAAK,8BAA8B,WAAW,MAAM;AAC3D,kBAAY,KAAK,0BAA0B,WAAW,MAAM;AAAA,IAC9D;AAEA,QAAI,eAAe,aAAa;AAC9B,eAAS,KAAK,oBAAoB,YAAY,uCAAuC,WAAW,QAAQ;AACxG,kBAAY,KAAK,0CAA0C;AAAA,IAC7D;AAGA,QAAI,YAAY,GAAG;AACjB,aAAO,KAAK,iCAAiC;AAAA,IAC/C;AAEA,QAAI,WAAW,KAAK;AAClB,eAAS,KAAK,gCAAgC;AAC9C,kBAAY,KAAK,mDAAmD;AAAA,IACtE;AAGA,QAAI,QAAQ,QAAQ,UAAU;AAC5B,aAAO,KAAK,kCAAkC,QAAQ,KAAK,gBAAgB,QAAQ,EAAE;AAAA,IACvF;AAGA,QAAI,CAAC,QAAQ,aAAa,QAAQ,aAAa,GAAG;AAChD,aAAO,KAAK,yBAAyB;AAAA,IACvC;AAEA,WAAO;AAAA,MACL,SAAS,OAAO,WAAW;AAAA,MAC3B;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,sBAAsB,QAA+B;AAC1D,UAAM,SAAmB,CAAC;AAC1B,UAAM,WAAqB,CAAC;AAG5B,QAAI,CAAC,OAAO,oBAAoB;AAC9B,aAAO,KAAK,kCAAkC;AAAA,IAChD;AAEA,QAAI,CAAC,OAAO,gBAAgB;AAC1B,aAAO,KAAK,8BAA8B;AAAA,IAC5C,OAAO;AACL,UAAI,CAAC,OAAO,eAAe,WAAW,OAAO,eAAe,UAAU,GAAG;AACvE,eAAO,KAAK,yCAAyC;AAAA,MACvD;AACA,UAAI,CAAC,OAAO,eAAe,WAAW,OAAO,eAAe,UAAU,GAAG;AACvE,eAAO,KAAK,yCAAyC;AAAA,MACvD;AACA,UAAI,OAAO,eAAe,WAAW,OAAO,eAAe,SAAS;AAClE,eAAO,KAAK,qDAAqD;AAAA,MACnE;AAAA,IACF;AAGA,QAAI,OAAO,eAAe;AACxB,UAAI,OAAO,cAAc,kBAAkB,OAAO,cAAc,qBAAqB,GAAG;AACtF,eAAO,KAAK,sEAAsE;AAAA,MACpF;AAAA,IACF;AAEA,WAAO;AAAA,MACL,SAAS,OAAO,WAAW;AAAA,MAC3B,OAAO,OAAO,SAAS,IAAI,OAAO,KAAK,IAAI,IAAI;AAAA,MAC/C,SAAS,SAAS,SAAS,IAAI,SAAS,KAAK,IAAI,IAAI;AAAA,MACrD,aAAa,OAAO,SAAS,IAAI,CAAC,8BAA8B,IAAI;AAAA,IACtE;AAAA,EACF;AACF;;;AC/rBA,oBAA6B;AAG7B,IAAM,kBAAkB;AAKjB,IAAM,SAAS,gBAAgB,UAAU,IAAI,2BAAa;AAAA,EAC/D,KAAK,QAAQ,IAAI,aAAa,gBAAgB,CAAC,SAAS,SAAS,MAAM,IAAI,CAAC,OAAO;AACrF,CAAC;AAGD,IAAI,QAAQ,IAAI,aAAa,cAAc;AACzC,kBAAgB,SAAS;AAC3B;;;ACQA,SAAS,6BAA6B,WAAmB;AACvD,QAAM,eAAe;AACrB,QAAM,iBAAiB,eAAe;AACtC,QAAM,cAAc,eAAe;AAEnC,SAAO;AAAA,IACL,SAAS;AAAA,MACP,OAAO;AAAA,MACP,UAAU;AAAA,MACV,SAAS;AAAA,IACX;AAAA,IACA,WAAW;AAAA,MACT,OAAO;AAAA,MACP,UAAU;AAAA;AAAA,MACV,SAAS,iBAAiB;AAAA,IAC5B;AAAA,IACA,QAAQ;AAAA,MACN,OAAO;AAAA,MACP,UAAU;AAAA;AAAA,MACV,SAAS,cAAc;AAAA,IACzB;AAAA,EACF;AACF;AAKA,SAAS,wBAAwB,YAAuB;AACtD,SAAO;AAAA,IACL,IAAI,WAAW;AAAA,IACf,MAAM,WAAW;AAAA,IACjB,aAAa,WAAW;AAAA,IACxB,WAAW,WAAW;AAAA,IACtB,UAAU,WAAW;AAAA,IACrB,WAAW,WAAW;AAAA,IACtB,QAAQ,KAAK,MAAM,WAAW,MAAgB;AAAA,IAC9C,UAAU,KAAK,MAAM,WAAW,QAAkB;AAAA,IAClD,UAAU,WAAW;AAAA,IACrB,WAAW,WAAW;AAAA,IACtB,WAAW,WAAW;AAAA,IACtB,SAAS,6BAA6B,WAAW,SAAS;AAAA,IAC1D,WAAW,WAAW;AAAA,IACtB,WAAW,WAAW;AAAA,IACtB,WAAW,WAAW,aAAa;AAAA,EACrC;AACF;AAuFA,eAAsB,4BAA4B,YAAkD;AAElG,QAAM,WAAW,MAAM,OAAO,SAAS,WAAW;AAAA,IAChD,OAAO,EAAE,IAAI,WAAW;AAAA,IACxB,QAAQ,EAAE,IAAI,KAAK;AAAA,EACrB,CAAC;AAED,MAAI,CAAC,UAAU;AACb,WAAO;AAAA,EACT;AAEA,QAAM,eAAe,MAAM,OAAO,aAAa,WAAW;AAAA,IACxD,OAAO,EAAE,YAAY,SAAS,GAAG;AAAA,IACjC,SAAS;AAAA,MACP,UAAU;AAAA,QACR,QAAQ;AAAA,UACN,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO;AAAA,UACP,oBAAoB;AAAA,QACtB;AAAA,MACF;AAAA,MACA,MAAM;AAAA,IACR;AAAA,EACF,CAAC;AAED,MAAI,CAAC;AAAc,WAAO;AAE1B,SAAO;AAAA,IACL,IAAI,aAAa;AAAA,IACjB,YAAY,aAAa;AAAA,IACzB,QAAQ,aAAa;AAAA,IACrB,QAAQ,aAAa;AAAA,IACrB,iBAAiB,aAAa;AAAA,IAC9B,oBAAoB,aAAa;AAAA,IACjC,kBAAkB,aAAa;AAAA,IAC/B,QAAQ,aAAa;AAAA,IACrB,WAAW,aAAa;AAAA,IACxB,WAAW,aAAa;AAAA,IACxB,UAAU,aAAa;AAAA,IACvB,MAAM,wBAAwB,aAAa,IAAI;AAAA,EACjD;AACF;;;AC0BA,eAAsB,oBACpB,QAC4B;AAC5B,QAAM;AAAA,IACJ,QAAAC,UAAS;AAAA,IACT;AAAA,IACA,SAAS;AAAA,IACT,cAAc;AAAA,IACd,iBAAiB;AAAA,IACjB,eAAe;AAAA,IACf,cAAc;AAAA,EAChB,IAAI;AAGJ,QAAM,SAAS,MAAM,OAAO,OAAO,WAAW;AAAA,IAC5C,OAAO,EAAE,IAAI,SAAS;AAAA,IACtB,QAAQ,EAAE,IAAI,MAAM,MAAM,KAAK;AAAA,EACjC,CAAC;AAED,MAAI,CAAC,QAAQ;AACX,UAAM,IAAI,MAAM,kBAAkB,QAAQ,YAAY;AAAA,EACxD;AAEA,QAAM,cAAc,OAAO,GAAG,SAAS,EAAE,SAAS,GAAG,GAAG;AACxD,QAAM,cAAc,oBAAI,KAAK;AAE7B,UAAQA,SAAQ;AAAA,IACd,KAAK;AACH,aAAO,MAAM,yBAAyB,aAAa,QAAQ,cAAc;AAAA,IAE3E,KAAK;AACH,aAAO,MAAM,wBAAwB,aAAa,QAAQ,gBAAgB,WAAW;AAAA,IAEvF,KAAK;AACH,aAAO,MAAM,qBAAqB,aAAa,QAAQ,cAAc,KAAK;AAAA,IAE5E,KAAK;AACH,aAAO,MAAM,qBAAqB,aAAa,QAAQ,cAAc,IAAI;AAAA,IAE3E,KAAK;AACH,aAAO,MAAM,6BAA6B,aAAa,MAAM;AAAA,IAE/D,KAAK;AACH,aAAO,MAAM,qBAAqB,aAAa,QAAQ,gBAAgB,aAAa,WAAW;AAAA,IAEjG;AACE,YAAM,IAAI,MAAM,oCAAoCA,OAAM,EAAE;AAAA,EAChE;AACF;AAMA,eAAe,yBACb,aACA,QACA,gBAC4B;AAC5B,QAAM,aAAa;AACnB,MAAI,aAAa;AAEjB,SAAO,aAAa,YAAY;AAC9B,QAAI;AAEF,YAAM,SAAS,MAAM,OAAO,aAAa,OAAO,OAAY;AAE1D,cAAM,YAAY,MAAM,GAAG,MAAM,UAAU;AAAA,UACzC,OAAO;AAAA,YACL,aAAa,EAAE,YAAY,GAAG,MAAM,IAAI,WAAW,IAAI;AAAA,UACzD;AAAA,UACA,SAAS,EAAE,WAAW,OAAO;AAAA,UAC7B,QAAQ,EAAE,aAAa,MAAM,WAAW,KAAK;AAAA,QAC/C,CAAC;AAED,YAAI,eAAe;AAEnB,YAAI,WAAW;AAEb,gBAAM,QAAQ,UAAU,YAAY,MAAM,GAAG;AAC7C,gBAAM,eAAe,SAAS,MAAM,MAAM,SAAS,CAAC,CAAC,KAAK;AAC1D,yBAAe,eAAe;AAAA,QAChC;AAEA,cAAM,cAAc,GAAG,MAAM,IAAI,WAAW,IAAI,aAAa,SAAS,EAAE,SAAS,gBAAgB,GAAG,CAAC;AAGrG,cAAM,gBAAgB,MAAM,GAAG,MAAM,WAAW;AAAA,UAC9C,OAAO,EAAE,YAAY;AAAA,UACrB,QAAQ,EAAE,IAAI,KAAK;AAAA,QACrB,CAAC;AAED,YAAI,eAAe;AACjB,gBAAM,IAAI,MAAM,iCAAiC;AAAA,QACnD;AAEA,eAAO;AAAA,UACL;AAAA,UACA,UAAU;AAAA,UACV,aAAa,oBAAI,KAAK;AAAA,QACxB;AAAA,MACF,CAAC;AAED,aAAO;AAAA,IACT,SAAS,OAAO;AACd;AACA,UAAI,cAAc,YAAY;AAC5B,cAAM,eAAe,iBAAiB,QAAQ,MAAM,UAAU;AAC9D,cAAM,IAAI,MAAM,oDAAoD,UAAU,aAAa,YAAY,EAAE;AAAA,MAC3G;AAGA,YAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,KAAK,IAAI,GAAG,UAAU,IAAI,EAAE,CAAC;AAAA,IAChF;AAAA,EACF;AAEA,QAAM,IAAI,MAAM,0BAA0B;AAC5C;AAMA,eAAe,wBACb,aACA,QACA,gBACA,aAC4B;AAC5B,QAAM,UAAU,YAAY,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,EAAE,QAAQ,MAAM,EAAE;AAExE,QAAM,SAAS,MAAM,OAAO,aAAa,OAAO,OAAY;AAE1D,UAAM,YAAY,MAAM,GAAG,MAAM,UAAU;AAAA,MACzC,OAAO;AAAA,QACL,aAAa,EAAE,YAAY,GAAG,MAAM,IAAI,WAAW,IAAI,OAAO,IAAI;AAAA,MACpE;AAAA,MACA,SAAS,EAAE,WAAW,OAAO;AAAA,MAC7B,QAAQ,EAAE,aAAa,KAAK;AAAA,IAC9B,CAAC;AAED,QAAI,eAAe;AAEnB,QAAI,WAAW;AACb,YAAM,QAAQ,UAAU,YAAY,MAAM,GAAG;AAC7C,YAAM,eAAe,SAAS,MAAM,MAAM,SAAS,CAAC,CAAC,KAAK;AAC1D,qBAAe,eAAe;AAAA,IAChC;AAEA,UAAM,cAAc,GAAG,MAAM,IAAI,WAAW,IAAI,OAAO,IAAI,aAAa,SAAS,EAAE,SAAS,gBAAgB,GAAG,CAAC;AAGhH,UAAM,gBAAgB,MAAM,GAAG,MAAM,WAAW;AAAA,MAC9C,OAAO,EAAE,YAAY;AAAA,MACrB,QAAQ,EAAE,IAAI,KAAK;AAAA,IACrB,CAAC;AAED,QAAI,eAAe;AACjB,YAAM,IAAI,MAAM,iCAAiC;AAAA,IACnD;AAEA,WAAO;AAAA,MACL;AAAA,MACA,UAAU;AAAA,MACV;AAAA,IACF;AAAA,EACF,CAAC;AAED,SAAO;AACT;AAMA,eAAe,qBACb,aACA,QACA,cACA,cAAuB,OACK;AAC5B,QAAM,aAAa;AACnB,MAAI,aAAa;AAEjB,SAAO,aAAa,YAAY;AAC9B,QAAI;AAEF,YAAM,YAAYC,sBAAqB,cAAc,WAAW;AAChE,YAAM,cAAc,GAAG,MAAM,IAAI,WAAW,IAAI,SAAS;AAGzD,YAAM,gBAAgB,MAAM,OAAO,MAAM,WAAW;AAAA,QAClD,OAAO,EAAE,YAAY;AAAA,QACrB,QAAQ,EAAE,IAAI,KAAK;AAAA,MACrB,CAAC;AAED,UAAI,CAAC,eAAe;AAClB,eAAO;AAAA,UACL;AAAA,UACA,UAAU;AAAA;AAAA,UACV,aAAa,oBAAI,KAAK;AAAA,QACxB;AAAA,MACF;AAEA;AAAA,IACF,SAAS,OAAO;AACd,YAAM,eAAe,iBAAiB,QAAQ,MAAM,UAAU;AAC9D,YAAM,IAAI,MAAM,2CAA2C,YAAY,EAAE;AAAA,IAC3E;AAAA,EACF;AAEA,QAAM,IAAI,MAAM,uDAAuD,UAAU,WAAW;AAC9F;AAMA,eAAe,6BACb,aACA,QAC4B;AAC5B,QAAM,aAAa;AACnB,MAAI,aAAa;AAEjB,SAAO,aAAa,YAAY;AAC9B,QAAI;AAEF,YAAM,YAAYA,sBAAqB,GAAG,IAAI;AAC9C,YAAM,cAAc,GAAG,MAAM,GAAG,WAAW,GAAG,SAAS;AAGvD,YAAM,gBAAgB,MAAM,OAAO,MAAM,WAAW;AAAA,QAClD,OAAO,EAAE,YAAY;AAAA,QACrB,QAAQ,EAAE,IAAI,KAAK;AAAA,MACrB,CAAC;AAED,UAAI,CAAC,eAAe;AAClB,eAAO;AAAA,UACL;AAAA,UACA,UAAU;AAAA;AAAA,UACV,aAAa,oBAAI,KAAK;AAAA,QACxB;AAAA,MACF;AAEA;AAAA,IACF,SAAS,OAAO;AACd,YAAM,eAAe,iBAAiB,QAAQ,MAAM,UAAU;AAC9D,YAAM,IAAI,MAAM,oDAAoD,YAAY,EAAE;AAAA,IACpF;AAAA,EACF;AAEA,QAAM,IAAI,MAAM,gEAAgE,UAAU,WAAW;AACvG;AAMA,eAAe,qBACb,aACA,QACA,gBACA,aACA,cAAuB,OACK;AAC5B,QAAM,UAAU,YAAY,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,EAAE,QAAQ,MAAM,EAAE;AACxE,QAAM,YAAYA,sBAAqB,GAAG,WAAW;AAErD,QAAM,cAAc,GAAG,MAAM,IAAI,WAAW,IAAI,OAAO,IAAI,SAAS;AAGpE,QAAM,gBAAgB,MAAM,OAAO,MAAM,WAAW;AAAA,IAClD,OAAO,EAAE,YAAY;AAAA,IACrB,QAAQ,EAAE,IAAI,KAAK;AAAA,EACrB,CAAC;AAED,MAAI,eAAe;AAEjB,WAAO,qBAAqB,aAAa,QAAQ,gBAAgB,aAAa,WAAW;AAAA,EAC3F;AAEA,SAAO;AAAA,IACL;AAAA,IACA,UAAU;AAAA;AAAA,IACV;AAAA,EACF;AACF;AAKA,SAASA,sBAAqB,QAAgB,cAAuB,OAAe;AAClF,QAAM,QAAQ,cAAc,eAAe;AAC3C,QAAM,cAAc,IAAI,WAAW,MAAM;AAEzC,MAAI,OAAO,WAAW,eAAe,OAAO,QAAQ;AAElD,WAAO,OAAO,gBAAgB,WAAW;AAAA,EAC3C,OAAO;AAEL,UAAM,SAAS,UAAQ,QAAQ;AAC/B,UAAM,kBAAkB,OAAO,YAAY,MAAM;AACjD,gBAAY,IAAI,eAAe;AAAA,EACjC;AAEA,SAAO,MAAM,KAAK,aAAa,UAAQ,MAAM,OAAO,MAAM,MAAM,CAAC,EAAE,KAAK,EAAE;AAC5E;AA2FA,eAAsB,oBAAoB,UAKvC;AACD,QAAM,SAAS,MAAM,OAAO,OAAO,WAAW;AAAA,IAC5C,OAAO,EAAE,IAAI,SAAS;AAAA,IACtB,QAAQ,EAAE,IAAI,KAAK;AAAA,EACrB,CAAC;AAED,MAAI,CAAC,QAAQ;AACX,UAAM,IAAI,MAAM,kBAAkB,QAAQ,YAAY;AAAA,EACxD;AAEA,QAAM,QAAQ,oBAAI,KAAK;AACvB,QAAM,SAAS,GAAG,GAAG,GAAG,CAAC;AACzB,QAAM,WAAW,IAAI,KAAK,KAAK;AAC/B,WAAS,QAAQ,SAAS,QAAQ,IAAI,CAAC;AAEvC,QAAM,CAAC,aAAa,aAAa,SAAS,IAAI,MAAM,QAAQ,IAAI;AAAA,IAC9D,OAAO,MAAM,MAAM;AAAA,MACjB,OAAO,EAAE,UAAU,OAAO,GAAG;AAAA,IAC/B,CAAC;AAAA,IACD,OAAO,MAAM,MAAM;AAAA,MACjB,OAAO;AAAA,QACL,UAAU,OAAO;AAAA,QACjB,WAAW;AAAA,UACT,KAAK;AAAA,UACL,IAAI;AAAA,QACN;AAAA,MACF;AAAA,IACF,CAAC;AAAA,IACD,OAAO,MAAM,UAAU;AAAA,MACrB,OAAO,EAAE,UAAU,OAAO,GAAG;AAAA,MAC7B,SAAS,EAAE,WAAW,OAAO;AAAA,MAC7B,QAAQ,EAAE,aAAa,MAAM,WAAW,KAAK;AAAA,IAC/C,CAAC;AAAA,EACH,CAAC;AAED,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,iBAAiB,WAAW;AAAA,IAC5B,eAAe,WAAW;AAAA,EAC5B;AACF;AAmBA,eAAsB,4BACpB,UACAD,SAC4B;AAC5B,QAAM,SAA4B;AAAA,IAChC,QAAAA;AAAA,IACA;AAAA,IACA,QAAQ;AAAA,IACR,gBAAgB;AAAA,IAChB,cAAc;AAAA,IACd,aAAa;AAAA,EACf;AAEA,SAAO,MAAM,oBAAoB,MAAM;AACzC;;;ACnoBO,IAAM,cAAN,MAAkB;AAAA,EAIvB,YAAYT,SAAsB;AAFlC,SAAQ,YAAoB;AAG1B,SAAK,SAASA;AAAA,EAChB;AAAA;AAAA,EAGA,MAAc,kBAAmC;AAE/C,WAAO;AAAA,EACT;AAAA;AAAA,EAGA,MAAM,IAAI,MAAmC;AAC3C,QAAI;AACF,cAAQ,IAAI,4DAAqD;AACjE,YAAM,KAAK,MAAM,KAAK,gBAAgB;AACtC,cAAQ,IAAI,uCAAgC,EAAE;AAG9C,YAAM,kBAAkB,MAAM,KAAK,eAAe,KAAK,QAAQ,MAAM;AACrE,YAAM,sBAAsB,MAAM,KAAK,mBAAmB,KAAK,QAAQ,UAAU;AACjF,YAAM,oBAAoB,MAAM,KAAK,iBAAiB,KAAK,QAAQ,QAAQ;AAE3E,cAAQ,IAAI,oEAA6D;AAAA,QACvE;AAAA,QACA,QAAQ,KAAK;AAAA,QACb,YAAY,KAAK;AAAA,QACjB,UAAU,KAAK;AAAA,QACf,QAAQ;AAAA,QACR,YAAY;AAAA,QACZ,UAAU;AAAA,MACZ,CAAC;AAGD,cAAQ,IAAI,yCAAkC;AAAA,QAC5C;AAAA,QACA,QAAQ,KAAK;AAAA,QACb,YAAY,KAAK;AAAA,QACjB,UAAU,KAAK;AAAA,MACjB,CAAC;AACD,cAAQ,IAAI,yDAAoD;AAAA,IAClE,SAAS,OAAO;AAEd,cAAQ,MAAM,kDAA6C,KAAK;AAChE,cAAQ,MAAM,2CAAsC,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAC1G,cAAQ,MAAM,yCAAoC,iBAAiB,QAAQ,MAAM,QAAQ,MAAS;AAAA,IACpG;AAAA,EACF;AAAA;AAAA,EAGA,MAAc,eAAe,QAAyC;AACpE,QAAI,CAAC;AAAQ,aAAO;AAEpB,QAAI;AACF,YAAM,OAAO,MAAM,KAAK,OAAO,KAAK,WAAW;AAAA,QAC7C,OAAO,EAAE,IAAI,OAAO;AAAA,QACpB,QAAQ,EAAE,IAAI,KAAK;AAAA,MACrB,CAAC;AACD,aAAO,OAAO,SAAS;AAAA,IACzB,SAAS,OAAO;AACd,cAAQ,KAAK,yDAA+C,QAAQ,KAAK;AACzE,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EAEA,MAAc,mBAAmB,YAA6C;AAC5E,QAAI,CAAC;AAAY,aAAO;AAExB,QAAI;AACF,YAAM,WAAW,MAAM,KAAK,OAAO,SAAS,WAAW;AAAA,QACrD,OAAO,EAAE,IAAI,WAAW;AAAA,QACxB,QAAQ,EAAE,IAAI,KAAK;AAAA,MACrB,CAAC;AACD,aAAO,WAAW,aAAa;AAAA,IACjC,SAAS,OAAO;AACd,cAAQ,KAAK,6DAAmD,YAAY,KAAK;AACjF,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EAEA,MAAc,iBAAiB,UAA2C;AACxE,QAAI,CAAC;AAAU,aAAO;AAEtB,QAAI;AACF,YAAM,SAAS,MAAM,KAAK,OAAO,OAAO,WAAW;AAAA,QACjD,OAAO,EAAE,IAAI,SAAS;AAAA,QACtB,QAAQ,EAAE,IAAI,KAAK;AAAA,MACrB,CAAC;AACD,aAAO,SAAS,WAAW;AAAA,IAC7B,SAAS,OAAO;AACd,cAAQ,KAAK,2DAAiD,UAAU,KAAK;AAC7E,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA,EAGA,MAAM,UACJ,YACA,UACA,YACA,WACA,SACA,aACe;AACf,UAAM,KAAK,IAAI;AAAA,MACb,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,aAAa,eAAe,WAAW,WAAW,YAAY,CAAC,KAAK,UAAU;AAAA,MAC9E;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,UACJ,YACA,UACA,YACA,WACA,WACA,SACA,aACe;AACf,UAAM,UAAU,KAAK,iBAAiB,WAAW,SAAS;AAE1D,UAAM,KAAK,IAAI;AAAA,MACb,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,aAAa,eAAe,WAAW,WAAW,YAAY,CAAC,KAAK,UAAU;AAAA,MAC9E;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,UACJ,YACA,UACA,YACA,WACA,SACA,aACe;AACf,UAAM,KAAK,IAAI;AAAA,MACb,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,aAAa,eAAe,WAAW,WAAW,YAAY,CAAC,KAAK,UAAU;AAAA,MAC9E;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,SACJ,QACA,WACA,UACA,SACA,UAAmB,MACJ;AACf,UAAM,KAAK,IAAI;AAAA,MACb,QAAQ;AAAA,MACR,YAAY;AAAA,MACZ,UAAU,OAAO,SAAS;AAAA,MAC1B,YAAY;AAAA,MACZ,WAAW,EAAE,SAAS,YAAW,oBAAI,KAAK,GAAE,YAAY,EAAE;AAAA,MAC1D,UAAU,UAAU,SAAS;AAAA,MAC7B,UAAU;AAAA,MACV,aAAa,UAAU,mBAAmB,SAAS,KAAK,yBAAyB,SAAS;AAAA,MAC1F;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,UACJ,QACA,WACA,SACe;AACf,UAAM,KAAK,IAAI;AAAA,MACb,QAAQ;AAAA,MACR,YAAY;AAAA,MACZ,UAAU,OAAO,SAAS;AAAA,MAC1B,YAAY;AAAA,MACZ,UAAU;AAAA,MACV,aAAa,oBAAoB,SAAS;AAAA,MAC1C;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,iBACJ,OACA,YACA,UACA,SACA,WAA6C,WAC7C,aACe;AACf,UAAM,KAAK,IAAI;AAAA,MACb,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,MACA;AAAA,MACA,UAAU;AAAA,MACV,aAAa,eAAe,mBAAmB,KAAK;AAAA,MACpD;AAAA,IACF,CAAC;AAAA,EACH;AAAA;AAAA,EAGQ,iBAAiB,WAAgC,WAAwE;AAC/H,UAAM,UAAkD,CAAC;AAGzD,UAAM,UAAU,oBAAI,IAAI,CAAC,GAAG,OAAO,KAAK,SAAS,GAAG,GAAG,OAAO,KAAK,SAAS,CAAC,CAAC;AAE9E,eAAW,OAAO,MAAM,KAAK,OAAO,GAAG;AACrC,YAAM,WAAW,UAAU,GAAG;AAC9B,YAAM,WAAW,UAAU,GAAG;AAE9B,UAAI,KAAK,UAAU,QAAQ,MAAM,KAAK,UAAU,QAAQ,GAAG;AACzD,gBAAQ,GAAG,IAAI,EAAE,KAAK,UAAU,KAAK,SAAS;AAAA,MAChD;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA;AAAA,EAGA,MAAM,aAAa,SAAyB,CAAC,GAI1C;AACD,UAAM,QAAa,CAAC;AAEpB,QAAI,OAAO;AAAQ,YAAM,SAAS,OAAO;AACzC,QAAI,OAAO;AAAY,YAAM,aAAa,OAAO;AACjD,QAAI,OAAO;AAAU,YAAM,WAAW,OAAO;AAC7C,QAAI,OAAO;AAAQ,YAAM,SAAS,OAAO;AACzC,QAAI,OAAO;AAAY,YAAM,aAAa,OAAO;AACjD,QAAI,OAAO;AAAU,YAAM,WAAW,OAAO;AAC7C,QAAI,OAAO;AAAU,YAAM,WAAW,OAAO;AAC7C,QAAI,OAAO;AAAU,YAAM,WAAW,OAAO;AAE7C,QAAI,OAAO,aAAa,OAAO,SAAS;AACtC,YAAM,YAAY,CAAC;AACnB,UAAI,OAAO;AAAW,cAAM,UAAU,MAAM,OAAO;AACnD,UAAI,OAAO;AAAS,cAAM,UAAU,MAAM,OAAO;AAAA,IACnD;AAEA,UAAM,QAAQ,OAAO,SAAS;AAC9B,UAAM,SAAS,OAAO,UAAU;AAGhC,UAAM,OAAc,CAAC;AACrB,UAAM,QAAQ;AAGd,UAAM,kBAAkB,KAAK,IAAI,UAAQ;AAAA,MACvC,IAAI,IAAI;AAAA,MACR,QAAQ,IAAI;AAAA,MACZ,YAAY,IAAI;AAAA,MAChB,UAAU,IAAI;AAAA,MACd,YAAY,IAAI;AAAA,MAChB,MAAM,IAAI,OAAO;AAAA,QACf,IAAI,IAAI,KAAK;AAAA,QACb,OAAO,IAAI,KAAK;AAAA,QAChB,MAAM,GAAG,IAAI,KAAK,SAAS,IAAI,IAAI,KAAK,QAAQ;AAAA,QAChD,MAAM,IAAI,KAAK;AAAA,MACjB,IAAI;AAAA,MACJ,UAAU,IAAI,WAAW;AAAA,QACvB,IAAI,IAAI,SAAS;AAAA,QACjB,MAAM,IAAI,SAAS;AAAA,MACrB,IAAI;AAAA,MACJ,QAAQ,IAAI,SAAS;AAAA,QACnB,IAAI,IAAI,OAAO;AAAA,QACf,MAAM,IAAI,OAAO;AAAA,MACnB,IAAI;AAAA,MACJ,WAAW,IAAI,YAAY,KAAK,MAAM,IAAI,SAAS,IAAI;AAAA,MACvD,WAAW,IAAI,YAAY,KAAK,MAAM,IAAI,SAAS,IAAI;AAAA,MACvD,SAAS,IAAI,UAAU,KAAK,MAAM,IAAI,OAAO,IAAI;AAAA,MACjD,WAAW,IAAI;AAAA,MACf,WAAW,IAAI;AAAA,MACf,WAAW,IAAI;AAAA,MACf,WAAW,IAAI;AAAA,MACf,UAAU,IAAI,WAAW,KAAK,MAAM,IAAI,QAAQ,IAAI;AAAA,MACpD,UAAU,IAAI;AAAA,MACd,UAAU,IAAI;AAAA,MACd,aAAa,IAAI;AAAA,MACjB,WAAW,IAAI;AAAA,IACjB,EAAE;AAEF,WAAO;AAAA,MACL,MAAM;AAAA,MACN;AAAA,MACA,SAAS,SAAS,QAAQ;AAAA,IAC5B;AAAA,EACF;AAAA;AAAA,EAGA,MAAM,cAAc,SAAkC,CAAC,GAOpD;AACD,UAAM,QAAa,CAAC;AAEpB,QAAI,OAAO;AAAY,YAAM,aAAa,OAAO;AACjD,QAAI,OAAO;AAAU,YAAM,WAAW,OAAO;AAC7C,QAAI,OAAO,aAAa,OAAO,SAAS;AACtC,YAAM,YAAY,CAAC;AACnB,UAAI,OAAO;AAAW,cAAM,UAAU,MAAM,OAAO;AACnD,UAAI,OAAO;AAAS,cAAM,UAAU,MAAM,OAAO;AAAA,IACnD;AAGA,UAAM,YAAY;AAClB,UAAM,cAAqB,CAAC;AAC5B,UAAM,cAAqB,CAAC;AAC5B,UAAM,gBAAuB,CAAC;AAC9B,UAAM,gBAAuB,CAAC;AAC9B,UAAM,iBAAiB;AAEvB,WAAO;AAAA,MACL;AAAA,MACA,cAAc,YAAY,OAAO,CAAC,KAAK,SAAS;AAC9C,YAAI,KAAK,MAAM,IAAI,KAAK,OAAO;AAC/B,eAAO;AAAA,MACT,GAAG,CAAC,CAA2B;AAAA,MAC/B,cAAc,YAAY,OAAO,CAAC,KAAK,SAAS;AAC9C,YAAI,KAAK,UAAU,IAAI,KAAK,OAAO;AACnC,eAAO;AAAA,MACT,GAAG,CAAC,CAA2B;AAAA,MAC/B,gBAAgB,cAAc,OAAO,CAAC,KAAK,SAAS;AAClD,YAAI,KAAK,QAAQ,IAAI,KAAK,OAAO;AACjC,eAAO;AAAA,MACT,GAAG,CAAC,CAA2B;AAAA,MAC/B,gBAAgB,cAAc,OAAO,CAAC,KAAK,SAAS;AAClD,YAAI,KAAK,QAAQ,IAAI,KAAK,OAAO;AACjC,eAAO;AAAA,MACT,GAAG,CAAC,CAA2B;AAAA,MAC/B;AAAA,IACF;AAAA,EACF;AACF;;;ACnTO,IAAM,sBAAN,MAA0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQ/B,aAAa,YAAY,MAA6B;AACpD,QAAI;AACF,UAAI,CAAC,MAAM,UAAU,IAAI;AACvB,gBAAQ,IAAI,oDAA6C;AACzD,eAAO;AAAA,MACT;AAEA,YAAM,oBAAoB,MAAM,KAAK,SAAS,IAAI;AAClD,aAAO,sBAAsB;AAAA,IAC/B,SAAS,OAAO;AACd,cAAQ,MAAM,uCAAuC,KAAK;AAC1D,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,iBAAiB,MAA6B;AACzD,QAAI;AACF,UAAI,CAAC,MAAM,UAAU,IAAI;AACvB,eAAO;AAAA,MACT;AAEA,YAAM,oBAAoB,MAAM,KAAK,SAAS,IAAI;AAClD,aAAO,sBAAsB;AAAA,IAC/B,SAAS,OAAO;AACd,cAAQ,MAAM,uCAAuC,KAAK;AAC1D,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,SAAS,MAA2C;AAC/D,QAAI;AACF,UAAI,CAAC,MAAM,UAAU,IAAI;AACvB,eAAO;AAAA,MACT;AAEA,UAAI,aAA8B,KAAK,SAAS;AAGhD,UAAI,OAAO,eAAe,UAAU;AAClC,gBAAQ,IAAI,yEAAkE;AAE9E,cAAM,YAAY,SAAS,UAAU;AACrC,YAAI,MAAM,SAAS,GAAG;AACpB,kBAAQ,IAAI,gDAAyC,UAAU;AAC/D,iBAAO,IAAI,eAAe,uBAAuB,wBAAwB;AAAA,QAC3E;AAEA,qBAAa;AACb,gBAAQ,IAAI,mDAA4C,UAAU;AAAA,MACpE;AAEA,cAAQ,IAAI,6CAAsC,YAAY,SAAS,OAAO,UAAU;AAExF,YAAM,eAAe,MAAM,4BAA4B,UAAU;AAEjE,cAAQ,IAAI,8CAAuC;AAAA,QACjD,OAAO,CAAC,CAAC;AAAA,QACT,QAAQ,cAAc;AAAA,QACtB,kBAAkB,cAAc;AAAA,MAClC,CAAC;AAED,UAAI,CAAC,cAAc;AACjB,gBAAQ,IAAI,4DAAqD;AACjE,eAAO,IAAI,eAAe,gCAAgC,wBAAwB;AAAA,MACpF;AAEA,YAAM,SAAS,aAAa,QAAQ,YAAY;AAChD,YAAM,gBAAgB,CAAC,aAAa,WAAW,aAAa,YAAY,QAAQ;AAEhF,UAAI,cAAc,SAAS,MAAM,GAAG;AAClC,gBAAQ,IAAI,gEAAyD,MAAM;AAC3E,eAAO,IAAI;AAAA,UACT,8BAA8B,MAAM;AAAA,UACpC;AAAA,QACF;AAAA,MACF;AAGA,UAAI,aAAa,kBAAkB;AACjC,cAAM,cAAc,oBAAI,KAAK;AAC7B,cAAM,UAAU,IAAI,KAAK,aAAa,gBAAgB;AAEtD,gBAAQ,IAAI,4CAAqC;AAAA,UAC/C,aAAa,YAAY,YAAY;AAAA,UACrC,SAAS,QAAQ,YAAY;AAAA,UAC7B,WAAW,cAAc;AAAA,QAC3B,CAAC;AAED,YAAI,cAAc,SAAS;AACzB,kBAAQ,IAAI,4EAAqE;AACjF,iBAAO,IAAI;AAAA,YACT;AAAA,YACA;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAEA,cAAQ,IAAI,+CAAwC;AACpD,aAAO;AAAA,IACT,SAAS,OAAO;AACd,cAAQ,MAAM,+DAAwD,KAAK;AAC3E,aAAO,IAAI,eAAe,wCAAwC,4BAA4B;AAAA,IAChG;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,aAAa,eACX,MACA,UAAyC,CAAC,GACH;AACvC,UAAM;AAAA,MACJ,4BAA4B;AAAA,MAC5B,kBAAkB,CAAC,UAAU,OAAO;AAAA,MACpC,sBAAsB;AAAA,MACtB,yBAAAW,2BAA0B;AAAA,MAC1B,oBAAoB;AAAA,IACtB,IAAI;AAEJ,QAAI;AAEF,UAAI,CAAC,MAAM,UAAU,IAAI;AACvB,eAAO;AAAA,UACL,SAAS;AAAA,UACT,OAAO;AAAA,UACP,YAAY;AAAA,QACd;AAAA,MACF;AAGA,UAAI,uBAAuB,KAAK,SAAS,WAAW,UAAU;AAC5D,eAAO;AAAA,UACL,SAAS;AAAA,UACT,OAAO,uBAAuB,KAAK,SAAS,MAAM;AAAA,UAClD,YAAY;AAAA,UACZ,UAAU,KAAK;AAAA,QACjB;AAAA,MACF;AAGA,UAAIA,4BAA2B,2BAA2B;AACxD,cAAM,oBAAoB,MAAM,KAAK,SAAS,IAAI;AAElD,YAAI,mBAAmB;AACrB,iBAAO;AAAA,YACL,SAAS;AAAA,YACT,OAAO,kBAAkB;AAAA,YACzB,YAAY,kBAAkB;AAAA,YAC9B,WAAW,kBAAkB;AAAA,UAC/B;AAAA,QACF;AAAA,MACF;AAEA,aAAO;AAAA,QACL,SAAS;AAAA,QACT,cAAc,KAAK;AAAA,QACnB,UAAU,KAAK;AAAA,MACjB;AAAA,IACF,SAAS,OAAO;AACd,cAAQ,MAAM,kCAAkC,KAAK;AACrD,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAY;AAAA,MACd;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,oBACL,oBACA,WACS;AACT,UAAM,SAAS,mBAAmB,YAAY;AAE9C,YAAQ,WAAW;AAAA,MACjB,KAAK;AACH,eAAO,CAAC,UAAU,SAAS,UAAU,EAAE,SAAS,MAAM;AAAA,MACxD,KAAK;AAAA,MACL,KAAK;AACH,eAAO,CAAC,UAAU,OAAO,EAAE,SAAS,MAAM;AAAA,MAC5C,KAAK;AACH,eAAO,WAAW;AAAA,MACpB,KAAK;AACH,eAAO,WAAW;AAAA,MACpB;AACE,eAAO;AAAA,IACX;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,gBACL,oBACA,gBACQ;AACR,UAAM,SAAS,mBAAmB,YAAY;AAE9C,QAAI,kBAAkB,mBAAmB,UAAU;AACjD,aAAO,uBAAuB,cAAc;AAAA,IAC9C;AAEA,UAAM,WAAmC;AAAA,MACvC,aAAa;AAAA,MACb,WAAW;AAAA,MACX,aAAa;AAAA,MACb,YAAY;AAAA,MACZ,UAAU;AAAA,IACZ;AAEA,WAAO,SAAS,MAAM,KAAK;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,qBAAqB,oBAAsC;AAChE,UAAM,aAAuB,CAAC;AAE9B,QAAI,KAAK,oBAAoB,oBAAoB,MAAM,GAAG;AACxD,iBAAW,KAAK,MAAM;AAAA,IACxB;AAEA,QAAI,KAAK,oBAAoB,oBAAoB,QAAQ,GAAG;AAC1D,iBAAW,KAAK,QAAQ;AAAA,IAC1B;AAEA,QAAI,KAAK,oBAAoB,oBAAoB,QAAQ,GAAG;AAC1D,iBAAW,KAAK,QAAQ;AAAA,IAC1B;AAEA,QAAI,KAAK,oBAAoB,oBAAoB,QAAQ,GAAG;AAC1D,iBAAW,KAAK,QAAQ;AAAA,IAC1B;AAEA,QAAI,KAAK,oBAAoB,oBAAoB,OAAO,GAAG;AACzD,iBAAW,KAAK,OAAO;AAAA,IACzB;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAO,gBACL,WACA,SACA,QACA,WAAmB,SACC;AACpB,UAAM,MAAM,oBAAI,KAAK;AACrB,UAAM,gBAAgB,KAAK,IAAI,GAAG,KAAK,MAAM,QAAQ,QAAQ,IAAI,IAAI,QAAQ,MAAM,MAAO,KAAK,KAAK,GAAG,CAAC;AAExG,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA,UAAU;AAAA,MACV,UAAU,OAAO,YAAY,MAAM,YAAY,OAAO,YAAY,MAAM;AAAA,MACxE;AAAA,MACA,iBAAiB;AAAA,MACjB,SAAS,OAAO,YAAY,MAAM;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,aAAa,QAA4B;AAC9C,UAAMC,cAAa,CAAC,SAAe;AACjC,aAAO,IAAI,KAAK,eAAe,SAAS;AAAA,QACtC,MAAM;AAAA,QACN,OAAO;AAAA,QACP,KAAK;AAAA,MACP,CAAC,EAAE,OAAO,IAAI;AAAA,IAChB;AAEA,UAAM,sBAAsB,CAAC,SAAiB;AAC5C,UAAI,QAAQ;AAAG,eAAO;AACtB,UAAI,SAAS;AAAG,eAAO;AACvB,UAAI,OAAO;AAAI,eAAO,GAAG,IAAI;AAC7B,UAAI,OAAO,KAAK;AACd,cAAM,SAAS,KAAK,MAAM,OAAO,EAAE;AACnC,eAAO,WAAW,IAAI,sBAAsB,GAAG,MAAM;AAAA,MACvD;AACA,YAAM,QAAQ,KAAK,MAAM,OAAO,GAAG;AACnC,aAAO,UAAU,IAAI,qBAAqB,GAAG,KAAK;AAAA,IACpD;AAEA,WAAO;AAAA,MACL,QAAQ,GAAGA,YAAW,OAAO,SAAS,CAAC,MAAMA,YAAW,OAAO,OAAO,CAAC;AAAA,MACvE,UAAU,OAAO;AAAA,MACjB,eAAe,oBAAoB,OAAO,aAAa;AAAA,MACvD,aAAaA,YAAW,OAAO,eAAe;AAAA,MAC9C,UAAU,OAAO;AAAA,MACjB,SAAS,OAAO;AAAA,IAClB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,eAAe,QAAgB,eAAuB;AAC3D,UAAM,eAAe;AAAA,MACnB,QAAQ,EAAE,OAAO,+BAA+B,MAAM,SAAS;AAAA,MAC/D,OAAO,EAAE,OAAO,6BAA6B,MAAM,QAAQ;AAAA,MAC3D,SAAS,EAAE,OAAO,2BAA2B,MAAM,UAAU;AAAA,MAC7D,WAAW,EAAE,OAAO,6BAA6B,MAAM,YAAY;AAAA,MACnE,WAAW,EAAE,OAAO,iCAAiC,MAAM,YAAY;AAAA,MACvE,UAAU,EAAE,OAAO,iCAAiC,MAAM,WAAW;AAAA,MACrE,QAAQ,EAAE,OAAO,iCAAiC,MAAM,SAAS;AAAA,IACnE;AAEA,UAAM,SAAS,aAAa,OAAO,YAAY,CAA8B,KAC3E,EAAE,OAAO,6BAA6B,MAAM,OAAO;AAErD,WAAO;AAAA,MACL,OAAO,OAAO;AAAA,MACd,MAAM,OAAO;AAAA,MACb;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAO,wBAAwB,cAAyB;AACtD,UAAM,cAAc,oBAAI,KAAK;AAC7B,UAAM,WAAW,aAAa,YAAY;AAC1C,UAAM,gBAAgB,aAAa,iBAAiB;AAEpD,UAAM,UAAU,IAAI,KAAK,WAAW;AAEpC,YAAQ,UAAU;AAAA,MAChB,KAAK;AACH,gBAAQ,QAAQ,QAAQ,QAAQ,IAAI,aAAa;AACjD;AAAA,MACF,KAAK;AACH,gBAAQ,QAAQ,QAAQ,QAAQ,IAAK,gBAAgB,CAAE;AACvD;AAAA,MACF,KAAK;AACH,gBAAQ,SAAS,QAAQ,SAAS,IAAI,aAAa;AACnD;AAAA,MACF,KAAK;AACH,gBAAQ,YAAY,QAAQ,YAAY,IAAI,aAAa;AACzD;AAAA,MACF;AACE,gBAAQ,SAAS,QAAQ,SAAS,IAAI,aAAa;AAAA,IACvD;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,UAAU,cAA4B;AAC3C,QAAI,CAAC,aAAa;AAAkB,aAAO;AAC3C,UAAM,MAAM,oBAAI,KAAK;AACrB,UAAM,UAAU,IAAI,KAAK,aAAa,gBAAgB;AACtD,WAAO,MAAM;AAAA,EACf;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,sBACL,cACA,kBAA0B,GACjB;AACT,QAAI,CAAC,aAAa;AAAkB,aAAO;AAE3C,UAAM,MAAM,oBAAI,KAAK;AACrB,UAAM,UAAU,IAAI,KAAK,aAAa,gBAAgB;AACtD,UAAM,iBAAiB,IAAI,KAAK,QAAQ,QAAQ,IAAK,kBAAkB,KAAK,KAAK,KAAK,GAAK;AAE3F,WAAO,MAAM;AAAA,EACf;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,mBACL,cACA,kBAA0B,GAI1B;AACA,QAAI,CAAC,cAAc;AACjB,aAAO;AAAA,QACL,UAAU;AAAA,QACV,QAAQ;AAAA,MACV;AAAA,IACF;AAEA,QAAI,aAAa,WAAW,aAAa;AACvC,aAAO;AAAA,QACL,UAAU;AAAA,QACV,QAAQ;AAAA,MACV;AAAA,IACF;AAEA,QAAI,aAAa,WAAW,YAAY,CAAC,KAAK,UAAU,YAAY,GAAG;AACrE,aAAO;AAAA,QACL,UAAU;AAAA,QACV,QAAQ;AAAA,MACV;AAAA,IACF;AAEA,QAAI,KAAK,sBAAsB,cAAc,eAAe,GAAG;AAC7D,aAAO;AAAA,QACL,UAAU;AAAA,QACV,QAAQ;AAAA,MACV;AAAA,IACF;AAEA,WAAO;AAAA,MACL,UAAU;AAAA,IACZ;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAO,kBAAkB,QAAwB;AAC/C,UAAM,aAAqC;AAAA,MACzC,UAAU;AAAA,MACV,SAAS;AAAA,MACT,YAAY;AAAA,MACZ,UAAU;AAAA,MACV,aAAa;AAAA,MACb,WAAW;AAAA,MACX,aAAa;AAAA,IACf;AAEA,WAAO,WAAW,OAAO,YAAY,CAAC,KAAK;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,aAAa,eAA6B;AAC/C,WAAO,CAAC,GAAG,aAAa,EAAE,KAAK,CAAC,GAAG,MAAM;AACvC,YAAM,YAAY,KAAK,kBAAkB,EAAE,MAAM;AACjD,YAAM,YAAY,KAAK,kBAAkB,EAAE,MAAM;AACjD,aAAO,YAAY;AAAA,IACrB,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,eAAe,cAIpB;AACA,QAAI,CAAC,cAAc;AACjB,aAAO;AAAA,QACL,gBAAgB;AAAA,QAChB,SAAS;AAAA,MACX;AAAA,IACF;AAEA,UAAM,SAAS,aAAa,QAAQ,YAAY;AAChD,UAAM,gBAAgB,aAAa,iBAAiB;AAGpD,QAAI,WAAW,aAAa,WAAW,aAAa;AAClD,aAAO;AAAA,QACL,gBAAgB;AAAA,QAChB,QAAQ,mBAAmB,MAAM;AAAA,QACjC,SAAS;AAAA,MACX;AAAA,IACF;AAGA,QAAI,WAAW,eAAe,WAAW,YAAY;AACnD,aAAO;AAAA,QACL,gBAAgB;AAAA,QAChB,QAAQ,mBAAmB,MAAM;AAAA,QACjC,SAAS;AAAA,MACX;AAAA,IACF;AAGA,QAAI,WAAW,WAAW,iBAAiB,GAAG;AAC5C,aAAO;AAAA,QACL,gBAAgB;AAAA,QAChB,QAAQ;AAAA,QACR,SAAS;AAAA,MACX;AAAA,IACF;AAEA,QAAI,WAAW,UAAU;AACvB,aAAO;AAAA,QACL,gBAAgB;AAAA,QAChB,QAAQ;AAAA,QACR,SAAS;AAAA,MACX;AAAA,IACF;AAGA,QAAI,WAAW,YAAY,iBAAiB,GAAG;AAC7C,aAAO;AAAA,QACL,gBAAgB;AAAA,QAChB,QAAQ;AAAA,QACR,SAAS;AAAA,MACX;AAAA,IACF;AAEA,WAAO;AAAA,MACL,gBAAgB;AAAA,MAChB,SAAS;AAAA,IACX;AAAA,EACF;AACF;AAOO,IAAM,0BAA0B,oBAAoB;AACpD,IAAM,4BAA4B,oBAAoB;AACtD,IAAM,oBAAoB,oBAAoB;AAC9C,IAAM,uBAAuB,oBAAoB;AACjD,IAAM,6BAA6B,oBAAoB;AACvD,IAAM,sBAAsB,oBAAoB;AAChD,IAAM,2BAA2B,oBAAoB;AACrD,IAAM,uBAAuB,oBAAoB;AACjD,IAAM,8BAA8B,oBAAoB;AACxD,IAAM,2BAA2B,oBAAoB;AACrD,IAAM,6BAA6B,oBAAoB;AACvD,IAAM,0BAA0B,oBAAoB;AACpD,IAAM,wBAAwB,oBAAoB;AAClD,IAAM,wBAAwB,oBAAoB;AAClD,IAAM,qBAAqB,oBAAoB;AAC/C,IAAM,gCAAgC,oBAAoB;AAC1D,IAAM,4BAA4B,oBAAoB;AACtD,IAAM,6BAA6B,oBAAoB;;;ACnpBvD,SAAS,mBACd,qBAKA,cACA,aAAmB,oBAAI,KAAK,GACN;AACtB,QAAM,eAAe,oBAAoB;AACzC,QAAM,kBAAkB,eAAe;AAGvC,QAAM,cAAc,IAAI,KAAK,oBAAoB,kBAAkB;AACnE,QAAM,YAAY,IAAI,KAAK,oBAAoB,gBAAgB;AAC/D,QAAM,eAAe,KAAK,MAAM,UAAU,QAAQ,IAAI,YAAY,QAAQ,MAAM,MAAO,KAAK,KAAK,GAAG;AACpG,QAAM,gBAAgB,KAAK,MAAM,UAAU,QAAQ,IAAI,WAAW,QAAQ,MAAM,MAAO,KAAK,KAAK,GAAG;AAGpG,QAAM,YAAY,kBAAkB;AACpC,QAAM,cAAc,kBAAkB;AAGtC,QAAM,YAAY,KAAK,IAAI,eAAe,IAAI;AAC9C,QAAM,iBAAiB,YAAY;AAEnC,MAAI,eAAe;AACnB,MAAI,eAAe;AACnB,MAAI,SAAS;AAEb,MAAI,WAAW;AAEb,mBAAe,KAAK,MAAM,iBAAiB,GAAG,IAAI;AAClD,aAAS,sBAAsB,aAAa,uBAAuB,UAAU,QAAQ,CAAC,CAAC;AAAA,EACzF,WAAW,aAAa;AAEtB,mBAAe,KAAK,MAAM,iBAAiB,GAAG,IAAI;AAClD,aAAS,qBAAqB,aAAa,uBAAuB,UAAU,QAAQ,CAAC,CAAC;AAAA,EACxF,OAAO;AAEL,aAAS;AAAA,EACX;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,kBAAkB;AAAA,IAClB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;AAMO,SAAS,qBACd,cACA,UACS;AAET,SAAO,WAAW;AACpB;AAKO,SAAS,gBAAgB,WAAyC;AACvE,MAAI,UAAU,eAAe,GAAG;AAC9B,WAAO,WAAW,UAAU,aAAa,QAAQ,CAAC,CAAC,KAAK,UAAU,MAAM;AAAA,EAC1E,WAAW,UAAU,eAAe,GAAG;AACrC,WAAO,WAAW,UAAU,aAAa,QAAQ,CAAC,CAAC,KAAK,UAAU,MAAM;AAAA,EAC1E,OAAO;AACL,WAAO;AAAA,EACT;AACF;;;AC9FA,OAAO,WAAW;;;;;;ACPlB,IAAe,oBAAA;EACb,OAAO;EACP,OAAO;EACP,QAAQ;EACR,SAAS;EACT,MAAM;EACN,QAAQ;EACR,aAAa;EACb,eAAe;EACf,gBAAgB;AAClB;;;ACYa,IAAA,cAAc,CAAC,WAAmB,OAAO,QAAQ,sBAAsB,OAAO,EAAE,YAAY;AAEzG,IAAM,mBAAmB,CAAC,UAAkB,aAAmC;AAC7E,QAAM,YAAY;IAChB,CAAC,EAAE,QAAQ,gBAAgB,OAAO,IAAI,cAAc,GAAG,qBAAqB,UAAA,GAAa,KAAK,GAAG,QAC/F;MACE;MACA;QACE;QACA,GAAG;QACH,OAAO;QACP,QAAQ;QACR,QAAQ;QACR,aAAa,sBAAsB,OAAO,WAAW,IAAI,KAAK,OAAO,IAAI,IAAI;QAC7E,WAAW,iBAAiB,YAAY,QAAQ,CAAA;QAChD,GAAG;MACL;MACA;QACE,GAAG,SAAS,IAAI,CAAC,CAAC,KAAK,KAAK,MAAM,cAAc,KAAK,KAAK,CAAC;QAC3D,IACG,MAAM,QAAQ,QAAQ,IAAI,WAAW,CAAC,QAAQ,MAAM,CAAC;MAE1D;IACF;EAAA;AAGJ,YAAU,cAAc,GAAG,QAAA;AAEpB,SAAA;AACT;AAEA,IAAA,qBAAe;;;ACxCT,IAAA,gBAAgB,mBAAiB,iBAAiB;EACtD;IACE;IACA;MACE,GAAG;MACH,KAAK;IACP;EACF;EACA,CAAC,QAAQ,EAAE,GAAG,WAAW,KAAK,SAAA,CAAU;EACxC,CAAC,QAAQ,EAAE,GAAG,cAAc,KAAK,SAAA,CAAU;AAC7C,CAAC;;;ACVK,IAAA,YAAY,mBAAiB,aAAa;EAC9C,CAAC,QAAQ,EAAE,GAAG,6CAA6C,KAAK,SAAA,CAAU;EAC1E,CAAC,QAAQ,EAAE,GAAG,2CAA2C,KAAK,SAAA,CAAU;EACxE,CAAC,QAAQ,EAAE,GAAG,4CAA4C,KAAK,SAAA,CAAU;EACzE,CAAC,QAAQ,EAAE,GAAG,WAAW,KAAK,SAAA,CAAU;EACxC,CAAC,QAAQ,EAAE,GAAG,YAAY,KAAK,SAAA,CAAU;EACzC,CAAC,QAAQ,EAAE,GAAG,YAAY,KAAK,SAAA,CAAU;EACzC,CAAC,QAAQ,EAAE,GAAG,YAAY,KAAK,SAAA,CAAU;AAC3C,CAAC;;;ACRK,IAAA,cAAc,mBAAiB,eAAe;EAClD,CAAC,QAAQ,EAAE,GAAG,sCAAsC,KAAK,SAAA,CAAU;EACnE,CAAC,YAAY,EAAE,QAAQ,yBAAyB,KAAK,SAAA,CAAU;AACjE,CAAC;;;ACHK,IAAA,aAAa,mBAAiB,cAAc;EAChD,CAAC,QAAQ,EAAE,IAAI,MAAM,IAAI,MAAM,IAAI,KAAK,IAAI,MAAM,KAAK,SAAA,CAAU;EACjE;IACE;IACA,EAAE,GAAG,qDAAqD,KAAK,SAAS;EAC1E;AACF,CAAC;;;ACNK,IAAA,WAAW,mBAAiB,YAAY;EAC5C;IACE;IACA;MACE,GAAG;MACH,KAAK;IACP;EACF;EACA,CAAC,YAAY,EAAE,QAAQ,kBAAkB,KAAK,SAAA,CAAU;EACxD,CAAC,QAAQ,EAAE,IAAI,MAAM,IAAI,KAAK,IAAI,MAAM,IAAI,MAAM,KAAK,SAAA,CAAU;EACjE,CAAC,QAAQ,EAAE,IAAI,MAAM,IAAI,KAAK,IAAI,MAAM,IAAI,MAAM,KAAK,SAAA,CAAU;EACjE,CAAC,QAAQ,EAAE,IAAI,MAAM,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,KAAK,SAAA,CAAU;AACjE,CAAC;;;ACZK,IAAA,SAAS,mBAAiB,UAAU;EACxC;IACE;IACA,EAAE,GAAG,kDAAkD,KAAK,SAAS;EACvE;EACA,CAAC,UAAU,EAAE,IAAI,MAAM,IAAI,MAAM,GAAG,KAAK,KAAK,SAAA,CAAU;AAC1D,CAAC;;;ACNK,IAAA,UAAU,mBAAiB,WAAW;EAC1C,CAAC,QAAQ,EAAE,GAAG,uBAAuB,KAAK,SAAA,CAAU;EACpD;IACE;IACA;MACE,GAAG;MACH,KAAK;IACP;EACF;EACA,CAAC,YAAY,EAAE,QAAQ,wBAAwB,KAAK,SAAA,CAAU;EAC9D,CAAC,QAAQ,EAAE,IAAI,MAAM,IAAI,MAAM,IAAI,MAAM,IAAI,MAAM,KAAK,SAAA,CAAU;AACpE,CAAC;;;ACXK,IAAA,SAAS,mBAAiB,UAAU;EACxC,CAAC,QAAQ,EAAE,GAAG,+CAA+C,KAAK,SAAA,CAAU;AAC9E,CAAC;;;ACFK,IAAA,eAAe,mBAAiB,gBAAgB;EACpD,CAAC,UAAU,EAAE,IAAI,KAAK,IAAI,MAAM,GAAG,KAAK,KAAK,SAAA,CAAU;EACvD,CAAC,UAAU,EAAE,IAAI,MAAM,IAAI,MAAM,GAAG,KAAK,KAAK,SAAA,CAAU;EACxD;IACE;IACA;MACE,GAAG;MACH,KAAK;IACP;EACF;AACF,CAAC;;;ACVK,IAAA,QAAQ,mBAAiB,SAAS;EACtC;IACE;IACA;MACE,GAAG;MACH,KAAK;IACP;EACF;EACA,CAAC,QAAQ,EAAE,GAAG,6CAA6C,KAAK,SAAA,CAAU;EAC1E,CAAC,QAAQ,EAAE,GAAG,8CAA8C,KAAK,SAAA,CAAU;EAC3E,CAAC,QAAQ,EAAE,GAAG,WAAW,KAAK,SAAA,CAAU;EACxC;IACE;IACA;MACE,GAAG;MACH,KAAK;IACP;EACF;AACF,CAAC;;;AClBK,IAAA,eAAe,mBAAiB,gBAAgB;EACpD,CAAC,YAAY,EAAE,QAAQ,+BAA+B,KAAK,SAAA,CAAU;EACrE,CAAC,YAAY,EAAE,QAAQ,qBAAqB,KAAK,SAAA,CAAU;AAC7D,CAAC;;;ACHK,IAAA,aAAa,mBAAiB,cAAc;EAChD,CAAC,YAAY,EAAE,QAAQ,gCAAgC,KAAK,SAAA,CAAU;EACtE,CAAC,YAAY,EAAE,QAAQ,mBAAmB,KAAK,SAAA,CAAU;AAC3D,CAAC;;;ACHK,IAAA,YAAY,mBAAiB,aAAa;EAC9C,CAAC,QAAQ,EAAE,GAAG,6CAA6C,KAAK,SAAA,CAAU;EAC1E,CAAC,UAAU,EAAE,IAAI,KAAK,IAAI,KAAK,GAAG,KAAK,KAAK,QAAA,CAAS;EACrD,CAAC,YAAY,EAAE,QAAQ,oBAAoB,KAAK,SAAA,CAAU;AAC5D,CAAC;;;ACJK,IAAA,QAAQ,mBAAiB,SAAS;EACtC,CAAC,QAAQ,EAAE,GAAG,6CAA6C,KAAK,SAAA,CAAU;EAC1E,CAAC,UAAU,EAAE,IAAI,KAAK,IAAI,KAAK,GAAG,KAAK,KAAK,QAAA,CAAS;EACrD,CAAC,QAAQ,EAAE,IAAI,MAAM,IAAI,MAAM,IAAI,KAAK,IAAI,MAAM,KAAK,SAAA,CAAU;EACjE,CAAC,QAAQ,EAAE,IAAI,MAAM,IAAI,MAAM,IAAI,KAAK,IAAI,MAAM,KAAK,SAAA,CAAU;AACnE,CAAC;;;ACLK,IAAA,OAAO,mBAAiB,QAAQ;EACpC,CAAC,QAAQ,EAAE,GAAG,6CAA6C,KAAK,SAAA,CAAU;EAC1E,CAAC,UAAU,EAAE,IAAI,MAAM,IAAI,KAAK,GAAG,KAAK,KAAK,SAAA,CAAU;AACzD,CAAC;;;ACHK,IAAA,UAAU,mBAAiB,WAAW;EAC1C,CAAC,UAAU,EAAE,IAAI,MAAM,IAAI,MAAM,GAAG,MAAM,KAAK,SAAA,CAAU;EACzD,CAAC,QAAQ,EAAE,GAAG,aAAa,KAAK,SAAA,CAAU;EAC1C,CAAC,QAAQ,EAAE,GAAG,YAAY,KAAK,SAAA,CAAU;AAC3C,CAAC;;;AlBQD,SAAS,eAAe,WAAW,gBAAgB,sBAAsB;AAsClE,IAAM,uBAAuB,CAAC,UAAmB,aAAwC,aAA0B;AACxH,QAAM,SAAS,WAAW,cAAc,SAAS,cAAc;AAC/D,QAAM,aAAa,eAAe,QAAQ,UAAU;AACpD,QAAM,QAAQ,eAAe,QAAQ,UAAU;AAE/C,MAAI;AAEJ,UAAQ,YAAY;AAAA,IAClB,KAAK;AACH,aAAO,WAAW,cAAc;AAChC;AAAA,IACF;AACE,aAAO,WAAW,YAAY;AAAA,EAClC;AAEA,SAAO;AAAA,IACL,OAAO;AAAA,IACP,MAAM;AAAA,IACN,MAAM;AAAA,EACR;AACF;AAKO,IAAM,iBAAiB,CAAC,EAAE,UAAU,aAAa,SAAS,MAAwB;AACvF,QAAM,SAAS,qBAAqB,UAAU,UAAU;AACxD,QAAM,OAAO,OAAO;AAEpB,SACE,oCAAC,UAAK,WAAW,2EAA2E,OAAO,KAAK,MACtG,oCAAC,QAAK,WAAU,gBAAe,GAC9B,OAAO,IACV;AAEJ;AASO,IAAM,qBAAqB,CAAC,SAA8B;AAC/D,QAAM,aAAa;AAAA,IACjB,CAAC,UAAU,KAAK,GAAG,EAAE,OAAO,2BAA2B,MAAM,QAAQ,MAAM,QAAQ;AAAA,IACnF,CAAC,UAAU,QAAQ,GAAG,EAAE,OAAO,6BAA6B,MAAM,WAAW,MAAM,WAAW;AAAA,IAC9F,CAAC,UAAU,YAAY,GAAG,EAAE,OAAO,+BAA+B,MAAM,OAAO,MAAM,eAAe;AAAA,IACpG,CAAC,UAAU,YAAY,GAAG,EAAE,OAAO,6BAA6B,MAAM,MAAU,MAAM,eAAe;AAAA,EACvG;AAEA,SAAO,WAAW,IAA+B,KAAK;AAAA,IACpD,OAAO;AAAA,IACP,MAAM;AAAA,IACN,MAAM;AAAA,EACR;AACF;AAKO,IAAM,eAAe,CAAC,EAAE,KAAK,MAAsB;AACxD,QAAM,SAAS,mBAAmB,IAAI;AACtC,QAAM,OAAO,OAAO;AAEpB,SACE,oCAAC,UAAK,WAAW,2EAA2E,OAAO,KAAK,MACtG,oCAAC,QAAK,WAAU,gBAAe,GAC9B,OAAO,IACV;AAEJ;AASO,IAAM,yBAAyB,CAAC,MAAe,UAAuC;AAC3F,MAAI,CAAC,QAAQ,CAAC,OAAO;AACnB,WAAO;AAAA,EACT;AAEA,QAAM,WAAW,CAAC,MAAM,KAAK,EAAE,OAAO,OAAO,EAAE,KAAK,IAAI;AAExD,SAAO;AAAA,IACL,OAAO;AAAA,IACP,MAAM;AAAA,IACN,MAAM;AAAA,EACR;AACF;AAKO,IAAM,mBAAmB,CAAC,EAAE,MAAM,MAAM,MAA0B;AACvE,QAAM,SAAS,uBAAuB,MAAM,KAAK;AAEjD,MAAI,CAAC,QAAQ;AACX,WACE,oCAAC,UAAK,WAAU,uGACd,oCAAC,UAAO,WAAU,gBAAe,GAAE,aAErC;AAAA,EAEJ;AAEA,QAAM,OAAO,OAAO;AAEpB,SACE,oCAAC,UAAK,WAAW,2EAA2E,OAAO,KAAK,MACtG,oCAAC,QAAK,WAAU,gBAAe,GAC9B,OAAO,IACV;AAEJ;AASO,IAAM,6BAA6B,CAAC,WAAmB,eAAoC;AAChG,QAAM,kBAAkB,aAAa,IAAK,YAAY,aAAc,MAAM;AAE1E,MAAI,cAAc,GAAG;AACnB,WAAO;AAAA,MACL,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM;AAAA,IACR;AAAA,EACF,WAAW,kBAAkB,IAAI;AAC/B,WAAO;AAAA,MACL,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM;AAAA,IACR;AAAA,EACF,WAAW,kBAAkB,IAAI;AAC/B,WAAO;AAAA,MACL,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM;AAAA,IACR;AAAA,EACF,OAAO;AACL,WAAO;AAAA,MACL,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM;AAAA,IACR;AAAA,EACF;AACF;AAKO,IAAM,uBAAuB,CAAC,EAAE,WAAW,WAAW,MAA8B;AACzF,QAAM,SAAS,2BAA2B,WAAW,UAAU;AAC/D,QAAM,OAAO,OAAO;AAEpB,SACE,oCAAC,UAAK,WAAW,2EAA2E,OAAO,KAAK,MACtG,oCAAC,QAAK,WAAU,gBAAe,GAC9B,OAAO,IACV;AAEJ;AASO,IAAM,2BAA2B,CAAC,cAAsB,kBAAuC;AACpG,QAAM,aAAa,eAAe;AAClC,QAAM,aAAa,gBAAgB,IAAK,aAAa,gBAAiB,MAAM;AAE5E,MAAI,aAAa,GAAG;AAClB,WAAO;AAAA,MACL,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM,IAAI,WAAW,QAAQ,CAAC,CAAC;AAAA,IACjC;AAAA,EACF,WAAW,aAAa,GAAG;AACzB,WAAO;AAAA,MACL,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM,GAAG,WAAW,QAAQ,CAAC,CAAC;AAAA,IAChC;AAAA,EACF,OAAO;AACL,WAAO;AAAA,MACL,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM;AAAA,IACR;AAAA,EACF;AACF;AAKO,IAAM,qBAAqB,CAAC,cAAsB,kBAA0B;AACjF,QAAM,SAAS,yBAAyB,cAAc,aAAa;AACnE,QAAM,OAAO,OAAO;AAEpB,SACE,oCAAC,UAAK,WAAW,2EAA2E,OAAO,KAAK,MACtG,oCAAC,QAAK,WAAU,gBAAe,GAC9B,OAAO,IACV;AAEJ;AASO,IAAM,yBAAyB,CAAC,aACrC,eAAe,EAAE,UAAU,YAAY,SAAS,CAAC;AAK5C,IAAM,qBAAqB,CAAC,aACjC,eAAe,EAAE,UAAU,YAAY,SAAS,CAAC;AAK5C,IAAM,wBAAwB,CAAC,aACpC,eAAe,EAAE,UAAU,YAAY,eAAe,CAAC;;;AmB9SzD,OAAOC,YAAW;AAmBX,IAAM,2BAA2B,CAAC,MAAe,UAAmB;AACzE,SAAO,iBAAiB,EAAE,MAAM,MAAM,CAAC;AACzC;AAOO,IAAM,yBAAyB,CAAC,WAAoB;AACzD,MAAI,CAAC,QAAQ;AACX,WACE,gBAAAA,OAAA,cAAC,UAAK,WAAU,uGACd,gBAAAA,OAAA,cAAC,YAAS,WAAU,gBAAe,GAAE,OAEvC;AAAA,EAEJ;AAEA,QAAM,eAAe;AAAA,IACnB,YAAY,EAAE,OAAO,iCAAiC,MAAM,WAAW;AAAA,IACvE,mBAAmB,EAAE,OAAO,6BAA6B,MAAM,iBAAiB;AAAA,IAChF,eAAe,EAAE,OAAO,+BAA+B,MAAM,cAAc;AAAA,IAC3E,SAAS,EAAE,OAAO,6BAA6B,MAAM,QAAQ;AAAA,EAC/D;AAEA,QAAM,SAAS,aAAa,MAAmC,KAAK,aAAa;AAEjF,SACE,gBAAAA,OAAA,cAAC,UAAK,WAAW,2EAA2E,OAAO,KAAK,MACtG,gBAAAA,OAAA,cAAC,YAAS,WAAU,gBAAe,GAClC,OAAO,IACV;AAEJ;AAOO,IAAM,yBAAyB,CAAC,cAA0B;AAC/D,QAAM,iBAAiB,aAAa,CAAC;AACrC,QAAM,iBAAiB,eAAe;AACtC,QAAM,kBAAkB,eAAe,OAAO,OAAK,EAAE,QAAQ,EAAE;AAC/D,QAAM,oBAAoB,eAAe,OAAO,OAAK,CAAC,EAAE,QAAQ,EAAE;AAClE,QAAM,qBAAqB,eAAe,OAAO,OAAK,EAAE,SAAS,EAAE,MAAM,KAAK,MAAM,EAAE,EAAE;AACxF,QAAM,uBAAuB,eAAe,OAAO,OAAK,EAAE,WAAW,EAAE,QAAQ,KAAK,MAAM,EAAE,EAAE;AAG9F,QAAM,gBAAgB,eAAe,OAAO,CAAC,KAAK,aAAa;AAC7D,UAAM,MAAM,GAAG,SAAS,QAAQ,SAAS,KAAK,SAAS,SAAS,SAAS;AACzE,QAAI,GAAG,KAAK,IAAI,GAAG,KAAK,KAAK;AAC7B,WAAO;AAAA,EACT,GAAG,CAAC,CAA2B;AAE/B,QAAM,cAAc,OAAO,QAAQ,aAAa,EAAE;AAAA,IAAO,CAAC,KAAK,CAAC,UAAU,KAAK,MAC7E,QAAQ,IAAI,QAAQ,EAAE,UAAU,MAAM,IAAI;AAAA,IAC1C,EAAE,UAAU,QAAQ,OAAO,EAAE;AAAA,EAC/B;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,aAAa,YAAY;AAAA,IACzB,kBAAkB,YAAY;AAAA,EAChC;AACF;AASO,IAAM,kBAAkB,CAC7B,WACA,YACA,YACe;AACf,UAAQ,aAAa,CAAC,GAAG,OAAO,cAAY;AAE1C,QAAI,CAAC,YAAY,OAAO,aAAa,UAAU;AAC7C,aAAO;AAAA,IACT;AAEA,UAAM,WAAW,GAAG,SAAS,aAAa,EAAE,IAAI,SAAS,YAAY,EAAE,GAAG,KAAK;AAC/E,UAAM,gBAAgB,SAAS,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC,MACxD,SAAS,SAAS,IAAI,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC,MACrE,SAAS,SAAS,IAAI,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC,MACrE,SAAS,WAAW,IAAI,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC;AAE7F,UAAM,cAAc,CAAC,QAAQ,SAAS,SAAS,QAAQ,IAAI,YAAY,EAAE,SAAS,QAAQ,KAAK,YAAY,CAAC;AAC5G,UAAM,eAAe,CAAC,QAAQ,UAAU,SAAS,SAAS,IAAI,YAAY,EAAE,SAAS,QAAQ,MAAM,YAAY,CAAC;AAChH,UAAM,iBAAiB,CAAC,QAAQ,YAAY,SAAS,WAAW,IAAI,YAAY,EAAE,SAAS,QAAQ,QAAQ,YAAY,CAAC;AACxH,UAAM,gBAAgB,CAAC,QAAQ,UAAU,SAAS,WAAW,QAAQ;AACrE,UAAM,gBAAgB,QAAQ,aAAa,UAAa,SAAS,aAAa,QAAQ;AACtF,UAAM,kBAAkB,CAAC,QAAQ,cAAc,SAAS,eAAe,QAAQ;AAC/E,UAAM,gBAAgB,CAAC,QAAQ,YAAY,SAAS,aAAa,QAAQ;AAEzE,WAAO,iBAAiB,eAAe,gBAAgB,kBAChD,iBAAiB,iBAAiB,mBAAmB;AAAA,EAC9D,CAAC;AACH;AAOO,IAAM,sBAAsB,CAAC,aAA+B;AACjE,SAAO,GAAG,SAAS,aAAa,EAAE,IAAI,SAAS,YAAY,EAAE,GAAG,KAAK;AACvE;AAOO,IAAM,qBAAqB,CAAC,aAA+B;AAChE,QAAM,QAAQ;AAAA,IACZ,SAAS;AAAA,IACT,SAAS;AAAA,IACT,SAAS;AAAA,IACT,SAAS;AAAA,IACT,SAAS;AAAA,EACX,EAAE,OAAO,OAAO;AAEhB,SAAO,MAAM,KAAK,IAAI,KAAK;AAC7B;AAOO,IAAM,yBAAyB,CAAC,aAAuB;AAC5D,SAAO;AAAA,IACL,OAAO,SAAS,SAAS;AAAA,IACzB,OAAO,SAAS,SAAS;AAAA,IACzB,UAAU,CAAC,EAAE,SAAS,SAAS,SAAS,MAAM,KAAK,MAAM;AAAA,IACzD,UAAU,CAAC,EAAE,SAAS,SAAS,SAAS,MAAM,KAAK,MAAM;AAAA,IACzD,YAAY,CAAC,EAAE,SAAS,WAAW,SAAS,QAAQ,KAAK,MAAM;AAAA,EACjE;AACF;AAOO,IAAM,2BAA2B,CAAC,aAAuB;AAC9D,SAAO;AAAA,IACL,GAAG;AAAA,IACH,UAAU,oBAAoB,QAAQ;AAAA,IACtC,gBAAgB,mBAAmB,QAAQ;AAAA,IAC3C,aAAa,uBAAuB,QAAQ;AAAA,IAC5C,aAAa,uBAAuB,SAAS,QAAQ;AAAA,IACrD,eAAe,yBAAyB,SAAS,MAAM,SAAS,KAAK;AAAA,IACrE,aAAa,uBAAuB,SAAS,MAAM;AAAA,EACrD;AACF;AAOO,IAAM,mBAAmB,CAAC,aAAgC;AAC/D,QAAM,SAAmB,CAAC;AAE1B,MAAI,CAAC,SAAS,aAAa,SAAS,UAAU,KAAK,MAAM,IAAI;AAC3D,WAAO,KAAK,wBAAwB;AAAA,EACtC;AAEA,MAAI,CAAC,SAAS,YAAY,SAAS,SAAS,KAAK,MAAM,IAAI;AACzD,WAAO,KAAK,uBAAuB;AAAA,EACrC;AAEA,MAAI,CAAC,SAAS,SAAS,SAAS,MAAM,KAAK,MAAM,IAAI;AACnD,WAAO,KAAK,0BAA0B;AAAA,EACxC;AAEA,MAAI,SAAS,SAAS,SAAS,MAAM,KAAK,MAAM,IAAI;AAClD,UAAM,aAAa;AACnB,QAAI,CAAC,WAAW,KAAK,SAAS,KAAK,GAAG;AACpC,aAAO,KAAK,sBAAsB;AAAA,IACpC;AAAA,EACF;AAEA,SAAO;AAAA,IACL,SAAS,OAAO,WAAW;AAAA,IAC3B;AAAA,EACF;AACF;AAOO,IAAM,iBAAiB,CAAC,gBAA+C;AAC5E,MAAI,CAAC;AAAa,WAAO;AAEzB,MAAI;AACF,UAAM,YAAY,IAAI,KAAK,WAAW;AACtC,UAAM,QAAQ,oBAAI,KAAK;AACvB,QAAI,MAAM,MAAM,YAAY,IAAI,UAAU,YAAY;AACtD,UAAM,YAAY,MAAM,SAAS,IAAI,UAAU,SAAS;AAExD,QAAI,YAAY,KAAM,cAAc,KAAK,MAAM,QAAQ,IAAI,UAAU,QAAQ,GAAI;AAC/E;AAAA,IACF;AAEA,WAAO,OAAO,IAAI,MAAM;AAAA,EAC1B,QAAQ;AACN,WAAO;AAAA,EACT;AACF;;;ACjPA,OAAOA,YAAW;AAoBX,IAAM,8BAA8B,CAAC,WAAmB,eAAuB;AACpF,QAAM,kBAAkB,aAAa,IAAK,YAAY,aAAc,MAAM;AAE1E,MAAI;AACJ,MAAI,cAAc,GAAG;AACnB,aAAS,EAAE,OAAO,2BAA2B,MAAM,SAAS,MAAM,eAAe;AAAA,EACnF,WAAW,kBAAkB,IAAI;AAC/B,aAAS,EAAE,OAAO,iCAAiC,MAAM,eAAe,MAAM,YAAY;AAAA,EAC5F,WAAW,kBAAkB,IAAI;AAC/B,aAAS,EAAE,OAAO,iCAAiC,MAAM,cAAc,MAAM,gBAAgB;AAAA,EAC/F,OAAO;AACL,aAAS,EAAE,OAAO,+BAA+B,MAAM,aAAa,MAAM,WAAW;AAAA,EACvF;AAEA,QAAM,OAAO,OAAO;AAEpB,SACE,gBAAAA,OAAA,cAAC,UAAK,WAAW,2EAA2E,OAAO,KAAK,MACtG,gBAAAA,OAAA,cAAC,QAAK,WAAU,gBAAe,GAC9B,OAAO,IACV;AAEJ;AAOO,IAAM,sBAAsB,CAAC,YAA0C;AAC5E,QAAM,eAAe,QAAQ,aAAa,QAAQ,YAAY;AAC9D,QAAM,eAAe,QAAQ,aAAa,QAAQ,YAAY;AAE9D,MAAI;AACJ,MAAI,gBAAgB,cAAc;AAChC,aAAS,EAAE,OAAO,6BAA6B,MAAM,SAAS,MAAM,cAAc;AAAA,EACpF,WAAW,cAAc;AACvB,aAAS,EAAE,OAAO,iCAAiC,MAAM,cAAc,MAAM,cAAc;AAAA,EAC7F,WAAW,cAAc;AACvB,aAAS,EAAE,OAAO,+BAA+B,MAAM,YAAY,MAAM,YAAY;AAAA,EACvF,OAAO;AACL,aAAS,EAAE,OAAO,6BAA6B,MAAM,SAAS,MAAM,aAAa;AAAA,EACnF;AAEA,QAAM,OAAO,OAAO;AAEpB,SACE,gBAAAA,OAAA,cAAC,UAAK,WAAW,2EAA2E,OAAO,KAAK,MACtG,gBAAAA,OAAA,cAAC,QAAK,WAAU,gBAAe,GAC9B,OAAO,IACV;AAEJ;AAOO,IAAM,wBAAwB,CAAC,aAA+C;AACnF,QAAM,gBAAgB,YAAY,CAAC;AACnC,QAAM,gBAAgB,cAAc;AACpC,QAAM,iBAAiB,cAAc,OAAO,OAAK,EAAE,QAAQ,EAAE;AAC7D,QAAM,mBAAmB,cAAc,OAAO,OAAK,CAAC,EAAE,QAAQ,EAAE;AAChE,QAAM,kBAAkB,cAAc,OAAO,OAAK,EAAE,YAAY,CAAC,EAAE;AACnE,QAAM,qBAAqB,cAAc,OAAO,OAAK,EAAE,cAAc,CAAC,EAAE;AACxE,QAAM,mBAAmB,cAAc,OAAO,OAAK,EAAE,YAAY,KAAK,EAAE,YAAY,CAAC,EAAE;AAGvF,QAAM,kBAAkB,cAAc,OAAO,CAAC,KAAK,YAAY;AAC7D,UAAM,aAAa,QAAQ,aAAa,QAAQ,aAAa;AAC7D,WAAO,MAAM;AAAA,EACf,GAAG,CAAC;AAGJ,QAAM,oBAAoB,cAAc,OAAO,OAAK,EAAE,aAAa,EAAE,YAAY,CAAC;AAClF,QAAM,eAAe,kBAAkB,SAAS,IAC5C,kBAAkB,OAAO,CAAC,KAAK,MAAM,OAAO,EAAE,aAAa,IAAI,CAAC,IAAI,kBAAkB,SACtF;AAEJ,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;AAYO,IAAM,iBAAiB,CAC5B,UACA,YACA,gBACA,cACA,oBACA,iBACuC;AACvC,UAAQ,YAAY,CAAC,GAAG,OAAO,aAAW;AAExC,QAAI,CAAC,WAAW,OAAO,YAAY,UAAU;AAC3C,aAAO;AAAA,IACT;AAEA,UAAM,iBAAiB,QAAQ,QAAQ,IAAI,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC,MACpE,QAAQ,eAAe,IAAI,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC,MAC1E,QAAQ,WAAW,IAAI,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC;AAG5F,UAAM,oBAAoB,cAAc,UAAW,QAAgB,UAAU,KAAK,QAAQ;AAC1F,UAAM,kBAAkB,mBAAmB,SACnB,qBAAqB,kBAAkB,SAAS,MAAM;AAG9E,UAAM,kBAAkB,YAAY,UAAW,QAAgB,QAAQ,KAAK;AAC5E,UAAM,gBAAgB,iBAAiB,SACjB,mBAAmB,gBAAgB,SAAS,MAAM;AAExE,UAAM,sBAAsB,uBAAuB,SACvB,uBAAuB,cAAc,QAAQ,YAAY,KACzD,uBAAuB,kBAAkB,QAAQ,cAAc,KAC/D,uBAAuB,eAAe,QAAQ,YAAY,KAAK,QAAQ,YAAY;AAE/G,UAAM,gBAAgB,iBAAiB,SACjB,iBAAiB,YAAY,QAAQ,YACrC,iBAAiB,cAAc,CAAC,QAAQ;AAE9D,WAAO,iBAAiB,mBAAmB,iBAAiB,uBAAuB;AAAA,EACrF,CAAC;AACH;AAQO,IAAM,qBAAqB,CAAC,OAAe,WAAmB,UAAkB;AACrF,SAAO,IAAI,KAAK,aAAa,SAAS;AAAA,IACpC,OAAO;AAAA,IACP;AAAA,EACF,CAAC,EAAE,OAAO,KAAK;AACjB;AAOO,IAAM,qBAAqB,CAAC,YAAkD;AACnF,MAAI,QAAQ,UAAU,QAAQ,OAAO,SAAS,GAAG;AAC/C,WAAO,QAAQ,OAAO,CAAC;AAAA,EACzB;AACA,SAAO;AACT;AAQO,IAAM,2BAA2B,CAAC,WAAmB,eAA+B;AACzF,MAAI,eAAe;AAAG,WAAO;AAC7B,SAAO,KAAK,MAAO,YAAY,aAAc,GAAG;AAClD;AAQO,IAAM,wBAAwB,CAAC,WAAmB,eAA+B;AACtF,MAAI,cAAc;AAAG,WAAO;AAC5B,MAAI,YAAY;AAAG,WAAO;AAC1B,MAAI,YAAY,aAAa;AAAK,WAAO;AACzC,SAAO;AACT;AAOO,IAAM,iBAAiB,CAAC,YAAmD;AAChF,SAAO,QAAQ,YAAY,QAAQ,YAAY,KAAK,QAAQ,YAAY;AAC1E;AAOO,IAAM,iBAAiB,CAAC,YAAmD;AAChF,SAAO,QAAQ,YAAY,QAAQ,YAAY,KAAM,QAAgB,aAAc,QAAgB,YAAY;AACjH;AAOO,IAAM,wBAAwB,CAAC,YAAkD;AACtF,SAAO,QAAQ,QAAQ;AACzB;AAOO,IAAM,yBAAyB,CAAC,YAAkD;AACvF,SAAO,cAAc,UAAW,QAAQ,UAAU,QAAQ,kBAAmB;AAC/E;AAOO,IAAM,uBAAuB,CAAC,YAAkD;AACrF,SAAO,YAAY,UAAY,QAAgB,QAAQ,QAAQ,cAAe;AAChF;AASO,IAAM,eAAe,CAC1B,UACA,QACA,YAA4B,UACW;AACvC,SAAO,CAAC,GAAG,QAAQ,EAAE,KAAK,CAAC,GAAG,MAAM;AAClC,QAAI;AACJ,QAAI;AAEJ,YAAQ,QAAQ;AAAA,MACd,KAAK;AACH,kBAAU,EAAE,QAAQ,IAAI,YAAY;AACpC,kBAAU,EAAE,QAAQ,IAAI,YAAY;AACpC;AAAA,MACF,KAAK;AACH,iBAAS,EAAE,aAAa;AACxB,iBAAS,EAAE,aAAa;AACxB;AAAA,MACF,KAAK;AACH,iBAAS,EAAE,aAAa;AACxB,iBAAS,EAAE,aAAa;AACxB;AAAA,MACF,KAAK;AACH,iBAAS,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ;AACvC,iBAAS,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ;AACvC;AAAA,MACF,KAAK;AACH,iBAAS,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ;AACvC,iBAAS,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ;AACvC;AAAA,MACF;AACE,iBAAS,EAAE,QAAQ;AACnB,iBAAS,EAAE,QAAQ;AAAA,IACvB;AAEA,QAAI,cAAc,OAAO;AACvB,aAAO,SAAS,SAAS,IAAI;AAAA,IAC/B,OAAO;AACL,aAAO,SAAS,SAAS,IAAI;AAAA,IAC/B;AAAA,EACF,CAAC;AACH;;;ACxSO,IAAM,mBAAmB,CAAC,SAAiB;AAChD,SAAO,aAAa,EAAE,KAAK,CAAC;AAC9B;AASO,IAAM,qBAAqB,CAAC,UAAkB;AACnD,QAAM,aAAa,SAAS,CAAC;AAC7B,QAAM,aAAa,WAAW;AAC9B,QAAM,cAAc,WAAW,OAAO,OAAK,EAAE,QAAQ,EAAE;AACvD,QAAM,gBAAgB,WAAW,OAAO,OAAK,CAAC,EAAE,QAAQ,EAAE;AAC1D,QAAM,gBAAgB,WAAW,OAAO,OAAK,EAAE,aAAa,EAAE;AAC9D,QAAM,kBAAkB,WAAW,OAAO,OAAK,CAAC,EAAE,aAAa,EAAE;AAEjE,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;AAUO,IAAM,cAAc,CACzB,OACA,YACA,YACA,iBACW;AACX,UAAQ,SAAS,CAAC,GAAG,OAAO,UAAQ;AAElC,QAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;AACrC,aAAO;AAAA,IACT;AAEA,UAAM,WAAW,GAAG,KAAK,aAAa,EAAE,IAAI,KAAK,YAAY,EAAE,GAAG,KAAK;AACvE,UAAM,gBAAgB,SAAS,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC,MACxD,KAAK,SAAS,IAAI,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC,KACjE,KAAK,UAAU,QAAQ,KAAK,SAAS,KAAK,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC,KACzF,KAAK,QAAQ,QAAQ,KAAK,OAAO,KAAK,YAAY,EAAE,SAAS,WAAW,YAAY,CAAC;AAE3G,UAAM,cAAc,eAAe,SAAS,KAAK,SAAS;AAC1D,UAAM,gBAAgB,iBAAiB,SACjB,iBAAiB,YAAY,KAAK,YAClC,iBAAiB,cAAc,CAAC,KAAK;AAE3D,WAAO,iBAAiB,eAAe;AAAA,EACzC,CAAC;AACH;AAOO,IAAM,kBAAkB,CAAC,SAAuB;AACrD,SAAO,GAAG,KAAK,aAAa,EAAE,IAAI,KAAK,YAAY,EAAE,GAAG,KAAK;AAC/D;AAOO,IAAM,iBAAiB,CAAC,aAA+B;AAC5D,SAAO,aAAa,WACb,aAAa,cACb,aAAa;AACtB;;;AC1FA,SAAS,SAAS;AAOX,IAAM,cAAc,EAAE,OAAO;AAAA,EAClC,OAAO,EAAE,OAAO,EAAE,MAAM,uBAAuB;AAAA,EAC/C,UAAU,EAAE,OAAO,EAAE,IAAI,GAAG,wCAAwC;AACtE,CAAC;AAEM,IAAM,iBAAiB,EAAE,OAAO;AAAA,EACrC,OAAO,EAAE,OAAO,EAAE,MAAM,uBAAuB;AAAA,EAC/C,UAAU,EAAE,OAAO,EAAE,IAAI,GAAG,wCAAwC;AAAA;AAAA,EAEpE,MAAM,EAAE,OAAO,EAAE,IAAI,GAAG,oCAAoC,EAAE,SAAS;AAAA,EACvE,WAAW,EAAE,OAAO,EAAE,IAAI,GAAG,wBAAwB,EAAE,SAAS;AAAA,EAChE,UAAU,EAAE,OAAO,EAAE,IAAI,GAAG,uBAAuB,EAAE,SAAS;AAAA,EAC9D,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,MAAM,EAAE,KAAK,CAAC,UAAU,cAAc,SAAS,YAAY,gBAAgB,cAAc,CAAC,EAAE,SAAS;AAAA;AAAA,EAErG,cAAc,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAElC,cAAc,EAAE,KAAK,CAAC,YAAY,WAAW,aAAa,SAAS,CAAC,EAAE,SAAS;AAAA,EAC/E,aAAa,EAAE,KAAK,CAAC,SAAS,UAAU,SAAS,QAAQ,CAAC,EAAE,SAAS;AAAA;AAAA,EAErE,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,MAAM,EAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,SAAS,EAAE,OAAO,EAAE,IAAI,GAAG,+BAA+B,EAAE,SAAS;AAAA;AAAA,EAErE,cAAc,EAAE,OAAO,EAAE,SAAS;AAAA,EAClC,YAAY,EAAE,OAAO,EAAE,SAAS;AAClC,CAAC,EAAE,OAAO,CAAC,SAAS;AAElB,SAAO,KAAK,QAAS,KAAK,aAAa,KAAK;AAC9C,GAAG;AAAA,EACD,SAAS;AACX,CAAC,EAAE,OAAO,CAAC,SAAS;AAElB,MAAI,KAAK,SAAS,cAAc,KAAK,cAAc;AACjD,WAAO,KAAK,gBAAgB,KAAK;AAAA,EACnC;AACA,SAAO;AACT,GAAG;AAAA,EACD,SAAS;AACX,CAAC;AAGD,IAAM,wBAAwB,EAAE,OAAO;AAAA,EACrC,UAAU,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,oBAAoB;AAAA,EAC/D,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,GAAG,4BAA4B;AAC7D,CAAC;AAEM,IAAM,sBAAsB,EAAE,OAAO;AAAA,EAC1C,MAAM,EAAE,OAAO,EAAE,IAAI,GAAG,0BAA0B;AAAA,EAClD,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,WAAW,EAAE,OAAO,EAAE,YAAY,iCAAiC;AAAA,EACnE,WAAW,EAAE,OAAO,EAAE,YAAY,iCAAiC;AAAA,EACnE,SAAS,EAAE,OAAO,EAAE,YAAY,8BAA8B,EAAE,QAAQ,CAAC;AAAA,EACzE,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACxD,YAAY,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,GAAG,kCAAkC;AAAA,EACtE,QAAQ,EAAE,MAAM,CAAC,EAAE,OAAO,GAAG,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC,EAAE,SAAS;AAAA;AAAA,EAC5D,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACxD,aAAa,EAAE,MAAM,qBAAqB,EAAE,IAAI,GAAG,6CAA6C;AAAA;AAClG,CAAC;AAEM,IAAM,sBAAsB,EAAE,OAAO;AAAA,EAC1C,MAAM,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,SAAS;AAAA,EACjC,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,WAAW,EAAE,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EAC7C,WAAW,EAAE,OAAO,EAAE,YAAY,EAAE,SAAS,EAAE,SAAS;AAAA,EACxD,SAAS,EAAE,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EAC3C,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACxD,YAAY,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,SAAS;AAC/C,CAAC;AAEM,IAAM,sBAAsB,EAAE,OAAO;AAAA,EAC1C,GAAG,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EACvB,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC5B,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACxD,UAAU,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACtD,WAAW,EAAE,OAAO,QAAQ,EAAE,SAAS;AAAA;AAAA,EACvC,UAAU,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA;AAAA,EACnD,UAAU,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA;AAAA,EACnD,MAAM,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA,EAC9C,OAAO,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG,EAAE,QAAQ,EAAE;AAAA,EACzD,QAAQ,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA;AAAA,EAChD,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC5B,WAAW,EAAE,KAAK,CAAC,OAAO,MAAM,CAAC,EAAE,SAAS;AAAA;AAC9C,CAAC;AAGM,IAAM,eAAe,EAAE,OAAO;AAAA,EACnC,WAAW,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,qBAAqB;AAAA;AAAA,EACjE,WAAW,EAAE,KAAK;AAAA,EAClB,SAAS,EAAE,KAAK;AAAA,EAChB,OAAO,EAAE,OAAO,EAAE,SAAS;AAC7B,CAAC,EAAE,OAAO,CAAC,SAAS,KAAK,UAAU,KAAK,WAAW;AAAA,EACjD,SAAS;AAAA,EACT,MAAM,CAAC,SAAS;AAClB,CAAC;AAUM,IAAM,uBAAuB,EAAE,OAAO;AAAA,EAC3C,WAAW,EAAE,OAAO,EAAE,IAAI,GAAG,wBAAwB;AAAA,EACrD,UAAU,EAAE,OAAO,EAAE,IAAI,GAAG,uBAAuB;AAAA,EACnD,OAAO,EAAE,OAAO,EAAE,MAAM,sBAAsB,EAAE,SAAS,EAAE,GAAG,EAAE,QAAQ,EAAE,CAAC;AAAA,EAC3E,OAAO,EAAE,OAAO,EAAE,IAAI,GAAG,0BAA0B;AAAA,EACnD,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACxD,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,MAAM,EAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,UAAU,EAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,QAAQ,EAAE,KAAK,CAAC,YAAY,mBAAmB,eAAe,OAAO,CAAC,EAAE,SAAS;AAAA,EACjF,OAAO,EAAE,OAAO,EAAE,SAAS;AAC7B,CAAC;AAEM,IAAM,uBAAuB,qBAAqB,QAAQ,EAAE,OAAO;AAAA,EACxE,UAAU,EAAE,QAAQ,EAAE,SAAS;AAAA,EAC/B,QAAQ,EAAE,KAAK,CAAC,YAAY,mBAAmB,eAAe,OAAO,CAAC,EAAE,SAAS;AACnF,CAAC;AAEM,IAAM,uBAAuB,EAAE,OAAO;AAAA,EAC3C,GAAG,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EACvB,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC5B,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACxD,UAAU,EAAE,MAAM,CAAC,EAAE,OAAO,GAAG,EAAE,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC,MAAM;AAC5D,QAAI,OAAO,MAAM;AAAW,aAAO;AACnC,QAAI,MAAM;AAAW,aAAO;AAC5B,WAAO,MAAM;AAAA,EACf,CAAC,EAAE,SAAS;AAAA,EACZ,MAAM,EAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,QAAQ,EAAE,KAAK,CAAC,YAAY,mBAAmB,eAAe,OAAO,CAAC,EAAE,SAAS;AAAA,EACjF,MAAM,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA,EAC9C,OAAO,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG,EAAE,QAAQ,EAAE;AAAA,EACzD,QAAQ,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA;AAAA,EAChD,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC5B,WAAW,EAAE,KAAK,CAAC,OAAO,MAAM,CAAC,EAAE,SAAS;AAAA;AAC9C,CAAC;AAOD,IAAM,gBAAgB,EAAE,KAAK,CAAC,QAAQ,MAAM,CAAC;AAK7C,IAAM,kBAAkB,EAAE,KAAK,CAAC,YAAY,YAAY,YAAY,aAAa,WAAW,CAAC;AAEtF,IAAM,oBAAoB,EAAE,OAAO;AAAA,EACxC,GAAG,EAAE,OAAO,EAAE,SAAS;AAAA,EACvB,UAAU,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACtD,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACxD,QAAQ,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACpD,WAAW,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACvD,WAAW,cAAc,SAAS;AAAA,EAClC,QAAQ,gBAAgB,SAAS;AAAA,EACjC,WAAW,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACpC,SAAS,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EAClC,YAAY,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACrC,YAAY,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACrC,WAAW,EAAE,OAAO,OAAO,EAAE,SAAS;AAAA,EACtC,WAAW,EAAE,OAAO,OAAO,EAAE,SAAS;AAAA,EACtC,OAAO,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG,EAAE,QAAQ,EAAE;AAAA,EACzD,QAAQ,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAClD,CAAC;AAED,IAAM,kBAAkB,EAAE,OAAO;AAAA,EAC/B,WAAW,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS;AAAA;AAAA,EAC5C,UAAU,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS;AAAA,EAC3C,WAAW,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,QAAQ,CAAC;AAAA,EACpD,YAAY,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA;AAAA,EACrD,SAAS,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,QAAQ,CAAC;AAAA,EAClD,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,WAAW,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACpC,SAAS,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EAClC,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,YAAY,EAAE,SAAS;AAC7D,CAAC;AAKD,IAAM,kBAAkB,EAAE,OAAO;AAAA;AAAA,EAE/B,SAAS,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA,EACrD,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAGjC,WAAW;AAAA,EACX,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA,EACxD,UAAU,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS;AAAA,EAC3C,cAAc,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACvC,cAAc,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACvC,gBAAgB,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA,EAC5D,UAAU,EAAE,OAAO,OAAO,EAAE,YAAY;AAAA,EACxC,WAAW,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EACpD,cAAc,EAAE,KAAK,CAAC,UAAU,YAAY,CAAC,EAAE,SAAS;AAAA,EACxD,eAAe,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EACxD,gBAAgB,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EACzD,aAAa,EAAE,OAAO,OAAO,EAAE,YAAY;AAAA,EAC3C,eAAe,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EACxD,iBAAiB,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EAC1D,WAAW,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EACpD,SAAS,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EAClD,gBAAgB,EAAE,OAAO,EAAE,SAAS;AAAA,EACpC,mBAAmB,EAAE,OAAO,EAAE,SAAS;AAAA,EACvC,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,cAAc,EAAE,OAAO,EAAE,SAAS;AAAA,EAClC,eAAe,EAAE,OAAO,EAAE,SAAS;AAAA,EACnC,eAAe,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS;AAAA,EAC3C,kBAAkB,EAAE,QAAQ,EAAE,SAAS;AAAA;AAAA,EAGvC,YAAY,EAAE,MAAM,eAAe;AACrC,CAAC;AAEM,IAAM,oBAAoB;AAE1B,IAAM,oBAAoB,gBAAgB,QAAQ,EAAE,OAAO;AAAA;AAAA,EAEhE,QAAQ,gBAAgB,SAAS;AAAA,EACjC,YAAY,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACrC,YAAY,EAAE,OAAO,KAAK,EAAE,SAAS;AACvC,CAAC;AAUD,IAAM,eAAe,EAAE,KAAK,CAAC,SAAS,YAAY,gBAAgB,cAAc,CAAC;AAE1E,IAAM,mBAAmB,EAAE,OAAO;AAAA,EACvC,MAAM,aAAa,SAAS;AAAA,EAC5B,UAAU,EAAE,MAAM,CAAC,EAAE,OAAO,GAAG,EAAE,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC,MAAM;AAC5D,QAAI,OAAO,MAAM;AAAW,aAAO;AACnC,QAAI,MAAM;AAAW,aAAO;AAC5B,WAAO,MAAM;AAAA,EACf,CAAC,EAAE,SAAS;AAAA,EACZ,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,MAAM,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA,EAC9C,OAAO,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG,EAAE,QAAQ,EAAE;AAAA,EACzD,QAAQ,EAAE,KAAK,CAAC,aAAa,YAAY,SAAS,WAAW,CAAC,EAAE,QAAQ,WAAW,EAAE,SAAS;AAAA,EAC9F,WAAW,EAAE,KAAK,CAAC,OAAO,MAAM,CAAC,EAAE,QAAQ,MAAM,EAAE,SAAS;AAC9D,CAAC;AAEM,IAAM,mBAAmB,EAAE,OAAO;AAAA,EACvC,OAAO,EAAE,OAAO,EAAE,MAAM;AAAA,EACxB,UAAU,EAAE,OAAO,EAAE,IAAI,CAAC;AAAA,EAC1B,WAAW,EAAE,OAAO,EAAE,IAAI,CAAC;AAAA,EAC3B,UAAU,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,GAAG,EAAE,QAAQ,EAAE,CAAC;AAAA;AAAA,EAC5C,OAAO,EAAE,OAAO,EAAE,IAAI,GAAG,0BAA0B;AAAA;AAAA,EACnD,MAAM,aAAa,SAAS;AAAA,EAC5B,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA,EACxD,UAAU,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AACxD,CAAC;AAEM,IAAM,mBAAmB,EAAE,OAAO;AAAA,EACvC,WAAW,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,SAAS;AAAA,EACtC,UAAU,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,GAAG,EAAE,QAAQ,EAAE,CAAC,EAAE,SAAS;AAAA;AAAA,EACvD,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS;AAAA,EACnC,OAAO,EAAE,OAAO,EAAE,IAAI,GAAG,0BAA0B,EAAE,SAAS;AAAA;AAAA,EAC9D,MAAM,aAAa,SAAS;AAAA,EAC5B,UAAU,EAAE,QAAQ,EAAE,SAAS;AAAA,EAC/B,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA,EACxD,UAAU,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AACxD,CAAC;AASM,IAAM,qBAAqB,EAAE,OAAO;AAAA,EACzC,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA;AAAA,EACxD,UAAU,EAAE,MAAM,CAAC,EAAE,OAAO,GAAG,EAAE,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC,MAAM;AAC5D,QAAI,OAAO,MAAM;AAAW,aAAO;AACnC,QAAI,MAAM;AAAW,aAAO;AAC5B,QAAI,MAAM;AAAO,aAAO;AACxB,WAAO,MAAM;AAAA,EACf,CAAC,EAAE,SAAS;AAAA,EACZ,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,MAAM,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA,EAC9C,OAAO,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG,EAAE,QAAQ,EAAE;AAC3D,CAAC;AAEM,IAAM,qBAAqB,EAAE,OAAO;AAAA,EACzC,MAAM,EAAE,OAAO,EAAE,IAAI,GAAG,yBAAyB;AAAA,EACjD,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,MAAM,EAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,QAAQ,EAAE,KAAK,CAAC,UAAU,YAAY,UAAU,WAAW,CAAC,EAAE,QAAQ,QAAQ;AAChF,CAAC;AAEM,IAAM,qBAAqB,EAAE,OAAO;AAAA,EACzC,MAAM,EAAE,OAAO,EAAE,IAAI,GAAG,yBAAyB,EAAE,SAAS;AAAA,EAC5D,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,MAAM,EAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,OAAO,EAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,SAAS,EAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,UAAU,EAAE,QAAQ,EAAE,SAAS;AAAA,EAC/B,QAAQ,EAAE,KAAK,CAAC,UAAU,YAAY,UAAU,WAAW,CAAC,EAAE,SAAS;AACzE,CAAC;AAOM,IAAM,mBAAmB,EAAE,OAAO;AAAA,EACvC,MAAM,EAAE,OAAO,EAAE,IAAI,GAAG,uBAAuB;AAAA,EAC/C,aAAa,EAAE,OAAO,EAAE,IAAI,GAAG,8BAA8B;AAAA,EAC7D,WAAW,EAAE,OAAO,EAAE,YAAY,iCAAiC;AAAA,EACnE,UAAU,EAAE,OAAO,EAAE,QAAQ,KAAK;AAAA,EAClC,WAAW,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,GAAG,iCAAiC;AAAA,EACpE,QAAQ,EAAE,OAAO;AAAA,IACf,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,IAAI,gDAAgD;AAAA,IAClF,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,IAAI,8CAA8C;AAAA,IAC9E,UAAU,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,IAAI,iDAAiD;AAAA,IACpF,WAAW,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,IAAI,kDAAkD;AAAA,EACxF,CAAC;AAAA,EACD,UAAU,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EACxC,UAAU,EAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EAClC,WAAW,EAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EACpC,WAAW,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,CAAC;AACvC,CAAC;AAEM,IAAM,mBAAmB,iBAAiB,QAAQ;AAElD,IAAM,mBAAmB,EAAE,OAAO;AAAA,EACvC,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,UAAU,EAAE,OAAO,QAAQ,EAAE,SAAS;AAAA,EACtC,WAAW,EAAE,OAAO,QAAQ,EAAE,SAAS;AAAA,EACvC,OAAO,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG,EAAE,QAAQ,EAAE;AAAA,EACzD,QAAQ,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA,EAChD,QAAQ,EAAE,KAAK,CAAC,QAAQ,SAAS,aAAa,aAAa,WAAW,CAAC,EAAE,QAAQ,WAAW;AAAA;AAAA,EAC5F,WAAW,EAAE,KAAK,CAAC,OAAO,MAAM,CAAC,EAAE,QAAQ,KAAK;AAClD,CAAC;AAUM,IAAM,0BAA0B,EAAE,OAAO;AAAA,EAC9C,QAAQ,EAAE,OAAO,EAAE,IAAI,GAAG,qBAAqB;AAAA,EAC/C,MAAM,EAAE,OAAO,EAAE,IAAI,GAAG,0BAA0B;AAAA,EAClD,UAAU,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,2BAA2B;AAAA,EAC/D,OAAO,EAAE,OAAO,EAAE,YAAY,4BAA4B,EAAE,SAAS;AAAA,EACrE,WAAW,EAAE,OAAO,EAAE,YAAY,iCAAiC,EAAE,SAAS;AAAA,EAC9E,UAAU,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,IAAI,KAAK,oCAAoC,EAAE,QAAQ,CAAC;AAAA,EACpF,UAAU,EAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EAClC,WAAW,EAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EACpC,WAAW,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,CAAC;AACvC,CAAC;AAEM,IAAM,0BAA0B,wBAAwB,QAAQ,EAAE,OAAO;AAAA,EAC9E,QAAQ,EAAE,OAAO,EAAE,IAAI,GAAG,qBAAqB,EAAE,SAAS;AAAA;AAC5D,CAAC;AAEM,IAAM,0BAA0B,EAAE,OAAO;AAAA,EAC9C,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,UAAU,EAAE,OAAO,QAAQ,EAAE,SAAS;AAAA,EACtC,WAAW,EAAE,OAAO,QAAQ,EAAE,SAAS;AAAA,EACvC,UAAU,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA,EACtD,UAAU,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EACnD,UAAU,EAAE,OAAO,OAAO,EAAE,YAAY,EAAE,SAAS;AAAA,EACnD,OAAO,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG,EAAE,QAAQ,EAAE;AAAA,EACzD,QAAQ,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA,EAChD,QAAQ,EAAE,KAAK,CAAC,QAAQ,SAAS,YAAY,YAAY,aAAa,WAAW,CAAC,EAAE,QAAQ,WAAW;AAAA,EACvG,WAAW,EAAE,KAAK,CAAC,OAAO,MAAM,CAAC,EAAE,QAAQ,KAAK;AAClD,CAAC;AAUM,IAAM,2BAA2B,EAAE,OAAO;AAAA,EAC/C,QAAQ,EAAE,OAAO,EAAE,IAAI,GAAG,qBAAqB;AAAA,EAC/C,eAAe,EAAE,OAAO,EAAE,IAAI,GAAG,6BAA6B;AAAA,EAC9D,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,yBAAyB;AAAA,EACtE,QAAQ,EAAE,KAAK,CAAC,SAAS,UAAU,YAAY,aAAa,UAAU,SAAS,CAAC,EAAE,QAAQ,QAAQ;AAAA,EAClG,iBAAiB,EAAE,KAAK,CAAC,SAAS,WAAW,cAAc,MAAM,CAAC,EAAE,QAAQ,OAAO;AAAA,EACnF,QAAQ,EAAE,OAAO,EAAE,YAAY,6BAA6B;AAAA,EAC5D,UAAU,EAAE,OAAO,EAAE,QAAQ,KAAK;AAAA,EAClC,gBAAgB,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACzC,cAAc,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACvC,oBAAoB,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EAC7C,kBAAkB,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EAC3C,mBAAmB,EAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EAC5C,aAAa,EAAE,OAAO,KAAK,EAAE,SAAS;AAAA,EACtC,OAAO,EAAE,OAAO,EAAE,SAAS;AAC7B,CAAC;AAEM,IAAM,2BAA2B,yBAAyB,QAAQ,EAAE,OAAO;AAAA,EAChF,IAAI,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAClD,CAAC;AAEM,IAAM,2BAA2B,EAAE,OAAO;AAAA,EAC/C,YAAY,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA,EACxD,QAAQ,EAAE,KAAK,CAAC,UAAU,YAAY,aAAa,WAAW,aAAa,YAAY,QAAQ,CAAC,EAAE,SAAS;AAAA,EAC3G,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,eAAe,EAAE,OAAO,EAAE,SAAS;AAAA,EACnC,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,OAAO,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG,EAAE,QAAQ,EAAE;AAAA,EACzD,QAAQ,EAAE,OAAO,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA,EAChD,QAAQ,EAAE,KAAK,CAAC,aAAa,oBAAoB,UAAU,QAAQ,CAAC,EAAE,QAAQ,WAAW;AAAA,EACzF,WAAW,EAAE,KAAK,CAAC,OAAO,MAAM,CAAC,EAAE,QAAQ,MAAM;AACnD,CAAC;AA6CD,eAAsB,uBAAuB,YAM1C;AACD,MAAI;AACF,UAAM,CAAC,SAAS,OAAO,UAAU,WAAW,MAAM,IAAI,MAAM,QAAQ,IAAI;AAAA,MACtE,OAAO,OAAO,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC;AAAA,MAC7C,OAAO,KAAK,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC;AAAA,MAC3C,OAAO,QAAQ,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC;AAAA,MAC9C,OAAO,SAAS,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC;AAAA,MAC/C,OAAO,MAAM,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,WAAW,EAAE,EAAE,CAAC;AAAA,IAC1D,CAAC;AAED,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,gCAAgC,KAAK;AACnD,UAAM,IAAI,gDAAmC,6BAA6B;AAAA,EAC5E;AACF;AAKA,eAAsB,kBAAkB,YAA6C;AACnF,MAAI;AAEF,UAAM,WAAW,MAAM,OAAO,SAAS,WAAW;AAAA,MAChD,OAAO,EAAE,IAAI,WAAW;AAAA,MACxB,SAAS;AAAA,QACP,cAAc;AAAA,MAChB;AAAA,IACF,CAAC;AAED,QAAI,CAAC,UAAU;AACb,YAAM,IAAI,wDAAuC,oBAAoB;AAAA,IACvE;AAEA,QAAI,CAAC,SAAS,cAAc;AAC1B,YAAM,IAAI,sCAA8B,oCAAoC;AAAA,IAC9E;AAGA,UAAM,OAAO,MAAM,OAAO,KAAK,WAAW;AAAA,MACxC,OAAO,EAAE,IAAI,SAAS,aAAa,OAAO;AAAA,IAC5C,CAAC;AACD,QAAI,CAAC,MAAM;AACT,YAAM,IAAI,sCAA8B,gBAAgB;AAAA,IAC1D;AACA,UAAM,aAAa,KAAK,MAAM,KAAK,MAAM;AACzC,UAAM,WAAW,KAAK,SAAS,SAAS,sBAAsB,IAAI,eAAe;AAGjF,UAAM,gBAAgB,MAAM,uBAAuB,UAAU;AAG7D,UAAM,cAAc;AAAA,MAClB,SAAS,WAAW,YAAY;AAAA,MAChC,OAAO,WAAW,UAAU;AAAA,MAC5B,UAAU,WAAW,aAAa;AAAA,MAClC,WAAW,WAAW,cAAc;AAAA,MACpC,QAAQ,WAAW,WAAW;AAAA,IAChC;AAGA,UAAM,WAAW,KAAK,MAAM,KAAK,QAAQ;AACzC,UAAM,iBAAiB;AAAA,MACrB,QAAQ;AAAA;AAAA,MACR,KAAK,SAAS,SAAS,sBAAsB;AAAA,MAC7C,oBAAoB,SAAS,SAAS,sBAAsB;AAAA,IAC9D;AAEA,WAAO;AAAA,MACL;AAAA,MACA,UAAU,YAAY;AAAA,MACtB;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,mCAAmC,KAAK;AACtD,QAAI,iBAAiB,UAAU;AAC7B,YAAM;AAAA,IACR;AACA,UAAM,IAAI,8DAA0C,uCAAuC;AAAA,EAC7F;AACF;AAKA,eAAsB,mBACpB,YACA,YACqC;AACrC,MAAI;AACF,UAAM,WAAW,MAAM,kBAAkB,UAAU;AACnD,UAAM,eAAe,SAAS,cAAc,UAAU;AACtD,UAAM,QAAQ,SAAS,WAAW,UAAU;AAC5C,UAAM,cAAc,SAAS,YAAY,UAAU;AAGnD,QAAI,aAAa;AACf,aAAO;AAAA,QACL,SAAS;AAAA,QACT;AAAA,QACA,OAAO;AAAA,QACP;AAAA,MACF;AAAA,IACF;AAGA,QAAI,gBAAgB,OAAO;AACzB,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO,GAAG,UAAU,6BAA6B,YAAY,YAAY,KAAK;AAAA,QAC9E;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAEA,WAAO;AAAA,MACL,SAAS;AAAA,MACT;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,iCAAiC,KAAK;AACpD,UAAM,IAAI,8DAA0C,gCAAgC;AAAA,EACtF;AACF;AAKO,SAAS,uBACd,YACA,UACA,UACS;AACT,UAAQ,UAAU;AAAA,IAChB,KAAK;AACH,aAAO,SAAS,eAAe;AAAA,IACjC,KAAK;AACH,aAAO,SAAS,eAAe;AAAA,IACjC;AACE,aAAO;AAAA,EACX;AACF;AAKO,SAAS,iCAAiC,UAAmC;AAClF,SAAO,SAAS,eAAe;AACjC;AAMA,eAAsB,gBACpB,YACA,YACe;AACf,MAAI;AACF,UAAM,aAAa,MAAM,mBAAmB,YAAY,UAAU;AAElE,QAAI,CAAC,WAAW,SAAS;AACvB,YAAM,IAAI;AAAA;AAAA,QAER,WAAW,SAAS,2BAA2B,UAAU;AAAA,MAC3D;AAAA,IACF;AAAA,EACF,SAAS,OAAO;AACd,QAAI,iBAAiB,UAAU;AAC7B,YAAM;AAAA,IACR;AACA,UAAM,IAAI;AAAA;AAAA,MAER,sCAAsC,UAAU;AAAA,IAClD;AAAA,EACF;AACF;;;ACjqBO,IAAM,qBAAiC;AAAA,EAC5C;AAAA,IACE,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,mBAAmB;AAAA,IACnB,mBAAmB;AAAA,IACnB,cAAc;AAAA,IACd,cAAc;AAAA,EAChB;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,mBAAmB;AAAA,IACnB,mBAAmB;AAAA,IACnB,cAAc;AAAA,IACd,cAAc;AAAA;AAAA,EAChB;AACF;AAKO,IAAM,4BAA8C;AAAA,EACzD,iBAAiB;AAAA;AAAA,EACjB,cAAc;AAAA,EACd,qBAAqB;AAAA,EACrB,YAAY;AAAA,EACZ,UAAU;AACZ;AAOO,SAAS,YAAY,MAA0C;AACpE,SAAO,mBAAmB,KAAK,cAAY,SAAS,SAAS,IAAI;AACnE;AAOO,SAAS,mBAAmB,UAAuC;AACxE,QAAM,kBAAkB,YAAY;AACpC,QAAM,WAAW,YAAY,gBAAgB,eAAe;AAE5D,MAAI,CAAC,UAAU;AAEb,WAAO,mBAAmB,KAAK,OAAK,EAAE,SAAS,KAAK;AAAA,EACtD;AAEA,SAAO;AACT;AASO,SAAS,gBACd,QACA,cACA,YACQ;AACR,MAAI,iBAAiB,YAAY;AAC/B,WAAO;AAAA,EACT;AAEA,QAAM,OAAO,YAAY,YAAY;AACrC,QAAM,KAAK,YAAY,UAAU;AAEjC,MAAI,CAAC,QAAQ,CAAC,IAAI;AAChB,UAAM,IAAI,MAAM,0BAA0B,YAAY,OAAO,UAAU,EAAE;AAAA,EAC3E;AAGA,QAAM,cAAc,SAAS,KAAK;AAClC,SAAO,cAAc,GAAG;AAC1B;AASO,SAAS,uBACd,QACA,UAAiC,CAAC,GAClC,UACQ;AACR,MAAI,WAAW,QAAQ,WAAW,UAAa,MAAM,MAAM,GAAG;AAC5D,WAAO;AAAA,EACT;AAEA,QAAM,kBAAkB,YAAY;AACpC,QAAM,eAAe,QAAQ,YAAY,gBAAgB;AACzD,QAAM,WAAW,YAAY,YAAY;AAEzC,MAAI,CAAC,UAAU;AACb,UAAM,IAAI,MAAM,0BAA0B,YAAY,EAAE;AAAA,EAC1D;AAEA,QAAM,SAAS,QAAQ,UAAU,SAAS;AAC1C,QAAM,aAAa,QAAQ,cAAc,gBAAgB;AACzD,QAAM,WAAW,QAAQ,YAAY,gBAAgB;AACrD,QAAM,iBAAiB,QAAQ,kBAAkB,SAAS;AAG1D,QAAM,kBAAkB,IAAI,KAAK,aAAa,QAAQ;AAAA,IACpD,uBAAuB;AAAA;AAAA,IACvB,uBAAuB;AAAA;AAAA,EACzB,CAAC,EAAE,OAAO,MAAM;AAGhB,MAAI,SAAS;AAEb,MAAI,YAAY;AACd,QAAI,SAAS,cAAc;AACzB,eAAS,GAAG,SAAS,MAAM,GAAG,MAAM;AAAA,IACtC,OAAO;AACL,eAAS,GAAG,MAAM,GAAG,SAAS,MAAM;AAAA,IACtC;AAAA,EACF;AAEA,MAAI,UAAU;AACZ,aAAS,GAAG,MAAM,IAAI,SAAS,IAAI;AAAA,EACrC;AAEA,SAAO;AACT;AASO,SAAS,eACd,QACA,WAAyB,OACzB,QACQ;AACR,SAAO,uBAAuB,QAAQ,EAAE,UAAU,OAAO,CAAC;AAC5D;AAQO,SAAS,cAAc,gBAAwB,WAAyB,OAAsB;AACnG,MAAI,CAAC,kBAAkB,OAAO,mBAAmB,UAAU;AACzD,WAAO;AAAA,EACT;AAEA,QAAM,iBAAiB,YAAY,QAAQ;AAC3C,MAAI,CAAC,gBAAgB;AACnB,WAAO;AAAA,EACT;AAGA,MAAI,cAAc,eACf,QAAQ,IAAI,OAAO,IAAI,eAAe,MAAM,KAAK,GAAG,GAAG,EAAE,EACzD,QAAQ,IAAI,OAAO,eAAe,MAAM,IAAI,GAAG,EAAE,EACjD,KAAK;AAGR,MAAI,eAAe,WAAW,SAAS;AAErC,kBAAc,YAAY,QAAQ,OAAO,EAAE,EAAE,QAAQ,KAAK,GAAG;AAAA,EAC/D,OAAO;AAEL,kBAAc,YAAY,QAAQ,MAAM,EAAE;AAAA,EAC5C;AAEA,QAAM,SAAS,WAAW,WAAW;AACrC,SAAO,MAAM,MAAM,IAAI,OAAO;AAChC;AAOO,SAAS,mBAAmB,UAAgC;AACjE,QAAM,iBAAiB,YAAY,QAAQ;AAC3C,MAAI,CAAC,gBAAgB;AACnB,WAAO;AAAA,EACT;AAEA,MAAI,eAAe,cAAc;AAC/B,WAAO,GAAG,eAAe,MAAM,IAAI,eAAe,IAAI;AAAA,EACxD,OAAO;AACL,WAAO,GAAG,eAAe,IAAI,IAAI,eAAe,MAAM;AAAA,EACxD;AACF;AAOO,SAAS,oBAAoB,MAAoC;AACtE,SAAO,CAAC,OAAO,KAAK,EAAE,SAAS,IAAoB;AACrD;AAQO,SAAS,gBAAgB,cAA4B,YAAkC;AAC5F,MAAI,iBAAiB,YAAY;AAC/B,WAAO;AAAA,EACT;AAEA,QAAM,OAAO,YAAY,YAAY;AACrC,QAAM,KAAK,YAAY,UAAU;AAEjC,MAAI,CAAC,QAAQ,CAAC,IAAI;AAChB,UAAM,IAAI,MAAM,0BAA0B,YAAY,OAAO,UAAU,EAAE;AAAA,EAC3E;AAGA,SAAO,GAAG,eAAe,KAAK;AAChC;;;ACxOO,SAAS,4BAA4B,QAAqD;AAC/F,SAAO;AAAA,IACL,eAAe,OAAO,QAAgB,UAAkB,aAAmB;AACzE,cAAQ,IAAI,qBAAqB,EAAE,QAAQ,UAAU,SAAS,CAAC;AAC/D,aAAO,EAAE,IAAI,mBAAmB,QAAQ,UAAU;AAAA,IACpD;AAAA,IACA,gBAAgB,OAAO,cAAsB;AAC3C,cAAQ,IAAI,uBAAuB,SAAS;AAC5C,aAAO,EAAE,IAAI,WAAW,QAAQ,YAAY;AAAA,IAC9C;AAAA,IACA,eAAe,OAAO,WAAmB,WAAoB;AAC3D,cAAQ,IAAI,sBAAsB,WAAW,MAAM;AACnD,aAAO,EAAE,IAAI,WAAW,QAAQ,WAAW;AAAA,IAC7C;AAAA,EACF;AACF;;;ACrBA,eAAsB,eAAe,UAAkB;AACrD,SAAO,MAAM,oBAAoB,QAAQ;AAC3C;AAKA,eAAsB,0BAA0B,UAAkB;AAChE,QAAM,UAA+B,CAAC,cAAc,cAAc,UAAU,QAAQ;AACpF,QAAM,UAA+B,CAAC;AAEtC,aAAWJ,WAAU,SAAS;AAC5B,QAAI;AACF,YAAM,SAAS,MAAM,4BAA4B,UAAUA,OAAM;AACjE,cAAQA,OAAM,IAAI;AAAA,QAChB,aAAa,OAAO;AAAA,QACpB,UAAU,OAAO;AAAA,QACjB,aAAa,OAAO;AAAA,QACpB,QAAQ,OAAO,YAAY;AAAA,MAC7B;AAAA,IACF,SAAS,OAAO;AACd,YAAM,eAAe,iBAAiB,QAAQ,MAAM,UAAU;AAC9D,cAAQA,OAAM,IAAI;AAAA,QAChB,OAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAEA,SAAO;AACT;AAKO,SAAS,2BAA2B;AACzC,SAAO;AAAA,IACL,eAAe;AAAA,MACb,aAAa;AAAA,MACb,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AAAA,IACA,gBAAgB;AAAA,MACd,aAAa;AAAA,MACb,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AAAA,IACA,eAAe;AAAA,MACb,aAAa;AAAA,MACb,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AAAA,IACA,cAAc;AAAA,MACZ,aAAa;AAAA,MACb,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AAAA,EACF;AACF;AAKA,eAAsB,oBACpB,UACA,WACwE;AACxE,MAAI;AAGF,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,gBAAgB;AAAA,IAClB;AAAA,EACF,SAAS,OAAO;AACd,UAAM,eAAe,iBAAiB,QAAQ,MAAM,UAAU;AAC9D,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS,qBAAqB,YAAY;AAAA,MAC1C,gBAAgB;AAAA,IAClB;AAAA,EACF;AACF;AAKO,SAAS,0BAA0B,aAIxC;AACA,QAAM,SAAmB,CAAC;AAC1B,QAAM,cAAwB,CAAC;AAE/B,MAAI,CAAC,aAAa;AAChB,WAAO,KAAK,8BAA8B;AAC1C,WAAO,EAAE,SAAS,OAAO,QAAQ,YAAY;AAAA,EAC/C;AAEA,MAAI,CAAC,YAAY,WAAW,MAAM,GAAG;AACnC,WAAO,KAAK,qCAAqC;AACjD,gBAAY,KAAK,uCAAuC;AAAA,EAC1D;AAEA,QAAM,QAAQ,YAAY,MAAM,GAAG;AACnC,MAAI,MAAM,SAAS,GAAG;AACpB,WAAO,KAAK,8DAA8D;AAC1E,gBAAY,KAAK,uCAAuC;AAAA,EAC1D;AAEA,MAAI,MAAM,UAAU,GAAG;AACrB,UAAM,WAAW,SAAS,MAAM,CAAC,CAAC;AAClC,QAAI,MAAM,QAAQ,KAAK,WAAW,GAAG;AACnC,aAAO,KAAK,qCAAqC;AACjD,kBAAY,KAAK,mDAAmD;AAAA,IACtE;AAAA,EACF;AAEA,QAAMK,WAAU,OAAO,WAAW;AAElC,MAAIA,UAAS;AACX,gBAAY,KAAK,8BAA8B;AAAA,EACjD;AAEA,SAAO,EAAE,SAAAA,UAAS,QAAQ,YAAY;AACxC;;;AC9IA,SAAS,QAAQ,SAAS,kBAAkB,SAAS,UAAU,SAAS,gBAAgB;AAKxF,IAAM,SAAS,CAAC,SAAwD;AACtE,MAAI,CAAC;AAAM,WAAO;AAElB,MAAI,gBAAgB,MAAM;AACxB,WAAO,QAAQ,IAAI,IAAI,OAAO;AAAA,EAChC;AAEA,MAAI;AACF,UAAM,SAAS,SAAS,IAAI;AAC5B,WAAO,QAAQ,MAAM,IAAI,SAAS;AAAA,EACpC,QAAQ;AACN,WAAO;AAAA,EACT;AACF;AAEO,IAAM,aAAa,CAAC,MAAwC,eAAuB,iBAAyB;AACjH,QAAM,UAAU,OAAO,IAAI;AAC3B,MAAI,CAAC;AAAS,WAAO;AAErB,MAAI;AACF,WAAO,OAAO,SAAS,YAAY;AAAA,EACrC,QAAQ;AACN,WAAO;AAAA,EACT;AACF;AAEO,IAAM,iBAAiB,CAAC,SAAmD;AAChF,QAAM,UAAU,OAAO,IAAI;AAC3B,MAAI,CAAC;AAAS,WAAO;AAErB,MAAI;AACF,WAAO,OAAO,SAAS,kBAAkB;AAAA,EAC3C,QAAQ;AACN,WAAO;AAAA,EACT;AACF;AAEO,IAAM,gBAAgB,CAAC,MAAY,SAAuB;AAC/D,SAAO,QAAQ,MAAM,IAAI;AAC3B;AAEO,IAAM,oBAAoB,CAAC,WAAiB,YAA0B;AAC3E,SAAO,iBAAiB,SAAS,SAAS;AAC5C;AAEO,IAAM,cAAc,CAAC,OAAa,UAAyB;AAChE,SAAO,QAAQ,OAAO,KAAK;AAC7B;AAEO,IAAM,eAAe,CAAC,OAAa,UAAyB;AACjE,SAAO,SAAS,OAAO,KAAK;AAC9B;AAEO,IAAM,iBAAiB,MAAY;AACxC,SAAO,oBAAI,KAAK;AAClB;AAEO,IAAM,cAAc,MAAY;AACrC,SAAO,cAAc,eAAe,GAAG,CAAC;AAC1C;AAKO,IAAM,iBAAiB,CAAC,SAAmD;AAChF,QAAM,UAAU,OAAO,IAAI;AAC3B,MAAI,CAAC;AAAS,WAAO;AAErB,MAAI;AACF,WAAO,IAAI,KAAK,eAAe,SAAS;AAAA,MACtC,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,IACP,CAAC,EAAE,OAAO,OAAO;AAAA,EACnB,QAAQ;AACN,WAAO;AAAA,EACT;AACF;AAKO,IAAM,qBAAqB,CAAC,SAAmD;AACpF,QAAM,UAAU,OAAO,IAAI;AAC3B,MAAI,CAAC;AAAS,WAAO;AAErB,MAAI;AACF,WAAO,IAAI,KAAK,eAAe,SAAS;AAAA,MACtC,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,MACL,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,QAAQ;AAAA,IACV,CAAC,EAAE,OAAO,OAAO;AAAA,EACnB,QAAQ;AACN,WAAO;AAAA,EACT;AACF;AAKO,IAAM,kBAAkB,CAAC,SAAmD;AACjF,QAAM,UAAU,OAAO,IAAI;AAC3B,MAAI,CAAC;AAAS,WAAO;AAErB,MAAI;AACF,WAAO,IAAI,KAAK,eAAe,SAAS;AAAA,MACtC,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,IACP,CAAC,EAAE,OAAO,OAAO;AAAA,EACnB,QAAQ;AACN,WAAO;AAAA,EACT;AACF;AAKO,IAAM,sBAAsB,CAAC,SAAmD;AACrF,QAAM,UAAU,OAAO,IAAI;AAC3B,MAAI,CAAC;AAAS,WAAO;AAErB,MAAI;AACF,WAAO,IAAI,KAAK,eAAe,SAAS;AAAA,MACtC,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,MACL,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,QAAQ;AAAA,IACV,CAAC,EAAE,OAAO,OAAO;AAAA,EACnB,QAAQ;AACN,WAAO;AAAA,EACT;AACF;;;AChGO,IAAM,qBAAkC;AAAA,EAC7C,QAAQ;AAAA,IACN,SAAS,QAAQ,IAAI,0BAA0B,UACtC,QAAQ,IAAI,aAAa,gBACzB,QAAQ,IAAI,aAAa,iBACzB,QAAQ,IAAI,aAAa;AAAA;AAAA,IAClC,OAAO;AAAA,IACP,eAAe,SAAS,QAAQ,IAAI,wBAAwB,IAAI;AAAA,IAChE,YAAY,SAAS,QAAQ,IAAI,sBAAsB,SAAS;AAAA;AAAA,EAClE;AAAA,EACA,UAAU;AAAA;AAAA,IAER,UAAU;AAAA,MACR,SAAS;AAAA,MACT,UAAU;AAAA,MACV,QAAQ;AAAA,QACN,SAAS,CAAC,GAAG;AAAA;AAAA,QACb,SAAS,CAAC,YAAY,SAAS,QAAQ;AAAA,QACvC,WAAW,CAAC,SAAS,SAAS,UAAU;AAAA,MAC1C;AAAA,MACA,UAAU,EAAE,SAAS,OAAO,MAAM,EAAI;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA,IACA,OAAO;AAAA,MACL,SAAS;AAAA,MACT,UAAU;AAAA,MACV,QAAQ;AAAA,QACN,SAAS,CAAC,GAAG;AAAA,QACb,SAAS,CAAC,gBAAgB,YAAY;AAAA,QACtC,WAAW,CAAC,cAAc,aAAa;AAAA,MACzC;AAAA,MACA,UAAU,EAAE,SAAS,OAAO,MAAM,EAAI;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA,IACA,MAAM;AAAA,MACJ,SAAS;AAAA,MACT,UAAU;AAAA,MACV,QAAQ;AAAA,QACN,SAAS,CAAC,GAAG;AAAA,QACb,SAAS,CAAC,YAAY,gBAAgB,OAAO;AAAA,QAC7C,WAAW,CAAC,SAAS,OAAO;AAAA,MAC9B;AAAA,MACA,UAAU,EAAE,SAAS,OAAO,MAAM,EAAI;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA,IACA,SAAS;AAAA,MACP,SAAS;AAAA,MACT,UAAU;AAAA,MACV,QAAQ;AAAA,QACN,SAAS,CAAC,GAAG;AAAA,QACb,SAAS,CAAC,cAAc,OAAO,OAAO;AAAA,QACtC,WAAW,CAAC,UAAU,YAAY;AAAA,MACpC;AAAA,MACA,UAAU,EAAE,SAAS,OAAO,MAAM,EAAI;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA;AAAA,IAGA,SAAS;AAAA,MACP,SAAS;AAAA,MACT,UAAU;AAAA,MACV,QAAQ;AAAA,QACN,SAAS,CAAC,QAAQ,SAAS,SAAS,YAAY,UAAU;AAAA,QAC1D,SAAS,CAAC,eAAe,QAAQ;AAAA,QACjC,WAAW,CAAC,QAAQ,QAAQ;AAAA,MAC9B;AAAA,MACA,UAAU,EAAE,SAAS,OAAO,MAAM,EAAI;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA,IACA,UAAU;AAAA,MACR,SAAS;AAAA,MACT,UAAU;AAAA,MACV,QAAQ;AAAA,QACN,SAAS,CAAC,GAAG;AAAA,QACb,SAAS,CAAC,UAAU,UAAU,UAAU;AAAA,QACxC,WAAW,CAAC,OAAO;AAAA,MACrB;AAAA,MACA,UAAU,EAAE,SAAS,OAAO,MAAM,EAAI;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA,IACA,QAAQ;AAAA,MACN,SAAS;AAAA,MACT,UAAU;AAAA,MACV,QAAQ;AAAA,QACN,SAAS,CAAC,GAAG;AAAA,QACb,SAAS,CAAC,QAAQ,SAAS;AAAA,QAC3B,WAAW,CAAC,UAAU,SAAS;AAAA,MACjC;AAAA,MACA,UAAU,EAAE,SAAS,OAAO,MAAM,EAAI;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA,IACA,UAAU;AAAA,MACR,SAAS;AAAA,MACT,UAAU;AAAA,MACV,QAAQ;AAAA,QACN,SAAS,CAAC,QAAQ,UAAU,QAAQ,UAAU;AAAA,QAC9C,SAAS,CAAC,UAAU,eAAe;AAAA,QACnC,WAAW,CAAC,SAAS,OAAO;AAAA,MAC9B;AAAA,MACA,UAAU,EAAE,SAAS,OAAO,MAAM,EAAI;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA;AAAA,IAGA,UAAU;AAAA,MACR,SAAS;AAAA;AAAA,MACT,UAAU;AAAA,MACV,QAAQ,EAAE,SAAS,CAAC,GAAG,SAAS,CAAC,GAAG,GAAG,WAAW,CAAC,EAAE;AAAA,MACrD,UAAU,EAAE,SAAS,MAAM,MAAM,KAAK;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA,IACA,SAAS;AAAA,MACP,SAAS;AAAA,MACT,UAAU;AAAA,MACV,QAAQ,EAAE,SAAS,CAAC,GAAG,SAAS,CAAC,GAAG,GAAG,WAAW,CAAC,EAAE;AAAA,MACrD,UAAU,EAAE,SAAS,MAAM,MAAM,KAAK;AAAA,MACtC,OAAO;AAAA,MACP,UAAU;AAAA,MACV,UAAU;AAAA,IACZ;AAAA,EACF;AAAA,EACA,aAAa;AAAA,IACX,YAAY;AAAA;AAAA,IACZ,WAAW;AAAA,IACX,WAAW;AAAA,EACb;AAAA,EACA,UAAU;AAAA,IACR,iBAAiB;AAAA,IACjB,oBAAoB;AAAA,IACpB,aAAa;AAAA,IACb,gBAAgB;AAAA,EAClB;AACF;AAGO,SAAS,iBAA8B;AAC5C,QAAM,SAAS,EAAE,GAAG,mBAAmB;AAGvC,MAAI,QAAQ,IAAI,gBAAgB;AAC9B,UAAM,kBAAkB,QAAQ,IAAI,eAAe,MAAM,GAAG;AAC5D,WAAO,KAAK,OAAO,QAAQ,EAAE,QAAQ,YAAU;AAC7C,aAAO,SAAS,MAAM,EAAE,UAAU,gBAAgB,SAAS,MAAM;AAAA,IACnE,CAAC;AAAA,EACH;AAEA,MAAI,QAAQ,IAAI,qBAAqB;AACnC,UAAM,eAAe,WAAW,QAAQ,IAAI,mBAAmB;AAC/D,WAAO,KAAK,OAAO,QAAQ,EAAE,QAAQ,YAAU;AAC7C,aAAO,SAAS,MAAM,EAAE,SAAS,OAAO;AAAA,IAC1C,CAAC;AAAA,EACH;AAEA,SAAO;AACT;AAGO,SAAS,gBAAgB,YAAoB,QAAyB;AAC3E,QAAM,SAAS,eAAe;AAE9B,UAAQ,IAAI,oCAA6B;AAAA,IACvC;AAAA,IACA;AAAA,IACA,eAAe,OAAO,OAAO;AAAA,IAC7B,cAAc,OAAO,SAAS,UAAU;AAAA,EAC1C,CAAC;AAED,MAAI,CAAC,OAAO,OAAO,SAAS;AAC1B,YAAQ,IAAI,yCAAoC;AAChD,WAAO;AAAA,EACT;AAEA,QAAM,eAAe,OAAO,SAAS,UAAU;AAC/C,MAAI,CAAC,gBAAgB,CAAC,aAAa,SAAS;AAC1C,YAAQ,IAAI,6CAAwC,UAAU;AAC9D,WAAO;AAAA,EACT;AAGA,UAAQ,aAAa,UAAU;AAAA,IAC7B,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO,CAAC,UAAU,UAAU,QAAQ,EAAE,SAAS,MAAM;AAAA,IACvD,KAAK;AACH,aAAO,CAAC,UAAU,QAAQ,EAAE,SAAS,MAAM;AAAA,IAC7C,KAAK;AACH,aAAO,CAAC,UAAU,SAAS,QAAQ,EAAE,SAAS,MAAM;AAAA,IACtD;AACE,aAAO;AAAA,EACX;AACF;AAGO,SAAS,eAAe,YAAoB,WAA4B;AAC7E,QAAM,SAAS,eAAe;AAC9B,QAAM,eAAe,OAAO,SAAS,UAAU;AAE/C,MAAI,CAAC;AAAc,WAAO;AAE1B,QAAM,EAAE,SAAS,QAAQ,IAAI,aAAa;AAG1C,MAAI,QAAQ,SAAS,GAAG,KAAK,QAAQ,SAAS,SAAS;AAAG,WAAO;AAGjE,MAAI,QAAQ,SAAS,GAAG;AAAG,WAAO;AAClC,MAAI,QAAQ,SAAS,SAAS;AAAG,WAAO;AAExC,SAAO;AACT;AAGO,SAAS,aAAa,YAA6B;AACxD,QAAM,SAAS,eAAe;AAC9B,QAAM,eAAe,OAAO,SAAS,UAAU;AAE/C,MAAI,CAAC,gBAAgB,CAAC,aAAa,SAAS;AAAS,WAAO;AAE5D,SAAO,KAAK,OAAO,IAAI,aAAa,SAAS;AAC/C;AAGO,SAAS,qBAAqB,YAA8C;AACjF,QAAM,SAAS,eAAe;AAC9B,SAAO,OAAO,SAAS,UAAU,KAAK;AACxC;AAGO,SAAS,mBAAmB,YAAoB,WAAmB,OAAiB;AACzF,QAAM,SAAS,eAAe;AAC9B,QAAM,eAAe,OAAO,SAAS,UAAU;AAE/C,MAAI,CAAC;AAAc,WAAO;AAE1B,MAAI,aAAa,OAAO,UAAU,SAAS,SAAS,GAAG;AACrD,QAAI,OAAO,UAAU,YAAY,MAAM,SAAS,GAAG;AACjD,aAAO,MAAM,UAAU,GAAG,CAAC,IAAI,IAAI,OAAO,MAAM,SAAS,CAAC,IAAI,MAAM,UAAU,MAAM,SAAS,CAAC;AAAA,IAChG;AACA,WAAO;AAAA,EACT;AAEA,SAAO;AACT;AAGO,IAAM,0BAAN,MAA8B;AAAA,EAA9B;AACL,SAAQ,UAAU;AAAA,MAChB,WAAW;AAAA,MACX,YAAY;AAAA,MACZ,WAAW;AAAA,MACX,aAAa;AAAA,MACb,SAAS;AAAA,IACX;AAAA;AAAA,EAEA,aAA2B;AACzB,UAAM,QAAQ,KAAK,IAAI;AACvB,WAAO,MAAM;AACX,YAAM,WAAW,KAAK,IAAI,IAAI;AAC9B,WAAK,cAAc,QAAQ;AAC3B,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EAEQ,cAAc,UAAkB;AACtC,SAAK,QAAQ;AACb,SAAK,QAAQ,aAAa;AAC1B,SAAK,QAAQ,cAAc,KAAK,QAAQ,YAAY,KAAK,QAAQ;AACjE,SAAK,QAAQ,UAAU,KAAK,IAAI,KAAK,QAAQ,SAAS,QAAQ;AAAA,EAChE;AAAA,EAEA,gBAAgB;AACd,SAAK,QAAQ;AAAA,EACf;AAAA,EAEA,aAAa;AACX,WAAO;AAAA,MACL,GAAG,KAAK;AAAA,MACR,aAAa,KAAK,QAAQ,aAAa,KAAK,QAAQ;AAAA,MACpD,aAAa;AAAA,QACX,aAAa,KAAK,QAAQ;AAAA,QAC1B,SAAS,KAAK,QAAQ;AAAA,QACtB,WAAW,KAAK,QAAQ,cAAc;AAAA;AAAA,MACxC;AAAA,IACF;AAAA,EACF;AAAA,EAEA,QAAQ;AACN,SAAK,UAAU;AAAA,MACb,WAAW;AAAA,MACX,YAAY;AAAA,MACZ,WAAW;AAAA,MACX,aAAa;AAAA,MACb,SAAS;AAAA,IACX;AAAA,EACF;AACF;AAGO,IAAM,0BAA0B,IAAI,wBAAwB;;;AC1U5D,IAAM,cAAN,MAAkB;AAAA,EAIvB,YAAYd,SAAsB;AAChC,SAAK,SAASA;AACd,SAAK,cAAc,IAAI,YAAYA,OAAM;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAU,QASb;AAED,QAAI,CAAC,gBAAgB,OAAO,YAAY,QAAQ,GAAG;AACjD;AAAA,IACF;AAGA,QAAI,aAAa,OAAO,UAAU,GAAG;AACnC;AAAA,IACF;AAEA,UAAM,QAAQ,wBAAwB,WAAW;AAEjD,QAAI;AAEF,YAAM,kBAAkB,KAAK,eAAe,OAAO,YAAY,OAAO,SAAS;AAG/E,YAAM,eAAe,qBAAqB,OAAO,UAAU;AAE3D,YAAM,KAAK,YAAY,IAAI;AAAA,QACzB,QAAQ;AAAA,QACR,YAAY,OAAO;AAAA,QACnB,UAAU,OAAO;AAAA,QACjB,YAAY,OAAO;AAAA,QACnB,WAAW;AAAA,QACX,UAAU,OAAO,YAAY,cAAc,YAAY;AAAA,QACvD,UAAU,OAAO,YAAY,cAAc,YAAY;AAAA,QACvD,aAAa,OAAO,eAAe,GAAG,OAAO,UAAU;AAAA,QACvD,SAAS,KAAK,iBAAiB,OAAO,OAAO;AAAA,MAC/C,CAAC;AAAA,IACH,SAAS,OAAO;AACd,cAAQ,MAAM,+BAA+B,KAAK;AAClD,8BAAwB,cAAc;AAAA,IACxC,UAAE;AACA,YAAM;AAAA,IACR;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAU,QAWb;AACD,YAAQ,IAAI,8CAAuC;AAAA,MACjD,YAAY,OAAO;AAAA,MACnB,UAAU,OAAO;AAAA,MACjB,WAAW,gBAAgB,OAAO,YAAY,QAAQ;AAAA,MACtD,cAAc,aAAa,OAAO,UAAU;AAAA,IAC9C,CAAC;AAGD,QAAI,CAAC,gBAAgB,OAAO,YAAY,QAAQ,GAAG;AACjD,cAAQ,IAAI,iEAA4D;AACxE;AAAA,IACF;AAGA,QAAI,aAAa,OAAO,UAAU,GAAG;AACnC,cAAQ,IAAI,gDAA2C;AACvD;AAAA,IACF;AAEA,UAAM,QAAQ,wBAAwB,WAAW;AAEjD,QAAI;AAEF,YAAM,UAAU,OAAO,WAAW,KAAK,iBAAiB,OAAO,WAAW,OAAO,SAAS;AAG1F,YAAM,qBAAqB,KAAK,yBAAyB,OAAO,YAAY,OAAO;AAEnF,UAAI,OAAO,KAAK,kBAAkB,EAAE,SAAS,GAAG;AAE9C,cAAM,qBAAqB,KAAK,eAAe,OAAO,YAAY,OAAO,SAAS;AAClF,cAAM,qBAAqB,KAAK,eAAe,OAAO,YAAY,OAAO,SAAS;AAGlF,cAAM,eAAe,qBAAqB,OAAO,UAAU;AAE3D,cAAM,KAAK,YAAY,IAAI;AAAA,UACzB,QAAQ;AAAA,UACR,YAAY,OAAO;AAAA,UACnB,UAAU,OAAO;AAAA,UACjB,YAAY,OAAO;AAAA,UACnB,WAAW;AAAA,UACX,WAAW;AAAA,UACX,SAAS;AAAA,UACT,UAAU,OAAO,YAAY,cAAc,YAAY;AAAA,UACvD,UAAU,OAAO,YAAY,cAAc,YAAY;AAAA,UACvD,aAAa,OAAO,eAAe,GAAG,OAAO,UAAU;AAAA,UACvD,SAAS,KAAK,iBAAiB,OAAO,OAAO;AAAA,QAC/C,CAAC;AAAA,MACH;AAAA,IACF,SAAS,OAAO;AACd,cAAQ,MAAM,+BAA+B,KAAK;AAClD,8BAAwB,cAAc;AAAA,IACxC,UAAE;AACA,YAAM;AAAA,IACR;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAU,QASb;AACD,QAAI;AACF,YAAM,KAAK,YAAY,IAAI;AAAA,QACzB,QAAQ;AAAA,QACR,YAAY,OAAO;AAAA,QACnB,UAAU,OAAO;AAAA,QACjB,YAAY,OAAO;AAAA,QACnB,WAAW,OAAO;AAAA,QAClB,UAAU,OAAO,YAAY;AAAA,QAC7B,UAAU,OAAO,YAAY;AAAA,QAC7B,aAAa,OAAO,eAAe,GAAG,OAAO,UAAU;AAAA,QACvD,SAAS,KAAK,iBAAiB,OAAO,OAAO;AAAA,MAC/C,CAAC;AAAA,IACH,SAAS,OAAO;AACd,cAAQ,MAAM,+BAA+B,KAAK;AAAA,IACpD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAU,QAUb;AACD,QAAI;AACF,YAAM,KAAK,YAAY,IAAI;AAAA,QACzB,QAAQ,OAAO;AAAA;AAAA,QACf,YAAY,OAAO;AAAA,QACnB,UAAU,OAAO;AAAA,QACjB,YAAY,OAAO;AAAA,QACnB,aAAa,OAAO;AAAA,QACpB,UAAU,OAAO,YAAY;AAAA,QAC7B,UAAU,OAAO,YAAY;AAAA,QAC7B,SAAS;AAAA,UACP,GAAG,KAAK,iBAAiB,OAAO,OAAO;AAAA,UACvC,UAAU;AAAA,YACR,GAAG,OAAO,QAAQ;AAAA,YAClB,GAAG,OAAO;AAAA,UACZ;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH,SAAS,OAAO;AACd,cAAQ,MAAM,+BAA+B,KAAK;AAAA,IACpD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,iBAAiB,WAAgC,WAAwE;AAC/H,UAAM,UAAkD,CAAC;AAGzD,eAAW,OAAO,WAAW;AAC3B,UAAI,QAAQ,QAAQ,QAAQ,eAAe,QAAQ;AAAa;AAEhE,UAAI,UAAU,GAAG,MAAM,UAAU,GAAG,GAAG;AACrC,gBAAQ,GAAG,IAAI;AAAA,UACb,KAAK,UAAU,GAAG;AAAA,UAClB,KAAK,UAAU,GAAG;AAAA,QACpB;AAAA,MACF;AAAA,IACF;AAGA,eAAW,OAAO,WAAW;AAC3B,UAAI,QAAQ,QAAQ,QAAQ,eAAe,QAAQ;AAAa;AAEhE,UAAI,EAAE,OAAO,YAAY;AACvB,gBAAQ,GAAG,IAAI;AAAA,UACb,KAAK,UAAU,GAAG;AAAA,UAClB,KAAK;AAAA,QACP;AAAA,MACF;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKQ,eAAe,YAAoB,QAAkD;AAC3F,UAAM,YAAiC,CAAC;AAExC,eAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,MAAM,GAAG;AACjD,UAAI,eAAe,YAAY,GAAG,GAAG;AACnC,kBAAU,GAAG,IAAI,mBAAmB,YAAY,KAAK,KAAK;AAAA,MAC5D;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKQ,yBAAyB,YAAoB,SAAyF;AAC5I,UAAM,cAAsD,CAAC;AAG7D,UAAM,oBAAoB,CAAC,QAAQ,SAAS,SAAS,UAAU,QAAQ,UAAU,OAAO;AAGxF,UAAM,uBAAuB,CAAC,aAAa,eAAe,aAAa,aAAa;AAEpF,eAAW,CAAC,OAAO,MAAM,KAAK,OAAO,QAAQ,OAAO,GAAG;AAErD,UAAI,CAAC,eAAe,YAAY,KAAK;AAAG;AAGxC,UAAI,kBAAkB,SAAS,KAAK,GAAG;AACrC,oBAAY,KAAK,IAAI;AACrB;AAAA,MACF;AAGA,UAAI,qBAAqB,SAAS,KAAK;AAAG;AAG1C,kBAAY,KAAK,IAAI;AAAA,IACvB;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKQ,iBAAiB,SAA2C;AAClE,WAAO;AAAA,MACL,QAAQ,QAAQ,SAAS,SAAS,QAAQ,MAAM,IAAI;AAAA,MACpD,WAAW,QAAQ;AAAA,MACnB,UAAU,QAAQ;AAAA,MAClB,YAAY,QAAQ,aAAa,SAAS,QAAQ,UAAU,IAAI;AAAA,MAChE,UAAU,QAAQ,WAAW,SAAS,QAAQ,QAAQ,IAAI;AAAA,MAC1D,WAAW,QAAQ;AAAA,MACnB,WAAW,QAAQ;AAAA,MACnB,WAAW,QAAQ;AAAA,MACnB,WAAW,QAAQ;AAAA,MACnB,UAAU,QAAQ;AAAA,IACpB;AAAA,EACF;AACF;AAKO,SAAS,kBAAkBA,SAAmC;AACnE,SAAO,IAAI,YAAYA,OAAM;AAC/B;AAKA,eAAsB,cACpBA,SACA,WACA,YACA,UACA,SACA,SAQA;AACA,QAAM,cAAc,IAAI,YAAYA,OAAM;AAE1C,UAAQ,WAAW;AAAA,IACjB,KAAK;AACH,YAAM,YAAY,UAAU;AAAA,QAC1B;AAAA,QACA;AAAA,QACA,YAAY,SAAS;AAAA,QACrB,WAAW,SAAS,aAAa,CAAC;AAAA,QAClC,aAAa,SAAS;AAAA,QACtB;AAAA,QACA,UAAU,SAAS;AAAA,QACnB,UAAU,SAAS;AAAA,MACrB,CAAC;AACD;AAAA,IAEF,KAAK;AACH,YAAM,YAAY,UAAU;AAAA,QAC1B;AAAA,QACA;AAAA,QACA,YAAY,SAAS;AAAA,QACrB,WAAW,SAAS,aAAa,CAAC;AAAA,QAClC,WAAW,SAAS,aAAa,CAAC;AAAA,QAClC,aAAa,SAAS;AAAA,QACtB;AAAA,QACA,UAAU,SAAS;AAAA,QACnB,UAAU,SAAS;AAAA,MACrB,CAAC;AACD;AAAA,IAEF,KAAK;AACH,YAAM,YAAY,UAAU;AAAA,QAC1B;AAAA,QACA;AAAA,QACA,YAAY,SAAS;AAAA,QACrB,WAAW,SAAS,aAAa,CAAC;AAAA,QAClC,aAAa,SAAS;AAAA,QACtB;AAAA,QACA,UAAU,SAAS;AAAA,QACnB,UAAU,SAAS;AAAA,MACrB,CAAC;AACD;AAAA,EACJ;AACF;;;AC9YA;AAaO,IAAM,UAAU;AAAA;AAAA;AAAA;AAAA,EAIrB,MAAM,MAAM,aAAmE;AAC7E,QAAI;AACF,YAAM,WAAW,MAAM,YAAY,QAAQ,KAAK,OAAO;AAAA,QACrD,QAAQ;AAAA,QACR,MAAM,KAAK,UAAU,WAAW;AAAA,MAClC,CAAC;AACD,aAAO,MAAM,iBAA+B,QAAQ;AAAA,IACtD,SAAS,OAAO;AACd,cAAQ,MAAM,gBAAgB,KAAK;AACnC,YAAM,IAAI,MAAM,iBAAiB;AAAA,IACnC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAS,UAA4D;AACzE,UAAM,WAAW,MAAM,YAAY,QAAQ,KAAK,UAAU;AAAA,MACxD,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAA0C;AAC9C,UAAM,WAAW,MAAM,mBAAmB,QAAQ,KAAK,MAAM;AAC7D,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAwD;AAC5D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,KAAK,OAAO;AAC9D,WAAO,MAAM,iBAAoC,QAAQ;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAqC;AACzC,UAAM,WAAW,MAAM,mBAAmB,QAAQ,KAAK,QAAQ;AAAA,MAC7D,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,OAA2C;AACpE,UAAM,WAAW,MAAM,MAAM,QAAQ,KAAK,gBAAgB;AAAA,MACxD,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,MAAM,CAAC;AAAA,IAChC,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,OAAe,aAAiD;AAClF,UAAM,WAAW,MAAM,MAAM,QAAQ,KAAK,eAAe;AAAA,MACvD,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,OAAO,YAAY,CAAC;AAAA,IAC7C,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,iBAAyB,aAAiD;AAC7F,UAAM,WAAW,MAAM,mBAAmB,QAAQ,KAAK,gBAAgB;AAAA,MACrE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,iBAAiB,YAAY,CAAC;AAAA,IACvD,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AACF;;;ACnGA;AAiBO,IAAM,cAAc;AAAA;AAAA;AAAA;AAAA,EAIzB,MAAM,cAA+C;AACnD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,IAAI;AAC/D,UAAM,SAAS,MAAM,iBAA4B,QAAQ;AACzD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,OAAe,GAAG,QAAgB,IAA4C;AACvG,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,SAAS,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AACzF,WAAO,MAAM,iBAAmC,QAAQ;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,SAA0D;AAC7E,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAQ,aAAO,OAAO,KAAK,QAAQ,MAAM;AACrD,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ,cAAc;AAAW,aAAO,OAAO,aAAa,QAAQ,UAAU,SAAS,CAAC;AAC5F,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAG3E,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AAErE,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,KAAK,SAAS,CAAC;AAG/D,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AAEnE,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,SAAS,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AACzF,WAAO,MAAM,iBAA4B,QAAQ;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAuB,YAAoB,SAA0D;AACzG,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ,cAAc;AAAW,aAAO,OAAO,aAAa,QAAQ,UAAU,SAAS,CAAC;AAC5F,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAG3E,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AAErE,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,KAAK,SAAS,CAAC;AAE/D,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,SAAS,KAAK,UAAU,CAAC,IAAI,OAAO,SAAS,CAAC,EAAE;AAC/G,WAAO,MAAM,iBAA4B,QAAQ;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,WAA2D;AAC1E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,OAAO,SAAS,CAAC;AAC5E,WAAO,MAAM,iBAAmC,QAAQ;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,WAA2D;AAC9E,WAAO,KAAK,WAAW,SAAS;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,aAAgE;AAClF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,QAAQ;AAAA,MACjE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,WAAW;AAAA,IAClC,CAAC;AACD,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,WAAmB,aAAgE;AACrG,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,OAAO,SAAS,GAAG;AAAA,MAC5E,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,WAAW;AAAA,IAClC,CAAC;AACD,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,WAA+C;AACjE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,OAAO,SAAS,GAAG;AAAA,MAC5E,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAAsB,YAAqD;AAC/E,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,SAAS,IAAI,eAAe,UAAU,EAAE;AAC7F,WAAO,MAAM,iBAA4B,QAAQ;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,UAAmD;AAC3E,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,SAAS,IAAI,aAAa,QAAQ,EAAE;AACzF,WAAO,MAAM,iBAA4B,QAAQ;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,WAAmB,OAA8C;AACxF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,YAAY,SAAS,GAAG;AAAA,MACjF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,MAAM,CAAC;AAAA,IAChC,CAAC;AACD,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,SAAoG;AAC3H,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,YAAY;AAAA,MACrE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,QAAQ,CAAC;AAAA,IAClC,CAAC;AACD,WAAO,MAAM,iBAA4B,QAAQ;AAAA,EACnD;AACF;;;AC1KA;AAiCO,IAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQ1B,MAAM,eAA6C;AACjD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,IAAI;AAChE,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAAsB,OAAe,GAAG,QAAgB,IAAwD;AACpH,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,MACtB,IAAI,KAAK,IAAI,EAAE,SAAS;AAAA;AAAA,IAC1B,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AAC1F,UAAM,SAAS,MAAM,iBAAuC,QAAQ;AACpE,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,wBACJ,UAA2B,CAAC,GAC5B,OAAO,GACP,QAAQ,IAC4C;AACpD,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ,aAAa;AAAW,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AACzF,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,IAAI;AACpD,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,KAAK;AACvD,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAE1D,WAAO,OAAO,QAAQ,KAAK,SAAS,CAAC;AACrC,WAAO,OAAO,SAAS,MAAM,SAAS,CAAC;AAEvC,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AAC1F,UAAM,SAAS,MAAM,iBAAuC,QAAQ;AACpE,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,UAAgC,CAAC,GAAyD;AAC9G,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAG,aAAO,OAAO,KAAK,QAAQ,CAAC;AAC3C,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ,aAAa;AAAW,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AACzF,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,IAAI;AACpD,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,KAAK;AACvD,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAE1D,WAAO,OAAO,UAAU,QAAQ,SAAS,IAAI,SAAS,CAAC;AACvD,WAAO,OAAO,WAAW,QAAQ,UAAU,GAAG,SAAS,CAAC;AACxD,WAAO,OAAO,MAAM,KAAK,IAAI,EAAE,SAAS,CAAC;AAEzC,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AAC1F,UAAM,SAAS,MAAM,iBAAyC,QAAQ;AACtE,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,YAAkD;AACtE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,OAAO,UAAU,CAAC;AAC9E,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,cAA2D;AAC9E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,QAAQ;AAAA,MAClE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,YAAY;AAAA,IACnC,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,YAAoB,cAAiE;AACxG,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,IAAI,OAAO,UAAU,IAAI;AAAA,MACtF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,YAAY;AAAA,IACnC,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,YAAkD;AACrE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,OAAO,UAAU,GAAG;AAAA,MAC9E,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,oBAAoB,cAA2D;AACnF,UAAM,WAAW,MAAM,mBAAmB,uBAAuB;AAAA,MAC/D,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,YAAY;AAAA,IACnC,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,cAA2D;AACpF,UAAM,WAAW,MAAM,mBAAmB,wBAAwB;AAAA,MAChE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,YAAY;AAAA,IACnC,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,qBAAqB,MAA6D;AAChF,UAAM,SAAmB,CAAC;AAE1B,QAAI,CAAC,KAAK,WAAW,KAAK;AAAG,aAAO,KAAK,wBAAwB;AACjE,QAAI,CAAC,KAAK,UAAU,KAAK;AAAG,aAAO,KAAK,uBAAuB;AAC/D,QAAI,CAAC,KAAK,OAAO,KAAK;AAAG,aAAO,KAAK,mBAAmB;AACxD,QAAI,CAAC,KAAK,OAAO,KAAK;AAAG,aAAO,KAAK,mBAAmB;AACxD,QAAI,CAAC,KAAK;AAAY,aAAO,KAAK,yBAAyB;AAG3D,QAAI,KAAK,SAAS,CAAC,6BAA6B,KAAK,KAAK,KAAK,GAAG;AAChE,aAAO,KAAK,sBAAsB;AAAA,IACpC;AAGA,QAAI,KAAK,SAAS,CAAC,kBAAkB,KAAK,KAAK,KAAK,GAAG;AACrD,aAAO,KAAK,0CAA0C;AAAA,IACxD;AAEA,QAAI,KAAK,SAAS,KAAK,MAAM,SAAS,GAAG;AACvC,aAAO,KAAK,4CAA4C;AAAA,IAC1D;AAGA,QAAI,KAAK,UAAU,CAAC,CAAC,YAAY,mBAAmB,eAAe,OAAO,EAAE,SAAS,KAAK,MAAM,GAAG;AACjG,aAAO,KAAK,iBAAiB;AAAA,IAC/B;AAEA,WAAO;AAAA,MACL,SAAS,OAAO,WAAW;AAAA,MAC3B;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,mBAAmB,MAAoC;AACrD,WAAO;AAAA,MACL,GAAG;AAAA,MACH,WAAW,KAAK,WAAW,KAAK;AAAA,MAChC,UAAU,KAAK,UAAU,KAAK;AAAA,MAC9B,OAAO,KAAK,OAAO,YAAY,EAAE,KAAK;AAAA,MACtC,OAAO,KAAK,OAAO,KAAK;AAAA,MACxB,SAAS,KAAK,SAAS,KAAK;AAAA,MAC5B,MAAM,KAAK,MAAM,KAAK;AAAA,MACtB,OAAO,KAAK,OAAO,KAAK;AAAA,MACxB,SAAS,KAAK,SAAS,KAAK;AAAA,MAC5B,SAAS,KAAK,SAAS,KAAK;AAAA,MAC5B,UAAU,KAAK,UAAU,KAAK;AAAA,MAC9B,OAAO,KAAK,OAAO,KAAK;AAAA,IAC1B;AAAA,EACF;AACF;;;AClPA;AAiBO,IAAM,YAAY;AAAA;AAAA;AAAA;AAAA,EAIvB,MAAM,YAA2C;AAC/C,UAAM,WAAW,MAAM,mBAAmB,QAAQ,OAAO,IAAI;AAC7D,UAAM,SAAS,MAAM,iBAA0B,QAAQ;AACvD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,OAAe,GAAG,QAAgB,IAA0C;AACnG,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,OAAO,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AACvF,WAAO,MAAM,iBAAiC,QAAQ;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,SAA6D;AAC9E,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAQ,aAAO,OAAO,KAAK,QAAQ,MAAM;AACrD,QAAI,QAAQ,QAAQ;AAElB,UAAI,MAAM,QAAQ,QAAQ,MAAM,GAAG;AACjC,gBAAQ,OAAO,QAAQ,YAAU,OAAO,OAAO,UAAU,MAAM,CAAC;AAAA,MAClE,OAAO;AACL,eAAO,OAAO,UAAU,QAAQ,MAAM;AAAA,MACxC;AAAA,IACF;AACA,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,UAAU,SAAS,CAAC;AAG9E,QAAI,QAAQ,WAAW;AACrB,YAAM,YAAY,QAAQ,qBAAqB,OAAO,QAAQ,UAAU,YAAY,IAAI,QAAQ;AAChG,aAAO,OAAO,aAAa,SAAS;AAAA,IACtC;AACA,QAAI,QAAQ,SAAS;AACnB,YAAM,UAAU,QAAQ,mBAAmB,OAAO,QAAQ,QAAQ,YAAY,IAAI,QAAQ;AAC1F,aAAO,OAAO,WAAW,OAAO;AAAA,IAClC;AAEA,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AAGnE,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AACrE,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,KAAK,SAAS,CAAC;AAG/D,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AAEnE,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,OAAO,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AACvF,WAAO,MAAM,iBAAiC,QAAQ;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAS,SAA8C;AAC3D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,OAAO,OAAO,OAAO,CAAC;AACxE,WAAO,MAAM,iBAAwB,QAAQ;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAAiB,aAAkD;AACvE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,OAAO,YAAY,WAAW,CAAC;AACjF,WAAO,MAAM,iBAAwB,QAAQ;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,WAA0D;AAC1E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,OAAO,QAAQ;AAAA,MAC/D,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,SAAS;AAAA,IAChC,CAAC;AACD,WAAO,MAAM,iBAAwB,QAAQ;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,SAAiB,WAA0D;AAC3F,UAAM,WAAW,MAAM,mBAAmB,QAAQ,OAAO,OAAO,OAAO,GAAG;AAAA,MACxE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,SAAS;AAAA,IAChC,CAAC;AACD,WAAO,MAAM,iBAAwB,QAAQ;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,SAA6C;AAC7D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,OAAO,OAAO,OAAO,GAAG;AAAA,MACxE,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,YAAmD;AAC3E,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,OAAO,IAAI,eAAe,UAAU,EAAE;AAC3F,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,UAAiD;AACvE,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,OAAO,IAAI,aAAa,QAAQ,EAAE;AACvF,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,WAAkD;AACzE,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,OAAO,IAAI,cAAc,SAAS,EAAE;AACzF,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,SAAiB,QAA6C;AACpF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,OAAO,aAAa,OAAO,GAAG;AAAA,MAC9E,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,OAAO,CAAC;AAAA,IACjC,CAAC;AACD,WAAO,MAAM,iBAAwB,QAAQ;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,SAA8C;AAC9D,WAAO,KAAK,kBAAkB,SAAS,UAAU;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,SAA8C;AAC9D,WAAO,KAAK,kBAAkB,SAAS,UAAU;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,SAA8C;AAC9D,WAAO,KAAK,kBAAkB,SAAS,WAAW;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,SAAiB,UAMX;AAC9B,UAAM,WAAW,MAAM,mBAAmB,QAAQ,OAAO,OAAO,OAAO,GAAG;AAAA,MACxE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAAwB,QAAQ;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAA2C;AAC/C,UAAM,WAAW,MAAM,mBAAmB,QAAQ,OAAO,KAAK;AAC9D,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AACF;;;ACpNA;AAeO,IAAM,aAAa;AAAA;AAAA;AAAA;AAAA,EAIxB,MAAM,aAAoD;AACxD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,IAAI;AAC9D,UAAM,SAAS,MAAM,iBAAkC,QAAQ;AAC/D,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,OAAe,GAAG,QAAgB,IAA2C;AACrG,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,QAAQ,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AACxF,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAU,UAAgD;AAC9D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,IAAI,QAAQ,CAAC;AACvE,WAAO,MAAM,iBAAyB,QAAQ;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,YAA6D;AAC9E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,QAAQ;AAAA,MAChE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,UAAU;AAAA,IACjC,CAAC;AACD,WAAO,MAAM,iBAAyB,QAAQ;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,UAAkB,YAA6D;AAChG,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,OAAO,QAAQ,GAAG;AAAA,MAC1E,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,UAAU;AAAA,IACjC,CAAC;AACD,WAAO,MAAM,iBAAyB,QAAQ;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,UAA8C;AAC/D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,OAAO,QAAQ,GAAG;AAAA,MAC1E,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAAiB,QAAuD;AAC5E,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,QAAQ,IAAI,WAAW,MAAM,EAAE;AACpF,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,YAA2D;AACpF,YAAQ,IAAI,+EAAwE,UAAU;AAC9F,YAAQ,IAAI,0CAAmC,QAAQ,UAAU,QAAQ,KAAK,UAAU,CAAC;AAEzF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,QAAQ,KAAK,UAAU,CAAC;AACpF,YAAQ,IAAI,+CAAwC,QAAQ;AAE5D,UAAM,SAAS,MAAM,iBAAkC,QAAQ;AAC/D,YAAQ,IAAI,gDAAyC,MAAM;AAC3D,YAAQ,IAAI,iDAA0C,OAAO,OAAO;AACpE,QAAI,OAAO,SAAS;AAClB,cAAQ,IAAI,8CAAuC,OAAO,IAAI;AAC9D,cAAQ,IAAI,uDAAgD,OAAO,MAAM,SAAS,UAAU,CAAC;AAAA,IAC/F,OAAO;AACL,cAAQ,IAAI,wCAAiC,OAAO,OAAO;AAAA,IAC7D;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAA4C;AAChD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,KAAK;AAC/D,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AACF;;;ACpHA;AAsDO,IAAM,eAAe;AAAA;AAAA;AAAA;AAAA,EAI1B,MAAM,eAAwD;AAC5D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,IAAI;AAChE,UAAM,SAAS,MAAM,iBAAoC,QAAQ;AACjE,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAAsB,OAAe,GAAG,QAAgB,IAA6C;AACzG,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,IAAI,SAAS,IAAI,UAAU,KAAK,EAAE;AACjG,UAAM,SAAS,MAAM,iBAAoC,QAAQ;AACjE,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,SAAyE;AAC7F,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAG,aAAO,OAAO,KAAK,QAAQ,CAAC;AAC3C,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,IAAI;AACpD,QAAI,QAAQ,aAAa;AAAW,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AACzF,QAAI,QAAQ;AAAoB,aAAO,OAAO,sBAAsB,QAAQ,kBAAkB;AAC9F,QAAI,QAAQ,eAAe;AAAW,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AAC/F,QAAI,QAAQ,eAAe;AAAW,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AAC/F,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AAErE,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AAC1F,WAAO,MAAM,iBAAoC,QAAQ;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,IAA4C;AAChE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,IAAI,EAAE,CAAC;AACnE,UAAM,SAAS,MAAM,iBAA2B,QAAQ;AACxD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,kBAAkB,IAA4C;AAClE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,IAAI,EAAE,CAAC;AACnE,UAAM,SAAS,MAAM,iBAA2B,QAAQ;AACxD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,cAAiE;AACpF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,QAAQ;AAAA,MAClE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,YAAY;AAAA,IACnC,CAAC;AACD,UAAM,SAAS,MAAM,iBAA2B,QAAQ;AACxD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAS,MAa6C;AAC1D,UAAM,WAAW,MAAM,MAAM,QAAQ,UAAU,UAAU;AAAA,MACvD,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AACD,WAAO,MAAM,iBAAoD,QAAQ;AAAA,EAC3E;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,IAAY,cAAiE;AAChG,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,OAAO,EAAE,GAAG;AAAA,MACtE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,YAAY;AAAA,IACnC,CAAC;AACD,UAAM,SAAS,MAAM,iBAA2B,QAAQ;AACxD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,IAAwC;AAC3D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,OAAO,EAAE,GAAG;AAAA,MACtE,QAAQ;AAAA,IACV,CAAC;AACD,UAAM,SAAS,MAAM,iBAAuB,QAAQ;AACpD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAA8C;AAClD,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,IAAI,QAAQ;AAC3E,UAAM,SAAS,MAAM,iBAAsB,QAAQ;AACnD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,YAAoB,UASf;AAC5B,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,WAAW,UAAU,GAAG;AAAA,MAClF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,UAAM,SAAS,MAAM,iBAAsB,QAAQ;AACnD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAuB,YAA+C;AAC1E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,QAAQ,UAAU,CAAC;AAC/E,UAAM,SAAS,MAAM,iBAAsB,QAAQ;AACnD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,YAAoB,gBAAwB,QAA2C;AAC/G,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,WAAW,UAAU,GAAG;AAAA,MAClF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU;AAAA,QACnB,QAAQ;AAAA,QACR;AAAA,QACA;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AACD,UAAM,SAAS,MAAM,iBAAsB,QAAQ;AACnD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,YAAoB,gBAAwB,QAA2C;AAC9G,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,WAAW,UAAU,GAAG;AAAA,MAClF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU;AAAA,QACnB,QAAQ;AAAA,QACR;AAAA,QACA;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AACD,UAAM,SAAS,MAAM,iBAAsB,QAAQ;AACnD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,UAAU;AAAA,IACR,MAAM,OAAO,eAAuB;AAClC,aAAO,mBAAmB,QAAQ,UAAU,SAAS,KAAK,UAAU,CAAC;AAAA,IACvE;AAAA,IAEA,KAAK,OAAO,YAAoB,cAAsB;AACpD,aAAO,mBAAmB,QAAQ,UAAU,SAAS,IAAI,YAAY,SAAS,CAAC;AAAA,IACjF;AAAA,IAEA,QAAQ,OAAO,YAAoB,SAAc;AAC/C,aAAO,mBAAmB,QAAQ,UAAU,SAAS,OAAO,UAAU,GAAG;AAAA,QACvE,QAAQ;AAAA,QACR,MAAM,KAAK,UAAU,IAAI;AAAA,MAC3B,CAAC;AAAA,IACH;AAAA,IAEA,QAAQ,OAAO,YAAoB,WAAmB,SAAc;AAClE,aAAO,mBAAmB,QAAQ,UAAU,SAAS,OAAO,YAAY,SAAS,GAAG;AAAA,QAClF,QAAQ;AAAA,QACR,MAAM,KAAK,UAAU,IAAI;AAAA,MAC3B,CAAC;AAAA,IACH;AAAA,IAEA,QAAQ,OAAO,YAAoB,cAAsB;AACvD,aAAO,mBAAmB,QAAQ,UAAU,SAAS,OAAO,YAAY,SAAS,GAAG;AAAA,QAClF,QAAQ;AAAA,MACV,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ;AAAA,IACN,MAAM,OAAO,YAAoB,gBAAyB;AACxD,YAAM,MAAM,cACR,GAAG,QAAQ,UAAU,OAAO,KAAK,UAAU,CAAC,IAAI,WAAW,KAC3D,QAAQ,UAAU,OAAO,KAAK,UAAU;AAC5C,aAAO,mBAAmB,GAAG;AAAA,IAC/B;AAAA,IAEA,KAAK,OAAO,YAAoB,YAAoB;AAClD,aAAO,mBAAmB,QAAQ,UAAU,OAAO,IAAI,YAAY,OAAO,CAAC;AAAA,IAC7E;AAAA,IAEA,QAAQ,OAAO,YAAoB,SAAc;AAC/C,aAAO,mBAAmB,QAAQ,UAAU,OAAO,OAAO,UAAU,GAAG;AAAA,QACrE,QAAQ;AAAA,QACR,MAAM,KAAK,UAAU,IAAI;AAAA,MAC3B,CAAC;AAAA,IACH;AAAA,IAEA,QAAQ,OAAO,YAAoB,SAAiB,SAAc;AAChE,aAAO,mBAAmB,QAAQ,UAAU,OAAO,OAAO,YAAY,OAAO,GAAG;AAAA,QAC9E,QAAQ;AAAA,QACR,MAAM,KAAK,UAAU,IAAI;AAAA,MAC3B,CAAC;AAAA,IACH;AAAA,IAEA,QAAQ,OAAO,YAAoB,YAAoB;AACrD,aAAO,mBAAmB,QAAQ,UAAU,OAAO,OAAO,YAAY,OAAO,GAAG;AAAA,QAC9E,QAAQ;AAAA,MACV,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO;AAAA,IACL,MAAM,OAAO,eAAuB;AAClC,aAAO,mBAAmB,QAAQ,UAAU,MAAM,KAAK,UAAU,CAAC;AAAA,IACpE;AAAA,IAEA,KAAK,OAAO,YAAoB,WAAmB;AACjD,aAAO,mBAAmB,QAAQ,UAAU,MAAM,IAAI,YAAY,MAAM,CAAC;AAAA,IAC3E;AAAA,IAEA,QAAQ,OAAO,YAAoB,SAAc;AAC/C,aAAO,mBAAmB,QAAQ,UAAU,MAAM,OAAO,UAAU,GAAG;AAAA,QACpE,QAAQ;AAAA,QACR,MAAM,KAAK,UAAU,IAAI;AAAA,MAC3B,CAAC;AAAA,IACH;AAAA,IAEA,QAAQ,OAAO,YAAoB,QAAgB,SAAc;AAC/D,aAAO,mBAAmB,QAAQ,UAAU,MAAM,OAAO,YAAY,MAAM,GAAG;AAAA,QAC5E,QAAQ;AAAA,QACR,MAAM,KAAK,UAAU,IAAI;AAAA,MAC3B,CAAC;AAAA,IACH;AAAA,IAEA,QAAQ,OAAO,YAAoB,WAAmB;AACpD,aAAO,mBAAmB,QAAQ,UAAU,MAAM,OAAO,YAAY,MAAM,GAAG;AAAA,QAC5E,QAAQ;AAAA,MACV,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS;AAAA,IACP,MAAM,OAAO,YAAoB,gBAAyB;AACxD,YAAM,MAAM,cACR,GAAG,QAAQ,UAAU,QAAQ,KAAK,UAAU,CAAC,IAAI,WAAW,KAC5D,QAAQ,UAAU,QAAQ,KAAK,UAAU;AAC7C,aAAO,mBAAmB,GAAG;AAAA,IAC/B;AAAA,IAEA,KAAK,OAAO,YAAoB,aAAqB;AACnD,aAAO,mBAAmB,QAAQ,UAAU,QAAQ,IAAI,YAAY,QAAQ,CAAC;AAAA,IAC/E;AAAA,IAEA,QAAQ,OAAO,YAAoB,SAAc;AAC/C,aAAO,mBAAmB,QAAQ,UAAU,QAAQ,OAAO,UAAU,GAAG;AAAA,QACtE,QAAQ;AAAA,QACR,MAAM,KAAK,UAAU,IAAI;AAAA,MAC3B,CAAC;AAAA,IACH;AAAA,IAEA,QAAQ,OAAO,YAAoB,UAAkB,SAAc;AACjE,aAAO,mBAAmB,QAAQ,UAAU,QAAQ,OAAO,YAAY,QAAQ,GAAG;AAAA,QAChF,QAAQ;AAAA,QACR,MAAM,KAAK,UAAU,IAAI;AAAA,MAC3B,CAAC;AAAA,IACH;AAAA,IAEA,QAAQ,OAAO,YAAoB,aAAqB;AACtD,aAAO,mBAAmB,QAAQ,UAAU,QAAQ,OAAO,YAAY,QAAQ,GAAG;AAAA,QAChF,QAAQ;AAAA,MACV,CAAC;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAAiB,YAAkI;AACvJ,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,QAAQ,IAAI,UAAU,CAAC;AACnF,UAAM,SAAS,MAAM,iBAAyG,QAAQ;AACtI,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,YAAoB,QAAwC;AACpF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,QAAQ,OAAO,UAAU,GAAG;AAAA,MACtF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,MAAM;AAAA,IAC7B,CAAC;AACD,UAAM,SAAS,MAAM,iBAAsB,QAAQ;AACnD,WAAO;AAAA,EACT;AACF;;;ACxZA;AAuCO,IAAM,eAAe;AAAA;AAAA;AAAA;AAAA,EAI1B,MAAM,oBAAoB,SAAgE;AACxF,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAE7D,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,OAAO,IAAI,OAAO,SAAS,CAAC,EAAE;AAC7F,WAAO,MAAM,iBAAgC,QAAQ;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,SAAsD;AAC5E,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAE7D,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,MAAM,IAAI,OAAO,SAAS,CAAC,EAAE;AAC5F,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,SAAqE;AAC7F,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AAEjF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,WAAW,IAAI,OAAO,SAAS,CAAC,EAAE;AACjG,WAAO,MAAM,iBAAqC,QAAQ;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,SAAsE;AAC/F,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AAEjF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,YAAY,IAAI,OAAO,SAAS,CAAC,EAAE;AAClG,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAAsB,SAAsD;AAChF,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AAEjF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,SAAS,IAAI,OAAO,SAAS,CAAC,EAAE;AAC/F,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAAiD;AACrD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,SAAS;AACrE,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,SAAuD;AAC9E,UAAM,SAAS,IAAI,gBAAgB;AACnC,QAAI,SAAS;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACpE,QAAI,SAAS;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC9D,QAAI,SAAS;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC9D,WAAO,OAAO,KAAK,KAAK,IAAI,EAAE,SAAS,CAAC;AAExC,UAAM,MAAM,GAAG,QAAQ,UAAU,MAAM,IAAI,OAAO,SAAS,CAAC;AAC5D,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,OAAgB,QAA4C;AACpF,UAAM,SAAS,IAAI,gBAAgB;AACnC,QAAI;AAAO,aAAO,OAAO,SAAS,MAAM,SAAS,CAAC;AAClD,QAAI;AAAQ,aAAO,OAAO,UAAU,OAAO,SAAS,CAAC;AACrD,WAAO,OAAO,KAAK,KAAK,IAAI,EAAE,SAAS,CAAC;AAExC,UAAM,MAAM,GAAG,QAAQ,UAAU,gBAAgB,IAAI,OAAO,SAAS,CAAC;AACtE,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,UAA4B,CAAC,GAA8B;AAClF,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAE7D,UAAM,cAAc,OAAO,SAAS;AACpC,UAAM,MAAM,cAAc,GAAG,QAAQ,UAAU,MAAM,IAAI,WAAW,KAAK,QAAQ,UAAU;AAE3F,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,2BAAsD;AAC1D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,UAAU,MAAM;AAClE,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,SAAuD;AAC1E,UAAM,SAAS,IAAI,gBAAgB;AACnC,QAAI,SAAS;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACpE,QAAI,SAAS;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAE9D,UAAM,MAAM,GAAG,QAAQ,UAAU,WAAW,GAAG,OAAO,SAAS,IAAI,IAAI,OAAO,SAAS,CAAC,KAAK,EAAE;AAC/F,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,SAAuD;AAC3E,UAAM,SAAS,IAAI,gBAAgB;AACnC,QAAI,SAAS;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACpE,QAAI,SAAS;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAE9D,UAAM,MAAM,GAAG,QAAQ,UAAU,YAAY,GAAG,OAAO,SAAS,IAAI,IAAI,OAAO,SAAS,CAAC,KAAK,EAAE;AAChG,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,SAAuD;AAC3E,UAAM,SAAS,IAAI,gBAAgB;AACnC,QAAI,SAAS;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACpE,QAAI,SAAS;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAE9D,UAAM,MAAM,GAAG,QAAQ,UAAU,YAAY,GAAG,OAAO,SAAS,IAAI,IAAI,OAAO,SAAS,CAAC,KAAK,EAAE;AAChG,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,SAAsD;AAC/E,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AAEjF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,iBAAiB,IAAI,OAAO,SAAS,CAAC,EAAE;AACvG,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,SAAsD;AAC5E,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AAEjF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,cAAc,IAAI,OAAO,SAAS,CAAC,EAAE;AACpG,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,SAA2BS,UAA0B,OAAkC;AAC3G,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACnE,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC7D,WAAO,OAAO,UAAUA,OAAM;AAE9B,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,UAAU,MAAM,IAAI,OAAO,SAAS,CAAC,EAAE;AAC5F,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAKF;AAEF,UAAM,MAAM,GAAG,QAAQ,UAAU,YAAY,MAAM,KAAK,IAAI,CAAC;AAC7D,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAAiB,SAInB;AACF,UAAM,SAAS,IAAI,gBAAgB;AACnC,QAAI,SAAS;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACpE,QAAI,SAAS;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC9D,WAAO,OAAO,KAAK,KAAK,IAAI,EAAE,SAAS,CAAC;AAExC,UAAM,MAAM,GAAG,QAAQ,UAAU,aAAa,IAAI,OAAO,SAAS,CAAC;AACnE,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,4BAA4B,SAY9B;AACF,UAAM,SAAS,IAAI,gBAAgB;AACnC,QAAI,SAAS;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AACpE,QAAI,SAAS;AAAS,aAAO,OAAO,WAAW,QAAQ,OAAO;AAC9D,WAAO,OAAO,KAAK,KAAK,IAAI,EAAE,SAAS,CAAC;AAExC,UAAM,MAAM,GAAG,QAAQ,UAAU,iBAAiB,IAAI,OAAO,SAAS,CAAC;AACvE,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AACF;;;ACpUA;AAWO,IAAM,gBAAgB;AAAA;AAAA;AAAA;AAAA,EAI3B,MAAM,gBAAkD;AACtD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,WAAW,IAAI;AACjE,UAAM,SAAS,MAAM,iBAA6B,QAAQ;AAC1D,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAuB,OAAe,GAAG,QAAgB,IAA8C;AAC3G,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,WAAW,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AAC3F,WAAO,MAAM,iBAAqC,QAAQ;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,cAAiE;AACpF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,WAAW,QAAQ;AAAA,MACnE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,YAAY;AAAA,IACnC,CAAC;AACD,WAAO,MAAM,iBAA2B,QAAQ;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,YAAoB,cAAiE;AACxG,UAAM,WAAW,MAAM,mBAAmB,QAAQ,WAAW,OAAO,UAAU,GAAG;AAAA,MAC/E,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,YAAY;AAAA,IACnC,CAAC;AACD,WAAO,MAAM,iBAA2B,QAAQ;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,YAA+C;AAClE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,WAAW,OAAO,UAAU,GAAG;AAAA,MAC/E,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AACF;;;ACjEA;AAgCO,IAAM,mBAAmB;AAAA;AAAA;AAAA;AAAA,EAI9B,MAAM,mBAAyD;AAC7D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,IAAI;AACpE,UAAM,SAAS,MAAM,iBAAiC,QAAQ;AAC9D,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,0BAA0B,OAAe,GAAG,QAAgB,IAAiD;AACjH,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AAC9F,WAAO,MAAM,iBAAwC,QAAQ;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,SAAoE;AAC5F,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,IAAI;AACpD,QAAI,QAAQ,WAAW;AAAW,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AACnF,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,KAAK,SAAS,CAAC;AAC/D,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAElE,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AAC9F,WAAO,MAAM,iBAAiC,QAAQ;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,gBAA4D;AAChF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,IAAI,cAAc,CAAC;AACnF,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,gBAAmE;AAClF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,SAAS,cAAc,GAAG;AAAA,MACxF,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,gBAAmE;AACpF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,WAAW,cAAc,GAAG;AAAA,MAC1F,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAA2D;AAC/D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,aAAa;AAAA,MAC3E,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,gBAAmE;AAC1F,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,OAAO,cAAc,GAAG;AAAA,MACtF,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAA2D;AAC/D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,eAAe;AAAA,MAC7E,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAA0D;AAC9D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,WAAW;AAC3E,WAAO,MAAM,iBAAoC,QAAQ;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAA4C;AAChD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,WAAW;AAC3E,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,aAA6C;AACnE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,aAAa;AAAA,MAC3E,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,WAAW;AAAA,IAClC,CAAC;AACD,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAkE;AACtE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,MAAM;AAAA,MACpE,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AACF;;;ACpKA;AAOO,IAAM,aAAa;AAAA;AAAA;AAAA;AAAA,EAIxB,MAAM,aAAyC;AAC7C,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,IAAI;AAC/D,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,aAA6D;AAC/E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,MAAM;AAAA,MAC/D,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,WAAW;AAAA,IAClC,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,cAIyB;AAC5C,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,gBAAgB;AAAA,MACzE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,YAAY;AAAA,IACnC,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,MAAwD;AACjF,UAAM,WAAW,IAAI,SAAS;AAC9B,aAAS,OAAO,kBAAkB,IAAI;AAEtC,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,eAAe;AAAA,MACxE,QAAQ;AAAA,MACR,MAAM;AAAA;AAAA,IAER,CAAC;AACD,WAAO,MAAM,iBAAuC,QAAQ;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAkE;AACtE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,eAAe;AAAA,MACxE,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAA4C;AAChD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,WAAW;AACtE,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,aAA6C;AACnE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,aAAa;AAAA,MACtE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,WAAW;AAAA,IAClC,CAAC;AACD,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,OAAe,GAAG,QAAgB,IAA+B;AACpF,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,SAAS,WAAW,IAAI,OAAO,SAAS,CAAC,EAAE;AAChG,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAAiB,OAAe,GAAG,QAAgB,IAA+B;AACtF,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,SAAS,oBAAoB,IAAI,OAAO,SAAS,CAAC,EAAE;AACzG,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAuB,gBAAmE;AAC9F,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,qBAAqB,cAAc,GAAG;AAAA,MAC/F,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,6BAAwE;AAC5E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,0BAA0B;AAAA,MACnF,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AACF;;;AClIA;AAiBO,IAAM,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQtB,MAAM,SAAS,UAAe,CAAC,GAAG,UAAe,CAAC,GAA6B;AAC7E,UAAM,SAAS,IAAI,gBAAgB;AAGnC,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,IAAI;AACpD,QAAI,QAAQ,aAAa;AAAW,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AACzF,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAG3E,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,KAAK,SAAS,CAAC;AAC/D,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AAEnE,UAAM,cAAc,OAAO,SAAS;AACpC,UAAM,MAAM,cAAc,GAAG,QAAQ,MAAM,IAAI,IAAI,WAAW,KAAK,QAAQ,MAAM;AAEjF,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,OAAe,GAAG,QAAgB,IAA8B;AACtF,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,MAAM,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AACtF,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,UAAe,CAAC,GAA6B;AAC7D,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAM,aAAO,OAAO,QAAQ,QAAQ,IAAI;AACpD,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAU,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AAC3E,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AAErE,UAAM,cAAc,OAAO,SAAS;AACpC,UAAM,MAAM,cAAc,GAAG,QAAQ,MAAM,IAAI,IAAI,WAAW,KAAK,QAAQ,MAAM;AAEjF,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,QAA0C;AAC1D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,OAAO,MAAM,CAAC;AACtE,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,UAAqD;AACpE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,QAAQ;AAAA,MAC9D,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,QAAgB,UAAmD;AAClF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,OAAO,MAAM,GAAG;AAAA,MACtE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,QAA0C;AACzD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,OAAO,MAAM,GAAG;AAAA,MACtE,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,qBAAqB,QAAgB,UAAmD;AAC5F,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,iBAAiB,MAAM,GAAG;AAAA,MAChF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAuB,QAA0C;AACrE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,mBAAmB,MAAM,GAAG;AAAA,MAClF,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,yBAAyB,QAA0C;AACvE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,qBAAqB,MAAM,GAAG;AAAA,MACpF,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,QAA0C;AAC3D,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,MAAM,OAAO,MAAM,CAAC,aAAa;AAAA,MACpF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,UAAU,KAAK,CAAC;AAAA,IACzC,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,QAA0C;AAC7D,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,MAAM,OAAO,MAAM,CAAC,eAAe;AAAA,MACtF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,UAAU,MAAM,CAAC;AAAA,IAC1C,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,QAAgB,aAA+C;AAClF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,MAAM,OAAO,MAAM,CAAC,oBAAoB;AAAA,MAC3F,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,YAAY,CAAC;AAAA,IACtC,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AACF;;;AC3LA;AAMA,IAAMM,eAAc,OAAO,KAAa,UAAuB,CAAC,MAAyB;AACvF,QAAM,UAAkC;AAAA,IACtC,gBAAgB;AAAA,IAChB,UAAU;AAAA,IACV,GAAI,QAAQ;AAAA,EACd;AAEA,QAAM,iBAA8B;AAAA,IAClC,QAAQ;AAAA,IACR;AAAA,IACA,GAAG;AAAA,EACL;AAEA,SAAO,MAAM,MAAM,KAAK,cAAc;AACxC;AAmBO,IAAM,WAAW;AAAA;AAAA;AAAA;AAAA,EAItB,MAAM,SAAS,UAAuD,CAAC,GAAwC;AAC7G,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ,aAAa;AAAW,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AACzF,QAAI,QAAQ,cAAc;AAAW,aAAO,OAAO,aAAa,QAAQ,UAAU,SAAS,CAAC;AAC5F,QAAI,QAAQ;AAAiB,aAAO,OAAO,mBAAmB,MAAM;AACpE,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AACrE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AAEnE,UAAM,cAAc,OAAO,SAAS;AACpC,UAAM,MAAM,cAAc,GAAG,QAAQ,MAAM,IAAI,IAAI,WAAW,KAAK,QAAQ,MAAM;AAEjF,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAgC,QAAQ;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,QAA4C;AAC5D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,IAAI,MAAM,CAAC;AACnE,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,UAAuD;AACtE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,QAAQ;AAAA,MAC9D,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,QAAgB,UAAuD;AACtF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,OAAO,MAAM,GAAG;AAAA,MACtE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAAuB,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,QAA2C;AAC1D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,OAAO,MAAM,GAAG;AAAA,MACtE,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAgD;AACpD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,KAAK;AAC7D,WAAO,MAAM,iBAA4B,QAAQ;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAA+C;AACnD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,MAAM,MAAM;AAC9D,WAAO,MAAM,iBAAyB,QAAQ;AAAA,EAChD;AACF;AAKO,IAAM,iBAAiB;AAAA;AAAA;AAAA;AAAA,EAI5B,MAAM,6BAA2D;AAC/D,UAAM,WAAW,MAAMA,aAAY,QAAQ,MAAM,MAAM;AACvD,WAAO,MAAM,iBAAyB,QAAQ;AAAA,EAChD;AACF;;;AClIA;AAyDO,IAAM,mBAAmB;AAAA;AAAA;AAAA;AAAA,EAI9B,MAAM,iBAAiB,UAA+B,CAAC,GAAgD;AACrG,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ,aAAa;AAAW,aAAO,OAAO,YAAY,QAAQ,SAAS,SAAS,CAAC;AACzF,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AACrE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AAEnE,UAAM,cAAc,OAAO,SAAS;AACpC,UAAM,MAAM,cAAc,GAAG,QAAQ,cAAc,IAAI,IAAI,WAAW,KAAK,QAAQ,cAAc;AAEjG,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAwC,QAAQ;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,IAAgD;AACpE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,IAAI,EAAE,CAAC;AACvE,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,OAAoE;AAC3F,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,QAAQ;AAAA,MACtE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,KAAK;AAAA,IAC5B,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,IAAY,OAAoE;AACvG,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,OAAO,EAAE,GAAG;AAAA,MAC1E,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,KAAK;AAAA,IAC5B,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,IAAuC;AAC9D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,OAAO,EAAE,GAAG;AAAA,MAC1E,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,yBAAsE;AAC1E,UAAM,WAAW,MAAM,KAAK,iBAAiB;AAAA,MAC3C,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,WAAW;AAAA,IACb,CAAC;AAED,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAuB,OAAmD;AAC9E,UAAM,WAAW,MAAM,KAAK,iBAAiB;AAAA,MAC3C,QAAQ;AAAA,MACR,UAAU;AAAA,IACZ,CAAC;AAED,QAAI,CAAC,SAAS,WAAW,CAAC,SAAS,MAAM;AACvC,YAAM,IAAI,MAAM,gCAAgC;AAAA,IAClD;AAEA,UAAM,QAAQ,SAAS,KAAK,cAAc,KAAK,CAAC,MAAW,EAAE,UAAU,KAAK;AAE5E,QAAI,CAAC,OAAO;AACV,YAAM,IAAI,MAAM,6BAA6B,KAAK,aAAa;AAAA,IACjE;AAEA,WAAO;AAAA,MACL,SAAS;AAAA,MACT,MAAM;AAAA,MACN,SAAS;AAAA,IACX;AAAA,EACF;AACF;;;AChKA;AAwBO,IAAM,cAAc;AAAA;AAAA;AAAA;AAAA,EAIzB,MAAM,YAAY,UAA0B,CAAC,GAA2C;AACtF,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AACrE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAW,aAAO,OAAO,aAAa,QAAQ,SAAS;AAEnE,UAAM,cAAc,OAAO,SAAS;AACpC,UAAM,MAAM,cAAc,GAAG,QAAQ,SAAS,IAAI,IAAI,WAAW,KAAK,QAAQ,SAAS;AAEvF,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAAmC,QAAQ;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,IAA2C;AAC1D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,IAAI,EAAE,CAAC;AAClE,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,OAAoD;AACtE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,QAAQ;AAAA,MACjE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,KAAK;AAAA,IAC5B,CAAC;AACD,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,IAAY,OAA0D;AACxF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,OAAO,EAAE,GAAG;AAAA,MACrE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,KAAK;AAAA,IAC5B,CAAC;AACD,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,oBAAoB,OAAsE;AAC9F,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,QAAQ;AAAA,MACjE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,KAAK;AAAA,IAC5B,CAAC;AACD,WAAO,MAAM,iBAAgC,QAAQ;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,IAAuC;AACzD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,OAAO,EAAE,GAAG;AAAA,MACrE,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,IAA2C;AAC9D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,QAAQ,EAAE,GAAG;AAAA,MACtE,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,IAAY,QAAgD;AAC9E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,OAAO,EAAE,GAAG;AAAA,MACrE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,OAAO,CAAC;AAAA,IACjC,CAAC;AACD,WAAO,MAAM,iBAA0B,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAA6C;AACjD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,KAAK;AAChE,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,UAA0B,CAAC,GAAkD;AAChG,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAE1D,UAAM,cAAc,OAAO,SAAS;AACpC,UAAM,MAAM,cAAc,GAAG,QAAQ,SAAS,MAAM,IAAI,WAAW,KAAK,QAAQ,SAAS;AAEzF,UAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,WAAO,MAAM,iBAA0C,QAAQ;AAAA,EACjE;AAEF;;;ACxIA;AAkFA,eAAsB,aAAa,SAAyB,CAAC,GAAqC;AAChG,QAAM,SAAS,IAAI,gBAAgB;AAEnC,SAAO,QAAQ,MAAM,EAAE,QAAQ,CAAC,CAAC,KAAK,KAAK,MAAM;AAC/C,QAAI,UAAU,UAAa,UAAU,IAAI;AACvC,aAAO,OAAO,KAAK,MAAM,SAAS,CAAC;AAAA,IACrC;AAAA,EACF,CAAC;AAED,QAAM,cAAc,OAAO,SAAS;AACpC,QAAM,MAAM,cAAc,GAAG,QAAQ,UAAU,IAAI,IAAI,WAAW,KAAK,QAAQ,UAAU;AAEzF,QAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,SAAO,MAAM,iBAA6B,QAAQ;AACpD;AAKA,eAAsB,iBAAiB,SAAkC,CAAC,GAAwC;AAChH,QAAM,SAAS,IAAI,gBAAgB;AAEnC,SAAO,QAAQ,MAAM,EAAE,QAAQ,CAAC,CAAC,KAAK,KAAK,MAAM;AAC/C,QAAI,UAAU,UAAa,UAAU,IAAI;AACvC,aAAO,OAAO,KAAK,MAAM,SAAS,CAAC;AAAA,IACrC;AAAA,EACF,CAAC;AAED,QAAM,cAAc,OAAO,SAAS;AACpC,QAAM,MAAM,cAAc,GAAG,QAAQ,UAAU,KAAK,IAAI,WAAW,KAAK,QAAQ,UAAU;AAE1F,QAAM,WAAW,MAAM,mBAAmB,GAAG;AAC7C,SAAO,MAAM,iBAAgC,QAAQ;AACvD;AAKA,eAAsB,gBAAgB,SAAyB,CAAC,GAAkB;AAChF,QAAM,SAAS,IAAI,gBAAgB;AAEnC,SAAO,QAAQ,MAAM,EAAE,QAAQ,CAAC,CAAC,KAAK,KAAK,MAAM;AAC/C,QAAI,UAAU,UAAa,UAAU,IAAI;AACvC,aAAO,OAAO,KAAK,MAAM,SAAS,CAAC;AAAA,IACrC;AAAA,EACF,CAAC;AAED,QAAM,cAAc,OAAO,SAAS;AACpC,QAAM,MAAM,cAAc,GAAG,QAAQ,UAAU,MAAM,IAAI,WAAW,KAAK,QAAQ,UAAU;AAE3F,QAAM,WAAW,MAAM,mBAAmB,KAAK;AAAA,IAC7C,SAAS;AAAA,MACP,UAAU;AAAA,IACZ;AAAA,EACF,CAAC;AAED,MAAI,CAAC,SAAS,IAAI;AAChB,UAAM,YAAY,MAAM,SAAS,KAAK;AACtC,UAAM,IAAI,MAAM,kBAAkB,SAAS,EAAE;AAAA,EAC/C;AAEA,SAAO,SAAS,KAAK;AACvB;;;ACvJA;AAwDO,IAAM,cAAc;AAAA;AAAA;AAAA;AAAA,EAIzB,MAAM,uBAAuB,MAAmD;AAC9E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,UAAU;AAAA,MACnE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AAED,UAAM,SAAS,MAAM,iBAAsB,QAAQ;AACnD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,MAAmD;AAC1E,WAAO,KAAK,uBAAuB,IAAI;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAAoD;AACxD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,IAAI;AAC/D,UAAM,SAAS,MAAM,iBAA8B,QAAQ;AAC3D,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,MAAsD;AAC5E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,MAAM;AAAA,MAC/D,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AACD,UAAM,SAAS,MAAM,iBAA8B,QAAQ;AAC3D,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAAiB,MAAiD;AACtE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,QAAQ;AAAA,MACjE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AACD,UAAM,SAAS,MAAM,iBAAsB,QAAQ;AACnD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAA4D;AAChE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,OAAO;AAClE,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAAsB,MAA8D;AACxF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,SAAS,SAAS;AAAA,MAClE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AACD,WAAO,MAAM,iBAAkC,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAA+D;AACnE,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,SAAS,OAAO,YAAY;AACjF,WAAO,MAAM,iBAAoC,QAAQ;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAuB,WAAuE;AAClG,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,SAAS,OAAO,cAAc;AAAA,MACjF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,UAAU,CAAC;AAAA,IACpC,CAAC;AACD,WAAO,MAAM,iBAAoC,QAAQ;AAAA,EAC3D;AACF;;;ACnJA;AAaO,IAAM,mBAAmB;AAAA;AAAA;AAAA;AAAA,EAI9B,MAAM,mBAAyD;AAC7D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,IAAI;AACpE,UAAM,SAAS,MAAM,iBAAiC,QAAQ;AAC9D,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,0BAA0B,OAAe,GAAG,QAAgB,IAAiD;AACjH,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AAC9F,WAAO,MAAM,iBAAwC,QAAQ;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,UAA+B,CAAC,GAAyC;AACpF,UAAM,SAAS,IAAI,gBAAgB;AAEnC,QAAI,QAAQ;AAAY,aAAO,OAAO,cAAc,QAAQ,WAAW,SAAS,CAAC;AACjF,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AACrE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,MAAM;AAC1D,QAAI,QAAQ,WAAW;AACrB,YAAM,YAAY,QAAQ,qBAAqB,OAAO,QAAQ,UAAU,YAAY,IAAI,QAAQ;AAChG,aAAO,OAAO,aAAa,SAAS;AAAA,IACtC;AACA,QAAI,QAAQ,SAAS;AACnB,YAAM,UAAU,QAAQ,mBAAmB,OAAO,QAAQ,QAAQ,YAAY,IAAI,QAAQ;AAC1F,aAAO,OAAO,WAAW,OAAO;AAAA,IAClC;AACA,QAAI,QAAQ;AAAO,aAAO,OAAO,SAAS,QAAQ,MAAM,SAAS,CAAC;AAClE,QAAI,QAAQ;AAAQ,aAAO,OAAO,UAAU,QAAQ,OAAO,SAAS,CAAC;AAErE,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,IAAI,IAAI,OAAO,SAAS,CAAC,EAAE;AAC9F,WAAO,MAAM,iBAAiC,QAAQ;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,QAAQ,IAAgD;AAC5D,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,IAAI,EAAE,CAAC;AACvE,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,MAAmE;AAC9E,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,QAAQ;AAAA,MACtE,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,IAAY,MAAmE;AAC1F,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,OAAO,EAAE,GAAG;AAAA,MAC1E,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,IAAY,QAAoD;AAC3E,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,OAAO,EAAE,CAAC,WAAW;AAAA,MACtF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,OAAO,CAAC;AAAA,IACjC,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,IAAY,WAAuD;AAClF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,OAAO,EAAE,CAAC,gBAAgB;AAAA,MAC3F,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,UAAU,CAAC;AAAA,IACpC,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,IAAY,MAKc;AACrC,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,OAAO,EAAE,GAAG;AAAA,MAC1E,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,mCAqDF;AACF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,MAAM;AACtE,WAAO,MAAM,iBAAiB,QAAQ;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAAsB,YAQxB;AACF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,MAAM,eAAe,UAAU,EAAE;AACpG,WAAO,MAAM,iBAAiB,QAAQ;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,2BAA2B,YAA0D;AACzF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,IAAI,eAAe,UAAU,EAAE;AAClG,WAAO,MAAM,iBAAiC,QAAQ;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAkD;AACtD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,cAAc,KAAK;AACrE,WAAO,MAAM,iBAAsB,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,QAAQ,IAAY,OAA4B,CAAC,GAAuC;AAC5F,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,IAAI,EAAE,CAAC,UAAU;AAAA,MAClF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,IAAY,OAA4B,CAAC,GAAuC;AAC3F,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,IAAI,EAAE,CAAC,WAAW;AAAA,MACnF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B,CAAC;AACD,WAAO,MAAM,iBAA+B,QAAQ;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,IAAY,QAAgB,IAAiC;AAC/E,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,IAAI,EAAE,CAAC,qBAAqB,KAAK,EAAE;AACtG,WAAO,MAAM,iBAAwB,QAAQ;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,IAAY,QAAgB,IAAiC;AAC7E,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,cAAc,IAAI,EAAE,CAAC,mBAAmB,KAAK,EAAE;AACpG,WAAO,MAAM,iBAAwB,QAAQ;AAAA,EAC/C;AACF;;;ACnQA;AAsDO,IAAM,YAAY;AAAA;AAAA;AAAA;AAAA,EAIvB,MAAM,aAA8D;AAClE,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,UAAU,oBAAoB;AACxF,WAAO,MAAM,iBAA4C,QAAQ;AAAA,EACnE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,OAA+B,QAAoD;AACpG,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,UAAU,sBAAsB;AAAA,MACxF,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,KAAK,CAAC;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAAuC,QAAQ;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,UAAqC;AACxD,WAAO,MAAM,mBAAmB,GAAG,QAAQ,QAAQ,UAAU,oBAAoB,IAAI,QAAQ,WAAW;AAAA,EAC1G;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,UAA6D;AAC9E,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,QAAQ,UAAU,oBAAoB,IAAI,QAAQ,IAAI;AAAA,MACzG,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAA4E;AAChF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,kBAAkB,6BAA6B;AACzG,WAAO,MAAM,iBAAkD,QAAQ;AAAA,EACzE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,UAAoF;AAC7G,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,kBAAkB,+BAA+B;AAAA,MACzG,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAAyC,QAAQ;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,YAAoB,UAA8E;AAC3H,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,QAAQ,kBAAkB,6BAA6B,IAAI,UAAU,IAAI;AAAA,MAC5H,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,QAAQ;AAAA,IAC/B,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,YAA+D;AACxF,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,QAAQ,kBAAkB,6BAA6B,IAAI,UAAU,IAAI;AAAA,MAC5H,QAAQ;AAAA,IACV,CAAC;AACD,WAAO,MAAM,iBAAsC,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,UAA4D;AAC7E,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,QAAQ,gBAAgB,2BAA2B,IAAI;AAAA,MAC1G,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,EAAE,SAAS,CAAC;AAAA,IACnC,CAAC;AACD,WAAO,MAAM,iBAAqC,QAAQ;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBAAoD;AACxD,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,SAAS,mBAAmB;AACtF,WAAO,MAAM,iBAA8B,QAAQ;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAQF;AACF,UAAM,WAAW,MAAM,mBAAmB,QAAQ,QAAQ,UAAU,oBAAoB;AACxF,WAAO,MAAM,iBAQV,QAAQ;AAAA,EACb;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,OAAe,GAAG,QAAgB,IAAI,OAWtD;AACF,UAAM,SAAS,IAAI,gBAAgB;AAAA,MACjC,MAAM,KAAK,SAAS;AAAA,MACpB,OAAO,MAAM,SAAS;AAAA,IACxB,CAAC;AACD,QAAI;AAAO,aAAO,OAAO,SAAS,KAAK;AAEvC,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,QAAQ,QAAQ,kBAAkB,IAAI,OAAO,SAAS,CAAC,EAAE;AAC9G,WAAO,MAAM,iBAWV,QAAQ;AAAA,EACb;AACF;;;ACjNA;AAiEO,IAAM,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOzB,MAAM,kBAAkB,OAAoD;AAC1E,UAAM,eAAe,IAAI,gBAAgB;AAAA,MACvC,OAAO,MAAM,MAAM,SAAS;AAAA,MAC5B,MAAM,MAAM,KAAK,SAAS;AAAA,MAC1B,GAAI,MAAM,YAAY,EAAE,UAAU,MAAM,SAAS,SAAS,EAAE;AAAA,MAC5D,GAAI,MAAM,SAAS,EAAE,OAAO,MAAM,MAAM,SAAS,EAAE;AAAA,IACrD,CAAC;AAED,UAAM,WAAW,MAAM,mBAAmB,GAAG,QAAQ,SAAS,MAAM,IAAI,YAAY,EAAE;AACtF,UAAM,SAAS,MAAM,iBAAsC,QAAQ;AAGnE,QAAI,OAAO,WAAW,OAAO,MAAM;AACjC,aAAO,OAAO;AAAA,IAChB;AAGA,WAAO;AAAA,MACL,SAAS,OAAO;AAAA,MAChB,MAAM,CAAC;AAAA,MACP,MAAM;AAAA,QACJ,OAAO,MAAM;AAAA,QACb,MAAM,MAAM;AAAA,QACZ,WAAW;AAAA,QACX,OAAO,EAAE,cAAc,GAAG,aAAa,EAAE;AAAA,QACzC,WAAW,EAAE,OAAO,IAAI,KAAK,GAAG;AAAA,MAClC;AAAA,MACA,SAAS,OAAO,WAAW;AAAA,IAC7B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAAsB,UAAiD;AAC3E,UAAM,MAAM,oBAAI,KAAK;AACrB,WAAO,KAAK,kBAAkB;AAAA,MAC5B,OAAO,IAAI,SAAS,IAAI;AAAA;AAAA,MACxB,MAAM,IAAI,YAAY;AAAA,MACtB;AAAA,MACA,OAAO;AAAA,IACT,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,mBAAmB,UAAiD;AACxE,UAAM,MAAM,oBAAI,KAAK;AACrB,UAAM,YAAY,IAAI,KAAK,IAAI,YAAY,GAAG,IAAI,SAAS,IAAI,GAAG,CAAC;AACnE,WAAO,KAAK,kBAAkB;AAAA,MAC5B,OAAO,UAAU,SAAS,IAAI;AAAA,MAC9B,MAAM,UAAU,YAAY;AAAA,MAC5B;AAAA,MACA,OAAO;AAAA,IACT,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,uBAAuB,UAAiD;AAC5E,UAAM,MAAM,oBAAI,KAAK;AACrB,UAAM,YAAY,IAAI,KAAK,IAAI,YAAY,GAAG,IAAI,SAAS,IAAI,GAAG,CAAC;AACnE,WAAO,KAAK,kBAAkB;AAAA,MAC5B,OAAO,UAAU,SAAS,IAAI;AAAA,MAC9B,MAAM,UAAU,YAAY;AAAA,MAC5B;AAAA,MACA,OAAO;AAAA,IACT,CAAC;AAAA,EACH;AACF;;;AC1FA,IAAM,wBAAwB,IAAI,OAAO;AACzC,IAAM,wBAAwB,CAAC,cAAc,aAAa,aAAa,cAAc,WAAW;AAChG,IAAM,yBAAyB,IAAI,OAAO;AAC1C,IAAM,gBAAgB;AAef,SAAS,cAAc,MAAY,UAAyB,CAAC,GAA0B;AAC5F,QAAM;AAAA,IACJ,cAAc;AAAA,IACd,eAAe;AAAA,EACjB,IAAI;AAEJ,QAAM,WAAqB,CAAC;AAC5B,MAAI;AAGJ,MAAI,CAAC,aAAa,SAAS,KAAK,IAAI,GAAG;AACrC,YAAQ,sBAAsB,KAAK,IAAI,qBAAqB,aAAa,KAAK,IAAI,CAAC;AACnF,WAAO,EAAE,SAAS,OAAO,MAAM;AAAA,EACjC;AAGA,MAAI,KAAK,OAAO,aAAa;AAC3B,YAAQ,eAAe,KAAK,OAAO,OAAO,MAAM,QAAQ,CAAC,CAAC,wCAAwC,cAAc,OAAO,MAAM,QAAQ,CAAC,CAAC;AACvI,WAAO,EAAE,SAAS,OAAO,MAAM;AAAA,EACjC;AAGA,MAAI,KAAK,OAAO,eAAe;AAC7B,YAAQ;AACR,WAAO,EAAE,SAAS,OAAO,MAAM;AAAA,EACjC;AAGA,MAAI,KAAK,OAAO,wBAAwB;AACtC,aAAS,KAAK,qBAAqB,KAAK,OAAO,OAAO,MAAM,QAAQ,CAAC,CAAC,iEAAiE;AAAA,EACzI;AAEA,SAAO;AAAA,IACL,SAAS;AAAA,IACT,UAAU,SAAS,SAAS,IAAI,WAAW;AAAA,EAC7C;AACF;AASO,SAAS,mBAAmB,MAAsC;AACvE,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,UAAM,MAAM,IAAI,MAAM;AACtB,UAAM,MAAM,IAAI,gBAAgB,IAAI;AAEpC,QAAI,SAAS,MAAM;AACjB,UAAI,gBAAgB,GAAG;AACvB,cAAQ;AAAA,QACN,OAAO,IAAI;AAAA,QACX,QAAQ,IAAI;AAAA,MACd,CAAC;AAAA,IACH;AAEA,QAAI,UAAU,MAAM;AAClB,UAAI,gBAAgB,GAAG;AACvB,aAAO,IAAI,MAAM,sBAAsB,CAAC;AAAA,IAC1C;AAEA,QAAI,MAAM;AAAA,EACZ,CAAC;AACH;AAWA,eAAsB,YACpB,MACA,WAAmB,MACnB,YAAoB,KACpB,UAAkB,MACH;AACf,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,UAAM,MAAM,IAAI,MAAM;AACtB,UAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,UAAM,MAAM,OAAO,WAAW,IAAI;AAElC,QAAI,CAAC,KAAK;AACR,aAAO,IAAI,MAAM,sBAAsB,CAAC;AACxC;AAAA,IACF;AAEA,QAAI,SAAS,MAAM;AACjB,UAAI,EAAE,OAAO,OAAO,IAAI;AAGxB,UAAI,QAAQ,YAAY,SAAS,WAAW;AAC1C,cAAM,QAAQ,KAAK,IAAI,WAAW,OAAO,YAAY,MAAM;AAC3D,gBAAQ,KAAK,MAAM,QAAQ,KAAK;AAChC,iBAAS,KAAK,MAAM,SAAS,KAAK;AAAA,MACpC;AAEA,aAAO,QAAQ;AACf,aAAO,SAAS;AAGhB,UAAI,UAAU,KAAK,GAAG,GAAG,OAAO,MAAM;AAGtC,aAAO;AAAA,QACL,CAAC,SAAS;AACR,cAAI,CAAC,MAAM;AACT,mBAAO,IAAI,MAAM,uBAAuB,CAAC;AACzC;AAAA,UACF;AAGA,gBAAM,cAAc,IAAI,KAAK,CAAC,IAAI,GAAG,KAAK,MAAM;AAAA,YAC9C,MAAM,KAAK;AAAA,YACX,cAAc,KAAK,IAAI;AAAA,UACzB,CAAC;AAED,kBAAQ,WAAW;AAAA,QACrB;AAAA,QACA,KAAK;AAAA,QACL;AAAA,MACF;AAAA,IACF;AAEA,QAAI,UAAU,MAAM;AAClB,aAAO,IAAI,MAAM,sBAAsB,CAAC;AAAA,IAC1C;AAEA,QAAI,MAAM,IAAI,gBAAgB,IAAI;AAAA,EACpC,CAAC;AACH;AAKO,SAAS,aAAa,MAA6B;AACxD,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,UAAM,SAAS,IAAI,WAAW;AAE9B,WAAO,SAAS,MAAM;AACpB,cAAQ,OAAO,MAAgB;AAAA,IACjC;AAEA,WAAO,UAAU,MAAM;AACrB,aAAO,IAAI,MAAM,qBAAqB,CAAC;AAAA,IACzC;AAEA,WAAO,cAAc,IAAI;AAAA,EAC3B,CAAC;AACH;AAeA,SAAS,mBACP,KACA,UACA,OACA,YACyB;AACzB,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,UAAM,MAAM,IAAI,eAAe;AAG/B,QAAI,OAAO,iBAAiB,YAAY,CAAC,MAAM;AAC7C,UAAI,EAAE,oBAAoB,YAAY;AACpC,mBAAW;AAAA,UACT,QAAQ,EAAE;AAAA,UACV,OAAO,EAAE;AAAA,UACT,YAAY,KAAK,MAAO,EAAE,SAAS,EAAE,QAAS,GAAG;AAAA,UACjD,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF,CAAC;AAGD,QAAI,iBAAiB,QAAQ,MAAM;AACjC,UAAI,IAAI,UAAU,OAAO,IAAI,SAAS,KAAK;AACzC,YAAI;AACF,gBAAM,SAAS,KAAK,MAAM,IAAI,YAAY;AAE1C,cAAI,YAAY;AACd,uBAAW;AAAA,cACT,QAAQ;AAAA,cACR,OAAO;AAAA,cACP,YAAY;AAAA,cACZ,OAAO;AAAA,YACT,CAAC;AAAA,UACH;AAEA,kBAAQ,MAAM;AAAA,QAChB,SAAS,OAAO;AACd,iBAAO,IAAI,MAAM,8BAA8B,CAAC;AAAA,QAClD;AAAA,MACF,OAAO;AACL,YAAI;AACF,gBAAM,QAAQ,KAAK,MAAM,IAAI,YAAY;AACzC,iBAAO,IAAI,MAAM,MAAM,WAAW,eAAe,CAAC;AAAA,QACpD,QAAQ;AACN,iBAAO,IAAI,MAAM,6BAA6B,IAAI,MAAM,EAAE,CAAC;AAAA,QAC7D;AAAA,MACF;AAAA,IACF,CAAC;AAGD,QAAI,iBAAiB,SAAS,MAAM;AAClC,aAAO,IAAI,MAAM,wBAAwB,CAAC;AAAA,IAC5C,CAAC;AAGD,QAAI,iBAAiB,WAAW,MAAM;AACpC,aAAO,IAAI,MAAM,gBAAgB,CAAC;AAAA,IACpC,CAAC;AAGD,QAAI,KAAK,QAAQ,GAAG;AACpB,QAAI,iBAAiB,iBAAiB,UAAU,KAAK,EAAE;AACvD,QAAI,UAAU;AAGd,QAAI,YAAY;AACd,iBAAW;AAAA,QACT,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,YAAY;AAAA,QACZ,OAAO;AAAA,MACT,CAAC;AAAA,IACH;AAEA,QAAI,KAAK,QAAQ;AAAA,EACnB,CAAC;AACH;AAeA,eAAsB,YACpB,MACA,OACA,UAAyB,CAAC,GACD;AACzB,QAAM;AAAA,IACJ;AAAA,IACA,cAAc;AAAA,IACd,eAAe;AAAA,IACf,SAAS;AAAA,IACT,oBAAoB;AAAA,IACpB,UAAU;AAAA,IACV;AAAA,IACA;AAAA,EACF,IAAI;AAEJ,MAAI;AAEF,QAAI,YAAY;AACd,iBAAW,EAAE,QAAQ,GAAG,OAAO,KAAK,YAAY,GAAG,OAAO,YAAY,CAAC;AAAA,IACzE;AAEA,UAAM,aAAa,cAAc,MAAM,EAAE,aAAa,aAAa,CAAC;AACpE,QAAI,CAAC,WAAW,SAAS;AACvB,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO,WAAW,SAAS;AAAA,MAC7B;AAAA,IACF;AAGA,QAAI,WAAW,YAAY,WAAW,SAAS,SAAS,GAAG;AACzD,cAAQ,KAAK,0BAA0B,WAAW,QAAQ;AAAA,IAC5D;AAGA,QAAI,eAAe;AACnB,QAAI,YAAY,WAAW;AACzB,UAAI;AACF,cAAM,aAAa,MAAM,mBAAmB,IAAI;AAChD,YAAI,WAAW,QAAQ,YAAY,WAAW,SAAS,WAAW;AAChE,kBAAQ,IAAI,uBAAuB,WAAW,KAAK,IAAI,WAAW,MAAM,WAAW,QAAQ,IAAI,SAAS,EAAE;AAC1G,yBAAe,MAAM,YAAY,MAAM,UAAU,WAAW,OAAO;AACnE,kBAAQ,IAAI,qCAAqC,KAAK,OAAO,MAAM,QAAQ,CAAC,CAAC,UAAU,aAAa,OAAO,MAAM,QAAQ,CAAC,CAAC,IAAI;AAAA,QACjI;AAAA,MACF,SAAS,aAAa;AACpB,gBAAQ,KAAK,kDAAkD,WAAW;AAAA,MAE5E;AAAA,IACF;AAGA,UAAM,WAAW,IAAI,SAAS;AAC9B,aAAS,OAAO,SAAS,YAAY;AACrC,aAAS,OAAO,UAAU,MAAM;AAChC,aAAS,OAAO,aAAa,kBAAkB,SAAS,CAAC;AAEzD,UAAM,SAAS,QAAQ,IAAI,uBAAuB;AAClD,UAAM,YAAY,GAAG,MAAM;AAE3B,UAAM,SAAS,MAAM,mBAAmB,WAAW,UAAU,OAAO,UAAU;AAE9E,WAAO;AAAA,EAET,SAAS,OAAO;AACd,YAAQ,MAAM,iBAAiB,KAAK;AAGpC,QAAI,mBAAmB;AACrB,UAAI;AACF,gBAAQ,IAAI,8CAA8C;AAC1D,cAAM,SAAS,MAAM,aAAa,IAAI;AAEtC,eAAO;AAAA,UACL,SAAS;AAAA,UACT,MAAM;AAAA,YACJ,KAAK;AAAA,YACL,UAAU,UAAU,KAAK,IAAI,CAAC;AAAA,YAC9B,OAAO;AAAA,YACP,QAAQ;AAAA,YACR,QAAQ,KAAK,KAAK,MAAM,GAAG,EAAE,CAAC,KAAK;AAAA,YACnC,MAAM,KAAK;AAAA,YACX,cAAc;AAAA,UAChB;AAAA,UACA,SAAS;AAAA,QACX;AAAA,MACF,SAAS,aAAa;AACpB,gBAAQ,MAAM,2BAA2B,WAAW;AAAA,MACtD;AAAA,IACF;AAEA,WAAO;AAAA,MACL,SAAS;AAAA,MACT,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,IAClD;AAAA,EACF;AACF;AAUA,eAAsB,aACpB,OACA,OACA,UAAyB,CAAC,GAC1B,gBAC2B;AAC3B,QAAM,iBAAiB,MAAM,IAAI,CAAC,MAAM,UAAU;AAChD,UAAM,cAA6B;AAAA,MACjC,GAAG;AAAA,MACH,YAAY,iBAAiB,CAAC,aAAa,eAAe,OAAO,QAAQ,IAAI;AAAA,IAC/E;AACA,WAAO,YAAY,MAAM,OAAO,WAAW;AAAA,EAC7C,CAAC;AAED,SAAO,QAAQ,IAAI,cAAc;AACnC;AAKO,SAAS,yBAAyB;AACvC,QAAM,aAAa,IAAI,gBAAgB;AAEvC,SAAO;AAAA,IACL,QAAQ,WAAW;AAAA,IACnB,QAAQ,MAAM,WAAW,MAAM;AAAA,EACjC;AACF;;;ACvcO,SAAS,oBAAoC;AAClD,QAAM,UAAW,QAAQ,IAAI,YAAY;AAEzC,UAAQ,SAAS;AAAA,IACf,KAAK;AACH,aAAO;AAAA,QACL,KAAK,QAAQ,IAAI,sBAAsB;AAAA,QACvC,UAAU;AAAA,MACZ;AAAA,IAEF,KAAK;AACH,aAAO;AAAA,QACL,KAAK,QAAQ,IAAI,gBAAgB;AAAA,QACjC,UAAU;AAAA,MACZ;AAAA,IAEF,KAAK;AACH,aAAO;AAAA,QACL,KAAK,QAAQ,IAAI,gBAAgB;AAAA,QACjC,UAAU;AAAA,MACZ;AAAA,IAEF;AACE,aAAO;AAAA,QACL,KAAK,QAAQ,IAAI,sBAAsB;AAAA,QACvC,UAAU;AAAA,MACZ;AAAA,EACJ;AACF;AAEO,SAAS,qBAA8B;AAC5C,QAAM,UAAU,QAAQ,IAAI;AAC5B,SAAO,CAAC,WAAW,YAAY;AACjC;AAEO,SAAS,2BAAoC;AAClD,SAAO,QAAQ,IAAI,aAAa;AAClC;AAEO,SAAS,0BAAmC;AACjD,SAAO,QAAQ,IAAI,aAAa;AAClC;AAGO,IAAM,iBAAiB,kBAAkB;;;AC9CzC,IAAM,eAAe,MAAc;AACxC,MAAI,QAAQ,IAAI,aAAa,cAAc;AACzC,WAAO,QAAQ,IAAI,mBAAmB,QAAQ,IAAI,0BAA0B;AAAA,EAC9E;AAEA,MAAI,QAAQ,IAAI,aAAa,eAAe;AAC1C,WAAO,QAAQ,IAAI,kBAAkB,QAAQ,IAAI,0BAA0B;AAAA,EAC7E;AAEA,SAAO,QAAQ,IAAI,oBAAoB,QAAQ,IAAI,0BAA0B;AAC/E;AAKO,IAAM,cAAc,MAAc;AACvC,MAAI,QAAQ,IAAI,aAAa,cAAc;AACzC,WAAO,QAAQ,IAAI,kBAAkB,QAAQ,IAAI,yBAAyB;AAAA,EAC5E;AAEA,MAAI,QAAQ,IAAI,aAAa,eAAe;AAC1C,WAAO,QAAQ,IAAI,iBAAiB,QAAQ,IAAI,yBAAyB;AAAA,EAC3E;AAEA,SAAO,QAAQ,IAAI,mBAAmB,QAAQ,IAAI,yBAAyB;AAC7E;AAOO,IAAM,eAAe,MAAc;AACxC,MAAI,QAAQ,IAAI,aAAa,cAAc;AACzC,WAAO,QAAQ,IAAI,mBAAmB,QAAQ,IAAI,0BAA0B;AAAA,EAC9E;AAEA,MAAI,QAAQ,IAAI,aAAa,eAAe;AAC1C,WAAO,QAAQ,IAAI,kBAAkB,QAAQ,IAAI,0BAA0B;AAAA,EAC7E;AAEA,SAAO,QAAQ,IAAI,oBAAoB,QAAQ,IAAI,0BAA0B;AAC/E;AAKO,IAAM,qBAAqB,OAAO;AAAA,EACvC,QAAQ,aAAa;AAAA,EACrB,OAAO,YAAY;AAAA,EACnB,QAAQ,aAAa;AACvB;AAKO,IAAM,YAAY,MAAe;AACtC,SAAO,OAAO,WAAW;AAC3B;AAKO,IAAM,WAAW,MAAe;AACrC,SAAO,OAAO,WAAW;AAC3B;AAKO,IAAM,QAAQ,MAAe;AAClC,SAAO,QAAQ,IAAI,aAAa;AAClC;AAKO,IAAM,SAAS,MAAe;AACnC,SAAO,QAAQ,IAAI,aAAa;AAClC;AAKO,IAAM,SAAS,MAAe;AACnC,SAAO,QAAQ,IAAI,aAAa;AAClC;;;ACjFA,IAAM,qBAAN,MAAyB;AAAA;AAAA;AAAA;AAAA;AAAA,EAQvB,aAAa,aACX,MACA,OACA,aACY;AACZ,UAAM,QAAQ,KAAK,IAAI;AACvB,UAAM,YAAY,oBAAI,KAAK;AAE3B,QAAI;AACF,YAAM,SAAS,MAAM,MAAM;AAC3B,YAAM,WAAW,KAAK,IAAI,IAAI;AAE9B,YAAM,SAA6B;AAAA,QACjC,WAAW;AAAA,QACX;AAAA,QACA;AAAA,QACA,WAAW,WAAW,KAAK;AAAA,QAC3B;AAAA,MACF;AAEA,WAAK,UAAU,MAAM;AACrB,aAAO;AAAA,IAET,SAAS,OAAO;AACd,YAAM,WAAW,KAAK,IAAI,IAAI;AAE9B,YAAM,SAA6B;AAAA,QACjC,WAAW;AAAA,QACX;AAAA,QACA;AAAA,QACA,WAAW;AAAA,QACX;AAAA,QACA,OAAO,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,MAC9D;AAEA,WAAK,UAAU,MAAM;AACrB,YAAM;AAAA,IACR;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAe,UAAU,QAA4B;AAEnD,SAAK,QAAQ,KAAK,MAAM;AAGxB,QAAI,KAAK,QAAQ,SAAS,KAAK,YAAY;AACzC,WAAK,UAAU,KAAK,QAAQ,MAAM,CAAC,KAAK,UAAU;AAAA,IACpD;AAGA,UAAM,WAAW,OAAO,YAAY,SAAS;AAC7C,UAAM,UAAU,OAAO,QACnB,gBAAgB,OAAO,SAAS,KAAK,OAAO,QAAQ,QAAQ,OAAO,KAAK,KACxE,UAAU,OAAO,SAAS,KAAK,OAAO,QAAQ,KAAK,OAAO,cAAc,KAAK,OAAO,WAAW,cAAc,EAAE;AAEnH,YAAQ,QAAQ,EAAE,OAAO;AAGzB,QAAI,OAAO,WAAW,KAAM;AAC1B,cAAQ,MAAM,yBAAyB,OAAO,SAAS,KAAK,OAAO,QAAQ,IAAI;AAAA,IACjF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,SAAS,WAMd;AACA,UAAM,UAAU,YACZ,KAAK,QAAQ,OAAO,OAAK,EAAE,cAAc,SAAS,IAClD,KAAK;AAET,UAAM,cAAc,QAAQ,OAAO,OAAK,EAAE,SAAS;AACnD,UAAM,kBAAkB,QAAQ,SAAS,IACrC,QAAQ,OAAO,CAAC,KAAK,MAAM,MAAM,EAAE,UAAU,CAAC,IAAI,QAAQ,SAC1D;AAEJ,UAAM,eAAe,QAAQ,SAAS,IAClC,QAAQ,OAAO,CAAC,MAAM,YAAY,KAAK,WAAW,QAAQ,WAAW,OAAO,OAAO,IACnF;AAEJ,UAAM,oBAAoB,YAAY,MAAM,GAAG;AAE/C,WAAO;AAAA,MACL,cAAc,QAAQ;AAAA,MACtB,aAAa,YAAY;AAAA,MACzB,iBAAiB,KAAK,MAAM,eAAe;AAAA,MAC3C;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,eAAe,WAA0C;AAC9D,UAAM,QAAQ,aAAa,KAAK;AAChC,WAAO,KAAK,QAAQ,OAAO,OAAK,EAAE,WAAW,KAAK;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,eAAe;AACpB,SAAK,UAAU,CAAC;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,gBAAsC;AAC3C,WAAO,CAAC,GAAG,KAAK,OAAO;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,sBAAsB,WAAmB;AAC9C,SAAK,qBAAqB;AAAA,EAC5B;AACF;AAxIM,mBACW,UAAgC,CAAC;AAD5C,mBAEW,qBAAqB;AAAA;AAFhC,mBAGW,aAAa;AA0IvB,IAAM,kBAAN,MAAsB;AAAA;AAAA;AAAA;AAAA,EAO3B,OAAO,kBAAkB;AACvB,SAAK;AACL,YAAQ,IAAI,kCAAkC,KAAK,eAAe,EAAE;AAAA,EACtE;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,gBAAgB,WAAmB;AACxC,SAAK;AACL,YAAQ,IAAI,uBAAuB,SAAS,aAAa,KAAK,aAAa,EAAE;AAAA,EAC/E;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,cAAc,WAAmB;AACtC,SAAK,gBAAgB,KAAK,IAAI,GAAG,KAAK,gBAAgB,CAAC;AACvD,YAAQ,IAAI,qBAAqB,SAAS,aAAa,KAAK,aAAa,EAAE;AAAA,EAC7E;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,WAAW;AAChB,WAAO;AAAA,MACL,iBAAiB,KAAK;AAAA,MACtB,eAAe,KAAK;AAAA,IACtB;AAAA,EACF;AACF;AArCa,gBACI,kBAAkB;AADtB,gBAEI,gBAAgB;AAwC1B,IAAM,gBAAN,MAAoB;AAAA;AAAA;AAAA;AAAA,EAIzB,OAAO,iBAIL;AACA,UAAM,QAAQ,QAAQ,YAAY;AAClC,UAAM,OAAO,MAAM;AACnB,UAAM,QAAQ,MAAM;AACpB,UAAM,aAAc,OAAO,QAAS;AAEpC,WAAO;AAAA,MACL,MAAM,KAAK,MAAM,OAAO,OAAO,IAAI;AAAA;AAAA,MACnC,OAAO,KAAK,MAAM,QAAQ,OAAO,IAAI;AAAA;AAAA,MACrC,YAAY,KAAK,MAAM,UAAU;AAAA,IACnC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,eAAe,SAAkB;AACtC,UAAM,SAAS,KAAK,eAAe;AACnC,UAAM,aAAa,UAAU,IAAI,OAAO,OAAO;AAC/C,YAAQ,IAAI,GAAG,UAAU,WAAW,OAAO,IAAI,QAAQ,OAAO,KAAK,OAAO,OAAO,UAAU,IAAI;AAAA,EACjG;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,kBAAkB,YAAY,IAAa;AAChD,UAAM,SAAS,KAAK,eAAe;AACnC,WAAO,OAAO,aAAa;AAAA,EAC7B;AACF;AAKO,IAAM,aAAN,MAAiB;AAAA;AAAA;AAAA;AAAA,EAItB,aAAa,gBACX,QACA,MACA,SACY;AACZ,UAAM,QAAQ,KAAK,IAAI;AACvB,UAAM,YAAY,oBAAI,KAAK;AAE3B,QAAI;AACF,YAAM,SAAS,MAAM,QAAQ;AAC7B,YAAM,WAAW,KAAK,IAAI,IAAI;AAE9B,cAAQ,IAAI,SAAS,MAAM,IAAI,IAAI,KAAK,QAAQ,IAAI;AAGpD,UAAI,WAAW,KAAM;AACnB,gBAAQ,KAAK,cAAc,MAAM,IAAI,IAAI,KAAK,QAAQ,IAAI;AAAA,MAC5D;AAEA,aAAO;AAAA,IAET,SAAS,OAAO;AACd,YAAM,WAAW,KAAK,IAAI,IAAI;AAC9B,cAAQ,MAAM,eAAe,MAAM,IAAI,IAAI,KAAK,QAAQ,QAAQ,KAAK,EAAE;AACvE,YAAM;AAAA,IACR;AAAA,EACF;AACF","sourcesContent":["// ============================================================================\n// COMPREHENSIVE API CONFIGURATION\n// ============================================================================\n\nimport { Environment } from './environment';\n\nexport interface ApiConfig {\n  // Server-side configuration\n  database: {\n    url: string;\n    type: 'sqlite' | 'postgresql';\n  };\n  auth: {\n    jwtSecret: string;\n    expiresIn: string;\n  };\n  cors: {\n    origins: string[];\n  };\n  features: {\n    emailVerification: boolean;\n    analytics: boolean;\n    rateLimiting: boolean;\n  };\n  urls: {\n    client: string;\n    admin: string;\n    api: string;\n    mobile?: string;\n  };\n  logging: {\n    level: string;\n    format: string;\n  };\n  security: {\n    rateLimitMax: number;\n    rateLimitWindow: string;\n  };\n}\n\n// Client-side API URL configuration\nexport interface ApiUrls {\n  base: string;\n  auth: {\n    login: string;\n    register: string;\n    verify: string;\n    refresh: string;\n    logout: string;\n    forgotPassword: string;\n    resetPassword: string;\n    changePassword: string;\n  };\n  categories: {\n    list: string;\n    create: string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n  };\n  products: {\n    list: string;\n    create: string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    updateStock: (id: number) => string;\n    bulkUpdate: string;\n  };\n  orders: {\n    list: string;\n    create: string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    getByNumber: (orderNumber: string) => string;\n    updateStatus: (id: number) => string;\n    stats: string;\n  };\n  customers: {\n    list: string;\n    create: string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    stats: string;\n  };\n  outlets: {\n    list: string;\n    create: string;\n    get: (id: number) => string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    stats: string;\n  };\n  users: {\n    list: string;\n    create: string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    updateRole: (id: number) => string;\n    updateStatus: (id: number) => string;\n    assignOutlet: (id: number) => string;\n    deleteAccount: string;\n    updateByPublicId: (id: number) => string;\n    activateByPublicId: (id: number) => string;\n    deactivateByPublicId: (id: number) => string;\n    deleteByPublicId: (id: number) => string;\n  };\n  plans: {\n    list: string;\n    create: string;\n    get: (id: number) => string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    stats: string;\n    public: string;\n  };\n  planVariants: {\n    list: string;\n    create: string;\n    get: (id: number) => string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    bulk: string;\n    recycle: string;\n    restore: (id: number) => string;\n    stats: string;\n  };\n  billingCycles: {\n    list: string;\n    create: string;\n    get: (id: number) => string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n  };\n  payments: {\n    list: string;\n    create: string;\n    manual: string;\n    get: (id: number) => string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    process: (id: number) => string;\n    refund: (id: number) => string;\n    stats: string;\n    export: string;\n  };\n  subscriptions: {\n    list: string;\n    create: string;\n    get: (id: number) => string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    extend: (id: number) => string;\n    status: string;\n    stats: string;\n  };\n  analytics: {\n    dashboard: string;\n    system: string;\n    revenue: string;\n    orders: string;\n    income: string;\n    topProducts: string;\n    topCustomers: string;\n    recentOrders: string;\n    recentActivities: string;\n    inventory: string;\n    outletPerformance: string;\n    seasonalTrends: string;\n    export: string;\n    todayMetrics: string;\n    growthMetrics: string;\n    enhancedDashboard: string;\n  };\n  merchants: {\n    list: string;\n    create: string;\n    register: string;\n    get: (id: number) => string;\n    update: (id: number) => string;\n    delete: (id: number) => string;\n    updatePlan: (id: number) => string;\n    getPlan: (id: number) => string;\n    extendPlan: (id: number) => string;\n    cancelPlan: (id: number) => string;\n    pricing: {\n      get: (id: number) => string;\n      update: (id: number) => string;\n    };\n    products: {\n      list: (merchantId: number) => string;\n      get: (merchantId: number, productId: number) => string;\n      create: (merchantId: number) => string;\n      update: (merchantId: number, productId: number) => string;\n      delete: (merchantId: number, productId: number) => string;\n    };\n    orders: {\n      list: (merchantId: number) => string;\n      get: (merchantId: number, orderId: number) => string;\n      create: (merchantId: number) => string;\n      update: (merchantId: number, orderId: number) => string;\n      delete: (merchantId: number, orderId: number) => string;\n    };\n    users: {\n      list: (merchantId: number) => string;\n      get: (merchantId: number, userId: number) => string;\n      create: (merchantId: number) => string;\n      update: (merchantId: number, userId: number) => string;\n      delete: (merchantId: number, userId: number) => string;\n    };\n    outlets: {\n      list: (merchantId: number) => string;\n      get: (merchantId: number, outletId: number) => string;\n      create: (merchantId: number) => string;\n      update: (merchantId: number, outletId: number) => string;\n      delete: (merchantId: number, outletId: number) => string;\n    };\n  };\n  settings: {\n    merchant: string;\n    user: string;\n    outlet: string;\n    billing: string;\n    changePassword: string;\n    uploadPicture: string;\n    deletePicture: string;\n    preferences: string;\n    activityLog: string;\n    profileNotifications: string;\n    markNotificationRead: (id: number) => string;\n    markAllNotificationsRead: string;\n  };\n  system: {\n    backup: string;\n    backupSchedule: string;\n    backupVerify: string;\n    stats: string;\n    health: string;\n    logs: string;\n  };\n  notifications: {\n    list: string;\n    get: (id: number) => string;\n    markRead: (id: number) => string;\n    markUnread: (id: number) => string;\n    markAllRead: string;\n    delete: (id: number) => string;\n    deleteAllRead: string;\n    unreadCount: string;\n    preferences: string;\n    test: string;\n  };\n    auditLogs: {\n      list: string;\n      stats: string;\n      export: string;\n    };\n    calendar: {\n      orders: string;\n    };\n  }\n\n/**\n * Get the current environment\n */\nfunction getEnvironment(): Environment {\n  // Check for explicit environment variable first\n  const explicitEnv = process.env.NEXT_PUBLIC_APP_ENV || process.env.APP_ENV;\n  if (explicitEnv === 'local' || explicitEnv === 'development' || explicitEnv === 'production') {\n    return explicitEnv;\n  }\n\n  // Fallback to NODE_ENV\n  if (process.env.NODE_ENV === 'production') {\n    return 'production';\n  }\n\n  // Default to local for development\n  return 'local';\n}\n\n/**\n * Get API base URL for current environment\n */\nfunction getApiBaseUrlInternal(): string {\n  const env = getEnvironment();\n  \n  switch (env) {\n    case 'local':\n      return process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3002';\n    \n    case 'development':\n      return process.env.NEXT_PUBLIC_API_URL || 'https://api.dev.rentalshop.com';\n    \n    case 'production':\n      return process.env.NEXT_PUBLIC_API_URL || 'https://api.rentalshop.com';\n    \n    default:\n      return 'http://localhost:3002';\n  }\n}\n\n/**\n * Get server-side API configuration\n */\nfunction getApiConfig(): ApiConfig {\n  const environment = getEnvironment();\n  \n  // Base configuration\n  const baseConfig: Partial<ApiConfig> = {\n    cors: {\n      origins: []\n    },\n    features: {\n      emailVerification: false,\n      analytics: false,\n      rateLimiting: false\n    },\n    logging: {\n      level: 'info',\n      format: 'json'\n    },\n    security: {\n      rateLimitMax: 1000,\n      rateLimitWindow: '15m'\n    }\n  };\n\n  // Environment-specific configurations\n  switch (environment) {\n    case 'local':\n      return {\n        ...baseConfig,\n        database: {\n          url: process.env.DATABASE_URL || 'file:./dev.db',\n          type: 'sqlite'\n        },\n        auth: {\n          jwtSecret: process.env.JWT_SECRET || 'local-jwt-secret-key-change-this',\n          expiresIn: process.env.JWT_EXPIRES_IN || '7d'\n        },\n        cors: {\n          origins: [\n            'http://localhost:3000',  // Client App\n            'http://localhost:3001',  // Admin App\n            'http://localhost:3002',  // API Server\n            'http://localhost:3003'   // Mobile App (Future)\n          ]\n        },\n        features: {\n          emailVerification: false,\n          analytics: false,\n          rateLimiting: false\n        },\n        urls: {\n          client: process.env.CLIENT_URL || 'http://localhost:3000',\n          admin: process.env.ADMIN_URL || 'http://localhost:3001',\n          api: process.env.API_URL || 'http://localhost:3002',\n          mobile: process.env.MOBILE_URL || 'http://localhost:3003'\n        },\n        logging: {\n          level: process.env.LOG_LEVEL || 'debug',\n          format: process.env.LOG_FORMAT || 'pretty'\n        },\n        security: {\n          rateLimitMax: parseInt(process.env.RATE_LIMIT_MAX || '1000'),\n          rateLimitWindow: process.env.RATE_LIMIT_WINDOW || '15m'\n        }\n      };\n\n    case 'development':\n      return {\n        ...baseConfig,\n        database: {\n          url: process.env.DATABASE_URL || 'postgresql://username:password@localhost:5432/rentalshop_dev',\n          type: 'postgresql'\n        },\n        auth: {\n          jwtSecret: process.env.JWT_SECRET || 'dev-jwt-secret-key-change-this',\n          expiresIn: process.env.JWT_EXPIRES_IN || '7d'\n        },\n        cors: {\n          origins: [\n            'https://dev.rentalshop.com',\n            'https://admin.dev.rentalshop.com',\n            'https://mobile.dev.rentalshop.com'\n          ]\n        },\n        features: {\n          emailVerification: true,\n          analytics: true,\n          rateLimiting: true\n        },\n        urls: {\n          client: process.env.CLIENT_URL || 'https://dev.rentalshop.com',\n          admin: process.env.ADMIN_URL || 'https://admin.dev.rentalshop.com',\n          api: process.env.API_URL || 'https://api.dev.rentalshop.com',\n          mobile: process.env.MOBILE_URL || 'https://mobile.dev.rentalshop.com'\n        },\n        logging: {\n          level: process.env.LOG_LEVEL || 'info',\n          format: process.env.LOG_FORMAT || 'json'\n        },\n        security: {\n          rateLimitMax: parseInt(process.env.RATE_LIMIT_MAX || '500'),\n          rateLimitWindow: process.env.RATE_LIMIT_WINDOW || '15m'\n        }\n      };\n\n    case 'production':\n      return {\n        ...baseConfig,\n        database: {\n          url: process.env.DATABASE_URL || 'postgresql://username:password@your-prod-host:5432/rentalshop_prod',\n          type: 'postgresql'\n        },\n        auth: {\n          jwtSecret: process.env.JWT_SECRET || 'your-super-secure-jwt-secret-key-here',\n          expiresIn: process.env.JWT_EXPIRES_IN || '1d'\n        },\n        cors: {\n          origins: [\n            'https://rentalshop.com',\n            'https://admin.rentalshop.com',\n            'https://mobile.rentalshop.com'\n          ]\n        },\n        features: {\n          emailVerification: true,\n          analytics: true,\n          rateLimiting: true\n        },\n        urls: {\n          client: process.env.CLIENT_URL || 'https://rentalshop.com',\n          admin: process.env.ADMIN_URL || 'https://admin.rentalshop.com',\n          api: process.env.API_URL || 'https://api.rentalshop.com',\n          mobile: process.env.MOBILE_URL || 'https://mobile.rentalshop.com'\n        },\n        logging: {\n          level: process.env.LOG_LEVEL || 'warn',\n          format: process.env.LOG_FORMAT || 'json'\n        },\n        security: {\n          rateLimitMax: parseInt(process.env.RATE_LIMIT_MAX || '100'),\n          rateLimitWindow: process.env.RATE_LIMIT_WINDOW || '15m'\n        }\n      };\n\n    default:\n      throw new Error(`Unknown environment: ${environment}`);\n  }\n}\n\n/**\n * Create client-side API URLs configuration\n */\nfunction createApiUrls(): ApiUrls {\n  const base = getApiBaseUrlInternal();\n  \n  return {\n    base,\n    auth: {\n      login: `${base}/api/auth/login`,\n      register: `${base}/api/auth/register`,\n      verify: `${base}/api/auth/verify`,\n      refresh: `${base}/api/auth/refresh`,\n      logout: `${base}/api/auth/logout`,\n      forgotPassword: `${base}/api/auth/forgot-password`,\n      resetPassword: `${base}/api/auth/reset-password`,\n      changePassword: `${base}/api/auth/change-password`,\n    },\n    categories: {\n      list: `${base}/api/categories`,\n      create: `${base}/api/categories`,\n      update: (id: number) => `${base}/api/categories/${id}`,\n      delete: (id: number) => `${base}/api/categories/${id}`,\n    },\n    products: {\n      list: `${base}/api/products`,\n      create: `${base}/api/products`,\n      update: (id: number) => `${base}/api/products/${id}`,\n      delete: (id: number) => `${base}/api/products/${id}`,\n      updateStock: (id: number) => `${base}/api/products/${id}/stock`,\n      bulkUpdate: `${base}/api/products/bulk-update`,\n    },\n    orders: {\n      list: `${base}/api/orders`,\n      create: `${base}/api/orders`,\n      update: (id: number) => `${base}/api/orders/${id}`,\n      delete: (id: number) => `${base}/api/orders/${id}`,\n      getByNumber: (orderNumber: string) => `${base}/api/orders/by-number/${orderNumber}`,\n      updateStatus: (id: number) => `${base}/api/orders/${id}/status`,\n      stats: `${base}/api/orders/stats`,\n    },\n    customers: {\n      list: `${base}/api/customers`,\n      create: `${base}/api/customers`,\n      update: (id: number) => `${base}/api/customers/${id}`,\n      delete: (id: number) => `${base}/api/customers/${id}`,\n      stats: `${base}/api/customers/stats`,\n    },\n    outlets: {\n      list: `${base}/api/outlets`,\n      create: `${base}/api/outlets`,\n      get: (id: number) => `${base}/api/outlets/${id}`,\n      update: (id: number) => `${base}/api/outlets?outletId=${id}`,\n      delete: (id: number) => `${base}/api/outlets?outletId=${id}`,\n      stats: `${base}/api/outlets/stats`,\n    },\n    users: {\n      list: `${base}/api/users`,\n      create: `${base}/api/users`,\n      update: (id: number) => `${base}/api/users/${id}`,\n      delete: (id: number) => `${base}/api/users/${id}`,\n      updateRole: (id: number) => `${base}/api/users/${id}/role`,\n      updateStatus: (id: number) => `${base}/api/users/${id}/status`,\n      assignOutlet: (id: number) => `${base}/api/users/${id}/assign-outlet`,\n      deleteAccount: `${base}/api/users/delete-account`,\n      updateByPublicId: (id: number) => `${base}/api/users/${id}`,\n      activateByPublicId: (id: number) => `${base}/api/users/${id}`,\n      deactivateByPublicId: (id: number) => `${base}/api/users/${id}`,\n      deleteByPublicId: (id: number) => `${base}/api/users/${id}`,\n    },\n    plans: {\n      list: `${base}/api/plans`,\n      create: `${base}/api/plans`,\n      get: (id: number) => `${base}/api/plans/${id}`,\n      update: (id: number) => `${base}/api/plans/${id}`,\n      delete: (id: number) => `${base}/api/plans/${id}`,\n      stats: `${base}/api/plans/stats`,\n      public: `${base}/api/plans/public`,\n    },\n    planVariants: {\n      list: `${base}/api/plan-variants`,\n      create: `${base}/api/plan-variants`,\n      get: (id: number) => `${base}/api/plan-variants/${id}`,\n      update: (id: number) => `${base}/api/plan-variants/${id}`,\n      delete: (id: number) => `${base}/api/plan-variants/${id}`,\n      bulk: `${base}/api/plan-variants/bulk`,\n      recycle: `${base}/api/plan-variants/recycle`,\n      restore: (id: number) => `${base}/api/plan-variants/recycle/${id}`,\n      stats: `${base}/api/plan-variants/stats`,\n    },\n    billingCycles: {\n      list: `${base}/api/billing-cycles`,\n      create: `${base}/api/billing-cycles`,\n      get: (id: number) => `${base}/api/billing-cycles/${id}`,\n      update: (id: number) => `${base}/api/billing-cycles/${id}`,\n      delete: (id: number) => `${base}/api/billing-cycles/${id}`,\n    },\n    payments: {\n      list: `${base}/api/payments`,\n      create: `${base}/api/payments`,\n      manual: `${base}/api/payments/manual`,\n      get: (id: number) => `${base}/api/payments/${id}`,\n      update: (id: number) => `${base}/api/payments/${id}`,\n      delete: (id: number) => `${base}/api/payments/${id}`,\n      process: (id: number) => `${base}/api/payments/${id}/process`,\n      refund: (id: number) => `${base}/api/payments/${id}/refund`,\n      stats: `${base}/api/payments/stats`,\n      export: `${base}/api/payments/export`,\n    },\n    subscriptions: {\n      list: `${base}/api/subscriptions`,\n      create: `${base}/api/subscriptions`,\n      get: (id: number) => `${base}/api/subscriptions/${id}`,\n      update: (id: number) => `${base}/api/subscriptions/${id}`,\n      delete: (id: number) => `${base}/api/subscriptions/${id}`,\n      extend: (id: number) => `${base}/api/subscriptions/${id}/extend`,\n      status: `${base}/api/subscriptions/status`,\n      stats: `${base}/api/subscriptions/stats`,\n    },\n    analytics: {\n      dashboard: `${base}/api/analytics/dashboard`,\n      system: `${base}/api/analytics/system`,\n      revenue: `${base}/api/analytics/revenue`,\n      orders: `${base}/api/analytics/orders`,\n      income: `${base}/api/analytics/income`,\n      topProducts: `${base}/api/analytics/top-products`,\n      topCustomers: `${base}/api/analytics/top-customers`,\n      recentOrders: `${base}/api/analytics/recent-orders`,\n      recentActivities: `${base}/api/analytics/recent-activities`,\n      inventory: `${base}/api/analytics/inventory`,\n      outletPerformance: `${base}/api/analytics/outlet-performance`,\n      seasonalTrends: `${base}/api/analytics/seasonal-trends`,\n      export: `${base}/api/analytics/export`,\n      todayMetrics: `${base}/api/analytics/today-metrics`,\n      growthMetrics: `${base}/api/analytics/growth-metrics`,\n      enhancedDashboard: `${base}/api/analytics/enhanced-dashboard`,\n    },\n    merchants: {\n      list: `${base}/api/merchants`,\n      create: `${base}/api/merchants`,\n      register: `${base}/api/merchants/register`,\n      get: (id: number) => `${base}/api/merchants/${id}`,\n      update: (id: number) => `${base}/api/merchants/${id}`,\n      delete: (id: number) => `${base}/api/merchants/${id}`,\n      updatePlan: (id: number) => `${base}/api/merchants/${id}/plan`,\n      getPlan: (id: number) => `${base}/api/merchants/${id}/plan`,\n      extendPlan: (id: number) => `${base}/api/merchants/${id}/plan`,\n      cancelPlan: (id: number) => `${base}/api/merchants/${id}/plan`,\n      pricing: {\n        get: (id: number) => `${base}/api/merchants/${id}/pricing`,\n        update: (id: number) => `${base}/api/merchants/${id}/pricing`,\n      },\n      products: {\n        list: (merchantId: number) => `${base}/api/merchants/${merchantId}/products`,\n        get: (merchantId: number, productId: number) => `${base}/api/merchants/${merchantId}/products/${productId}`,\n        create: (merchantId: number) => `${base}/api/merchants/${merchantId}/products`,\n        update: (merchantId: number, productId: number) => `${base}/api/merchants/${merchantId}/products/${productId}`,\n        delete: (merchantId: number, productId: number) => `${base}/api/merchants/${merchantId}/products/${productId}`,\n      },\n      orders: {\n        list: (merchantId: number) => `${base}/api/merchants/${merchantId}/orders`,\n        get: (merchantId: number, orderId: number) => `${base}/api/merchants/${merchantId}/orders/${orderId}`,\n        create: (merchantId: number) => `${base}/api/merchants/${merchantId}/orders`,\n        update: (merchantId: number, orderId: number) => `${base}/api/merchants/${merchantId}/orders/${orderId}`,\n        delete: (merchantId: number, orderId: number) => `${base}/api/merchants/${merchantId}/orders/${orderId}`,\n      },\n      users: {\n        list: (merchantId: number) => `${base}/api/merchants/${merchantId}/users`,\n        get: (merchantId: number, userId: number) => `${base}/api/merchants/${merchantId}/users/${userId}`,\n        create: (merchantId: number) => `${base}/api/merchants/${merchantId}/users`,\n        update: (merchantId: number, userId: number) => `${base}/api/merchants/${merchantId}/users/${userId}`,\n        delete: (merchantId: number, userId: number) => `${base}/api/merchants/${merchantId}/users/${userId}`,\n      },\n      outlets: {\n        list: (merchantId: number) => `${base}/api/merchants/${merchantId}/outlets`,\n        get: (merchantId: number, outletId: number) => `${base}/api/merchants/${merchantId}/outlets/${outletId}`,\n        create: (merchantId: number) => `${base}/api/merchants/${merchantId}/outlets`,\n        update: (merchantId: number, outletId: number) => `${base}/api/merchants/${merchantId}/outlets/${outletId}`,\n        delete: (merchantId: number, outletId: number) => `${base}/api/merchants/${merchantId}/outlets/${outletId}`,\n      },\n    },\n  settings: {\n    merchant: `${base}/api/settings/merchant`,\n    user: `${base}/api/users/profile`,\n    outlet: `${base}/api/settings/outlet`,\n    billing: `${base}/api/settings/billing`,\n    changePassword: `${base}/api/profile/change-password`,\n    uploadPicture: `${base}/api/profile/upload-picture`,\n    deletePicture: `${base}/api/profile/delete-picture`,\n    preferences: `${base}/api/profile/preferences`,\n    activityLog: `${base}/api/profile/activity-log`,\n    profileNotifications: `${base}/api/profile/notifications`,\n    markNotificationRead: (id: number) => `${base}/api/profile/notifications/${id}/read`,\n    markAllNotificationsRead: `${base}/api/profile/notifications/mark-all-read`,\n  },\n  system: {\n    backup: `${base}/api/system/backup`,\n    backupSchedule: `${base}/api/system/backup/schedule`,\n    backupVerify: `${base}/api/system/backup/verify`,\n    stats: `${base}/api/system/stats`,\n    health: `${base}/api/system/health`,\n    logs: `${base}/api/system/logs`,\n  },\n    notifications: {\n      list: `${base}/api/notifications`,\n      get: (id: number) => `${base}/api/notifications/${id}`,\n      markRead: (id: number) => `${base}/api/notifications/${id}/read`,\n      markUnread: (id: number) => `${base}/api/notifications/${id}/unread`,\n      markAllRead: `${base}/api/notifications/mark-all-read`,\n      delete: (id: number) => `${base}/api/notifications/${id}`,\n      deleteAllRead: `${base}/api/notifications/delete-read`,\n      unreadCount: `${base}/api/notifications/unread-count`,\n      preferences: `${base}/api/notifications/preferences`,\n      test: `${base}/api/notifications/test`,\n    },\n    auditLogs: {\n      list: `${base}/api/audit-logs`,\n      stats: `${base}/api/audit-logs/stats`,\n      export: `${base}/api/audit-logs/export`,\n    },\n    calendar: {\n      orders: `${base}/api/calendar/orders`,\n    },\n  };\n}\n\n// ============================================================================\n// EXPORTS\n// ============================================================================\n\n// Server-side configuration (for API server)\nexport const apiConfig = getApiConfig();\nexport const apiEnvironment = getEnvironment();\n\n// Client-side configuration (for client apps)\nexport const apiUrls = createApiUrls();\n\n// Environment helpers\nexport const getCurrentEnvironment = (): Environment => getEnvironment();\nexport const isLocal = (): boolean => getEnvironment() === 'local';\nexport const isDevelopment = (): boolean => getEnvironment() === 'development';\nexport const isProduction = (): boolean => getEnvironment() === 'production';\n\n// API base URL helpers\nexport const getApiBaseUrl = (): string => getApiBaseUrlInternal();\n\n// Helper function to build custom API endpoints\nexport const buildApiUrl = (endpoint: string): string => {\n  const base = getApiBaseUrl();\n  const cleanEndpoint = endpoint.startsWith('/') ? endpoint.slice(1) : endpoint;\n  return `${base}/${cleanEndpoint}`;\n};\n\n// Get the current API base URL (for swagger docs)\nexport const getApiUrl = (): string => getApiBaseUrl();\n\n// Export API_BASE_URL for direct use in API clients\nexport const API_BASE_URL = getApiBaseUrl();\n\n// Legacy exports for backward compatibility\nexport const getApiDatabaseUrl = () => apiConfig.database.url;\nexport const getApiJwtSecret = () => apiConfig.auth.jwtSecret;\nexport const getApiCorsOrigins = () => apiConfig.cors.origins;\n\n\n","\"use strict\";\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toCommonJS = (mod) => __copyProps(__defProp({}, \"__esModule\", { value: true }), mod);\n\n// src/scripts/default-index.ts\nvar default_index_exports = {};\n__export(default_index_exports, {\n  Prisma: () => Prisma,\n  PrismaClient: () => PrismaClient,\n  default: () => default_index_default\n});\nmodule.exports = __toCommonJS(default_index_exports);\n\n// ../../node_modules/.pnpm/@prisma+engines-version@6.16.0-7.1c57fdcd7e44b29b9313256c76699e91c3ac3c43/node_modules/@prisma/engines-version/package.json\nvar prisma = {\n  enginesVersion: \"1c57fdcd7e44b29b9313256c76699e91c3ac3c43\"\n};\n\n// package.json\nvar version = \"6.16.2\";\n\n// src/runtime/utils/clientVersion.ts\nvar clientVersion = version;\n\n// src/scripts/default-index.ts\nvar PrismaClient = class {\n  constructor() {\n    throw new Error('@prisma/client did not initialize yet. Please run \"prisma generate\" and try to import it again.');\n  }\n};\nfunction defineExtension(ext) {\n  if (typeof ext === \"function\") {\n    return ext;\n  }\n  return (client) => client.$extends(ext);\n}\nfunction getExtensionContext(that) {\n  return that;\n}\nvar Prisma = {\n  defineExtension,\n  getExtensionContext,\n  prismaVersion: { client: clientVersion, engine: prisma.enginesVersion }\n};\nvar default_index_default = { Prisma };\n// Annotate the CommonJS export names for ESM import in node:\n0 && (module.exports = {\n  Prisma,\n  PrismaClient\n});\n","module.exports = {\n  ...require('.prisma/client/default'),\n}\n","/**\n * String Utility Functions\n * \n * Provides common string manipulation and validation functions\n */\n\n/**\n * Format phone number for display\n */\nexport const formatPhoneNumber = (phone: string): string => {\n  // Remove all non-digit characters\n  const cleaned = phone.replace(/\\D/g, '');\n  \n  // Format Vietnamese phone number\n  if (cleaned.length === 10) {\n    return `${cleaned.slice(0, 3)} ${cleaned.slice(3, 6)} ${cleaned.slice(6)}`;\n  } else if (cleaned.length === 11) {\n    return `${cleaned.slice(0, 4)} ${cleaned.slice(4, 7)} ${cleaned.slice(7)}`;\n  }\n  \n  return phone;\n};\n\n/**\n * Generate URL-friendly slug from text\n */\nexport const generateSlug = (text: string): string => {\n  return text\n    .toLowerCase()\n    .replace(/[^\\w\\s-]/g, '')\n    .replace(/[\\s_-]+/g, '-')\n    .replace(/^-+|-+$/g, '');\n};\n\n/**\n * Truncate text to specified length with ellipsis\n */\nexport const truncateText = (text: string, maxLength: number): string => {\n  if (text.length <= maxLength) return text;\n  return text.slice(0, maxLength) + '...';\n};\n\n/**\n * Validate email format\n */\nexport const isValidEmail = (email: string): boolean => {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n};\n\n/**\n * Validate Vietnamese phone number format\n */\nexport const isValidPhone = (phone: string): boolean => {\n  const phoneRegex = /^(\\+84|84|0)[3|5|7|8|9][0-9]{8}$/;\n  return phoneRegex.test(phone.replace(/\\s/g, ''));\n};\n\n/**\n * Capitalize first letter of each word\n */\nexport const capitalizeWords = (text: string): string => {\n  return text\n    .toLowerCase()\n    .split(' ')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n};\n\n/**\n * Remove extra whitespace and normalize spaces\n */\nexport const normalizeWhitespace = (text: string): string => {\n  return text.replace(/\\s+/g, ' ').trim();\n};\n\n/**\n * Generate random string of specified length\n */\nexport const generateRandomString = (length: number): string => {\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  let result = '';\n  for (let i = 0; i < length; i++) {\n    result += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return result;\n};\n\n/**\n * Check if string is empty or only whitespace\n */\nexport const isEmpty = (text: string): boolean => {\n  return !text || text.trim().length === 0;\n};\n\n/**\n * Extract initials from name\n */\nexport const getInitials = (name: string): string => {\n  return name\n    .split(' ')\n    .map(word => word.charAt(0).toUpperCase())\n    .join('')\n    .slice(0, 2);\n};\n","/**\n * Function Utility Functions\n * \n * Provides common function manipulation utilities like debounce and throttle\n */\n\n/**\n * Debounce function execution\n * Delays execution until after wait time has passed since last invocation\n */\nexport const debounce = <T extends (...args: any[]) => any>(\n  func: T,\n  wait: number\n): ((...args: Parameters<T>) => void) => {\n  let timeout: NodeJS.Timeout;\n  return (...args: Parameters<T>) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  };\n};\n\n/**\n * Throttle function execution\n * Limits execution to once per specified time period\n */\nexport const throttle = <T extends (...args: any[]) => any>(\n  func: T,\n  limit: number\n): ((...args: Parameters<T>) => void) => {\n  let inThrottle: boolean;\n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args);\n      inThrottle = true;\n      setTimeout(() => (inThrottle = false), limit);\n    }\n  };\n};\n\n/**\n * Memoize function results\n * Caches function results based on input parameters\n */\nexport const memoize = <T extends (...args: any[]) => any>(\n  func: T,\n  keyGenerator?: (...args: Parameters<T>) => string\n): T => {\n  const cache = new Map<string, ReturnType<T>>();\n  \n  return ((...args: Parameters<T>) => {\n    const key = keyGenerator ? keyGenerator(...args) : JSON.stringify(args);\n    \n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    \n    const result = func(...args);\n    cache.set(key, result);\n    return result;\n  }) as T;\n};\n\n/**\n * Retry function execution with exponential backoff\n */\nexport const retry = async <T>(\n  fn: () => Promise<T>,\n  maxAttempts: number = 3,\n  baseDelay: number = 1000\n): Promise<T> => {\n  let lastError: Error;\n  \n  for (let attempt = 1; attempt <= maxAttempts; attempt++) {\n    try {\n      return await fn();\n    } catch (error) {\n      lastError = error as Error;\n      \n      if (attempt === maxAttempts) {\n        throw lastError;\n      }\n      \n      const delay = baseDelay * Math.pow(2, attempt - 1);\n      await new Promise(resolve => setTimeout(resolve, delay));\n    }\n  }\n  \n  throw lastError!;\n};\n\n/**\n * Create a function that only executes once\n */\nexport const once = <T extends (...args: any[]) => any>(func: T): T => {\n  let called = false;\n  let result: ReturnType<T>;\n  \n  return ((...args: Parameters<T>) => {\n    if (!called) {\n      called = true;\n      result = func(...args);\n    }\n    return result;\n  }) as T;\n};\n\n/**\n * Create a function that executes after a delay\n */\nexport const delay = (ms: number): Promise<void> => {\n  return new Promise(resolve => setTimeout(resolve, ms));\n};\n\n/**\n * Create a timeout promise that rejects after specified time\n */\nexport const timeout = <T>(promise: Promise<T>, ms: number): Promise<T> => {\n  return Promise.race([\n    promise,\n    new Promise<never>((_, reject) => \n      setTimeout(() => reject(new Error('Operation timed out')), ms)\n    )\n  ]);\n};\n","import CONSTANTS from '@rentalshop/constants';\nimport type { User, LoginCredentials } from '@rentalshop/types';\nimport type { ApiResponse, ErrorCode } from './errors';\nimport { analyzeError } from './errors'; // Import analyzeError for handleApiErrorForUI\n\nconst API = CONSTANTS.API;\n\n// formatCurrency is now exported from ./currency.ts for centralized currency management\n\n// String utilities are now exported from ./string-utils.ts\n// Function utilities are now exported from ./function-utils.ts\n// This file focuses on API utilities and authentication functions\n\n// ============================================================================\n// API UTILITIES\n// ============================================================================\n\n// ApiResponse interface moved to errors.ts for unified error handling\n\n/**\n * Create API URL with proper base URL\n */\nexport const createApiUrl = (endpoint: string): string => {\n  // Remove leading slash if present\n  const cleanEndpoint = endpoint.startsWith('/') ? endpoint.slice(1) : endpoint;\n  \n  // Check if it's already a full URL\n  if (cleanEndpoint.startsWith('http://') || cleanEndpoint.startsWith('https://')) {\n    return cleanEndpoint;\n  }\n  \n  // For relative endpoints, construct full URL\n  if (cleanEndpoint.startsWith('api/')) {\n    // Use centralized API URL configuration\n    try {\n      const { apiUrls } = require('../config/api');\n      return `${apiUrls.base}/${cleanEndpoint}`;\n    } catch {\n      // Fallback to environment variable if centralized config not available\n      const baseUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3002';\n      return `${baseUrl}/${cleanEndpoint}`;\n    }\n  }\n  \n  // Default to relative API path\n  return `/api/${cleanEndpoint}`;\n};\n\n/**\n * Authenticated fetch wrapper for API calls\n * Handles authentication headers and common error cases\n */\n/**\n * Public fetch wrapper for unauthenticated requests (login, register, etc.)\n * Does not require authentication token\n */\nexport const publicFetch = async (\n  url: string,\n  options: RequestInit = {}\n): Promise<Response> => {\n  console.log('🔍 FRONTEND: publicFetch called with URL:', url);\n  console.log('🔍 FRONTEND: publicFetch options:', options);\n  \n  // Input validation\n  if (!url || typeof url !== 'string') {\n    console.log('🔍 FRONTEND: URL validation failed');\n    throw new Error('URL is required and must be a string');\n  }\n\n  // Set default headers using API constants\n  const headers: Record<string, string> = {\n    [API.HEADERS.CONTENT_TYPE]: API.CONTENT_TYPES.JSON,\n    [API.HEADERS.ACCEPT]: API.CONTENT_TYPES.JSON,\n  };\n\n  // Create full URL\n  const fullUrl = createApiUrl(url);\n\n  // Merge headers\n  const requestOptions: RequestInit = {\n    ...options,\n    headers: {\n      ...headers,\n      ...options.headers,\n    },\n  };\n\n  console.log(`🌐 PUBLIC REQUEST: ${requestOptions.method || 'GET'} ${fullUrl}`);\n  \n  try {\n    const response = await fetch(fullUrl, requestOptions);\n    console.log(`✅ PUBLIC RESPONSE: ${response.status} ${response.statusText}`);\n    return response;\n  } catch (error) {\n    console.error(`❌ PUBLIC REQUEST FAILED:`, error);\n    throw error;\n  }\n};\n\n/**\n * Authenticated fetch wrapper for API calls\n * \n * Best Practices:\n * - Proper error handling and user feedback\n * - Automatic token cleanup on auth failure\n * - Consistent header management\n * - Type-safe implementation\n */\nexport const authenticatedFetch = async (\n  url: string,\n  options: RequestInit = {}\n): Promise<Response> => {\n  console.log('🔍 FRONTEND: authenticatedFetch called with URL:', url);\n  console.log('🔍 FRONTEND: authenticatedFetch options:', options);\n  \n  // Input validation\n  if (!url || typeof url !== 'string') {\n    console.log('🔍 FRONTEND: URL validation failed');\n    throw new Error('URL is required and must be a string');\n  }\n\n  // Get token from localStorage (client-side only) - CONSOLIDATED APPROACH\n  const token = getAuthToken();\n  console.log('🔍 FRONTEND: Token from localStorage:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n  \n  // TEMPORARY DEBUG: Check if token is expired or invalid\n  if (token && typeof window !== 'undefined') {\n    try {\n      const parts = token.split('.');\n      if (parts.length === 3) {\n        const payload = JSON.parse(atob(parts[1]));\n        const now = Math.floor(Date.now() / 1000);\n        console.log('🔍 FRONTEND: Token debug:', {\n          userId: payload.userId,\n          email: payload.email,\n          role: payload.role,\n          exp: payload.exp,\n          now: now,\n          expired: payload.exp < now,\n          timeUntilExpiry: payload.exp - now\n        });\n        \n        // If token is expired, clear it\n        if (payload.exp < now) {\n          console.log('🔍 FRONTEND: Token is expired, clearing auth data');\n          clearAuthData();\n          throw new Error('Token expired - please log in again');\n        }\n      }\n    } catch (error) {\n      console.log('🔍 FRONTEND: Token validation failed:', error);\n      clearAuthData();\n      throw new Error('Invalid token - please log in again');\n    }\n  }\n  \n  // Check if user is authenticated before making the request\n  if (!token && typeof window !== 'undefined') {\n    console.log('🔍 FRONTEND: No token found, cleaning up and redirecting to login');\n    // Clean up any stale auth data\n    clearAuthData();\n    // Redirect to login page\n    setTimeout(() => {\n      // window.location.href = '/login';\n    }, 100);\n    throw new Error('Authentication required');\n  }\n  \n  // Set default headers using API constants\n  const headers: Record<string, string> = {\n    [API.HEADERS.CONTENT_TYPE]: API.CONTENT_TYPES.JSON,\n    [API.HEADERS.ACCEPT]: API.CONTENT_TYPES.JSON,\n    ...(options.headers as Record<string, string>),\n  };\n  \n  // Add authorization header if token exists\n  if (token) {\n    headers[API.HEADERS.AUTHORIZATION] = `Bearer ${token}`;\n    console.log('🔍 FRONTEND: Authorization header set:', `Bearer ${token.substring(0, 20)}...`);\n  }\n  \n  console.log('🔍 FRONTEND: Final headers:', headers);\n  \n  // Set default options using API constants\n  const defaultOptions: RequestInit = {\n    method: API.METHODS.GET,\n    headers,\n    ...options,\n  };\n  \n  console.log('🔍 FRONTEND: Final request options:', defaultOptions);\n  \n  try {\n    console.log('🔍 FRONTEND: Making fetch request to:', url);\n    console.log('🔍 FRONTEND: Request body:', options.body);\n    const response = await fetch(url, defaultOptions);\n    console.log('🔍 FRONTEND: Response received:', {\n      status: response.status,\n      statusText: response.statusText,\n      ok: response.ok,\n      url: response.url,\n      headers: Object.fromEntries(response.headers.entries())\n    });\n    \n    // Handle subscription errors (402 Payment Required)\n    if (response.status === API.STATUS.PAYMENT_REQUIRED) {\n      console.log('🔍 FRONTEND: 402 Payment Required response received (subscription error)');\n      \n      try {\n        const errorData = await response.clone().json();\n        console.log('🔍 FRONTEND: 402 Error details:', errorData);\n        \n        // Don't redirect to login for subscription errors - let the app handle it\n        throw new Error(errorData.message || 'Subscription issue detected');\n      } catch (parseError) {\n        console.log('🔍 FRONTEND: Could not parse 402 error response');\n        throw new Error('Subscription issue detected');\n      }\n    }\n    \n    // Handle authentication errors (401 Unauthorized)\n    if (response.status === API.STATUS.UNAUTHORIZED) {\n      console.log('🔍 FRONTEND: 401 Unauthorized response received');\n      \n      // Handle unauthorized - clean up auth data and redirect immediately\n      if (typeof window !== 'undefined') {\n        console.log('🔍 FRONTEND: Cleaning up auth data and redirecting to login');\n        clearAuthData();\n        // Immediate redirect on 401 error\n        window.location.href = '/login';\n      }\n      throw new Error('Unauthorized access - redirecting to login');\n    }\n    \n    if (response.status === API.STATUS.FORBIDDEN) {\n      throw new Error('Access forbidden - insufficient permissions');\n    }\n    \n    if (response.status >= 500) {\n      throw new Error('Server error - please try again later');\n    }\n    \n    if (response.status >= API.STATUS.INTERNAL_SERVER_ERROR) {\n      throw new Error('Server error occurred');\n    }\n    \n    return response;\n  } catch (error) {\n    // Handle network errors using API constants\n    if (error instanceof TypeError && error.message.includes('fetch')) {\n      throw new Error(API.ERROR_CODES.NETWORK_ERROR);\n    }\n    throw error;\n  }\n};\n\n\n\n\n/**\n * Parse API response\n * \n * This function handles the nested API response structure:\n * API returns: { success: true, data: { ... }, message: \"...\" }\n * We extract: { success: true, data: { ... } }\n * \n * This allows frontend to access user data directly via response.data\n * instead of response.data.data\n */\nexport const parseApiResponse = async <T>(response: Response): Promise<ApiResponse<T>> => {\n  console.log('🔍 DEBUG: parseApiResponse called with status:', response.status);\n  console.log('🔍 DEBUG: Response OK:', response.ok);\n  console.log('🔍 DEBUG: Response URL:', response.url);\n  \n  // Subscription status checking is now handled in authenticatedFetch\n  \n  if (!response.ok) {\n    console.error('❌ DEBUG: parseApiResponse - Response not OK, status:', response.status);\n    console.error('❌ DEBUG: parseApiResponse - Response statusText:', response.statusText);\n    console.error('❌ DEBUG: parseApiResponse - Response URL:', response.url);\n    \n    // Handle unauthorized responses by redirecting to login\n    if (response.status === API.STATUS.UNAUTHORIZED) {\n      if (typeof window !== 'undefined') {\n        console.error('🚨 DEBUG: parseApiResponse - UNAUTHORIZED RESPONSE!');\n        console.error('🚨 DEBUG: This will trigger auto-redirect to login page!');\n        console.error('🔒 parseApiResponse: Unauthorized access - token may be expired or invalid');\n        console.error('🔒 parseApiResponse: Response status:', response.status);\n        console.error('🔒 parseApiResponse: Response URL:', response.url);\n        \n        // Try to get response body for more details\n        try {\n          const responseText = await response.clone().text();\n          console.error('🔒 parseApiResponse - Response body:', responseText);\n        } catch (e) {\n          console.error('🔒 parseApiResponse - Could not read response body:', e);\n        }\n        \n        clearAuthData();\n        // Immediate redirect on 401 error\n        console.error('🚨 DEBUG: parseApiResponse - REDIRECTING TO LOGIN PAGE NOW!');\n        // window.location.href = '/login';\n      }\n      throw new Error('Unauthorized access - redirecting to login');\n    }\n    \n    const errorText = await response.text();\n    console.log('🔍 parseApiResponse: Error response text:', errorText);\n    \n    try {\n      const errorData = JSON.parse(errorText);\n      console.log('🔍 parseApiResponse: Parsed error data:', errorData);\n      \n      // Handle structured error responses that include both message and error code\n      if (errorData.success === false && errorData.message && errorData.error) {\n        console.log('🔍 parseApiResponse: Structured error response detected');\n        const result = {\n          success: false as const,\n          message: errorData.message, // Use the user-friendly message\n          error: errorData.error as ErrorCode, // Preserve the error code for specific handling\n        };\n        console.log('🔍 parseApiResponse: Returning structured error:', result);\n        return result;\n      }\n      \n      // Handle API error responses with error field (most common case)\n      if (errorData.success === false && errorData.error) {\n        console.log('🔍 parseApiResponse: API error response detected');\n        \n        // Check if this is a subscription-related \"Invalid token\" error\n        const isSubscriptionInvalidToken = (\n          errorData.error === 'Invalid token' && (\n            // Check for subscription-related context\n            errorData.subscriptionError === true ||\n            errorData.context === 'subscription' ||\n            errorData.context === 'plan' ||\n            errorData.subscriptionStatus === 'cancelled' ||\n            errorData.subscriptionStatus === 'expired' ||\n            // Check if this came from a subscription-related endpoint\n            response.url.includes('/subscription') ||\n            response.url.includes('/plan') ||\n            response.url.includes('/billing') ||\n            // Check for subscription-specific error codes\n            errorData.errorCode === 'SUBSCRIPTION_CANCELLED' ||\n            errorData.errorCode === 'PLAN_CANCELLED' ||\n            errorData.errorCode === 'SUBSCRIPTION_EXPIRED'\n          )\n        );\n        \n        const result = {\n          success: false as const,\n          message: errorData.error, // Use the error message directly\n          error: errorData.errorCode as ErrorCode || 'INTERNAL_SERVER_ERROR',\n          // Add subscription context if detected\n          ...(isSubscriptionInvalidToken && {\n            details: 'subscription'\n          })\n        };\n        console.log('🔍 parseApiResponse: Returning API error:', result);\n        return result;\n      }\n      \n      // Handle legacy error responses\n      console.log('🔍 parseApiResponse: Legacy error response detected');\n      \n      // Check if this is a subscription-related \"Invalid token\" error using message field\n      const isSubscriptionInvalidTokenMessage = (\n        errorData.message === 'Invalid token' && (\n          // Check for subscription-related context\n          errorData.subscriptionError === true ||\n          errorData.context === 'subscription' ||\n          errorData.context === 'plan' ||\n          errorData.subscriptionStatus === 'cancelled' ||\n          errorData.subscriptionStatus === 'expired' ||\n          // Check if this came from a subscription-related endpoint\n          response.url.includes('/subscription') ||\n          response.url.includes('/plan') ||\n          response.url.includes('/billing') ||\n          // Check for subscription-specific error codes\n          errorData.errorCode === 'SUBSCRIPTION_CANCELLED' ||\n          errorData.errorCode === 'PLAN_CANCELLED' ||\n          errorData.errorCode === 'SUBSCRIPTION_EXPIRED'\n        )\n      );\n      \n      const result = {\n        success: false as const,\n        message: errorData.message || `HTTP ${response.status}: ${response.statusText}`,\n        error: errorData.errorCode as ErrorCode || 'INTERNAL_SERVER_ERROR',\n        // Add subscription context if detected\n        ...(isSubscriptionInvalidTokenMessage && {\n          details: 'subscription'\n        })\n      };\n      console.log('🔍 parseApiResponse: Returning legacy error:', result);\n      return result;\n    } catch {\n      console.log('🔍 parseApiResponse: Failed to parse error JSON, using fallback');\n      const result = {\n        success: false as const,\n        message: `HTTP ${response.status}: ${response.statusText}`,\n        error: 'INTERNAL_SERVER_ERROR' as ErrorCode,\n      };\n      console.log('🔍 parseApiResponse: Returning fallback error:', result);\n      return result;\n    }\n  }\n\n  try {\n    const responseData = await response.json();\n    \n    // Handle nested API response structure\n    // API returns: { success: true, data: { ... }, message: \"...\" }\n    // We extract: { success: true, data: { ... } }\n    if (responseData.success && responseData.data !== undefined) {\n      return {\n        success: true as const,\n        data: responseData.data, // Extract the nested data\n      };\n    }\n    \n    // Fallback for non-standard responses\n    return {\n      success: true as const,\n      data: responseData,\n    };\n  } catch (error) {\n    return {\n      success: false as const,\n      message: 'Failed to parse response',\n      error: 'INTERNAL_SERVER_ERROR' as ErrorCode,\n    };\n  }\n};\n\n/**\n * Execute with data refresh\n */\nexport const executeWithDataRefresh = async <T>(\n  operation: () => Promise<T>,\n  refreshCallback?: () => void\n): Promise<T> => {\n  try {\n    const result = await operation();\n    if (refreshCallback) {\n      refreshCallback();\n    }\n    return result;\n  } catch (error) {\n    console.error('Operation failed:', error);\n    throw error;\n  }\n};\n\n// handleApiError is now exported from ./error-handling.ts for centralized error handling\n\n/**\n * Check if user is authenticated\n */\nexport const isAuthenticated = (): boolean => {\n  if (typeof window === 'undefined') return false;\n  \n  const token = getAuthToken();\n  return !!token;\n};\n\n/**\n * Redirect to login if not authenticated\n */\nexport const requireAuth = (): void => {\n  if (!isAuthenticated()) {\n    if (typeof window !== 'undefined') {\n      console.log('🔒 User not authenticated, redirecting to login');\n      clearAuthData();\n      // window.location.href = '/login';\n    }\n  }\n};\n\n// ============================================================================\n// AUTHENTICATION STORAGE UTILITIES (NON-DUPLICATE)\n// ============================================================================\n\nimport { UserRole } from '@rentalshop/types';\n\nexport interface StoredUser {\n  id: number;\n  firstName: string;\n  lastName: string;\n  name: string;\n  email: string;\n  phone: string;\n  role: UserRole;\n  isActive: boolean;\n  createdAt: Date | string;\n  emailVerified: boolean;\n  updatedAt: Date | string;\n  merchantId?: number;\n  outletId?: number;\n  token: string;\n  expiresAt: number;\n}\n\n/**\n * Get stored authentication token - CONSOLIDATED APPROACH\n */\nexport const getAuthToken = (): string | null => {\n  if (typeof window === 'undefined') return null;\n  \n  // Try new consolidated format first\n  const authData = localStorage.getItem('authData');\n  if (authData) {\n    try {\n      const parsed = JSON.parse(authData);\n      if (parsed.token && parsed.expiresAt) {\n        // Check if token is expired\n        if (Date.now() > parsed.expiresAt) {\n          console.log('🔍 Token is expired, clearing auth data');\n          clearAuthData();\n          return null;\n        }\n        return parsed.token;\n      }\n    } catch (error) {\n      console.warn('Failed to parse authData:', error);\n      clearAuthData();\n      return null;\n    }\n  }\n  \n  // Fallback to old format for backward compatibility\n  const token = localStorage.getItem('authToken');\n  if (token) {\n    // Check if token is actually expired by decoding it\n    try {\n      const parts = token.split('.');\n      if (parts.length === 3) {\n        const payload = JSON.parse(atob(parts[1]));\n        if (payload.exp) {\n          const now = Math.floor(Date.now() / 1000);\n          if (payload.exp < now) {\n            console.log('🔍 Token is expired, clearing auth data');\n            clearAuthData();\n            return null;\n          }\n        }\n      }\n    } catch (error) {\n      console.warn('Failed to decode JWT token for expiration check:', error);\n      clearAuthData();\n      return null;\n    }\n    return token;\n  }\n  \n  return null;\n};\n\n/**\n * Get stored user data\n */\nexport const getStoredUser = (): StoredUser | null => {\n  if (typeof window === 'undefined') return null;\n  \n  try {\n    // First try the new consolidated authData\n    const authData = localStorage.getItem('authData');\n    if (authData) {\n      const parsed = JSON.parse(authData);\n      if (parsed.user) {\n        // Check if token is expired\n        if (parsed.expiresAt && Date.now() > parsed.expiresAt) {\n          clearAuthData();\n          return null;\n        }\n        return parsed.user as StoredUser;\n      }\n    }\n    \n    // Fallback to old userData for backward compatibility\n    const userData = localStorage.getItem('userData');\n    if (userData) {\n      const user = JSON.parse(userData) as StoredUser;\n      \n      // Check if token is expired\n      if (user.expiresAt && Date.now() > user.expiresAt) {\n        clearAuthData();\n        return null;\n      }\n      \n      return user;\n    }\n    \n    return null;\n  } catch (error) {\n    console.error('Failed to parse stored user data:', error);\n    clearAuthData();\n    return null;\n  }\n};\n\n/**\n * Store authentication data - CONSOLIDATED APPROACH\n * Only stores ONE item: 'authData' with everything needed\n */\nexport const storeAuthData = (token: string, user: User): void => {\n  if (typeof window === 'undefined') return;\n  \n  // Decode JWT token to get actual expiration time\n  let expiresAt = Date.now() + (24 * 60 * 60 * 1000); // Default fallback\n  try {\n    const parts = token.split('.');\n    if (parts.length === 3) {\n      const payload = JSON.parse(atob(parts[1]));\n      if (payload.exp) {\n        expiresAt = payload.exp * 1000; // Convert to milliseconds\n      }\n    }\n  } catch (error) {\n    console.warn('Failed to decode JWT token for expiration time:', error);\n  }\n  \n  const authData = {\n    token,\n    user: {\n      id: user.id,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      name: user.name,\n      email: user.email,\n      phone: user.phone,\n      role: user.role,\n      isActive: user.isActive,\n      createdAt: user.createdAt,\n      emailVerified: user.emailVerified,\n      updatedAt: user.updatedAt,\n      merchantId: user.merchantId ? Number(user.merchantId) : undefined,\n      outletId: user.outletId ? Number(user.outletId) : undefined,\n    },\n    expiresAt, // Use actual JWT expiration time\n  };\n  \n  // CONSOLIDATED: Only store ONE item with everything\n  localStorage.setItem('authData', JSON.stringify(authData));\n  \n  // Clean up old redundant items\n  localStorage.removeItem('authToken');\n  localStorage.removeItem('user');\n  localStorage.removeItem('userData');\n  \n  console.log('✅ Auth data stored in consolidated format');\n};\n\n/**\n * Clear authentication data - CONSOLIDATED APPROACH\n */\nexport const clearAuthData = (): void => {\n  if (typeof window === 'undefined') return;\n  \n  console.log('🧹 Clearing auth data from localStorage');\n  \n  // Clear new consolidated format\n  localStorage.removeItem('authData');\n  \n  // Clear old redundant formats\n  localStorage.removeItem('authToken');\n  localStorage.removeItem('user');\n  localStorage.removeItem('userData');\n  \n  console.log('✅ All auth data cleared');\n};\n\n/**\n * Get current authenticated user\n */\nexport const getCurrentUser = (): StoredUser | null => {\n  return getStoredUser();\n};\n\n/**\n * Force clear all auth data and redirect to login\n * Use this when you need to force a fresh login\n */\nexport const forceLogout = (): void => {\n  if (typeof window === 'undefined') return;\n  \n  console.log('🚪 Force logout - clearing all auth data');\n  clearAuthData();\n  \n  // Immediate redirect to login page\n  // window.location.href = '/login';\n};\n\n/**\n * Handle API response with proper error handling\n */\nexport const handleApiResponse = async <T>(response: Response): Promise<ApiResponse<T>> => {\n  return await parseApiResponse<T>(response);\n};\n\n/**\n * Handle 401 authentication errors - MODERN PATTERN\n * Automatically redirects to login page and clears auth data\n */\nexport const handleAuthError = (error: Error): void => {\n  const errorMessage = error.message.toLowerCase();\n  \n  // Check if it's an authentication error\n  if (errorMessage.includes('unauthorized') || \n      errorMessage.includes('authentication required') ||\n      errorMessage.includes('token expired') ||\n      errorMessage.includes('invalid token')) {\n    \n    console.log('🔒 Authentication error detected:', error.message);\n    \n    // Clear auth data\n    clearAuthData();\n    \n    // Redirect to login page\n    if (typeof window !== 'undefined') {\n      console.log('🔄 Redirecting to login page...');\n      window.location.href = '/login';\n    }\n  }\n};\n\n// ============================================================================\n// TOAST UTILITIES (for UI components)\n// ============================================================================\n\n/**\n * Get toast type based on error type\n */\nexport const getToastType = (errorType: 'auth' | 'permission' | 'subscription' | 'network' | 'validation' | 'unknown'): 'error' | 'warning' | 'info' => {\n  switch (errorType) {\n    case 'auth':\n      return 'error';\n    case 'permission':\n      return 'error';\n    case 'subscription':\n      return 'warning';\n    case 'network':\n      return 'warning';\n    case 'validation':\n      return 'warning';\n    case 'unknown':\n      return 'error';\n    default:\n      return 'error';\n  }\n};\n\n/**\n * Wrap API call with error handling for UI\n */\nexport const withErrorHandlingForUI = async <T>(\n  apiCall: () => Promise<T>\n): Promise<{ data?: T; error?: any }> => {\n  try {\n    const data = await apiCall();\n    return { data };\n  } catch (error) {\n    return { error };\n  }\n};\n\n/**\n * Handle API error for UI display\n */\nexport const handleApiErrorForUI = (error: any): { message: string; type: string } => {\n  const errorInfo = analyzeError(error);\n  return {\n    message: errorInfo.message,\n    type: errorInfo.type\n  };\n}; ","import { z } from 'zod';\nimport { clearAuthData } from './common';\nimport CONSTANTS from '@rentalshop/constants';\n\nconst API = CONSTANTS.API;\n\n// ============================================================================\n// UNIFIED ERROR HANDLING SYSTEM - DRY PRINCIPLE\n// ============================================================================\n\n/**\n * Core Error Codes - Simplified and Unified\n */\nexport enum ErrorCode {\n  // Authentication & Authorization\n  UNAUTHORIZED = 'UNAUTHORIZED',\n  FORBIDDEN = 'FORBIDDEN',\n  INVALID_TOKEN = 'INVALID_TOKEN',\n  TOKEN_EXPIRED = 'TOKEN_EXPIRED',\n  INVALID_CREDENTIALS = 'INVALID_CREDENTIALS',\n  \n  // Validation Errors\n  VALIDATION_ERROR = 'VALIDATION_ERROR',\n  INVALID_INPUT = 'INVALID_INPUT',\n  MISSING_REQUIRED_FIELD = 'MISSING_REQUIRED_FIELD',\n  \n  // Database Errors\n  DATABASE_ERROR = 'DATABASE_ERROR',\n  DUPLICATE_ENTRY = 'DUPLICATE_ENTRY',\n  FOREIGN_KEY_CONSTRAINT = 'FOREIGN_KEY_CONSTRAINT',\n  NOT_FOUND = 'NOT_FOUND',\n  \n  // Business Logic Errors\n  PLAN_LIMIT_EXCEEDED = 'PLAN_LIMIT_EXCEEDED',\n  INSUFFICIENT_PERMISSIONS = 'INSUFFICIENT_PERMISSIONS',\n  BUSINESS_RULE_VIOLATION = 'BUSINESS_RULE_VIOLATION',\n  ACCOUNT_DEACTIVATED = 'ACCOUNT_DEACTIVATED',\n  SUBSCRIPTION_EXPIRED = 'SUBSCRIPTION_EXPIRED',\n  SUBSCRIPTION_CANCELLED = 'SUBSCRIPTION_CANCELLED',\n  SUBSCRIPTION_PAUSED = 'SUBSCRIPTION_PAUSED',\n  TRIAL_EXPIRED = 'TRIAL_EXPIRED',\n  ORDER_ALREADY_EXISTS = 'ORDER_ALREADY_EXISTS',\n  PRODUCT_OUT_OF_STOCK = 'PRODUCT_OUT_OF_STOCK',\n  INVALID_ORDER_STATUS = 'INVALID_ORDER_STATUS',\n  PAYMENT_FAILED = 'PAYMENT_FAILED',\n  INVALID_PAYMENT_METHOD = 'INVALID_PAYMENT_METHOD',\n  \n  // Resource Specific Errors\n  EMAIL_EXISTS = 'EMAIL_EXISTS',\n  PHONE_EXISTS = 'PHONE_EXISTS',\n  USER_NOT_FOUND = 'USER_NOT_FOUND',\n  MERCHANT_NOT_FOUND = 'MERCHANT_NOT_FOUND',\n  OUTLET_NOT_FOUND = 'OUTLET_NOT_FOUND',\n  PRODUCT_NOT_FOUND = 'PRODUCT_NOT_FOUND',\n  ORDER_NOT_FOUND = 'ORDER_NOT_FOUND',\n  CUSTOMER_NOT_FOUND = 'CUSTOMER_NOT_FOUND',\n  CATEGORY_NOT_FOUND = 'CATEGORY_NOT_FOUND',\n  PLAN_NOT_FOUND = 'PLAN_NOT_FOUND',\n  SUBSCRIPTION_NOT_FOUND = 'SUBSCRIPTION_NOT_FOUND',\n  PAYMENT_NOT_FOUND = 'PAYMENT_NOT_FOUND',\n  AUDIT_LOG_NOT_FOUND = 'AUDIT_LOG_NOT_FOUND',\n  BILLING_CYCLE_NOT_FOUND = 'BILLING_CYCLE_NOT_FOUND',\n  PLAN_VARIANT_NOT_FOUND = 'PLAN_VARIANT_NOT_FOUND',\n  \n  // System Errors\n  INTERNAL_SERVER_ERROR = 'INTERNAL_SERVER_ERROR',\n  SERVICE_UNAVAILABLE = 'SERVICE_UNAVAILABLE',\n  NETWORK_ERROR = 'NETWORK_ERROR',\n  \n  // File Upload Errors\n  FILE_TOO_LARGE = 'FILE_TOO_LARGE',\n  INVALID_FILE_TYPE = 'INVALID_FILE_TYPE',\n  UPLOAD_FAILED = 'UPLOAD_FAILED'\n}\n\n// ============================================================================\n// ERROR RESPONSE TYPES - Unified Format\n// ============================================================================\n\nexport interface ApiErrorResponse {\n  success: false;\n  message: string;\n  error: ErrorCode;\n  details?: string;\n  field?: string;\n}\n\nexport interface ApiSuccessResponse<T = any> {\n  success: true;\n  data: T;\n  message?: string;\n}\n\nexport type ApiResponse<T = any> = ApiSuccessResponse<T> | ApiErrorResponse;\n\n// ============================================================================\n// TYPE GUARDS - Type-safe response checking\n// ============================================================================\n\nexport function isSuccessResponse<T>(response: ApiResponse<T>): response is ApiSuccessResponse<T> {\n  return response.success === true;\n}\n\nexport function isErrorResponse(response: ApiResponse<any>): response is ApiErrorResponse {\n  return response.success === false;\n}\n\n// ============================================================================\n// ERROR MESSAGE MAPPINGS - DRY and Consistent\n// ============================================================================\n\nexport const ERROR_MESSAGES: Record<ErrorCode, string> = {\n  // Authentication & Authorization\n  [ErrorCode.UNAUTHORIZED]: 'Authentication required',\n  [ErrorCode.FORBIDDEN]: 'Access denied',\n  [ErrorCode.INVALID_TOKEN]: 'Invalid authentication token',\n  [ErrorCode.TOKEN_EXPIRED]: 'Authentication token has expired',\n  [ErrorCode.INVALID_CREDENTIALS]: 'Invalid email or password',\n  \n  // Validation Errors\n  [ErrorCode.VALIDATION_ERROR]: 'Input validation failed',\n  [ErrorCode.INVALID_INPUT]: 'Invalid input provided',\n  [ErrorCode.MISSING_REQUIRED_FIELD]: 'Required field is missing',\n  \n  // Database Errors\n  [ErrorCode.DATABASE_ERROR]: 'Database operation failed',\n  [ErrorCode.DUPLICATE_ENTRY]: 'Record already exists',\n  [ErrorCode.FOREIGN_KEY_CONSTRAINT]: 'Invalid reference',\n  [ErrorCode.NOT_FOUND]: 'Resource not found',\n  \n  // Business Logic Errors\n  [ErrorCode.PLAN_LIMIT_EXCEEDED]: 'Plan limit exceeded',\n  [ErrorCode.INSUFFICIENT_PERMISSIONS]: 'Insufficient permissions',\n  [ErrorCode.BUSINESS_RULE_VIOLATION]: 'Business rule violation',\n  [ErrorCode.ACCOUNT_DEACTIVATED]: 'Account is deactivated',\n  [ErrorCode.SUBSCRIPTION_EXPIRED]: 'Subscription has expired',\n  [ErrorCode.SUBSCRIPTION_CANCELLED]: 'Subscription has been cancelled',\n  [ErrorCode.SUBSCRIPTION_PAUSED]: 'Subscription is paused',\n  [ErrorCode.TRIAL_EXPIRED]: 'Trial period has expired',\n  [ErrorCode.ORDER_ALREADY_EXISTS]: 'Order already exists',\n  [ErrorCode.PRODUCT_OUT_OF_STOCK]: 'Product is out of stock',\n  [ErrorCode.INVALID_ORDER_STATUS]: 'Invalid order status',\n  [ErrorCode.PAYMENT_FAILED]: 'Payment processing failed',\n  [ErrorCode.INVALID_PAYMENT_METHOD]: 'Invalid payment method',\n  \n  // Resource Specific Errors\n  [ErrorCode.EMAIL_EXISTS]: 'Email address is already registered',\n  [ErrorCode.PHONE_EXISTS]: 'Phone number is already registered',\n  [ErrorCode.USER_NOT_FOUND]: 'User not found',\n  [ErrorCode.MERCHANT_NOT_FOUND]: 'Merchant not found',\n  [ErrorCode.OUTLET_NOT_FOUND]: 'Outlet not found',\n  [ErrorCode.PRODUCT_NOT_FOUND]: 'Product not found',\n  [ErrorCode.ORDER_NOT_FOUND]: 'Order not found',\n  [ErrorCode.CUSTOMER_NOT_FOUND]: 'Customer not found',\n  [ErrorCode.CATEGORY_NOT_FOUND]: 'Category not found',\n  [ErrorCode.PLAN_NOT_FOUND]: 'Plan not found',\n  [ErrorCode.SUBSCRIPTION_NOT_FOUND]: 'Subscription not found',\n  [ErrorCode.PAYMENT_NOT_FOUND]: 'Payment not found',\n  [ErrorCode.AUDIT_LOG_NOT_FOUND]: 'Audit log not found',\n  [ErrorCode.BILLING_CYCLE_NOT_FOUND]: 'Billing cycle not found',\n  [ErrorCode.PLAN_VARIANT_NOT_FOUND]: 'Plan variant not found',\n  \n  // System Errors\n  [ErrorCode.INTERNAL_SERVER_ERROR]: 'Internal server error',\n  [ErrorCode.SERVICE_UNAVAILABLE]: 'Service temporarily unavailable',\n  [ErrorCode.NETWORK_ERROR]: 'Network error occurred',\n  \n  // File Upload Errors\n  [ErrorCode.FILE_TOO_LARGE]: 'File size exceeds limit',\n  [ErrorCode.INVALID_FILE_TYPE]: 'Invalid file type',\n  [ErrorCode.UPLOAD_FAILED]: 'File upload failed'\n};\n\n// ============================================================================\n// HTTP STATUS CODE MAPPINGS - DRY and Consistent\n// ============================================================================\n\nexport const ERROR_STATUS_CODES: Record<ErrorCode, number> = {\n  // Authentication & Authorization (4xx)\n  [ErrorCode.UNAUTHORIZED]: 401,\n  [ErrorCode.FORBIDDEN]: 403,\n  [ErrorCode.INVALID_TOKEN]: 401,\n  [ErrorCode.TOKEN_EXPIRED]: 401,\n  [ErrorCode.INVALID_CREDENTIALS]: 401,\n  \n  // Validation Errors (4xx)\n  [ErrorCode.VALIDATION_ERROR]: 400,\n  [ErrorCode.INVALID_INPUT]: 400,\n  [ErrorCode.MISSING_REQUIRED_FIELD]: 400,\n  \n  // Database Errors (4xx/5xx)\n  [ErrorCode.DATABASE_ERROR]: 500,\n  [ErrorCode.DUPLICATE_ENTRY]: 409,\n  [ErrorCode.FOREIGN_KEY_CONSTRAINT]: 400,\n  [ErrorCode.NOT_FOUND]: 404,\n  \n  // Business Logic Errors (4xx)\n  [ErrorCode.PLAN_LIMIT_EXCEEDED]: 403,\n  [ErrorCode.INSUFFICIENT_PERMISSIONS]: 403,\n  [ErrorCode.BUSINESS_RULE_VIOLATION]: 422,\n  [ErrorCode.ACCOUNT_DEACTIVATED]: 403,\n  [ErrorCode.SUBSCRIPTION_EXPIRED]: 402,\n  [ErrorCode.SUBSCRIPTION_CANCELLED]: 402,\n  [ErrorCode.SUBSCRIPTION_PAUSED]: 402,\n  [ErrorCode.TRIAL_EXPIRED]: 402,\n  [ErrorCode.ORDER_ALREADY_EXISTS]: 409,\n  [ErrorCode.PRODUCT_OUT_OF_STOCK]: 422,\n  [ErrorCode.INVALID_ORDER_STATUS]: 422,\n  [ErrorCode.PAYMENT_FAILED]: 402,\n  [ErrorCode.INVALID_PAYMENT_METHOD]: 400,\n  \n  // Resource Specific Errors (4xx)\n  [ErrorCode.EMAIL_EXISTS]: 409,\n  [ErrorCode.PHONE_EXISTS]: 409,\n  [ErrorCode.USER_NOT_FOUND]: 404,\n  [ErrorCode.MERCHANT_NOT_FOUND]: 404,\n  [ErrorCode.OUTLET_NOT_FOUND]: 404,\n  [ErrorCode.PRODUCT_NOT_FOUND]: 404,\n  [ErrorCode.ORDER_NOT_FOUND]: 404,\n  [ErrorCode.CUSTOMER_NOT_FOUND]: 404,\n  [ErrorCode.CATEGORY_NOT_FOUND]: 404,\n  [ErrorCode.PLAN_NOT_FOUND]: 404,\n  [ErrorCode.SUBSCRIPTION_NOT_FOUND]: 404,\n  [ErrorCode.PAYMENT_NOT_FOUND]: 404,\n  [ErrorCode.AUDIT_LOG_NOT_FOUND]: 404,\n  [ErrorCode.BILLING_CYCLE_NOT_FOUND]: 404,\n  [ErrorCode.PLAN_VARIANT_NOT_FOUND]: 404,\n  \n  // System Errors (5xx)\n  [ErrorCode.INTERNAL_SERVER_ERROR]: 500,\n  [ErrorCode.SERVICE_UNAVAILABLE]: 503,\n  [ErrorCode.NETWORK_ERROR]: 503,\n  \n  // File Upload Errors (4xx)\n  [ErrorCode.FILE_TOO_LARGE]: 413,\n  [ErrorCode.INVALID_FILE_TYPE]: 400,\n  [ErrorCode.UPLOAD_FAILED]: 500\n};\n\n// ============================================================================\n// ERROR CLASSES - Unified and Simplified\n// ============================================================================\n\nexport class ApiError extends Error {\n  public readonly code: ErrorCode;\n  public readonly statusCode: number;\n  public readonly details?: string;\n  public readonly field?: string;\n\n  constructor(\n    code: ErrorCode,\n    message?: string,\n    details?: string,\n    field?: string\n  ) {\n    const errorMessage = message || ERROR_MESSAGES[code];\n    super(errorMessage);\n    \n    this.name = 'ApiError';\n    this.code = code;\n    this.statusCode = ERROR_STATUS_CODES[code];\n    this.details = details;\n    this.field = field;\n  }\n\n  toResponse(): ApiErrorResponse {\n    return {\n      success: false,\n      message: this.message,\n      error: this.code,\n      details: this.details,\n      field: this.field\n    };\n  }\n}\n\n// ============================================================================\n// CONVENIENCE ERROR CLASSES\n// ============================================================================\n\nexport class ValidationError extends ApiError {\n  constructor(message: string, details?: string, field?: string) {\n    super(ErrorCode.VALIDATION_ERROR, message, details, field);\n    this.name = 'ValidationError';\n  }\n}\n\nexport class DuplicateError extends ApiError {\n  constructor(code: ErrorCode, message?: string, details?: string, field?: string) {\n    super(code, message, details, field);\n    this.name = 'DuplicateError';\n  }\n}\n\nexport class NotFoundError extends ApiError {\n  constructor(code: ErrorCode, message?: string, details?: string) {\n    super(code, message, details);\n    this.name = 'NotFoundError';\n  }\n}\n\nexport class UnauthorizedError extends ApiError {\n  constructor(message?: string, details?: string) {\n    super(ErrorCode.UNAUTHORIZED, message, details);\n    this.name = 'UnauthorizedError';\n  }\n}\n\nexport class ForbiddenError extends ApiError {\n  constructor(message?: string, details?: string) {\n    super(ErrorCode.FORBIDDEN, message, details);\n    this.name = 'ForbiddenError';\n  }\n}\n\nexport class PlanLimitError extends ApiError {\n  constructor(message?: string, details?: string) {\n    super(ErrorCode.PLAN_LIMIT_EXCEEDED, message, details);\n    this.name = 'PlanLimitError';\n  }\n}\n\n// ============================================================================\n// ERROR RESPONSE BUILDERS - DRY and Consistent\n// ============================================================================\n\nexport function createErrorResponse(\n  code: ErrorCode,\n  message?: string,\n  details?: string,\n  field?: string\n): ApiErrorResponse {\n  return {\n    success: false,\n    message: message || ERROR_MESSAGES[code],\n    error: code,\n    details,\n    field\n  };\n}\n\nexport function createSuccessResponse<T>(\n  data: T,\n  message?: string\n): ApiSuccessResponse<T> {\n  return {\n    success: true,\n    data,\n    message\n  };\n}\n\n// ============================================================================\n// DATABASE ERROR HANDLERS - Unified and Comprehensive\n// ============================================================================\n\nexport function handlePrismaError(error: any): ApiError {\n  console.error('🔍 Prisma Error Details:', {\n    code: error.code,\n    message: error.message,\n    meta: error.meta\n  });\n\n  switch (error.code) {\n    case 'P2002': {\n      // Unique constraint violation\n      const target = error.meta?.target;\n      const field = Array.isArray(target) ? target[0] : target;\n      \n      if (field?.includes('email')) {\n        return new ApiError(\n          ErrorCode.EMAIL_EXISTS,\n          `Email address is already registered`,\n          `Field: ${field}`,\n          'email'\n        );\n      }\n      \n      if (field?.includes('phone')) {\n        return new ApiError(\n          ErrorCode.PHONE_EXISTS,\n          `Phone number is already registered`,\n          `Field: ${field}`,\n          'phone'\n        );\n      }\n      \n      return new ApiError(\n        ErrorCode.DUPLICATE_ENTRY,\n        'Record with this information already exists',\n        `Field: ${field}`\n      );\n    }\n    \n    case 'P2003': {\n      // Foreign key constraint violation\n      const fieldName = error.meta?.field_name;\n      return new ApiError(\n        ErrorCode.FOREIGN_KEY_CONSTRAINT,\n        `Invalid reference: ${fieldName}`,\n        `Field: ${fieldName}`\n      );\n    }\n    \n    case 'P2025': {\n      // Record not found\n      return new ApiError(\n        ErrorCode.NOT_FOUND,\n        'Record not found',\n        error.message\n      );\n    }\n    \n    case 'P2014': {\n      // Relation violation\n      return new ApiError(\n        ErrorCode.BUSINESS_RULE_VIOLATION,\n        'Cannot perform this operation due to existing relationships',\n        error.message\n      );\n    }\n    \n    default: {\n      return new ApiError(\n        ErrorCode.DATABASE_ERROR,\n        'Database operation failed',\n        error.message\n      );\n    }\n  }\n}\n\n// ============================================================================\n// VALIDATION ERROR HANDLERS\n// ============================================================================\n\nexport function handleValidationError(error: any): ApiError {\n  if (error.name === 'ZodError') {\n    const firstError = error.errors[0];\n    const field = firstError.path.join('.');\n    \n    return new ApiError(\n      ErrorCode.VALIDATION_ERROR,\n      firstError.message,\n      `Field: ${field}`,\n      field\n    );\n  }\n  \n  return new ApiError(\n    ErrorCode.INVALID_INPUT,\n    error.message || 'Validation failed'\n  );\n}\n\n// ============================================================================\n// BUSINESS LOGIC ERROR HANDLERS\n// ============================================================================\n\nexport function handleBusinessError(error: any): ApiError {\n  if (error instanceof ApiError) {\n    return error;\n  }\n  \n  if (error.message?.includes('not found')) {\n    if (error.message.includes('Merchant')) {\n      return new ApiError(ErrorCode.MERCHANT_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Outlet')) {\n      return new ApiError(ErrorCode.OUTLET_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('User')) {\n      return new ApiError(ErrorCode.USER_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Product')) {\n      return new ApiError(ErrorCode.PRODUCT_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Order')) {\n      return new ApiError(ErrorCode.ORDER_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Customer')) {\n      return new ApiError(ErrorCode.CUSTOMER_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Category')) {\n      return new ApiError(ErrorCode.CATEGORY_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Plan')) {\n      return new ApiError(ErrorCode.PLAN_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Subscription')) {\n      return new ApiError(ErrorCode.SUBSCRIPTION_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Payment')) {\n      return new ApiError(ErrorCode.PAYMENT_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Audit log')) {\n      return new ApiError(ErrorCode.AUDIT_LOG_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Billing cycle')) {\n      return new ApiError(ErrorCode.BILLING_CYCLE_NOT_FOUND, error.message);\n    }\n    if (error.message.includes('Plan variant')) {\n      return new ApiError(ErrorCode.PLAN_VARIANT_NOT_FOUND, error.message);\n    }\n  }\n  \n  if (error.message?.includes('already registered')) {\n    if (error.message.includes('Email')) {\n      return new ApiError(ErrorCode.EMAIL_EXISTS, error.message);\n    }\n    if (error.message.includes('Phone')) {\n      return new ApiError(ErrorCode.PHONE_EXISTS, error.message);\n    }\n  }\n  \n  if (error.message?.includes('already exists')) {\n    if (error.message.includes('order')) {\n      return new ApiError(ErrorCode.ORDER_ALREADY_EXISTS, error.message);\n    }\n  }\n  \n  if (error.message?.includes('Plan limit')) {\n    return new ApiError(ErrorCode.PLAN_LIMIT_EXCEEDED, error.message);\n  }\n  \n  if (error.message?.includes('permission')) {\n    return new ApiError(ErrorCode.INSUFFICIENT_PERMISSIONS, error.message);\n  }\n  \n  if (error.message?.includes('deactivated')) {\n    return new ApiError(ErrorCode.ACCOUNT_DEACTIVATED, error.message);\n  }\n  \n  if (error.message?.includes('subscription')) {\n    if (error.message.includes('expired')) {\n      return new ApiError(ErrorCode.SUBSCRIPTION_EXPIRED, error.message);\n    }\n    if (error.message.includes('cancelled')) {\n      return new ApiError(ErrorCode.SUBSCRIPTION_CANCELLED, error.message);\n    }\n    if (error.message.includes('paused')) {\n      return new ApiError(ErrorCode.SUBSCRIPTION_PAUSED, error.message);\n    }\n  }\n  \n  if (error.message?.includes('trial')) {\n    if (error.message.includes('expired')) {\n      return new ApiError(ErrorCode.TRIAL_EXPIRED, error.message);\n    }\n  }\n  \n  if (error.message?.includes('out of stock')) {\n    return new ApiError(ErrorCode.PRODUCT_OUT_OF_STOCK, error.message);\n  }\n  \n  if (error.message?.includes('payment')) {\n    if (error.message.includes('failed')) {\n      return new ApiError(ErrorCode.PAYMENT_FAILED, error.message);\n    }\n    if (error.message.includes('invalid')) {\n      return new ApiError(ErrorCode.INVALID_PAYMENT_METHOD, error.message);\n    }\n  }\n  \n  if (error.message?.includes('invalid order status')) {\n    return new ApiError(ErrorCode.INVALID_ORDER_STATUS, error.message);\n  }\n  \n  return new ApiError(\n    ErrorCode.BUSINESS_RULE_VIOLATION,\n    error.message || 'Business rule violation'\n  );\n}\n\n// ============================================================================\n// GLOBAL ERROR HANDLER - DRY and Comprehensive\n// ============================================================================\n\nexport function handleApiError(error: any): {\n  response: ApiErrorResponse;\n  statusCode: number;\n} {\n  console.error('🚨 API Error:', error);\n  \n  let apiError: ApiError;\n  \n  // Handle different error types\n  if (error instanceof ApiError) {\n    apiError = error;\n  } else if (error.code && error.code.startsWith('P')) {\n    // Prisma errors\n    apiError = handlePrismaError(error);\n  } else if (error.name === 'ZodError') {\n    // Validation errors\n    apiError = handleValidationError(error);\n  } else {\n    // Business logic or other errors\n    apiError = handleBusinessError(error);\n  }\n  \n  const response = createErrorResponse(\n    apiError.code,\n    apiError.message,\n    apiError.details,\n    apiError.field\n  );\n\n  return {\n    response,\n    statusCode: apiError.statusCode\n  };\n}\n\n// ============================================================================\n// ERROR ANALYSIS & HANDLING (from error-handling.ts)\n// ============================================================================\n\n/**\n * Error types for better user experience\n */\nexport type ErrorType = 'auth' | 'permission' | 'subscription' | 'network' | 'validation' | 'unknown';\n\n/**\n * Enhanced error information for better handling\n */\nexport interface ErrorInfo {\n  type: ErrorType;\n  message: string;\n  title: string;\n  showLoginButton: boolean;\n  originalError: any;\n}\n\n/**\n * Check if an error is authentication-related (401)\n */\nexport const isAuthError = (error: any): boolean => {\n  return (\n    error?.message?.includes('Authentication required') ||\n    error?.message?.includes('Unauthorized') ||\n    error?.message?.includes('Invalid token') ||\n    error?.message?.includes('Token expired') ||\n    error?.status === API.STATUS.UNAUTHORIZED ||\n    error?.status === 401\n  );\n};\n\n/**\n * Check if an error is permission-related (403)\n */\nexport const isPermissionError = (error: any): boolean => {\n  return (\n    error?.message?.includes('Forbidden') ||\n    error?.message?.includes('Access denied') ||\n    error?.message?.includes('Insufficient permissions') ||\n    error?.status === API.STATUS.FORBIDDEN ||\n    error?.status === 403\n  );\n};\n\n/**\n * Check if an error is subscription-related (402)\n */\nconst isSubscriptionErrorNew = (error: any): boolean => {\n  if (!error) return false;\n\n  const message = error.message || error.error || '';\n  const code = error.code || '';\n\n  return (\n    code === 'PLAN_LIMIT_EXCEEDED' ||\n    message.toLowerCase().includes('subscription') ||\n    message.toLowerCase().includes('plan limit') ||\n    message.toLowerCase().includes('trial expired') ||\n    message.toLowerCase().includes('cancelled') ||\n    message.toLowerCase().includes('expired') ||\n    message.toLowerCase().includes('suspended') ||\n    message.toLowerCase().includes('past due') ||\n    message.toLowerCase().includes('paused')\n  );\n};\n\n/**\n * Check if an error is network-related\n */\nexport const isNetworkError = (error: any): boolean => {\n  return (\n    error?.message?.includes('Network Error') ||\n    error?.message?.includes('Failed to fetch') ||\n    error?.message?.includes('Connection failed') ||\n    error?.status === API.STATUS.SERVICE_UNAVAILABLE ||\n    error?.status === 503\n  );\n};\n\n/**\n * Check if an error is validation-related (400)\n */\nexport const isValidationError = (error: any): boolean => {\n  return (\n    error?.message?.includes('Validation failed') ||\n    error?.message?.includes('Invalid input') ||\n    error?.message?.includes('Required field') ||\n    error?.status === API.STATUS.BAD_REQUEST ||\n    error?.status === 400\n  );\n};\n\n/**\n * Analyze error and provide enhanced information\n */\nexport const analyzeError = (error: any): ErrorInfo => {\n  console.log('🔍 analyzeError called with:', error);\n\n  // Authentication errors\n  if (isAuthError(error)) {\n    console.log('🔍 analyzeError: Detected auth error, clearing auth data');\n    clearAuthData();\n    \n    return {\n      type: 'auth',\n      message: 'Your session has expired. Please log in again.',\n      title: 'Session Expired',\n      showLoginButton: true,\n      originalError: error\n    };\n  }\n\n  // Permission errors\n  if (isPermissionError(error)) {\n    return {\n      type: 'permission',\n      message: 'You do not have permission to perform this action.',\n      title: 'Access Denied',\n      showLoginButton: false,\n      originalError: error\n    };\n  }\n\n  // Subscription errors\n  if (isSubscriptionErrorNew(error)) {\n    return {\n      type: 'subscription',\n      message: 'Your subscription has expired or been cancelled. Please renew to continue.',\n      title: 'Subscription Issue',\n      showLoginButton: false,\n      originalError: error\n    };\n  }\n\n  // Network errors\n  if (isNetworkError(error)) {\n    return {\n      type: 'network',\n      message: 'Network connection failed. Please check your internet connection and try again.',\n      title: 'Connection Error',\n      showLoginButton: false,\n      originalError: error\n    };\n  }\n\n  // Validation errors\n  if (isValidationError(error)) {\n    return {\n      type: 'validation',\n      message: 'Please check your input and try again.',\n      title: 'Invalid Input',\n      showLoginButton: false,\n      originalError: error\n    };\n  }\n\n  // Unknown errors\n  return {\n    type: 'unknown',\n    message: 'An unexpected error occurred. Please try again later.',\n    title: 'Error',\n    showLoginButton: false,\n    originalError: error\n  };\n}; ","// ============================================================================\n// REFACTORED PRICING CALCULATOR SYSTEM\n// ============================================================================\n\nimport { Plan, Product, Merchant, PricingType, BusinessType, PricingDurationLimits, PricingBusinessRules } from '@rentalshop/types';\nimport { BillingInterval, BUSINESS_TYPE_DEFAULTS } from '@rentalshop/constants';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface PricingBreakdown {\n  basePrice: number;\n  totalPrice: number;\n  discount: number;\n  discountAmount: number;\n  finalPrice: number;\n  monthlyEquivalent: number;\n  billingInterval: BillingInterval;\n  totalMonths: number;\n}\n\nexport interface PricingConfig {\n  discounts: {\n    month: number;\n    quarter: number;\n    semiAnnual: number;\n    year: number;\n  };\n  intervals: {\n    month: { interval: BillingInterval; intervalCount: number };\n    quarter: { interval: BillingInterval; intervalCount: number };\n    semiAnnual: { interval: BillingInterval; intervalCount: number };\n    year: { interval: BillingInterval; intervalCount: number };\n  };\n}\n\n// ============================================================================\n// PRICING RESOLUTION INTERFACES (from pricing-resolver.ts)\n// ============================================================================\n\nexport interface PricingInfo {\n  pricingType: PricingType;\n  pricePerUnit: number;\n  minDuration: number;\n  maxDuration: number;\n  requireRentalDates: boolean;\n  showPricingOptions: boolean;\n}\n\nexport interface CalculatedPricing {\n  unitPrice: number;\n  totalPrice: number;\n  deposit: number;\n  pricingType: PricingType;\n  duration?: number;\n  durationUnit?: string;\n}\n\n// ============================================================================\n// VALIDATION INTERFACES (from pricing-validation.ts)\n// ============================================================================\n\nexport interface ValidationResult {\n  isValid: boolean;\n  error?: string;\n  warning?: string;\n  suggestions?: string[];\n}\n\nexport interface RentalPeriodValidation {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n  suggestions: string[];\n}\n\n// ============================================================================\n// DISCOUNT CALCULATOR\n// ============================================================================\n\nexport class DiscountCalculator {\n  private config: PricingConfig;\n\n  constructor(config: PricingConfig) {\n    this.config = config;\n  }\n\n  /**\n   * Calculate discount amount for billing interval\n   */\n  calculateDiscount(totalPrice: number, billingInterval: BillingInterval): {\n    discount: number;\n    discountAmount: number;\n  } {\n    const discountPercentage = this.getDiscountPercentage(billingInterval);\n    const discountAmount = (totalPrice * discountPercentage) / 100;\n\n    return {\n      discount: discountPercentage,\n      discountAmount\n    };\n  }\n\n  /**\n   * Get discount percentage for billing interval\n   */\n  private getDiscountPercentage(billingInterval: BillingInterval): number {\n    return this.config.discounts[billingInterval] || 0;\n  }\n}\n\n// ============================================================================\n// BILLING INTERVAL CALCULATOR\n// ============================================================================\n\nexport class BillingIntervalCalculator {\n  private config: PricingConfig;\n\n  constructor(config: PricingConfig) {\n    this.config = config;\n  }\n\n  /**\n   * Get total months for billing interval\n   */\n  getTotalMonths(billingInterval: BillingInterval): number {\n    const intervalMap = {\n      month: 1,\n      quarter: 3,\n      semiAnnual: 6,\n      year: 12\n    };\n\n    return intervalMap[billingInterval] || 1;\n  }\n\n  /**\n   * Get all available billing intervals\n   */\n  getAllIntervals(): BillingInterval[] {\n    return ['month', 'quarter', 'semiAnnual', 'year'];\n  }\n}\n\n// ============================================================================\n// PRORATION CALCULATOR\n// ============================================================================\n\nexport class ProrationCalculator {\n  private discountCalculator: DiscountCalculator;\n  private intervalCalculator: BillingIntervalCalculator;\n\n  constructor(config: PricingConfig) {\n    this.discountCalculator = new DiscountCalculator(config);\n    this.intervalCalculator = new BillingIntervalCalculator(config);\n  }\n\n  /**\n   * Calculate prorated amount for plan changes\n   */\n  calculateProratedAmount(\n    currentPlan: Plan,\n    newPlan: Plan,\n    billingInterval: BillingInterval,\n    daysRemaining: number\n  ): {\n    currentPlanRefund: number;\n    newPlanCharge: number;\n    netAmount: number;\n  } {\n    // Calculate total months for the billing interval\n    const totalMonths = this.intervalCalculator.getTotalMonths(billingInterval);\n\n    // Calculate daily rates\n    const currentDailyRate = (currentPlan.basePrice * totalMonths) / (totalMonths * 30);\n    const newDailyRate = (newPlan.basePrice * totalMonths) / (totalMonths * 30);\n\n    // Calculate refund for current plan\n    const currentPlanRefund = currentDailyRate * daysRemaining;\n\n    // Calculate charge for new plan\n    const newPlanCharge = newDailyRate * daysRemaining;\n\n    // Net amount (positive means customer owes money, negative means refund)\n    const netAmount = newPlanCharge - currentPlanRefund;\n\n    return {\n      currentPlanRefund,\n      newPlanCharge,\n      netAmount\n    };\n  }\n}\n\n// ============================================================================\n// PRICE FORMATTER\n// ============================================================================\n\nexport class PriceFormatter {\n  /**\n   * Format price for display\n   */\n  static formatPrice(price: number, currency: string = 'USD'): string {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: currency,\n      minimumFractionDigits: 2\n    }).format(price);\n  }\n\n  /**\n   * Format discount for display\n   */\n  static formatDiscount(discount: number): string {\n    if (discount === 0) {\n      return 'No discount';\n    }\n    return `${discount}% off`;\n  }\n\n  /**\n   * Format billing interval for display\n   */\n  static formatBillingInterval(interval: BillingInterval): string {\n    const intervalMap = {\n      month: 'Monthly',\n      quarter: 'Quarterly',\n      semiAnnual: 'Semi-Annual',\n      year: 'Yearly'\n    };\n\n    return intervalMap[interval] || interval;\n  }\n}\n\n// ============================================================================\n// PRICING COMPARISON ENGINE\n// ============================================================================\n\nexport class PricingComparisonEngine {\n  private discountCalculator: DiscountCalculator;\n  private intervalCalculator: BillingIntervalCalculator;\n\n  constructor(config: PricingConfig) {\n    this.discountCalculator = new DiscountCalculator(config);\n    this.intervalCalculator = new BillingIntervalCalculator(config);\n  }\n\n  /**\n   * Get pricing comparison between two plans\n   */\n  getPricingComparison(\n    plan1: Plan,\n    plan2: Plan,\n    billingInterval: BillingInterval\n  ): {\n    plan1: PricingBreakdown;\n    plan2: PricingBreakdown;\n    difference: number;\n    savings: number;\n  } {\n    const plan1Pricing = this.calculatePricingBreakdown(plan1, billingInterval);\n    const plan2Pricing = this.calculatePricingBreakdown(plan2, billingInterval);\n    const difference = plan2Pricing.finalPrice - plan1Pricing.finalPrice;\n    const savings = Math.abs(difference);\n\n    return {\n      plan1: plan1Pricing,\n      plan2: plan2Pricing,\n      difference,\n      savings\n    };\n  }\n\n  /**\n   * Calculate pricing breakdown for a plan\n   */\n  private calculatePricingBreakdown(plan: Plan, billingInterval: BillingInterval): PricingBreakdown {\n    const totalMonths = this.intervalCalculator.getTotalMonths(billingInterval);\n    const totalPrice = plan.basePrice * totalMonths;\n    const discountInfo = this.discountCalculator.calculateDiscount(totalPrice, billingInterval);\n    const finalPrice = totalPrice - discountInfo.discountAmount;\n    const monthlyEquivalent = finalPrice / totalMonths;\n\n    return {\n      basePrice: plan.basePrice,\n      totalPrice,\n      discount: discountInfo.discount,\n      discountAmount: discountInfo.discountAmount,\n      finalPrice,\n      monthlyEquivalent,\n      billingInterval,\n      totalMonths\n    };\n  }\n}\n\n// ============================================================================\n// MAIN PRICING CALCULATOR (SIMPLIFIED)\n// ============================================================================\n\nexport class PricingCalculator {\n  private config: PricingConfig;\n  private discountCalculator: DiscountCalculator;\n  private intervalCalculator: BillingIntervalCalculator;\n  private prorationCalculator: ProrationCalculator;\n  private comparisonEngine: PricingComparisonEngine;\n\n  constructor(config: PricingConfig = DEFAULT_PRICING_CONFIG) {\n    this.config = config;\n    this.discountCalculator = new DiscountCalculator(config);\n    this.intervalCalculator = new BillingIntervalCalculator(config);\n    this.prorationCalculator = new ProrationCalculator(config);\n    this.comparisonEngine = new PricingComparisonEngine(config);\n  }\n\n  /**\n   * Calculate subscription price based on plan and billing interval\n   */\n  calculateSubscriptionPrice(plan: Plan, billingInterval: BillingInterval): number {\n    const breakdown = this.getPricingBreakdown(plan, billingInterval);\n    return breakdown.finalPrice;\n  }\n\n  /**\n   * Get detailed pricing breakdown\n   */\n  getPricingBreakdown(plan: Plan, billingInterval: BillingInterval): PricingBreakdown {\n    const totalMonths = this.intervalCalculator.getTotalMonths(billingInterval);\n    const totalPrice = plan.basePrice * totalMonths;\n    const discountInfo = this.discountCalculator.calculateDiscount(totalPrice, billingInterval);\n    const finalPrice = totalPrice - discountInfo.discountAmount;\n    const monthlyEquivalent = finalPrice / totalMonths;\n\n    return {\n      basePrice: plan.basePrice,\n      totalPrice,\n      discount: discountInfo.discount,\n      discountAmount: discountInfo.discountAmount,\n      finalPrice,\n      monthlyEquivalent,\n      billingInterval,\n      totalMonths\n    };\n  }\n\n  /**\n   * Get all pricing options for a plan\n   */\n  getAllPricingOptions(plan: Plan): Record<BillingInterval, PricingBreakdown> {\n    const intervals = this.intervalCalculator.getAllIntervals();\n    const pricing: Record<BillingInterval, PricingBreakdown> = {} as any;\n\n    for (const interval of intervals) {\n      pricing[interval] = this.getPricingBreakdown(plan, interval);\n    }\n\n    return pricing;\n  }\n\n  /**\n   * Get pricing comparison between two plans\n   */\n  getPricingComparison(plan1: Plan, plan2: Plan, billingInterval: BillingInterval) {\n    return this.comparisonEngine.getPricingComparison(plan1, plan2, billingInterval);\n  }\n\n  /**\n   * Calculate prorated amount for plan changes\n   */\n  calculateProratedAmount(\n    currentPlan: Plan,\n    newPlan: Plan,\n    billingInterval: BillingInterval,\n    daysRemaining: number\n  ) {\n    return this.prorationCalculator.calculateProratedAmount(\n      currentPlan,\n      newPlan,\n      billingInterval,\n      daysRemaining\n    );\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfig(newConfig: PricingConfig): void {\n    this.config = newConfig;\n    this.discountCalculator = new DiscountCalculator(newConfig);\n    this.intervalCalculator = new BillingIntervalCalculator(newConfig);\n    this.prorationCalculator = new ProrationCalculator(newConfig);\n    this.comparisonEngine = new PricingComparisonEngine(newConfig);\n  }\n\n  getConfig(): PricingConfig {\n    return { ...this.config };\n  }\n}\n\n// ============================================================================\n// FACTORY FUNCTIONS\n// ============================================================================\n\nexport function createPricingCalculator(config?: PricingConfig): PricingCalculator {\n  return new PricingCalculator(config);\n}\n\nexport function createDiscountCalculator(config: PricingConfig): DiscountCalculator {\n  return new DiscountCalculator(config);\n}\n\nexport function createBillingIntervalCalculator(config: PricingConfig): BillingIntervalCalculator {\n  return new BillingIntervalCalculator(config);\n}\n\nexport function createProrationCalculator(config: PricingConfig): ProrationCalculator {\n  return new ProrationCalculator(config);\n}\n\nexport function createPricingComparisonEngine(config: PricingConfig): PricingComparisonEngine {\n  return new PricingComparisonEngine(config);\n}\n\n// ============================================================================\n// DEFAULT CONFIG\n// ============================================================================\n\nexport const DEFAULT_PRICING_CONFIG: PricingConfig = {\n  discounts: {\n    month: 0,        // 0% discount\n    quarter: 10,     // 10% discount\n    semiAnnual: 15,  // 15% discount\n    year: 20         // 20% discount\n  },\n  intervals: {\n    month: { interval: 'month' as const, intervalCount: 1 },\n    quarter: { interval: 'month' as const, intervalCount: 3 },\n    semiAnnual: { interval: 'month' as const, intervalCount: 6 },\n    year: { interval: 'year' as const, intervalCount: 1 }\n  }\n};\n\n// ============================================================================\n// CONVENIENCE FUNCTIONS\n// ============================================================================\n\n// Export default instance\nexport const pricingCalculator = new PricingCalculator();\n\n// Export utility functions\nexport const calculateSubscriptionPrice = (plan: Plan, billingInterval: BillingInterval) =>\n  pricingCalculator.calculateSubscriptionPrice(plan, billingInterval);\n\nexport const getPricingBreakdown = (plan: Plan, billingInterval: BillingInterval) =>\n  pricingCalculator.getPricingBreakdown(plan, billingInterval);\n\nexport const getAllPricingOptions = (plan: Plan) =>\n  pricingCalculator.getAllPricingOptions(plan);\n\nexport const getPricingComparison = (plan1: Plan, plan2: Plan, billingInterval: BillingInterval) =>\n  pricingCalculator.getPricingComparison(plan1, plan2, billingInterval);\n\nexport const calculateProratedAmount = (\n  currentPlan: Plan,\n  newPlan: Plan,\n  billingInterval: BillingInterval,\n  daysRemaining: number\n) => pricingCalculator.calculateProratedAmount(currentPlan, newPlan, billingInterval, daysRemaining);\n\n// ============================================================================\n// ADDITIONAL UTILITY FUNCTIONS (for UI components)\n// ============================================================================\n\n/**\n * Format billing cycle for display\n */\nexport const formatBillingCycle = (billingInterval: BillingInterval): string => {\n  switch (billingInterval) {\n    case 'month':\n      return 'Monthly';\n    case 'quarter':\n      return 'Quarterly';\n    case 'semiAnnual':\n      return 'Semi-Annual';\n    case 'year':\n      return 'Yearly';\n    default:\n      return billingInterval;\n  }\n};\n\n/**\n * Get billing cycle discount percentage\n */\nexport const getBillingCycleDiscount = (billingInterval: BillingInterval): number => {\n  return DEFAULT_PRICING_CONFIG.discounts[billingInterval] || 0;\n};\n\n/**\n * Calculate renewal price\n */\nexport const calculateRenewalPrice = (plan: Plan, billingInterval: BillingInterval): number => {\n  return calculateSubscriptionPrice(plan, billingInterval);\n};\n\n/**\n * Calculate savings amount\n */\nexport const calculateSavings = (originalPrice: number, discountedPrice: number): number => {\n  return Math.max(0, originalPrice - discountedPrice);\n};\n\n/**\n * Get discount percentage\n */\nexport const getDiscountPercentage = (billingInterval: BillingInterval): number => {\n  return DEFAULT_PRICING_CONFIG.discounts[billingInterval] || 0;\n};\n\n/**\n * Calculate discounted price\n */\nexport const calculateDiscountedPrice = (originalPrice: number, discountPercentage: number): number => {\n  const discountAmount = originalPrice * (discountPercentage / 100);\n  return Math.max(0, originalPrice - discountAmount);\n};\n\n// ============================================================================\n// PRICING RESOLVER CLASS (from pricing-resolver.ts)\n// ============================================================================\n\nexport class PricingResolver {\n  /**\n   * Resolve pricing type cho product dựa trên merchant config\n   * Simple: Chỉ dùng pricingType từ merchant (không cần pricingConfig object)\n   */\n  static resolvePricingType(\n    product: Product,\n    merchant: Merchant\n  ): PricingType {\n    // Use pricingType directly from merchant\n    return (merchant.pricingType as PricingType) || 'FIXED';\n  }\n  \n  /**\n   * Get effective pricing config cho product\n   */\n  static getEffectivePricingConfig(\n    product: Product,\n    merchant: Merchant\n  ): PricingInfo {\n    const pricingType = this.resolvePricingType(product, merchant);\n    \n    return {\n      pricingType,\n      pricePerUnit: product.rentPrice || 0,\n      minDuration: 1,\n      maxDuration: 365,\n      requireRentalDates: false,\n      showPricingOptions: true\n    };\n  }\n\n  /**\n   * Calculate pricing cho product\n   */\n  static calculatePricing(\n    product: Product,\n    merchant: Merchant,\n    duration?: number,\n    quantity: number = 1\n  ): CalculatedPricing {\n    const config = this.getEffectivePricingConfig(product, merchant);\n    const unitPrice = config.pricePerUnit;\n    const totalPrice = unitPrice * quantity * (duration || 1);\n    \n    return {\n      unitPrice,\n      totalPrice,\n      deposit: product.deposit || 0,\n      pricingType: config.pricingType,\n      duration,\n      durationUnit: 'days'\n    };\n  }\n}\n\n// ============================================================================\n// PRICING VALIDATOR CLASS (from pricing-validation.ts)\n// ============================================================================\n\nexport class PricingValidator {\n  /**\n   * Validate rental period for a product\n   */\n  static validateRentalPeriod(\n    product: Product,\n    merchant: Merchant,\n    rentalStartAt: Date,\n    rentalEndAt: Date,\n    quantity: number = 1\n  ): RentalPeriodValidation {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n    const suggestions: string[] = [];\n\n    // Get pricing type from merchant (simplified - no need for pricingConfig object)\n    const pricingType = merchant.pricingType || 'FIXED';\n    const businessType = merchant.businessType || 'GENERAL';\n\n    // Validate rental dates\n    if (rentalStartAt >= rentalEndAt) {\n      errors.push('Rental start date must be before end date');\n    }\n\n    // Calculate duration in days\n    const durationMs = rentalEndAt.getTime() - rentalStartAt.getTime();\n    const durationDays = Math.ceil(durationMs / (1000 * 60 * 60 * 24));\n\n    // Use default duration limits (simplified)\n    const minDuration = 1;\n    const maxDuration = 365;\n    \n    if (durationDays < minDuration) {\n      errors.push(`Minimum rental duration is ${minDuration} day`);\n      suggestions.push(`Please select at least ${minDuration} day`);\n    }\n\n    if (durationDays > maxDuration) {\n      warnings.push(`Rental duration (${durationDays} days) exceeds recommended maximum (${maxDuration} days)`);\n      suggestions.push('Consider splitting into multiple rentals');\n    }\n\n    // Validate quantity\n    if (quantity <= 0) {\n      errors.push('Quantity must be greater than 0');\n    }\n\n    if (quantity > 100) {\n      warnings.push('Large quantity rental detected');\n      suggestions.push('Consider bulk pricing or contact for custom quote');\n    }\n\n    // Validate product availability\n    if (product.stock < quantity) {\n      errors.push(`Insufficient stock. Available: ${product.stock}, Requested: ${quantity}`);\n    }\n\n    // Validate pricing\n    if (!product.rentPrice || product.rentPrice <= 0) {\n      errors.push('Invalid product pricing');\n    }\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      warnings,\n      suggestions\n    };\n  }\n\n  /**\n   * Validate pricing configuration\n   */\n  static validatePricingConfig(config: any): ValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    // Check required fields\n    if (!config.defaultPricingType) {\n      errors.push('Default pricing type is required');\n    }\n\n    if (!config.durationLimits) {\n      errors.push('Duration limits are required');\n    } else {\n      if (!config.durationLimits.minDays || config.durationLimits.minDays < 1) {\n        errors.push('Minimum duration must be at least 1 day');\n      }\n      if (!config.durationLimits.maxDays || config.durationLimits.maxDays < 1) {\n        errors.push('Maximum duration must be at least 1 day');\n      }\n      if (config.durationLimits.minDays >= config.durationLimits.maxDays) {\n        errors.push('Minimum duration must be less than maximum duration');\n      }\n    }\n\n    // Check business rules\n    if (config.businessRules) {\n      if (config.businessRules.requireDeposit && config.businessRules.depositPercentage <= 0) {\n        errors.push('Deposit percentage must be greater than 0 when deposits are required');\n      }\n    }\n\n    return {\n      isValid: errors.length === 0,\n      error: errors.length > 0 ? errors.join('; ') : undefined,\n      warning: warnings.length > 0 ? warnings.join('; ') : undefined,\n      suggestions: errors.length > 0 ? ['Review pricing configuration'] : undefined\n    };\n  }\n}\n","import { PrismaClient } from '@prisma/client';\n\n// Global Prisma client instance for singleton pattern\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\n// Create a singleton Prisma client instance\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient({\n  log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],\n});\n\n// Store the instance globally in development to prevent multiple instances\nif (process.env.NODE_ENV !== 'production') {\n  globalForPrisma.prisma = prisma;\n} ","// ============================================================================\n// SIMPLIFIED SUBSCRIPTION DATABASE FUNCTIONS\n// ============================================================================\n\nimport { prisma } from './client';\nimport { calculateSubscriptionPrice, getPricingBreakdown } from '@rentalshop/utils';\nimport type { \n  Subscription, \n  Plan, \n  PlanLimits,\n  SubscriptionCreateInput, \n  SubscriptionUpdateInput,\n  SubscriptionStatus,\n  BillingInterval\n} from '@rentalshop/types';\n\n// ============================================================================\n// PRICING UTILITIES\n// ============================================================================\n\n/**\n * Generate pricing object from base price\n */\nfunction generatePricingFromBasePrice(basePrice: number) {\n  const monthlyPrice = basePrice;\n  const quarterlyPrice = monthlyPrice * 3;\n  const yearlyPrice = monthlyPrice * 12;\n  \n  return {\n    monthly: {\n      price: monthlyPrice,\n      discount: 0,\n      savings: 0\n    },\n    quarterly: {\n      price: quarterlyPrice,\n      discount: 5, // 5% discount for quarterly\n      savings: quarterlyPrice * 0.05\n    },\n    yearly: {\n      price: yearlyPrice,\n      discount: 15, // 15% discount for yearly\n      savings: yearlyPrice * 0.15\n    }\n  };\n}\n\n/**\n * Convert Prisma plan object to our Plan type\n */\nfunction convertPrismaPlanToPlan(prismaPlan: any): Plan {\n  return {\n    id: prismaPlan.id,\n    name: prismaPlan.name,\n    description: prismaPlan.description,\n    basePrice: prismaPlan.basePrice,\n    currency: prismaPlan.currency,\n    trialDays: prismaPlan.trialDays,\n    limits: JSON.parse(prismaPlan.limits as string) as PlanLimits,\n    features: JSON.parse(prismaPlan.features as string) as string[],\n    isActive: prismaPlan.isActive,\n    isPopular: prismaPlan.isPopular,\n    sortOrder: prismaPlan.sortOrder,\n    pricing: generatePricingFromBasePrice(prismaPlan.basePrice),\n    createdAt: prismaPlan.createdAt,\n    updatedAt: prismaPlan.updatedAt,\n    deletedAt: prismaPlan.deletedAt || undefined\n  };\n}\n\n/**\n * Helper function to generate pricing object for a plan\n */\nfunction generatePlanPricing(basePrice: number) {\n  return {\n    monthly: {\n      price: basePrice,\n      discount: 0,\n      savings: 0\n    },\n    quarterly: {\n      price: basePrice * 3 * 0.95, // 5% discount for quarterly\n      discount: 5,\n      savings: basePrice * 3 * 0.05\n    },\n    yearly: {\n      price: basePrice * 12 * 0.85, // 15% discount for yearly\n      discount: 15,\n      savings: basePrice * 12 * 0.15\n    }\n  };\n}\n\n/**\n * Helper function to transform database plan to Plan type\n */\nfunction transformPlanFromDb(plan: any): Plan {\n  return {\n    id: plan.id,\n    name: plan.name,\n    description: plan.description,\n    basePrice: plan.basePrice,\n    currency: plan.currency,\n    trialDays: plan.trialDays,\n    limits: typeof plan.limits === 'string' ? JSON.parse(plan.limits) : plan.limits,\n    features: typeof plan.features === 'string' ? JSON.parse(plan.features) : plan.features,\n    isActive: plan.isActive,\n    isPopular: plan.isPopular,\n    sortOrder: plan.sortOrder,\n    pricing: generatePlanPricing(plan.basePrice),\n    createdAt: plan.createdAt,\n    updatedAt: plan.updatedAt,\n    ...(plan.deletedAt && { deletedAt: plan.deletedAt })\n  };\n}\n\nexport function calculatePlanPricing(plan: Plan): Record<BillingInterval, number> {\n  const pricing: Record<BillingInterval, number> = {} as any;\n  \n  const intervals: BillingInterval[] = ['month', 'quarter', 'semiAnnual', 'year'];\n  \n  for (const interval of intervals) {\n    pricing[interval] = calculateSubscriptionPrice(plan, interval);\n  }\n  \n  return pricing;\n}\n\nexport function calculatePeriodEnd(startDate: Date, billingInterval: BillingInterval): Date {\n  const endDate = new Date(startDate);\n  \n  switch (billingInterval) {\n    case 'month':\n      endDate.setMonth(endDate.getMonth() + 1);\n      break;\n    case 'quarter':\n      endDate.setMonth(endDate.getMonth() + 3);\n      break;\n    case 'semiAnnual':\n      endDate.setMonth(endDate.getMonth() + 6);\n      break;\n    case 'year':\n      endDate.setFullYear(endDate.getFullYear() + 1);\n      break;\n    default:\n      endDate.setMonth(endDate.getMonth() + 1);\n  }\n  \n  return endDate;\n}\n\n// ============================================================================\n// SUBSCRIPTION QUERIES\n// ============================================================================\n\nexport async function getSubscriptionByMerchantId(merchantId: number): Promise<Subscription | null> {\n  // Find the merchant by id\n  const merchant = await prisma.merchant.findUnique({\n    where: { id: merchantId },\n    select: { id: true }\n  });\n  \n  if (!merchant) {\n    return null;\n  }\n  \n  const subscription = await prisma.subscription.findUnique({\n    where: { merchantId: merchant.id },\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    }\n  });\n\n  if (!subscription) return null;\n\n  return {\n    id: subscription.id,\n    merchantId: subscription.merchantId,\n    planId: subscription.planId,\n    status: subscription.status as SubscriptionStatus,\n    billingInterval: subscription.interval as BillingInterval,\n    currentPeriodStart: subscription.currentPeriodStart,\n    currentPeriodEnd: subscription.currentPeriodEnd,\n    amount: subscription.amount,\n    createdAt: subscription.createdAt,\n    updatedAt: subscription.updatedAt,\n    merchant: subscription.merchant,\n    plan: convertPrismaPlanToPlan(subscription.plan)\n  };\n}\n\nexport async function getAllSubscriptions(): Promise<Subscription[]> {\n  const subscriptions = await prisma.subscription.findMany({\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    },\n    orderBy: { createdAt: 'desc' }\n  });\n\n  return subscriptions.map((sub: any) => ({\n    id: sub.id,\n    merchantId: sub.merchantId,\n    planId: sub.planId,\n    status: sub.status as SubscriptionStatus,\n    billingInterval: sub.interval as BillingInterval,\n    currentPeriodStart: sub.currentPeriodStart,\n    currentPeriodEnd: sub.currentPeriodEnd,\n    amount: sub.amount,\n    createdAt: sub.createdAt,\n    updatedAt: sub.updatedAt,\n    merchant: sub.merchant,\n    plan: convertPrismaPlanToPlan(sub.plan)\n  }));\n}\n\n// ============================================================================\n// SUBSCRIPTION SEARCH\n// ============================================================================\n\nexport async function searchSubscriptions(filters: {\n  merchantId?: number;\n  planId?: number;\n  status?: string;\n  startDate?: Date;\n  endDate?: Date;\n  limit?: number;\n  offset?: number;\n}): Promise<{ subscriptions: Subscription[]; total: number; hasMore: boolean }> {\n  const where: any = {};\n\n  // Apply filters\n  if (filters.merchantId) {\n    where.merchantId = filters.merchantId;\n  }\n\n  if (filters.planId) {\n    where.planId = filters.planId;\n  }\n\n  if (filters.status) {\n    where.status = filters.status;\n  }\n\n  if (filters.startDate || filters.endDate) {\n    where.currentPeriodStart = {};\n    if (filters.startDate) where.currentPeriodStart.gte = filters.startDate;\n    if (filters.endDate) where.currentPeriodStart.lte = filters.endDate;\n  }\n\n  // Get total count\n  const total = await prisma.subscription.count({ where });\n\n  // Get subscriptions with pagination\n  const subscriptions = await prisma.subscription.findMany({\n    where,\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    },\n    orderBy: { createdAt: 'desc' },\n    take: filters.limit || 20,\n    skip: filters.offset || 0\n  });\n\n  const hasMore = (filters.offset || 0) + (filters.limit || 20) < total;\n\n  return {\n    subscriptions: subscriptions.map((sub: any) => ({\n      id: sub.id,\n      merchantId: sub.merchantId,\n      planId: sub.planId,\n      status: sub.status as SubscriptionStatus,\n      billingInterval: sub.interval as BillingInterval,\n      currentPeriodStart: sub.currentPeriodStart,\n      currentPeriodEnd: sub.currentPeriodEnd,\n      amount: sub.amount,\n      createdAt: sub.createdAt,\n      updatedAt: sub.updatedAt,\n      merchant: sub.merchant,\n      plan: {\n        id: sub.plan.id,\n        name: sub.plan.name,\n        description: sub.plan.description,\n        basePrice: sub.plan.basePrice,\n        currency: sub.plan.currency,\n        trialDays: sub.plan.trialDays,\n        limits: JSON.parse(sub.plan.limits as string) as PlanLimits,\n        features: JSON.parse(sub.plan.features as string) as string[],\n        isActive: sub.plan.isActive,\n        isPopular: sub.plan.isPopular,\n        sortOrder: sub.plan.sortOrder,\n        pricing: generatePricingFromBasePrice(sub.plan.basePrice),\n        createdAt: sub.plan.createdAt,\n        updatedAt: sub.plan.updatedAt\n      }\n    })),\n    total,\n    hasMore\n  };\n}\n\n// ============================================================================\n// SUBSCRIPTION MUTATIONS\n// ============================================================================\n\nexport async function createSubscription(data: SubscriptionCreateInput): Promise<Subscription> {\n  // Get merchant by id\n  const merchant = await prisma.merchant.findUnique({\n    where: { id: data.merchantId }\n  });\n\n  if (!merchant) {\n    throw new Error('Merchant not found');\n  }\n\n  // Get plan by id\n  const plan = await prisma.plan.findUnique({\n    where: { id: data.planId }\n  });\n\n  if (!plan) {\n    throw new Error('Plan not found');\n  }\n\n  // Check if merchant already has a subscription\n  const existingSubscription = await prisma.subscription.findUnique({\n    where: { merchantId: merchant.id }\n  });\n\n  if (existingSubscription) {\n    throw new Error('Merchant already has a subscription');\n  }\n\n  // Calculate pricing based on billing interval\n  const billingInterval = data.billingInterval || 'month';\n  const convertedPlan = convertPrismaPlanToPlan(plan);\n  const amount = calculateSubscriptionPrice(convertedPlan, billingInterval);\n  \n  // Calculate dates\n  const startDate = data.startDate || new Date();\n  const currentPeriodEnd = calculatePeriodEnd(startDate, billingInterval);\n\n  const subscription = await prisma.subscription.create({\n    data: {\n      merchantId: merchant.id,\n      planId: plan.id,\n      status: data.status || 'trial',\n      interval: billingInterval,\n      currentPeriodStart: startDate,\n      currentPeriodEnd: currentPeriodEnd,\n      amount: amount\n    },\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    }\n  });\n\n  // Update merchant subscription status\n  await prisma.merchant.update({\n    where: { id: merchant.id },\n    data: {\n      subscriptionStatus: subscription.status\n    }\n  });\n\n  return {\n    id: subscription.id,\n    merchantId: subscription.merchantId,\n    planId: subscription.planId,\n    status: subscription.status as SubscriptionStatus,\n    billingInterval: subscription.interval as BillingInterval,\n    currentPeriodStart: subscription.currentPeriodStart,\n    currentPeriodEnd: subscription.currentPeriodEnd,\n    amount: subscription.amount,\n    createdAt: subscription.createdAt,\n    updatedAt: subscription.updatedAt,\n    merchant: subscription.merchant,\n    plan: convertPrismaPlanToPlan(subscription.plan)\n  };\n}\n\n// ============================================================================\n// PLAN FUNCTIONS\n// ============================================================================\n\nexport async function getAllPlans(): Promise<Plan[]> {\n  const plans = await prisma.plan.findMany({\n    where: { isActive: true },\n    orderBy: { sortOrder: 'asc' }\n  });\n\n  return plans.map((plan: any) => convertPrismaPlanToPlan(plan));\n}\n\nexport async function getPlanById(planId: number): Promise<Plan | null> {\n  const plan = await prisma.plan.findUnique({\n    where: { id: planId }\n  });\n\n  if (!plan) return null;\n\n  return {\n    id: plan.id,\n    name: plan.name,\n    description: plan.description,\n    basePrice: plan.basePrice,\n    currency: plan.currency,\n    trialDays: plan.trialDays,\n    limits: JSON.parse(plan.limits as string) as PlanLimits,\n    features: JSON.parse(plan.features as string) as string[],\n    isActive: plan.isActive,\n    isPopular: plan.isPopular,\n    sortOrder: plan.sortOrder,\n    pricing: generatePricingFromBasePrice(plan.basePrice),\n    createdAt: plan.createdAt,\n    updatedAt: plan.updatedAt,\n    deletedAt: plan.deletedAt || undefined\n  };\n}\n\n// ============================================================================\n// SUBSCRIPTION ACTIONS\n// ============================================================================\n\nexport async function changePlan(\n  subscriptionId: number, \n  newPlanId: number, \n  billingInterval: BillingInterval = 'month'\n): Promise<Subscription> {\n  const subscription = await prisma.subscription.findUnique({\n    where: { id: subscriptionId }\n  });\n\n  if (!subscription) {\n    throw new Error('Subscription not found');\n  }\n\n  const plan = await prisma.plan.findUnique({\n    where: { id: newPlanId }\n  });\n\n  if (!plan) {\n    throw new Error('Plan not found');\n  }\n\n  const convertedPlan = convertPrismaPlanToPlan(plan);\n  const amount = calculateSubscriptionPrice(convertedPlan, billingInterval);\n\n  // Calculate new period dates based on billing interval\n  const now = new Date();\n  const newPeriodStart = now;\n  \n  // Calculate period duration in days based on billing interval\n  const getPeriodDays = (interval: BillingInterval): number => {\n    switch (interval) {\n      case 'month': return 30;\n      case 'quarter': return 90;\n      case 'semiAnnual': return 180;\n      case 'year': return 365;\n      default: return 30;\n    }\n  };\n  \n  const periodDays = getPeriodDays(billingInterval);\n  const newPeriodEnd = new Date(now.getTime() + periodDays * 24 * 60 * 60 * 1000);\n\n  const updatedSubscription = await prisma.subscription.update({\n    where: { id: subscriptionId },\n    data: {\n      planId: plan.id,\n      interval: billingInterval,\n      amount: amount,\n      currentPeriodStart: newPeriodStart,\n      currentPeriodEnd: newPeriodEnd,\n      updatedAt: new Date()\n    },\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    }\n  });\n\n  // Update merchant's subscription status\n  await prisma.merchant.update({\n    where: { id: subscription.merchantId },\n    data: { subscriptionStatus: updatedSubscription.status }\n  });\n\n  return {\n    id: updatedSubscription.id,\n    merchantId: updatedSubscription.merchantId,\n    planId: updatedSubscription.planId,\n    status: updatedSubscription.status as SubscriptionStatus,\n    billingInterval: updatedSubscription.interval as BillingInterval,\n    currentPeriodStart: updatedSubscription.currentPeriodStart,\n    currentPeriodEnd: updatedSubscription.currentPeriodEnd,\n    amount: updatedSubscription.amount,\n    createdAt: updatedSubscription.createdAt,\n    updatedAt: updatedSubscription.updatedAt,\n    // Enhanced subscription period information\n    subscriptionPeriod: {\n      startDate: updatedSubscription.currentPeriodStart,\n      endDate: updatedSubscription.currentPeriodEnd,\n      duration: updatedSubscription.interval,\n      isActive: updatedSubscription.status === 'active',\n      daysRemaining: Math.ceil((updatedSubscription.currentPeriodEnd.getTime() - new Date().getTime()) / (1000 * 60 * 60 * 24)),\n      nextBillingDate: updatedSubscription.currentPeriodEnd\n    },\n    merchant: updatedSubscription.merchant,\n    plan: convertPrismaPlanToPlan(updatedSubscription.plan)\n  };\n}\n\nexport async function pauseSubscription(subscriptionId: number): Promise<Subscription> {\n  const subscription = await prisma.subscription.update({\n    where: { id: subscriptionId },\n    data: {\n      status: 'paused',\n      updatedAt: new Date()\n    },\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    }\n  });\n\n  return {\n    id: subscription.id,\n    merchantId: subscription.merchantId,\n    planId: subscription.planId,\n    status: subscription.status as SubscriptionStatus,\n    billingInterval: subscription.interval as BillingInterval,\n    currentPeriodStart: subscription.currentPeriodStart,\n    currentPeriodEnd: subscription.currentPeriodEnd,\n    amount: subscription.amount,\n    createdAt: subscription.createdAt,\n    updatedAt: subscription.updatedAt,\n    merchant: subscription.merchant,\n    plan: convertPrismaPlanToPlan(subscription.plan)\n  };\n}\n\nexport async function resumeSubscription(subscriptionId: number): Promise<Subscription> {\n  const subscription = await prisma.subscription.update({\n    where: { id: subscriptionId },\n    data: {\n      status: 'active',\n      updatedAt: new Date()\n    },\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    }\n  });\n\n  return {\n    id: subscription.id,\n    merchantId: subscription.merchantId,\n    planId: subscription.planId,\n    status: subscription.status as SubscriptionStatus,\n    billingInterval: subscription.interval as BillingInterval,\n    currentPeriodStart: subscription.currentPeriodStart,\n    currentPeriodEnd: subscription.currentPeriodEnd,\n    amount: subscription.amount,\n    createdAt: subscription.createdAt,\n    updatedAt: subscription.updatedAt,\n    merchant: subscription.merchant,\n    plan: convertPrismaPlanToPlan(subscription.plan)\n  };\n}\n\nexport async function cancelSubscription(subscriptionId: number): Promise<{ success: boolean; message: string; data?: Subscription; statusCode?: number }> {\n  try {\n    const subscription = await prisma.subscription.update({\n      where: { id: subscriptionId },\n      data: {\n        status: 'cancelled',\n        updatedAt: new Date()\n      },\n      include: {\n        merchant: {\n          select: {\n      id: true,\n            name: true,\n            email: true,\n            subscriptionStatus: true\n          }\n        },\n        plan: true\n      }\n    });\n\n    const result: Subscription = {\n      id: subscription.id,\n      merchantId: subscription.merchantId,\n      planId: subscription.planId,\n      status: subscription.status as SubscriptionStatus,\n      billingInterval: subscription.interval as BillingInterval,\n      currentPeriodStart: subscription.currentPeriodStart,\n      currentPeriodEnd: subscription.currentPeriodEnd,\n      amount: subscription.amount,\n      createdAt: subscription.createdAt,\n      updatedAt: subscription.updatedAt,\n      merchant: subscription.merchant,\n      plan: {\n        id: subscription.plan.id,\n        name: subscription.plan.name,\n        description: subscription.plan.description,\n        basePrice: subscription.plan.basePrice,\n        currency: subscription.plan.currency,\n        trialDays: subscription.plan.trialDays,\n        limits: JSON.parse(subscription.plan.limits as string) as PlanLimits,\n        features: JSON.parse(subscription.plan.features as string) as string[],\n        isActive: subscription.plan.isActive,\n        isPopular: subscription.plan.isPopular,\n        sortOrder: subscription.plan.sortOrder,\n        pricing: generatePricingFromBasePrice(subscription.plan.basePrice),\n        createdAt: subscription.plan.createdAt,\n        updatedAt: subscription.plan.updatedAt\n      }\n    };\n\n    return {\n      success: true,\n      message: 'Subscription cancelled successfully',\n      data: result\n    };\n  } catch (error) {\n    console.error('Error cancelling subscription:', error);\n    return {\n      success: false,\n      message: 'Failed to cancel subscription',\n      statusCode: 500\n    };\n  }\n}\n\n// ============================================================================\n// SUBSCRIPTION RENEWAL FUNCTIONS\n// ============================================================================\n\nexport async function getExpiredSubscriptions(): Promise<Subscription[]> {\n  const now = new Date();\n  \n  const subscriptions = await prisma.subscription.findMany({\n    where: {\n      currentPeriodEnd: {\n        lt: now\n      },\n      status: {\n        in: ['active', 'trial']\n      }\n    },\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    },\n    orderBy: { currentPeriodEnd: 'asc' }\n  });\n\n  return subscriptions.map((sub: any) => ({\n    id: sub.id,\n    merchantId: sub.merchantId,\n    planId: sub.planId,\n    status: sub.status as SubscriptionStatus,\n    billingInterval: sub.interval as BillingInterval,\n    currentPeriodStart: sub.currentPeriodStart,\n    currentPeriodEnd: sub.currentPeriodEnd,\n    amount: sub.amount,\n    createdAt: sub.createdAt,\n    updatedAt: sub.updatedAt,\n    merchant: sub.merchant,\n    plan: convertPrismaPlanToPlan(sub.plan)\n  }));\n}\n\nexport async function getSubscriptionById(id: number): Promise<Subscription | null> {\n  const subscription = await prisma.subscription.findUnique({\n    where: { id },\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    }\n  });\n\n  if (!subscription) return null;\n\n  return {\n    id: subscription.id,\n    merchantId: subscription.merchantId,\n    planId: subscription.planId,\n    status: subscription.status as SubscriptionStatus,\n    billingInterval: subscription.interval as BillingInterval,\n    currentPeriodStart: subscription.currentPeriodStart,\n    currentPeriodEnd: subscription.currentPeriodEnd,\n    amount: subscription.amount,\n    createdAt: subscription.createdAt,\n    updatedAt: subscription.updatedAt,\n    merchant: subscription.merchant,\n    plan: convertPrismaPlanToPlan(subscription.plan)\n  };\n}\n\nexport async function updateSubscription(\n  subscriptionId: number, \n  data: Partial<{\n    status: SubscriptionStatus;\n    currentPeriodStart: Date;\n    currentPeriodEnd: Date;\n    amount: number;\n  }>\n): Promise<Subscription> {\n  const subscription = await prisma.subscription.update({\n    where: { id: subscriptionId },\n    data: {\n      ...data,\n      updatedAt: new Date()\n    },\n    include: {\n      merchant: {\n        select: {\n          id: true,\n          name: true,\n          email: true,\n          subscriptionStatus: true\n        }\n      },\n      plan: true\n    }\n  });\n\n  return {\n    id: subscription.id,\n    merchantId: subscription.merchantId,\n    planId: subscription.planId,\n    status: subscription.status as SubscriptionStatus,\n    billingInterval: subscription.interval as BillingInterval,\n    currentPeriodStart: subscription.currentPeriodStart,\n    currentPeriodEnd: subscription.currentPeriodEnd,\n    amount: subscription.amount,\n    createdAt: subscription.createdAt,\n    updatedAt: subscription.updatedAt,\n    merchant: subscription.merchant,\n    plan: convertPrismaPlanToPlan(subscription.plan)\n  };\n}\n\n// ============================================================================\n// SUBSCRIPTION PAYMENT FUNCTIONS\n// ============================================================================\n\nexport interface SubscriptionPaymentCreateInput {\n  subscriptionId: number;\n  amount: number;\n  currency: string;\n  method: string;\n  status: string;\n  transactionId: string;\n  description?: string;\n  failureReason?: string;\n}\n\nexport interface SubscriptionPayment {\n  id: number;\n  subscriptionId: number;\n  amount: number;\n  currency: string;\n  method: string;\n  status: string;\n  transactionId: string;\n  description?: string;\n  failureReason?: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport async function createSubscriptionPayment(data: SubscriptionPaymentCreateInput): Promise<SubscriptionPayment> {\n  // Find subscription by id\n  const subscription = await prisma.subscription.findUnique({\n    where: { id: data.subscriptionId },\n    select: { id: true }\n  });\n\n  if (!subscription) {\n    throw new Error('Subscription not found');\n  }\n\n  const payment = await prisma.payment.create({\n    data: {\n      subscriptionId: subscription.id,\n      amount: data.amount,\n      currency: data.currency,\n      method: data.method,\n      type: 'SUBSCRIPTION',\n      status: data.status,\n      transactionId: data.transactionId,\n      description: data.description,\n      failureReason: data.failureReason\n    }\n  });\n\n  return {\n    id: payment.id,\n    subscriptionId: data.subscriptionId,\n    amount: payment.amount,\n    currency: payment.currency,\n    method: payment.method,\n    status: payment.status,\n    transactionId: payment.transactionId || '',\n    description: payment.description || undefined,\n    failureReason: payment.failureReason || undefined,\n    createdAt: payment.createdAt,\n    updatedAt: payment.updatedAt\n  };\n}\n\n// ============================================================================\n// SUBSCRIPTION PAYMENT HISTORY\n// ============================================================================\n\n/**\n * Get payment history for a subscription\n * @param subscriptionId - Subscription ID\n * @param filters - Optional filters for payments\n * @returns Payment history with pagination\n */\nexport async function getSubscriptionPaymentHistory(\n  subscriptionId: number,\n  filters?: {\n    status?: string;\n    method?: string;\n    startDate?: Date;\n    endDate?: Date;\n    limit?: number;\n    offset?: number;\n  }\n): Promise<{\n  payments: SubscriptionPayment[];\n  total: number;\n  hasMore: boolean;\n}> {\n  const where: any = {\n    subscriptionId,\n    type: 'SUBSCRIPTION'\n  };\n\n  // Apply filters\n  if (filters?.status) {\n    where.status = filters.status.toUpperCase();\n  }\n\n  if (filters?.method) {\n    where.method = filters.method.toUpperCase();\n  }\n\n  if (filters?.startDate || filters?.endDate) {\n    where.createdAt = {};\n    if (filters.startDate) where.createdAt.gte = filters.startDate;\n    if (filters.endDate) where.createdAt.lte = filters.endDate;\n  }\n\n  const limit = filters?.limit || 20;\n  const offset = filters?.offset || 0;\n\n  // Get total count and payments\n  const [total, payments] = await Promise.all([\n    prisma.payment.count({ where }),\n    prisma.payment.findMany({\n      where,\n      orderBy: { createdAt: 'desc' },\n      take: limit,\n      skip: offset\n    })\n  ]);\n\n  const hasMore = offset + limit < total;\n\n  return {\n    payments: payments.map((p: any) => ({\n      id: p.id,\n      subscriptionId: subscriptionId,\n      amount: p.amount,\n      currency: p.currency,\n      method: p.method,\n      status: p.status,\n      transactionId: p.transactionId || '',\n      description: p.description || undefined,\n      failureReason: p.failureReason || undefined,\n      createdAt: p.createdAt,\n      updatedAt: p.updatedAt\n    })),\n    total,\n    hasMore\n  };\n}\n\n// ============================================================================\n// SUBSCRIPTION RENEWAL\n// ============================================================================\n\n/**\n * Renew subscription for another month with payment\n * @param subscriptionId - Subscription ID\n * @param paymentData - Payment information\n * @returns Updated subscription and payment record\n */\nexport async function renewSubscription(\n  subscriptionId: number,\n  paymentData: {\n    method: 'STRIPE' | 'TRANSFER';\n    transactionId: string;\n    reference?: string;\n    description?: string;\n  }\n): Promise<{\n  subscription: Subscription;\n  payment: SubscriptionPayment;\n}> {\n  // 1. Get subscription with merchant\n  const subscription = await prisma.subscription.findUnique({\n    where: { id: subscriptionId },\n    include: {\n      merchant: true,\n      plan: true\n    }\n  });\n\n  if (!subscription) {\n    throw new Error('Subscription not found');\n  }\n\n  // 2. Validate subscription can be renewed\n  if (subscription.status === 'cancelled') {\n    throw new Error('Cannot renew cancelled subscription');\n  }\n\n  // 3. Calculate new period (extend by 1 month)\n  const newPeriodStart = subscription.currentPeriodEnd;\n  const newPeriodEnd = calculatePeriodEnd(newPeriodStart, 'month');\n\n  // 4. Use database transaction to ensure atomicity\n  const result = await prisma.$transaction(async (tx: any) => {\n    // Create payment record\n    const payment = await tx.payment.create({\n      data: {\n        subscriptionId: subscription.id,\n        merchantId: subscription.merchantId,\n        amount: subscription.amount,\n        currency: subscription.currency,\n        method: paymentData.method,\n        type: 'SUBSCRIPTION',\n        status: paymentData.method === 'STRIPE' ? 'COMPLETED' : 'PENDING',\n        transactionId: paymentData.transactionId,\n        reference: paymentData.reference,\n        description: paymentData.description || `Monthly subscription renewal - ${new Date().toLocaleDateString()}`,\n        processedAt: paymentData.method === 'STRIPE' ? new Date() : null\n      }\n    });\n\n    // Update subscription period\n    const updatedSubscription = await tx.subscription.update({\n      where: { id: subscriptionId },\n      data: {\n        currentPeriodStart: newPeriodStart,\n        currentPeriodEnd: newPeriodEnd,\n        status: 'active',\n        updatedAt: new Date()\n      },\n      include: {\n        merchant: {\n          select: {\n            id: true,\n            name: true,\n            email: true,\n            subscriptionStatus: true\n          }\n        },\n        plan: true\n      }\n    });\n\n    // Update merchant status\n    await tx.merchant.update({\n      where: { id: subscription.merchantId },\n      data: {\n        subscriptionStatus: 'active',\n        lastActiveAt: new Date()\n      }\n    });\n\n    return { updatedSubscription, payment };\n  });\n\n  // 5. Return formatted response\n  return {\n    subscription: {\n      id: result.updatedSubscription.id,\n      merchantId: result.updatedSubscription.merchantId,\n      planId: result.updatedSubscription.planId,\n      status: result.updatedSubscription.status as SubscriptionStatus,\n      billingInterval: result.updatedSubscription.interval as BillingInterval,\n      currentPeriodStart: result.updatedSubscription.currentPeriodStart,\n      currentPeriodEnd: result.updatedSubscription.currentPeriodEnd,\n      amount: result.updatedSubscription.amount,\n      createdAt: result.updatedSubscription.createdAt,\n      updatedAt: result.updatedSubscription.updatedAt,\n      merchant: result.updatedSubscription.merchant,\n      plan: convertPrismaPlanToPlan(result.updatedSubscription.plan)\n    },\n    payment: {\n      id: result.payment.id,\n      subscriptionId: subscriptionId,\n      amount: result.payment.amount,\n      currency: result.payment.currency,\n      method: result.payment.method,\n      status: result.payment.status,\n      transactionId: result.payment.transactionId || '',\n      description: result.payment.description || undefined,\n      createdAt: result.payment.createdAt,\n      updatedAt: result.payment.updatedAt\n    }\n  };\n}\n\n// ============================================================================\n// SIMPLIFIED API FUNCTIONS (for db object)\n// ============================================================================\n\nexport const simplifiedSubscriptions = {\n  /**\n   * Find subscription by ID (simplified API)\n   */\n  findById: async (id: number) => {\n    return await prisma.subscription.findUnique({\n      where: { id },\n      include: {\n        merchant: { select: { id: true, name: true } },\n        plan: { select: { id: true, name: true } },\n        payments: {\n          orderBy: { createdAt: 'desc' },\n          take: 5\n        }\n      }\n    });\n  },\n\n  /**\n   * Find subscription by merchant ID (simplified API)\n   */\n  findByMerchantId: async (merchantId: number) => {\n    return await prisma.subscription.findFirst({\n      where: { \n        merchantId,\n        status: { not: 'CANCELLED' }\n      },\n      include: {\n        merchant: { select: { id: true, name: true } },\n        plan: { select: { id: true, name: true } },\n        payments: {\n          orderBy: { createdAt: 'desc' },\n          take: 5\n        }\n      }\n    });\n  },\n\n  /**\n   * Create new subscription (simplified API)\n   */\n  create: async (data: any) => {\n    return await prisma.subscription.create({\n      data,\n      include: {\n        merchant: { select: { id: true, name: true } },\n        plan: { select: { id: true, name: true } }\n      }\n    });\n  },\n\n  /**\n   * Update subscription (simplified API)\n   */\n  update: async (id: number, data: any) => {\n    return await prisma.subscription.update({\n      where: { id },\n      data,\n      include: {\n        merchant: { select: { id: true, name: true } },\n        plan: { select: { id: true, name: true } }\n      }\n    });\n  },\n\n  /**\n   * Delete subscription (simplified API)\n   */\n  delete: async (id: number) => {\n    return await prisma.subscription.update({\n      where: { id },\n      data: { \n        status: 'CANCELLED',\n        canceledAt: new Date()\n      }\n    });\n  },\n\n  /**\n   * Search subscriptions with simple filters (simplified API)\n   */\n  search: async (filters: any) => {\n    const { page = 1, limit = 20, ...whereFilters } = filters;\n    const skip = (page - 1) * limit;\n\n    // Build where clause\n    const where: any = {};\n    \n    if (whereFilters.merchantId) where.merchantId = whereFilters.merchantId;\n    if (whereFilters.planId) where.planId = whereFilters.planId;\n    if (whereFilters.isActive !== undefined) {\n      if (whereFilters.isActive) {\n        where.status = { not: 'CANCELLED' };\n      } else {\n        where.status = 'CANCELLED';\n      }\n    }\n    if (whereFilters.status) where.status = whereFilters.status;\n    \n    // Date range filters\n    if (whereFilters.startDate || whereFilters.endDate) {\n      where.createdAt = {};\n      if (whereFilters.startDate) where.createdAt.gte = whereFilters.startDate;\n      if (whereFilters.endDate) where.createdAt.lte = whereFilters.endDate;\n    }\n\n    const [subscriptions, total] = await Promise.all([\n      prisma.subscription.findMany({\n        where,\n        include: {\n          merchant: { select: { id: true, name: true } },\n          plan: { select: { id: true, name: true } },\n          payments: {\n            orderBy: { createdAt: 'desc' },\n            take: 3\n          }\n        },\n        orderBy: { createdAt: 'desc' },\n        skip,\n        take: limit\n      }),\n      prisma.subscription.count({ where })\n    ]);\n\n    return {\n      data: subscriptions,\n      total,\n      page,\n      limit,\n      hasMore: skip + limit < total\n    };\n  },\n\n  /**\n   * Get expired subscriptions (simplified API)\n   */\n  getExpired: async () => {\n    const now = new Date();\n    \n    return await prisma.subscription.findMany({\n      where: {\n        status: { not: 'CANCELLED' },\n        OR: [\n          { \n            status: 'TRIAL',\n            trialEnd: { lt: now }\n          },\n          {\n            status: 'ACTIVE',\n            currentPeriodEnd: { lt: now }\n          }\n        ]\n      },\n      include: {\n        merchant: { select: { id: true, name: true } },\n        plan: { select: { id: true, name: true } }\n      },\n      orderBy: { currentPeriodEnd: 'asc' }\n    });\n  }\n};","/**\n * Order Number Generator & Configuration\n * \n * Provides robust, concurrent-safe order number generation for rental shop orders.\n * Supports multiple formats, handles race conditions, and includes centralized configuration.\n */\n\nimport { prisma } from './index';\n\n// ============================================================================\n// TYPES & INTERFACES\n// ============================================================================\n\nexport type OrderNumberFormat = 'sequential' | 'date-based' | 'random' | 'random-numeric' | 'hybrid' | 'compact-numeric';\n\nexport interface OrderNumberConfig {\n  format: OrderNumberFormat;\n  outletId: number;\n  prefix?: string;\n  includeDate?: boolean;\n  sequenceLength?: number;\n  randomLength?: number;\n  numericOnly?: boolean;\n}\n\nexport interface OrderNumberResult {\n  orderNumber: string;\n  sequence: number;\n  generatedAt: Date;\n}\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\n\n/**\n * Default order number format for new orders\n * \n * Available formats:\n * - 'sequential': ORD-{outletId}-{sequence} (e.g., ORD-001-0001)\n * - 'date-based': ORD-{outletId}-{date}-{sequence} (e.g., ORD-001-20250115-0001)\n * - 'random': ORD-{outletId}-{random} (e.g., ORD-001-A7B9C2)\n * - 'random-numeric': ORD-{outletId}-{random} (e.g., ORD-001-123456)\n * - 'hybrid': ORD-{outletId}-{date}-{random} (e.g., ORD-001-20250115-A7B9)\n * - 'compact-numeric': ORD{outletId}{random} (e.g., ORD00112345)\n */\nexport const ORDER_NUMBER_CONFIG = {\n  // Primary format for all new orders\n  format: 'compact-numeric' as OrderNumberFormat,\n  \n  // Prefix for all order numbers\n  prefix: 'ORD',\n  \n  // Sequence number padding (how many digits)\n  sequenceLength: 4,\n  \n  // Random string length (for random and hybrid formats)\n  randomLength: 6,\n  \n  // Whether to include date in order numbers (for date-based and hybrid)\n  includeDate: true,\n  \n  // Maximum retry attempts for collision resolution\n  maxRetries: 5,\n  \n  // Retry delay in milliseconds (exponential backoff)\n  retryDelay: 10,\n} as const;\n\n/**\n * Format-specific configurations\n */\nexport const FORMAT_CONFIGS = {\n  sequential: {\n    description: 'Sequential numbering per outlet',\n    example: 'ORD-001-0001',\n    pros: ['Outlet identification', 'Easy tracking', 'Human readable'],\n    cons: ['Business intelligence leakage', 'Race conditions possible'],\n    bestFor: 'Small to medium businesses with low concurrency'\n  },\n  \n  'date-based': {\n    description: 'Date-based with daily sequence reset',\n    example: 'ORD-001-20250115-0001',\n    pros: ['Daily organization', 'Better security', 'Easy daily reporting'],\n    cons: ['Longer numbers', 'Still somewhat predictable'],\n    bestFor: 'Medium businesses with daily operations focus'\n  },\n  \n  random: {\n    description: 'Random alphanumeric strings for security',\n    example: 'ORD-001-A7B9C2',\n    pros: ['Maximum security', 'No race conditions', 'Unpredictable'],\n    cons: ['No sequence tracking', 'Harder to manage', 'No business insights'],\n    bestFor: 'Large businesses prioritizing security'\n  },\n  \n  'random-numeric': {\n    description: 'Random numeric strings for security',\n    example: 'ORD-001-123456',\n    pros: ['Maximum security', 'No race conditions', 'Numbers only', 'Unpredictable'],\n    cons: ['No sequence tracking', 'Harder to manage', 'No business insights'],\n    bestFor: 'Businesses needing numeric-only random order numbers'\n  },\n  \n  'compact-numeric': {\n    description: 'Compact format with outlet ID and 5-digit random number',\n    example: 'ORD00112345',\n    pros: ['Compact format', 'Outlet identification', 'Numbers only', 'Short length', 'Easy to read'],\n    cons: ['No sequence tracking', 'Limited randomness (5 digits)'],\n    bestFor: 'Businesses wanting compact, numeric-only order numbers'\n  },\n  \n  hybrid: {\n    description: 'Combines outlet, date, and random elements',\n    example: 'ORD-001-20250115-A7B9',\n    pros: ['Balanced security', 'Outlet identification', 'Date organization'],\n    cons: ['Longer numbers', 'More complex'],\n    bestFor: 'Large businesses needing both security and organization'\n  }\n} as const;\n\n// ============================================================================\n// CONFIGURATION FUNCTIONS\n// ============================================================================\n\n/**\n * Get the current order number configuration\n */\nexport function getOrderNumberConfig() {\n  return ORDER_NUMBER_CONFIG;\n}\n\n/**\n * Update order number configuration (for testing or admin purposes)\n */\nexport function updateOrderNumberConfig(updates: Partial<typeof ORDER_NUMBER_CONFIG>) {\n  Object.assign(ORDER_NUMBER_CONFIG, updates);\n}\n\n/**\n * Get format information for display purposes\n */\nexport function getFormatInfo(format: OrderNumberFormat) {\n  return FORMAT_CONFIGS[format];\n}\n\n/**\n * Get all available formats with their information\n */\nexport function getAllFormats() {\n  return Object.entries(FORMAT_CONFIGS).map(([key, value]) => ({\n    format: key as OrderNumberFormat,\n    ...value\n  }));\n}\n\n/**\n * Validate order number format configuration\n */\nexport function validateOrderNumberConfig(config: typeof ORDER_NUMBER_CONFIG): string[] {\n  const errors: string[] = [];\n  \n  if (!config.prefix || config.prefix.length === 0) {\n    errors.push('Prefix cannot be empty');\n  }\n  \n  if (config.sequenceLength < 1 || config.sequenceLength > 10) {\n    errors.push('Sequence length must be between 1 and 10');\n  }\n  \n  if (config.randomLength < 4 || config.randomLength > 20) {\n    errors.push('Random length must be between 4 and 20');\n  }\n  \n  if (config.maxRetries < 1 || config.maxRetries > 20) {\n    errors.push('Max retries must be between 1 and 20');\n  }\n  \n  if (config.retryDelay < 1 || config.retryDelay > 1000) {\n    errors.push('Retry delay must be between 1 and 1000 milliseconds');\n  }\n  \n  return errors;\n}\n\n/**\n * Get recommended format based on business characteristics\n */\nexport function getRecommendedFormat(businessSize: 'small' | 'medium' | 'large', \n                                   concurrencyLevel: 'low' | 'medium' | 'high',\n                                   securityPriority: 'low' | 'medium' | 'high'): OrderNumberFormat {\n  // Small business with low concurrency and low security needs\n  if (businessSize === 'small' && concurrencyLevel === 'low' && securityPriority === 'low') {\n    return 'compact-numeric';\n  }\n  \n  // Medium business or higher security needs\n  if (businessSize === 'medium' || securityPriority === 'medium') {\n    return 'date-based';\n  }\n  \n  // High concurrency or high security needs\n  if (concurrencyLevel === 'high' || securityPriority === 'high') {\n    return 'random-numeric';\n  }\n  \n  // Large business with balanced needs\n  if (businessSize === 'large') {\n    return 'hybrid';\n  }\n  \n  // Default fallback - compact numeric for easy use\n  return 'compact-numeric';\n}\n\n// ============================================================================\n// ORDER NUMBER GENERATION\n// ============================================================================\n\n/**\n * Generate order number with specified format\n */\nexport async function generateOrderNumber(\n  config: OrderNumberConfig\n): Promise<OrderNumberResult> {\n  const {\n    format = 'sequential',\n    outletId,\n    prefix = 'ORD',\n    includeDate = false,\n    sequenceLength = 4,\n    randomLength = 6,\n    numericOnly = false\n  } = config;\n\n  // Validate outlet exists\n  const outlet = await prisma.outlet.findUnique({\n    where: { id: outletId },\n    select: { id: true, name: true }\n  });\n\n  if (!outlet) {\n    throw new Error(`Outlet with id ${outletId} not found`);\n  }\n\n  const outletIdStr = outlet.id.toString().padStart(3, '0');\n  const generatedAt = new Date();\n\n  switch (format) {\n    case 'sequential':\n      return await generateSequentialNumber(outletIdStr, prefix, sequenceLength);\n    \n    case 'date-based':\n      return await generateDateBasedNumber(outletIdStr, prefix, sequenceLength, generatedAt);\n    \n    case 'random':\n      return await generateRandomNumber(outletIdStr, prefix, randomLength, false);\n    \n    case 'random-numeric':\n      return await generateRandomNumber(outletIdStr, prefix, randomLength, true);\n    \n    case 'compact-numeric':\n      return await generateCompactNumericNumber(outletIdStr, prefix);\n    \n    case 'hybrid':\n      return await generateHybridNumber(outletIdStr, prefix, sequenceLength, generatedAt, numericOnly);\n    \n    default:\n      throw new Error(`Unsupported order number format: ${format}`);\n  }\n}\n\n/**\n * Generate sequential order number: ORD-{outletId}-{sequence}\n * Uses atomic counter to prevent race conditions\n */\nasync function generateSequentialNumber(\n  outletIdStr: string,\n  prefix: string,\n  sequenceLength: number\n): Promise<OrderNumberResult> {\n  const maxRetries = 5;\n  let retryCount = 0;\n\n  while (retryCount < maxRetries) {\n    try {\n      // Use atomic increment with retry logic\n      const result = await prisma.$transaction(async (tx: any) => {\n        // Get current sequence for this outlet\n        const lastOrder = await tx.order.findFirst({\n          where: { \n            orderNumber: { startsWith: `${prefix}-${outletIdStr}-` }\n          },\n          orderBy: { createdAt: 'desc' },\n          select: { orderNumber: true, createdAt: true }\n        });\n\n        let nextSequence = 1;\n        \n        if (lastOrder) {\n          // Extract sequence from last order number\n          const parts = lastOrder.orderNumber.split('-');\n          const lastSequence = parseInt(parts[parts.length - 1]) || 0;\n          nextSequence = lastSequence + 1;\n        }\n\n        const orderNumber = `${prefix}-${outletIdStr}-${nextSequence.toString().padStart(sequenceLength, '0')}`;\n\n        // Check for uniqueness (double-check)\n        const existingOrder = await tx.order.findUnique({\n          where: { orderNumber },\n          select: { id: true }\n        });\n\n        if (existingOrder) {\n          throw new Error('Order number collision detected');\n        }\n\n        return {\n          orderNumber,\n          sequence: nextSequence,\n          generatedAt: new Date()\n        };\n      });\n\n      return result;\n    } catch (error) {\n      retryCount++;\n      if (retryCount >= maxRetries) {\n        const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n        throw new Error(`Failed to generate sequential order number after ${maxRetries} retries: ${errorMessage}`);\n      }\n      \n      // Wait before retry (exponential backoff)\n      await new Promise(resolve => setTimeout(resolve, Math.pow(2, retryCount) * 10));\n    }\n  }\n\n  throw new Error('Maximum retries exceeded');\n}\n\n/**\n * Generate date-based order number: ORD-{outletId}-{date}-{sequence}\n * Resets sequence daily for better organization\n */\nasync function generateDateBasedNumber(\n  outletIdStr: string,\n  prefix: string,\n  sequenceLength: number,\n  generatedAt: Date\n): Promise<OrderNumberResult> {\n  const dateStr = generatedAt.toISOString().split('T')[0].replace(/-/g, '');\n  \n  const result = await prisma.$transaction(async (tx: any) => {\n    // Get last order for this outlet on this date\n    const lastOrder = await tx.order.findFirst({\n      where: { \n        orderNumber: { startsWith: `${prefix}-${outletIdStr}-${dateStr}-` }\n      },\n      orderBy: { createdAt: 'desc' },\n      select: { orderNumber: true }\n    });\n\n    let nextSequence = 1;\n    \n    if (lastOrder) {\n      const parts = lastOrder.orderNumber.split('-');\n      const lastSequence = parseInt(parts[parts.length - 1]) || 0;\n      nextSequence = lastSequence + 1;\n    }\n\n    const orderNumber = `${prefix}-${outletIdStr}-${dateStr}-${nextSequence.toString().padStart(sequenceLength, '0')}`;\n\n    // Check for uniqueness\n    const existingOrder = await tx.order.findUnique({\n      where: { orderNumber },\n      select: { id: true }\n    });\n\n    if (existingOrder) {\n      throw new Error('Order number collision detected');\n    }\n\n    return {\n      orderNumber,\n      sequence: nextSequence,\n      generatedAt\n    };\n  });\n\n  return result;\n}\n\n/**\n * Generate random order number: ORD-{outletId}-{random}\n * Uses crypto-secure random generation\n */\nasync function generateRandomNumber(\n  outletIdStr: string,\n  prefix: string,\n  randomLength: number,\n  numericOnly: boolean = false\n): Promise<OrderNumberResult> {\n  const maxRetries = 10;\n  let retryCount = 0;\n\n  while (retryCount < maxRetries) {\n    try {\n      // Generate crypto-secure random string\n      const randomStr = generateRandomString(randomLength, numericOnly);\n      const orderNumber = `${prefix}-${outletIdStr}-${randomStr}`;\n\n      // Check for uniqueness\n      const existingOrder = await prisma.order.findUnique({\n        where: { orderNumber },\n        select: { id: true }\n      });\n\n      if (!existingOrder) {\n        return {\n          orderNumber,\n          sequence: 0, // No sequence for random\n          generatedAt: new Date()\n        };\n      }\n\n      retryCount++;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      throw new Error(`Failed to generate random order number: ${errorMessage}`);\n    }\n  }\n\n  throw new Error(`Failed to generate unique random order number after ${maxRetries} attempts`);\n}\n\n/**\n * Generate compact numeric order number: ORD{outletId}{random}\n * Format: ORD00112345 (no hyphens, 5-digit random number)\n */\nasync function generateCompactNumericNumber(\n  outletIdStr: string,\n  prefix: string\n): Promise<OrderNumberResult> {\n  const maxRetries = 10;\n  let retryCount = 0;\n\n  while (retryCount < maxRetries) {\n    try {\n      // Generate 5-digit random number\n      const randomStr = generateRandomString(5, true); // 5 digits, numeric only\n      const orderNumber = `${prefix}${outletIdStr}${randomStr}`;\n\n      // Check for uniqueness\n      const existingOrder = await prisma.order.findUnique({\n        where: { orderNumber },\n        select: { id: true }\n      });\n\n      if (!existingOrder) {\n        return {\n          orderNumber,\n          sequence: 0, // No sequence for compact numeric\n          generatedAt: new Date()\n        };\n      }\n\n      retryCount++;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      throw new Error(`Failed to generate compact numeric order number: ${errorMessage}`);\n    }\n  }\n\n  throw new Error(`Failed to generate unique compact numeric order number after ${maxRetries} attempts`);\n}\n\n/**\n * Generate hybrid order number: ORD-{outletId}-{date}-{random}\n * Combines outlet, date, and random for optimal security and organization\n */\nasync function generateHybridNumber(\n  outletIdStr: string,\n  prefix: string,\n  sequenceLength: number,\n  generatedAt: Date,\n  numericOnly: boolean = false\n): Promise<OrderNumberResult> {\n  const dateStr = generatedAt.toISOString().split('T')[0].replace(/-/g, '');\n  const randomStr = generateRandomString(4, numericOnly); // Shorter random part\n  \n  const orderNumber = `${prefix}-${outletIdStr}-${dateStr}-${randomStr}`;\n\n  // Check for uniqueness\n  const existingOrder = await prisma.order.findUnique({\n    where: { orderNumber },\n    select: { id: true }\n  });\n\n  if (existingOrder) {\n    // If collision, try with different random string\n    return generateHybridNumber(outletIdStr, prefix, sequenceLength, generatedAt, numericOnly);\n  }\n\n  return {\n    orderNumber,\n    sequence: 0, // No sequence for hybrid\n    generatedAt\n  };\n}\n\n/**\n * Generate crypto-secure random string\n */\nfunction generateRandomString(length: number, numericOnly: boolean = false): string {\n  const chars = numericOnly ? '0123456789' : 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n  const randomBytes = new Uint8Array(length);\n  \n  if (typeof window !== 'undefined' && window.crypto) {\n    // Browser environment\n    window.crypto.getRandomValues(randomBytes);\n  } else {\n    // Node.js environment\n    const crypto = require('crypto');\n    const randomBytesNode = crypto.randomBytes(length);\n    randomBytes.set(randomBytesNode);\n  }\n  \n  return Array.from(randomBytes, byte => chars[byte % chars.length]).join('');\n}\n\n// ============================================================================\n// VALIDATION & PARSING\n// ============================================================================\n\n/**\n * Validate order number format\n */\nexport function validateOrderNumber(orderNumber: string): boolean {\n  const patterns = [\n    /^ORD-\\d{3}-\\d{4}$/, // Sequential: ORD-001-0001\n    /^ORD-\\d{3}-\\d{8}-\\d{4}$/, // Date-based: ORD-001-20250115-0001\n    /^ORD-\\d{3}-[A-Z0-9]{6}$/, // Random: ORD-001-A7B9C2\n    /^ORD-\\d{3}-\\d{6}$/, // Random-numeric: ORD-001-123456\n    /^ORD-\\d{3}-\\d{8}-[A-Z0-9]{4}$/, // Hybrid: ORD-001-20250115-A7B9\n    /^ORD\\d{3}\\d{5}$/ // Compact-numeric: ORD00112345\n  ];\n  \n  return patterns.some(pattern => pattern.test(orderNumber));\n}\n\n/**\n * Parse order number to extract components\n */\nexport function parseOrderNumber(orderNumber: string): {\n  prefix: string;\n  outletId: number;\n  date?: string;\n  sequence?: number;\n  random?: string;\n  format: OrderNumberFormat;\n} | null {\n  if (!validateOrderNumber(orderNumber)) {\n    return null;\n  }\n\n  // Check for compact-numeric format first (no hyphens)\n  if (/^ORD\\d{3}\\d{5}$/.test(orderNumber)) {\n    const outletId = parseInt(orderNumber.substring(3, 6));\n    const random = orderNumber.substring(6);\n    \n    return {\n      prefix: 'ORD',\n      outletId,\n      random,\n      format: 'compact-numeric'\n    };\n  }\n\n  const parts = orderNumber.split('-');\n  \n  if (parts.length === 3) {\n    // Sequential or Random format\n    const sequence = parseInt(parts[2]);\n    const isNumeric = /^\\d+$/.test(parts[2]);\n    \n    return {\n      prefix: parts[0],\n      outletId: parseInt(parts[1]),\n      sequence: isNumeric ? sequence : undefined,\n      random: !isNumeric ? parts[2] : undefined,\n      format: isNumeric ? 'sequential' : 'random'\n    };\n  }\n  \n  if (parts.length === 4) {\n    // Date-based or Hybrid format\n    const sequence = parseInt(parts[3]);\n    const isNumeric = /^\\d+$/.test(parts[3]);\n    \n    return {\n      prefix: parts[0],\n      outletId: parseInt(parts[1]),\n      date: parts[2],\n      sequence: isNumeric ? sequence : undefined,\n      random: !isNumeric ? parts[3] : undefined,\n      format: isNumeric ? 'date-based' : 'hybrid'\n    };\n  }\n  \n  return null;\n}\n\n// ============================================================================\n// STATISTICS & UTILITIES\n// ============================================================================\n\n/**\n * Get order statistics for an outlet\n */\nexport async function getOutletOrderStats(outletId: number): Promise<{\n  totalOrders: number;\n  todayOrders: number;\n  lastOrderNumber?: string;\n  lastOrderDate?: Date;\n}> {\n  const outlet = await prisma.outlet.findUnique({\n    where: { id: outletId },\n    select: { id: true }\n  });\n\n  if (!outlet) {\n    throw new Error(`Outlet with id ${outletId} not found`);\n  }\n\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  const tomorrow = new Date(today);\n  tomorrow.setDate(tomorrow.getDate() + 1);\n\n  const [totalOrders, todayOrders, lastOrder] = await Promise.all([\n    prisma.order.count({\n      where: { outletId: outlet.id }\n    }),\n    prisma.order.count({\n      where: { \n        outletId: outlet.id,\n        createdAt: {\n          gte: today,\n          lt: tomorrow\n        }\n      }\n    }),\n    prisma.order.findFirst({\n      where: { outletId: outlet.id },\n      orderBy: { createdAt: 'desc' },\n      select: { orderNumber: true, createdAt: true }\n    })\n  ]);\n\n  return {\n    totalOrders,\n    todayOrders,\n    lastOrderNumber: lastOrder?.orderNumber,\n    lastOrderDate: lastOrder?.createdAt\n  };\n}\n\n/**\n * Quick order number generation with default settings\n */\nexport async function createOrderNumber(outletId: number): Promise<string> {\n  const result = await generateOrderNumber({\n    format: 'sequential',\n    outletId,\n    prefix: 'ORD',\n    sequenceLength: 4\n  });\n  \n  return result.orderNumber;\n}\n\n/**\n * Generate order number with specific format\n */\nexport async function createOrderNumberWithFormat(\n  outletId: number, \n  format: OrderNumberFormat\n): Promise<OrderNumberResult> {\n  const config: OrderNumberConfig = {\n    format,\n    outletId,\n    prefix: 'ORD',\n    sequenceLength: 4,\n    randomLength: 6,\n    includeDate: true\n  };\n  \n  return await generateOrderNumber(config);\n}\n\n/**\n * Generate multiple order numbers for testing\n */\nexport async function generateTestOrderNumbers(\n  outletId: number, \n  count: number, \n  format: OrderNumberFormat = 'sequential'\n): Promise<string[]> {\n  const orderNumbers: string[] = [];\n  \n  for (let i = 0; i < count; i++) {\n    const result = await createOrderNumberWithFormat(outletId, format);\n    orderNumbers.push(result.orderNumber);\n  }\n  \n  return orderNumbers;\n}\n\n/**\n * Analyze order number\n */\nexport function analyzeOrderNumber(orderNumber: string) {\n  const isValid = validateOrderNumber(orderNumber);\n  const parsed = parseOrderNumber(orderNumber);\n  \n  return {\n    orderNumber,\n    isValid,\n    parsed,\n    format: parsed?.format || 'unknown',\n    outletId: parsed?.outletId,\n    sequence: parsed?.sequence,\n    date: parsed?.date,\n    random: parsed?.random\n  };\n}\n\n// ============================================================================\n// SIMPLIFIED API FUNCTIONS (for db object)\n// ============================================================================\n\nexport const simplifiedOrderNumbers = {\n  /**\n   * Get outlet order stats (simplified API)\n   */\n  getOutletStats: async (outletId: number) => {\n    return await getOutletOrderStats(outletId);\n  },\n\n  /**\n   * Create order number with format (simplified API)\n   */\n  createWithFormat: async (outletId: number, format: OrderNumberFormat) => {\n    return await createOrderNumberWithFormat(outletId, format);\n  },\n\n  /**\n   * Generate multiple order numbers (simplified API)\n   */\n  generateMultiple: async (outletId: number, count: number, format: OrderNumberFormat = 'sequential') => {\n    return await generateTestOrderNumbers(outletId, count, format);\n  },\n\n  /**\n   * Validate order number format (simplified API)\n   */\n  validateFormat: (orderNumber: string) => {\n    return validateOrderNumber(orderNumber);\n  },\n\n  /**\n   * Get format info (simplified API)\n   */\n  getFormatInfo: (format: OrderNumberFormat) => {\n    return getFormatInfo(format);\n  }\n};","/**\n * Comprehensive Audit Logging System\n * \n * This module provides a complete audit logging solution that tracks:\n * - Who made changes (user, role, context)\n * - What was changed (entity, fields, values)\n * - When changes occurred (timestamp, session)\n * - Where changes came from (IP, user agent)\n * - Why changes were made (business context)\n */\n\nimport { PrismaClient } from '@prisma/client';\n\n// Types for audit logging\nexport interface AuditContext {\n  userId?: number;\n  userEmail?: string;\n  userRole?: string;\n  merchantId?: number;\n  outletId?: number;\n  ipAddress?: string;\n  userAgent?: string;\n  sessionId?: string;\n  requestId?: string;\n  metadata?: Record<string, any>;\n}\n\nexport interface AuditLogData {\n  action: 'CREATE' | 'UPDATE' | 'DELETE' | 'LOGIN' | 'LOGOUT' | 'VIEW' | 'EXPORT' | 'IMPORT' | 'CUSTOM';\n  entityType: string;\n  entityId: string;\n  entityName?: string;\n  oldValues?: Record<string, any>;\n  newValues?: Record<string, any>;\n  changes?: Record<string, { old: any; new: any }>;\n  severity?: 'INFO' | 'WARNING' | 'ERROR' | 'CRITICAL';\n  category?: 'GENERAL' | 'SECURITY' | 'BUSINESS' | 'SYSTEM' | 'COMPLIANCE';\n  description?: string;\n  context: AuditContext;\n}\n\nexport interface AuditLogFilter {\n  action?: string;\n  entityType?: string;\n  entityId?: string;\n  userId?: number;\n  merchantId?: number;\n  outletId?: number;\n  severity?: string;\n  category?: string;\n  startDate?: Date;\n  endDate?: Date;\n  limit?: number;\n  offset?: number;\n}\n\n// Audit logger class\nexport class AuditLogger {\n  private prisma: PrismaClient;\n  private idCounter: number = 0;\n\n  constructor(prisma: PrismaClient) {\n    this.prisma = prisma;\n  }\n\n  // Get next public ID\n  private async getNextPublicId(): Promise<number> {\n    // Temporarily disabled - AuditLog model not in schema\n    return 1;\n  }\n\n  // Main logging method\n  async log(data: AuditLogData): Promise<void> {\n    try {\n      console.log('🔍 AuditLogger.log - Starting audit log creation...');\n      const id = await this.getNextPublicId();\n      console.log('🔍 AuditLogger.log - Got id:', id);\n      \n      // Validate foreign key IDs to prevent constraint violations\n      const validatedUserId = await this.validateUserId(data.context.userId);\n      const validatedMerchantId = await this.validateMerchantId(data.context.merchantId);\n      const validatedOutletId = await this.validateOutletId(data.context.outletId);\n      \n      console.log('🔍 AuditLogger.log - About to create audit log with data:', {\n        id,\n        action: data.action,\n        entityType: data.entityType,\n        entityId: data.entityId,\n        userId: validatedUserId,\n        merchantId: validatedMerchantId,\n        outletId: validatedOutletId\n      });\n      \n      // Temporarily disabled - AuditLog model not in schema\n      console.log('🔍 Audit log would be created:', {\n        id,\n        action: data.action,\n        entityType: data.entityType,\n        entityId: data.entityId\n      });\n      console.log('✅ AuditLogger.log - Audit log created successfully');\n    } catch (error) {\n      // Don't throw errors from audit logging to avoid breaking main operations\n      console.error('❌ AuditLogger.log - Audit logging failed:', error);\n      console.error('❌ AuditLogger.log - Error details:', error instanceof Error ? error.message : String(error));\n      console.error('❌ AuditLogger.log - Error stack:', error instanceof Error ? error.stack : undefined);\n    }\n  }\n\n  // Validate foreign key IDs to prevent constraint violations\n  private async validateUserId(userId?: number): Promise<number | null> {\n    if (!userId) return null;\n    \n    try {\n      const user = await this.prisma.user.findUnique({\n        where: { id: userId },\n        select: { id: true }\n      });\n      return user ? userId : null;\n    } catch (error) {\n      console.warn('⚠️ AuditLogger - Failed to validate userId:', userId, error);\n      return null;\n    }\n  }\n\n  private async validateMerchantId(merchantId?: number): Promise<number | null> {\n    if (!merchantId) return null;\n    \n    try {\n      const merchant = await this.prisma.merchant.findUnique({\n        where: { id: merchantId },\n        select: { id: true }\n      });\n      return merchant ? merchantId : null;\n    } catch (error) {\n      console.warn('⚠️ AuditLogger - Failed to validate merchantId:', merchantId, error);\n      return null;\n    }\n  }\n\n  private async validateOutletId(outletId?: number): Promise<number | null> {\n    if (!outletId) return null;\n    \n    try {\n      const outlet = await this.prisma.outlet.findUnique({\n        where: { id: outletId },\n        select: { id: true }\n      });\n      return outlet ? outletId : null;\n    } catch (error) {\n      console.warn('⚠️ AuditLogger - Failed to validate outletId:', outletId, error);\n      return null;\n    }\n  }\n\n  // Convenience methods for common operations\n  async logCreate(\n    entityType: string,\n    entityId: string,\n    entityName: string,\n    newValues: Record<string, any>,\n    context: AuditContext,\n    description?: string\n  ): Promise<void> {\n    await this.log({\n      action: 'CREATE',\n      entityType,\n      entityId,\n      entityName,\n      newValues,\n      description: description || `Created ${entityType.toLowerCase()}: ${entityName}`,\n      context\n    });\n  }\n\n  async logUpdate(\n    entityType: string,\n    entityId: string,\n    entityName: string,\n    oldValues: Record<string, any>,\n    newValues: Record<string, any>,\n    context: AuditContext,\n    description?: string\n  ): Promise<void> {\n    const changes = this.calculateChanges(oldValues, newValues);\n    \n    await this.log({\n      action: 'UPDATE',\n      entityType,\n      entityId,\n      entityName,\n      oldValues,\n      newValues,\n      changes,\n      description: description || `Updated ${entityType.toLowerCase()}: ${entityName}`,\n      context\n    });\n  }\n\n  async logDelete(\n    entityType: string,\n    entityId: string,\n    entityName: string,\n    oldValues: Record<string, any>,\n    context: AuditContext,\n    description?: string\n  ): Promise<void> {\n    await this.log({\n      action: 'DELETE',\n      entityType,\n      entityId,\n      entityName,\n      oldValues,\n      description: description || `Deleted ${entityType.toLowerCase()}: ${entityName}`,\n      context\n    });\n  }\n\n  async logLogin(\n    userId: number,\n    userEmail: string,\n    userRole: string,\n    context: AuditContext,\n    success: boolean = true\n  ): Promise<void> {\n    await this.log({\n      action: 'LOGIN',\n      entityType: 'User',\n      entityId: userId.toString(),\n      entityName: userEmail,\n      newValues: { success, timestamp: new Date().toISOString() },\n      severity: success ? 'INFO' : 'WARNING',\n      category: 'SECURITY',\n      description: success ? `User logged in: ${userEmail}` : `Failed login attempt: ${userEmail}`,\n      context\n    });\n  }\n\n  async logLogout(\n    userId: number,\n    userEmail: string,\n    context: AuditContext\n  ): Promise<void> {\n    await this.log({\n      action: 'LOGOUT',\n      entityType: 'User',\n      entityId: userId.toString(),\n      entityName: userEmail,\n      category: 'SECURITY',\n      description: `User logged out: ${userEmail}`,\n      context\n    });\n  }\n\n  async logSecurityEvent(\n    event: string,\n    entityType: string,\n    entityId: string,\n    context: AuditContext,\n    severity: 'WARNING' | 'ERROR' | 'CRITICAL' = 'WARNING',\n    description?: string\n  ): Promise<void> {\n    await this.log({\n      action: 'CUSTOM',\n      entityType,\n      entityId,\n      severity,\n      category: 'SECURITY',\n      description: description || `Security event: ${event}`,\n      context\n    });\n  }\n\n  // Calculate changes between old and new values\n  private calculateChanges(oldValues: Record<string, any>, newValues: Record<string, any>): Record<string, { old: any; new: any }> {\n    const changes: Record<string, { old: any; new: any }> = {};\n    \n    // Check for changed fields\n    const allKeys = new Set([...Object.keys(oldValues), ...Object.keys(newValues)]);\n    \n    for (const key of Array.from(allKeys)) {\n      const oldValue = oldValues[key];\n      const newValue = newValues[key];\n      \n      if (JSON.stringify(oldValue) !== JSON.stringify(newValue)) {\n        changes[key] = { old: oldValue, new: newValue };\n      }\n    }\n    \n    return changes;\n  }\n\n  // Query audit logs\n  async getAuditLogs(filter: AuditLogFilter = {}): Promise<{\n    logs: any[];\n    total: number;\n    hasMore: boolean;\n  }> {\n    const where: any = {};\n    \n    if (filter.action) where.action = filter.action;\n    if (filter.entityType) where.entityType = filter.entityType;\n    if (filter.entityId) where.entityId = filter.entityId;\n    if (filter.userId) where.userId = filter.userId;\n    if (filter.merchantId) where.merchantId = filter.merchantId;\n    if (filter.outletId) where.outletId = filter.outletId;\n    if (filter.severity) where.severity = filter.severity;\n    if (filter.category) where.category = filter.category;\n    \n    if (filter.startDate || filter.endDate) {\n      where.createdAt = {};\n      if (filter.startDate) where.createdAt.gte = filter.startDate;\n      if (filter.endDate) where.createdAt.lte = filter.endDate;\n    }\n\n    const limit = filter.limit || 50;\n    const offset = filter.offset || 0;\n\n    // Temporarily disabled - AuditLog model not in schema\n    const logs: any[] = [];\n    const total = 0;\n\n    // Transform logs to include parsed JSON fields\n    const transformedLogs = logs.map(log => ({\n      id: log.id,\n      action: log.action,\n      entityType: log.entityType,\n      entityId: log.entityId,\n      entityName: log.entityName,\n      user: log.user ? {\n        id: log.user.id,\n        email: log.user.email,\n        name: `${log.user.firstName} ${log.user.lastName}`,\n        role: log.user.role\n      } : null,\n      merchant: log.merchant ? {\n        id: log.merchant.id,\n        name: log.merchant.name\n      } : null,\n      outlet: log.outlet ? {\n        id: log.outlet.id,\n        name: log.outlet.name\n      } : null,\n      oldValues: log.oldValues ? JSON.parse(log.oldValues) : null,\n      newValues: log.newValues ? JSON.parse(log.newValues) : null,\n      changes: log.changes ? JSON.parse(log.changes) : null,\n      ipAddress: log.ipAddress,\n      userAgent: log.userAgent,\n      sessionId: log.sessionId,\n      requestId: log.requestId,\n      metadata: log.metadata ? JSON.parse(log.metadata) : null,\n      severity: log.severity,\n      category: log.category,\n      description: log.description,\n      createdAt: log.createdAt\n    }));\n\n    return {\n      logs: transformedLogs,\n      total,\n      hasMore: offset + limit < total\n    };\n  }\n\n  // Get audit statistics\n  async getAuditStats(filter: Partial<AuditLogFilter> = {}): Promise<{\n    totalLogs: number;\n    logsByAction: Record<string, number>;\n    logsByEntity: Record<string, number>;\n    logsBySeverity: Record<string, number>;\n    logsByCategory: Record<string, number>;\n    recentActivity: number; // Last 24 hours\n  }> {\n    const where: any = {};\n    \n    if (filter.merchantId) where.merchantId = filter.merchantId;\n    if (filter.outletId) where.outletId = filter.outletId;\n    if (filter.startDate || filter.endDate) {\n      where.createdAt = {};\n      if (filter.startDate) where.createdAt.gte = filter.startDate;\n      if (filter.endDate) where.createdAt.lte = filter.endDate;\n    }\n\n    // Temporarily disabled - AuditLog model not in schema\n    const totalLogs = 0;\n    const actionStats: any[] = [];\n    const entityStats: any[] = [];\n    const severityStats: any[] = [];\n    const categoryStats: any[] = [];\n    const recentActivity = 0;\n\n    return {\n      totalLogs,\n      logsByAction: actionStats.reduce((acc, item) => {\n        acc[item.action] = item._count.action;\n        return acc;\n      }, {} as Record<string, number>),\n      logsByEntity: entityStats.reduce((acc, item) => {\n        acc[item.entityType] = item._count.entityType;\n        return acc;\n      }, {} as Record<string, number>),\n      logsBySeverity: severityStats.reduce((acc, item) => {\n        acc[item.severity] = item._count.severity;\n        return acc;\n      }, {} as Record<string, number>),\n      logsByCategory: categoryStats.reduce((acc, item) => {\n        acc[item.category] = item._count.category;\n        return acc;\n      }, {} as Record<string, number>),\n      recentActivity\n    };\n  }\n}\n\n// Create singleton instance\nlet auditLogger: AuditLogger | null = null;\n\nexport function getAuditLogger(prisma?: PrismaClient): AuditLogger {\n  if (!auditLogger) {\n    if (!prisma) {\n      throw new Error('Prisma client is required for audit logging');\n    }\n    auditLogger = new AuditLogger(prisma);\n  }\n  return auditLogger;\n}\n\n// Helper function to extract audit context from request\nexport function extractAuditContext(request: Request, user?: any): AuditContext {\n  const headers = request.headers;\n  \n  return {\n    userId: user?.id,\n    userEmail: user?.email,\n    userRole: user?.role,\n    merchantId: user?.merchantId,\n    outletId: user?.outletId,\n    ipAddress: headers.get('x-forwarded-for') || headers.get('x-real-ip') || 'unknown',\n    userAgent: headers.get('user-agent') || 'unknown',\n    sessionId: headers.get('x-session-id') || undefined,\n    requestId: headers.get('x-request-id') || undefined,\n    metadata: {\n      method: request.method,\n      url: request.url,\n      timestamp: new Date().toISOString()\n    }\n  };\n}\n","/**\n * Consolidated Subscription Manager\n * \n * Consolidates all subscription functionality into a single, organized class\n * following DRY principles and consistent naming conventions.\n * \n * Consolidates:\n * - subscription-utils-consolidated.ts\n * - subscription-utils.ts\n * - subscription-renewal.ts\n * - subscription-validation.ts\n * - subscription-check.ts\n */\n\nimport { PlanLimitError } from '../core';\nimport { ErrorCode } from './errors';\nimport { getSubscriptionByMerchantId } from '@rentalshop/database';\nimport { prisma } from '@rentalshop/database';\nimport { API } from '@rentalshop/constants';\nimport type { AuthUser, Subscription, SubscriptionStatus } from '@rentalshop/types';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface SubscriptionPeriod {\n  startDate: Date;\n  endDate: Date;\n  duration: string;\n  isActive: boolean;\n  daysRemaining: number;\n  nextBillingDate: Date;\n  isTrial?: boolean;\n}\n\nexport interface SubscriptionRenewalConfig {\n  paymentGateway: {\n    apiKey: string;\n    webhookSecret: string;\n  };\n  autoRenewEnabled: boolean;\n  gracePeriodDays: number;\n  retryAttempts: number;\n  retryDelayHours: number;\n}\n\nexport interface SubscriptionRenewalResult {\n  subscriptionId: number;\n  success: boolean;\n  status: string;\n  error?: string;\n  paymentId?: number;\n  nextBillingDate?: Date;\n}\n\nexport interface RenewalStats {\n  totalProcessed: number;\n  successful: number;\n  failed: number;\n  skipped: number;\n  errors: string[];\n}\n\nexport interface SubscriptionValidationResult {\n  isValid: boolean;\n  error?: string;\n  statusCode?: number;\n  subscription?: any;\n  merchant?: any;\n  isExpired?: boolean;\n  needsStatusUpdate?: boolean;\n}\n\nexport interface SubscriptionValidationOptions {\n  requireActiveSubscription?: boolean;\n  allowedStatuses?: string[];\n  checkMerchantStatus?: boolean;\n  checkSubscriptionStatus?: boolean;\n  autoUpdateExpired?: boolean;\n}\n\nexport interface RenewalConfig {\n  paymentGateway: {\n    apiKey: string;\n    webhookSecret: string;\n  };\n  autoRenewEnabled: boolean;\n  gracePeriodDays: number;\n  retryAttempts: number;\n  retryDelayHours: number;\n}\n\nexport interface RenewalResult {\n  subscriptionId: number;\n  success: boolean;\n  status: string;\n  error?: string;\n  paymentId?: number;\n  nextBillingDate?: Date;\n}\n\n// ============================================================================\n// SUBSCRIPTION MANAGER CLASS\n// ============================================================================\n\nexport class SubscriptionManager {\n  // ============================================================================\n  // CORE SUBSCRIPTION CHECKING\n  // ============================================================================\n\n  /**\n   * Check if user has valid subscription\n   */\n  static async checkStatus(user: any): Promise<boolean> {\n    try {\n      if (!user?.merchant?.id) {\n        console.log('🔍 SUBSCRIPTION: No merchant found for user');\n        return true; // No merchant = no subscription check needed\n      }\n\n      const subscriptionError = await this.getError(user);\n      return subscriptionError === null;\n    } catch (error) {\n      console.error('Error checking subscription status:', error);\n      return false; // Fail safe - assume subscription is invalid\n    }\n  }\n\n  /**\n   * Check if subscription error should be thrown\n   */\n  static async shouldThrowError(user: any): Promise<boolean> {\n    try {\n      if (!user?.merchant?.id) {\n        return false; // No merchant = no subscription check needed\n      }\n\n      const subscriptionError = await this.getError(user);\n      return subscriptionError !== null;\n    } catch (error) {\n      console.error('Error checking subscription status:', error);\n      return true; // Fail safe - throw error\n    }\n  }\n\n  /**\n   * Get subscription error if any\n   */\n  static async getError(user: any): Promise<PlanLimitError | null> {\n    try {\n      if (!user?.merchant?.id) {\n        return null; // No merchant = no subscription check needed\n      }\n\n      let merchantId: string | number = user.merchant.id;\n\n      // Handle string to numeric ID conversion\n      if (typeof merchantId === 'string') {\n        console.log('🔍 SUBSCRIPTION: Merchant ID is string, converting to numeric id');\n        \n        const numericId = parseInt(merchantId);\n        if (isNaN(numericId)) {\n          console.log('🔍 SUBSCRIPTION: Invalid merchant ID:', merchantId);\n          return new PlanLimitError('Invalid merchant ID', 'SUBSCRIPTION_NOT_FOUND');\n        }\n        \n        merchantId = numericId;\n        console.log('🔍 SUBSCRIPTION: Converted string to id:', merchantId);\n      }\n\n      console.log('🔍 SUBSCRIPTION: Using merchantId:', merchantId, 'type:', typeof merchantId);\n\n      const subscription = await getSubscriptionByMerchantId(merchantId);\n      \n      console.log('🔍 SUBSCRIPTION: Subscription data:', {\n        found: !!subscription,\n        status: subscription?.status,\n        currentPeriodEnd: subscription?.currentPeriodEnd\n      });\n\n      if (!subscription) {\n        console.log('🔍 SUBSCRIPTION: No subscription found for merchant');\n        return new PlanLimitError('No active subscription found', 'SUBSCRIPTION_NOT_FOUND');\n      }\n\n      const status = subscription.status?.toLowerCase();\n      const errorStatuses = ['cancelled', 'expired', 'suspended', 'past_due', 'paused'];\n\n      if (errorStatuses.includes(status)) {\n        console.log('🔍 SUBSCRIPTION: Subscription status is error status:', status);\n        return new PlanLimitError(\n          `Your subscription has been ${status}. Please renew to continue using our services.`,\n          'SUBSCRIPTION_ACCESS_DENIED'\n        );\n      }\n\n      // Additional check: Verify subscription is not actually expired by date\n      if (subscription.currentPeriodEnd) {\n        const currentDate = new Date();\n        const endDate = new Date(subscription.currentPeriodEnd);\n        \n        console.log('🔍 SUBSCRIPTION: Date validation:', {\n          currentDate: currentDate.toISOString(),\n          endDate: endDate.toISOString(),\n          isExpired: currentDate > endDate\n        });\n        \n        if (currentDate > endDate) {\n          console.log('🔍 SUBSCRIPTION: Subscription is past end date, treating as expired');\n          return new PlanLimitError(\n            'Your subscription has expired. Please renew to continue using our services.',\n            'SUBSCRIPTION_EXPIRED'\n          );\n        }\n      }\n\n      console.log('🔍 SUBSCRIPTION: Subscription is valid');\n      return null;\n    } catch (error) {\n      console.error('🔍 SUBSCRIPTION: Error checking subscription status:', error);\n      return new PlanLimitError('Unable to verify subscription status', 'SUBSCRIPTION_ACCESS_DENIED');\n    }\n  }\n\n  // ============================================================================\n  // ADVANCED VALIDATION\n  // ============================================================================\n\n  /**\n   * Comprehensive subscription validation with options\n   */\n  static async validateAccess(\n    user: any,\n    options: SubscriptionValidationOptions = {}\n  ): Promise<SubscriptionValidationResult> {\n    const {\n      requireActiveSubscription = true,\n      allowedStatuses = ['active', 'trial'],\n      checkMerchantStatus = true,\n      checkSubscriptionStatus = true,\n      autoUpdateExpired = false\n    } = options;\n\n    try {\n      // Check if user has merchant\n      if (!user?.merchant?.id) {\n        return {\n          isValid: false,\n          error: 'User not associated with any merchant',\n          statusCode: 400\n        };\n      }\n\n      // Check merchant status\n      if (checkMerchantStatus && user.merchant.status !== 'active') {\n        return {\n          isValid: false,\n          error: `Merchant account is ${user.merchant.status}`,\n          statusCode: 403,\n          merchant: user.merchant\n        };\n      }\n\n      // Check active subscription\n      if (checkSubscriptionStatus && requireActiveSubscription) {\n        const subscriptionError = await this.getError(user);\n        \n        if (subscriptionError) {\n          return {\n            isValid: false,\n            error: subscriptionError.message,\n            statusCode: subscriptionError.statusCode,\n            isExpired: subscriptionError.code === ErrorCode.TOKEN_EXPIRED\n          };\n        }\n      }\n\n      return {\n        isValid: true,\n        subscription: user.subscription,\n        merchant: user.merchant\n      };\n    } catch (error) {\n      console.error('Subscription validation error:', error);\n      return {\n        isValid: false,\n        error: 'Unable to validate subscription access',\n        statusCode: 500\n      };\n    }\n  }\n\n  /**\n   * Check if subscription status allows specific operations\n   */\n  static canPerformOperation(\n    subscriptionStatus: string,\n    operation: 'create' | 'read' | 'update' | 'delete' | 'admin'\n  ): boolean {\n    const status = subscriptionStatus.toLowerCase();\n    \n    switch (operation) {\n      case 'read':\n        return ['active', 'trial', 'past_due'].includes(status);\n      case 'create':\n      case 'update':\n        return ['active', 'trial'].includes(status);\n      case 'delete':\n        return status === 'active';\n      case 'admin':\n        return status === 'active';\n      default:\n        return false;\n    }\n  }\n\n  /**\n   * Get subscription error message for UI display\n   */\n  static getErrorMessage(\n    subscriptionStatus: string,\n    merchantStatus?: string\n  ): string {\n    const status = subscriptionStatus.toLowerCase();\n    \n    if (merchantStatus && merchantStatus !== 'active') {\n      return `Merchant account is ${merchantStatus}. Please contact support.`;\n    }\n    \n    const messages: Record<string, string> = {\n      'cancelled': 'Your subscription has been cancelled. Please contact support to reactivate your account.',\n      'expired': 'Your subscription has expired. Please renew to continue using our services.',\n      'suspended': 'Your subscription has been suspended. Please contact support for assistance.',\n      'past_due': 'Your subscription payment is past due. Please update your payment method.',\n      'paused': 'Your subscription is paused. Please contact support to reactivate your account.'\n    };\n    \n    return messages[status] || 'There is an issue with your subscription. Please contact support.';\n  }\n\n  /**\n   * Get allowed operations for subscription status\n   */\n  static getAllowedOperations(subscriptionStatus: string): string[] {\n    const operations: string[] = [];\n    \n    if (this.canPerformOperation(subscriptionStatus, 'read')) {\n      operations.push('read');\n    }\n    \n    if (this.canPerformOperation(subscriptionStatus, 'create')) {\n      operations.push('create');\n    }\n    \n    if (this.canPerformOperation(subscriptionStatus, 'update')) {\n      operations.push('update');\n    }\n    \n    if (this.canPerformOperation(subscriptionStatus, 'delete')) {\n      operations.push('delete');\n    }\n    \n    if (this.canPerformOperation(subscriptionStatus, 'admin')) {\n      operations.push('admin');\n    }\n    \n    return operations;\n  }\n\n  // ============================================================================\n  // PERIOD UTILITIES\n  // ============================================================================\n\n  /**\n   * Calculate subscription period details\n   */\n  static calculatePeriod(\n    startDate: Date,\n    endDate: Date,\n    status: string,\n    interval: string = 'month'\n  ): SubscriptionPeriod {\n    const now = new Date();\n    const daysRemaining = Math.max(0, Math.ceil((endDate.getTime() - now.getTime()) / (1000 * 60 * 60 * 24)));\n    \n    return {\n      startDate,\n      endDate,\n      duration: interval,\n      isActive: status.toLowerCase() === 'active' || status.toLowerCase() === 'trial',\n      daysRemaining,\n      nextBillingDate: endDate,\n      isTrial: status.toLowerCase() === 'trial'\n    };\n  }\n\n  /**\n   * Format subscription period for display\n   */\n  static formatPeriod(period: SubscriptionPeriod) {\n    const formatDate = (date: Date) => {\n      return new Intl.DateTimeFormat('en-US', {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric'\n      }).format(date);\n    };\n\n    const formatTimeRemaining = (days: number) => {\n      if (days <= 0) return 'Expired';\n      if (days === 1) return '1 day remaining';\n      if (days < 30) return `${days} days remaining`;\n      if (days < 365) {\n        const months = Math.floor(days / 30);\n        return months === 1 ? '1 month remaining' : `${months} months remaining`;\n      }\n      const years = Math.floor(days / 365);\n      return years === 1 ? '1 year remaining' : `${years} years remaining`;\n    };\n\n    return {\n      period: `${formatDate(period.startDate)} - ${formatDate(period.endDate)}`,\n      duration: period.duration,\n      timeRemaining: formatTimeRemaining(period.daysRemaining),\n      nextBilling: formatDate(period.nextBillingDate),\n      isActive: period.isActive,\n      isTrial: period.isTrial\n    };\n  }\n\n  /**\n   * Get subscription status badge\n   */\n  static getStatusBadge(status: string, daysRemaining: number) {\n    const statusConfig = {\n      active: { color: 'bg-green-100 text-green-800', text: 'Active' },\n      trial: { color: 'bg-blue-100 text-blue-800', text: 'Trial' },\n      expired: { color: 'bg-red-100 text-red-800', text: 'Expired' },\n      cancelled: { color: 'bg-gray-100 text-gray-800', text: 'Cancelled' },\n      suspended: { color: 'bg-orange-100 text-orange-800', text: 'Suspended' },\n      past_due: { color: 'bg-yellow-100 text-yellow-800', text: 'Past Due' },\n      paused: { color: 'bg-purple-100 text-purple-800', text: 'Paused' }\n    };\n    \n    const config = statusConfig[status.toLowerCase() as keyof typeof statusConfig] || \n      { color: 'bg-gray-100 text-gray-800', text: status };\n    \n    return {\n      color: config.color,\n      text: config.text,\n      daysRemaining\n    };\n  }\n\n  // ============================================================================\n  // RENEWAL UTILITIES\n  // ============================================================================\n\n  /**\n   * Calculate new billing date based on subscription interval\n   */\n  static calculateNewBillingDate(subscription: any): Date {\n    const currentDate = new Date();\n    const interval = subscription.interval || 'month';\n    const intervalCount = subscription.intervalCount || 1;\n    \n    const newDate = new Date(currentDate);\n    \n    switch (interval) {\n      case 'day':\n        newDate.setDate(newDate.getDate() + intervalCount);\n        break;\n      case 'week':\n        newDate.setDate(newDate.getDate() + (intervalCount * 7));\n        break;\n      case 'month':\n        newDate.setMonth(newDate.getMonth() + intervalCount);\n        break;\n      case 'year':\n        newDate.setFullYear(newDate.getFullYear() + intervalCount);\n        break;\n      default:\n        newDate.setMonth(newDate.getMonth() + intervalCount);\n    }\n    \n    return newDate;\n  }\n\n  /**\n   * Check if subscription is expired\n   */\n  static isExpired(subscription: any): boolean {\n    if (!subscription.currentPeriodEnd) return false;\n    const now = new Date();\n    const endDate = new Date(subscription.currentPeriodEnd);\n    return now > endDate;\n  }\n\n  /**\n   * Check if grace period is exceeded\n   */\n  static isGracePeriodExceeded(\n    subscription: any,\n    gracePeriodDays: number = 7\n  ): boolean {\n    if (!subscription.currentPeriodEnd) return false;\n    \n    const now = new Date();\n    const endDate = new Date(subscription.currentPeriodEnd);\n    const gracePeriodEnd = new Date(endDate.getTime() + (gracePeriodDays * 24 * 60 * 60 * 1000));\n    \n    return now > gracePeriodEnd;\n  }\n\n  /**\n   * Validate subscription for renewal\n   */\n  static validateForRenewal(\n    subscription: any,\n    gracePeriodDays: number = 7\n  ): {\n    canRenew: boolean;\n    reason?: string;\n  } {\n    if (!subscription) {\n      return {\n        canRenew: false,\n        reason: 'Subscription not found'\n      };\n    }\n    \n    if (subscription.status === 'cancelled') {\n      return {\n        canRenew: false,\n        reason: 'Subscription is cancelled'\n      };\n    }\n    \n    if (subscription.status === 'active' && !this.isExpired(subscription)) {\n      return {\n        canRenew: false,\n        reason: 'Subscription is still active'\n      };\n    }\n    \n    if (this.isGracePeriodExceeded(subscription, gracePeriodDays)) {\n      return {\n        canRenew: false,\n        reason: 'Grace period exceeded'\n      };\n    }\n    \n    return {\n      canRenew: true\n    };\n  }\n\n  // ============================================================================\n  // UTILITY FUNCTIONS\n  // ============================================================================\n\n  /**\n   * Get subscription status priority (for sorting/display)\n   */\n  static getStatusPriority(status: string): number {\n    const priorities: Record<string, number> = {\n      'active': 1,\n      'trial': 2,\n      'past_due': 3,\n      'paused': 4,\n      'suspended': 5,\n      'expired': 6,\n      'cancelled': 7\n    };\n    \n    return priorities[status.toLowerCase()] || 999;\n  }\n\n  /**\n   * Sort subscriptions by status priority\n   */\n  static sortByStatus(subscriptions: any[]): any[] {\n    return [...subscriptions].sort((a, b) => {\n      const priorityA = this.getStatusPriority(a.status);\n      const priorityB = this.getStatusPriority(b.status);\n      return priorityA - priorityB;\n    });\n  }\n\n  /**\n   * Check if subscription needs attention\n   */\n  static needsAttention(subscription: any): {\n    needsAttention: boolean;\n    reason?: string;\n    urgency: 'low' | 'medium' | 'high' | 'critical';\n  } {\n    if (!subscription) {\n      return {\n        needsAttention: false,\n        urgency: 'low'\n      };\n    }\n    \n    const status = subscription.status?.toLowerCase();\n    const daysRemaining = subscription.daysRemaining || 0;\n    \n    // Critical: Expired or cancelled\n    if (status === 'expired' || status === 'cancelled') {\n      return {\n        needsAttention: true,\n        reason: `Subscription is ${status}`,\n        urgency: 'critical'\n      };\n    }\n    \n    // High: Suspended or past due\n    if (status === 'suspended' || status === 'past_due') {\n      return {\n        needsAttention: true,\n        reason: `Subscription is ${status}`,\n        urgency: 'high'\n      };\n    }\n    \n    // Medium: Trial ending soon or paused\n    if (status === 'trial' && daysRemaining <= 3) {\n      return {\n        needsAttention: true,\n        reason: 'Trial ending soon',\n        urgency: 'medium'\n      };\n    }\n    \n    if (status === 'paused') {\n      return {\n        needsAttention: true,\n        reason: 'Subscription is paused',\n        urgency: 'medium'\n      };\n    }\n    \n    // Low: Active but ending soon\n    if (status === 'active' && daysRemaining <= 7) {\n      return {\n        needsAttention: true,\n        reason: 'Subscription ending soon',\n        urgency: 'low'\n      };\n    }\n    \n    return {\n      needsAttention: false,\n      urgency: 'low'\n    };\n  }\n}\n\n// ============================================================================\n// BACKWARD COMPATIBILITY EXPORTS\n// ============================================================================\n\n// Export individual functions for backward compatibility\nexport const checkSubscriptionStatus = SubscriptionManager.checkStatus;\nexport const shouldThrowPlanLimitError = SubscriptionManager.shouldThrowError;\nexport const getPlanLimitError = SubscriptionManager.getError;\nexport const getSubscriptionError = SubscriptionManager.getError; // Backward compatibility alias\nexport const validateSubscriptionAccess = SubscriptionManager.validateAccess;\nexport const canPerformOperation = SubscriptionManager.canPerformOperation;\nexport const getPlanLimitErrorMessage = SubscriptionManager.getErrorMessage;\nexport const getAllowedOperations = SubscriptionManager.getAllowedOperations;\nexport const calculateSubscriptionPeriod = SubscriptionManager.calculatePeriod;\nexport const formatSubscriptionPeriod = SubscriptionManager.formatPeriod;\nexport const getSubscriptionStatusBadge = SubscriptionManager.getStatusBadge;\nexport const calculateNewBillingDate = SubscriptionManager.calculateNewBillingDate;\nexport const isSubscriptionExpired = SubscriptionManager.isExpired;\nexport const isGracePeriodExceeded = SubscriptionManager.isGracePeriodExceeded;\nexport const validateForRenewal = SubscriptionManager.validateForRenewal;\nexport const getSubscriptionStatusPriority = SubscriptionManager.getStatusPriority;\nexport const sortSubscriptionsByStatus = SubscriptionManager.sortByStatus;\nexport const subscriptionNeedsAttention = SubscriptionManager.needsAttention;\n","// ============================================================================\n// SIMPLE PRORATION CALCULATION\n// ============================================================================\n\nexport interface ProrationCalculation {\n  isUpgrade: boolean;\n  isDowngrade: boolean;\n  currentPlanPrice: number;\n  newPlanPrice: number;\n  daysRemaining: number;\n  daysInPeriod: number;\n  proratedAmount: number;\n  creditAmount: number;\n  chargeAmount: number;\n  reason: string;\n}\n\n/**\n * Calculate proration for plan changes\n * Simple logic: Charge difference for upgrades, credit for downgrades\n */\nexport function calculateProration(\n  currentSubscription: {\n    amount: number;\n    currentPeriodStart: Date;\n    currentPeriodEnd: Date;\n  },\n  newPlanPrice: number,\n  changeDate: Date = new Date()\n): ProrationCalculation {\n  const currentPrice = currentSubscription.amount;\n  const priceDifference = newPlanPrice - currentPrice;\n  \n  // Calculate days\n  const periodStart = new Date(currentSubscription.currentPeriodStart);\n  const periodEnd = new Date(currentSubscription.currentPeriodEnd);\n  const daysInPeriod = Math.ceil((periodEnd.getTime() - periodStart.getTime()) / (1000 * 60 * 60 * 24));\n  const daysRemaining = Math.ceil((periodEnd.getTime() - changeDate.getTime()) / (1000 * 60 * 60 * 24));\n  \n  // Determine if upgrade or downgrade\n  const isUpgrade = priceDifference > 0;\n  const isDowngrade = priceDifference < 0;\n  \n  // Calculate prorated amounts\n  const dailyRate = Math.abs(priceDifference) / daysInPeriod;\n  const proratedAmount = dailyRate * daysRemaining;\n  \n  let chargeAmount = 0;\n  let creditAmount = 0;\n  let reason = '';\n  \n  if (isUpgrade) {\n    // Charge the prorated difference for upgrades\n    chargeAmount = Math.round(proratedAmount * 100) / 100; // Round to 2 decimal places\n    reason = `Upgrade proration: ${daysRemaining} days remaining at $${dailyRate.toFixed(2)}/day`;\n  } else if (isDowngrade) {\n    // Credit the prorated difference for downgrades\n    creditAmount = Math.round(proratedAmount * 100) / 100;\n    reason = `Downgrade credit: ${daysRemaining} days remaining at $${dailyRate.toFixed(2)}/day`;\n  } else {\n    // Same price - no proration needed\n    reason = 'Same price - no proration needed';\n  }\n  \n  return {\n    isUpgrade,\n    isDowngrade,\n    currentPlanPrice: currentPrice,\n    newPlanPrice,\n    daysRemaining,\n    daysInPeriod,\n    proratedAmount,\n    creditAmount,\n    chargeAmount,\n    reason\n  };\n}\n\n/**\n * Check if proration should be applied\n * Simple rule: Only apply proration for upgrades (charge difference)\n */\nexport function shouldApplyProration(\n  currentPrice: number,\n  newPrice: number\n): boolean {\n  // Only charge proration for upgrades (new price > current price)\n  return newPrice > currentPrice;\n}\n\n/**\n * Format proration for display\n */\nexport function formatProration(proration: ProrationCalculation): string {\n  if (proration.chargeAmount > 0) {\n    return `Charge $${proration.chargeAmount.toFixed(2)} (${proration.reason})`;\n  } else if (proration.creditAmount > 0) {\n    return `Credit $${proration.creditAmount.toFixed(2)} (${proration.reason})`;\n  } else {\n    return 'No proration needed';\n  }\n}\n","/**\n * Centralized Badge Utilities\n * \n * Provides consistent badge generation across all entity types\n * with proper styling and icon handling.\n */\n\nimport React from 'react';\nimport { \n  UserCheck, \n  UserX, \n  CheckCircle, \n  XCircle,\n  MapPin,\n  Building2,\n  Store,\n  User as UserIcon,\n  Shield,\n  Package,\n  DollarSign,\n  TrendingUp,\n  TrendingDown,\n  AlertTriangle,\n  ShoppingCart\n} from 'lucide-react';\nimport { ENTITY_STATUS, USER_ROLE, getStatusColor, getStatusLabel } from '@rentalshop/constants';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface BadgeConfig {\n  color: string;\n  icon: React.ComponentType<{ className?: string }>;\n  text: string;\n}\n\nexport interface StatusBadgeProps {\n  isActive: boolean;\n  entityType?: 'entity' | 'availability';\n}\n\nexport interface RoleBadgeProps {\n  role: string;\n}\n\nexport interface LocationBadgeProps {\n  city?: string;\n  state?: string;\n}\n\nexport interface AvailabilityBadgeProps {\n  available: number;\n  totalStock: number;\n}\n\n// ============================================================================\n// STATUS BADGES\n// ============================================================================\n\n/**\n * Get status badge configuration for any entity\n */\nexport const getStatusBadgeConfig = (isActive: boolean, entityType: 'entity' | 'availability' = 'entity'): BadgeConfig => {\n  const status = isActive ? ENTITY_STATUS.ACTIVE : ENTITY_STATUS.INACTIVE;\n  const colorClass = getStatusColor(status, entityType);\n  const label = getStatusLabel(status, entityType);\n  \n  let Icon: React.ComponentType<{ className?: string }>;\n  \n  switch (entityType) {\n    case 'availability':\n      Icon = isActive ? CheckCircle : XCircle;\n      break;\n    default:\n      Icon = isActive ? UserCheck : UserX;\n  }\n  \n  return {\n    color: colorClass,\n    icon: Icon,\n    text: label\n  };\n};\n\n/**\n * Generate status badge component\n */\nexport const getStatusBadge = ({ isActive, entityType = 'entity' }: StatusBadgeProps) => {\n  const config = getStatusBadgeConfig(isActive, entityType);\n  const Icon = config.icon;\n  \n  return (\n    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n      <Icon className=\"w-3 h-3 mr-1\" />\n      {config.text}\n    </span>\n  );\n};\n\n// ============================================================================\n// ROLE BADGES\n// ============================================================================\n\n/**\n * Get role badge configuration\n */\nexport const getRoleBadgeConfig = (role: string): BadgeConfig => {\n  const roleConfig = {\n    [USER_ROLE.ADMIN]: { color: 'bg-red-100 text-red-800', icon: Shield, text: 'Admin' },\n    [USER_ROLE.MERCHANT]: { color: 'bg-blue-100 text-blue-800', icon: Building2, text: 'Merchant' },\n    [USER_ROLE.OUTLET_ADMIN]: { color: 'bg-green-100 text-green-800', icon: Store, text: 'Outlet Admin' },\n    [USER_ROLE.OUTLET_STAFF]: { color: 'bg-gray-100 text-gray-800', icon: UserIcon, text: 'Outlet Staff' }\n  };\n  \n  return roleConfig[role as keyof typeof roleConfig] || {\n    color: 'bg-gray-100 text-gray-800',\n    icon: UserIcon,\n    text: role\n  };\n};\n\n/**\n * Generate role badge component\n */\nexport const getRoleBadge = ({ role }: RoleBadgeProps) => {\n  const config = getRoleBadgeConfig(role);\n  const Icon = config.icon;\n  \n  return (\n    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n      <Icon className=\"w-3 h-3 mr-1\" />\n      {config.text}\n    </span>\n  );\n};\n\n// ============================================================================\n// LOCATION BADGES\n// ============================================================================\n\n/**\n * Get location badge configuration\n */\nexport const getLocationBadgeConfig = (city?: string, state?: string): BadgeConfig | null => {\n  if (!city && !state) {\n    return null;\n  }\n  \n  const location = [city, state].filter(Boolean).join(', ');\n  \n  return {\n    color: 'bg-blue-100 text-blue-800',\n    icon: MapPin,\n    text: location\n  };\n};\n\n/**\n * Generate location badge component\n */\nexport const getLocationBadge = ({ city, state }: LocationBadgeProps) => {\n  const config = getLocationBadgeConfig(city, state);\n  \n  if (!config) {\n    return (\n      <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-500\">\n        <MapPin className=\"w-3 h-3 mr-1\" />\n        No location\n      </span>\n    );\n  }\n  \n  const Icon = config.icon;\n  \n  return (\n    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n      <Icon className=\"w-3 h-3 mr-1\" />\n      {config.text}\n    </span>\n  );\n};\n\n// ============================================================================\n// AVAILABILITY BADGES\n// ============================================================================\n\n/**\n * Get availability badge configuration\n */\nexport const getAvailabilityBadgeConfig = (available: number, totalStock: number): BadgeConfig => {\n  const stockPercentage = totalStock > 0 ? (available / totalStock) * 100 : 0;\n  \n  if (available === 0) {\n    return {\n      color: 'bg-red-100 text-red-800',\n      icon: XCircle,\n      text: 'Out of Stock'\n    };\n  } else if (stockPercentage < 20) {\n    return {\n      color: 'bg-orange-100 text-orange-800',\n      icon: AlertTriangle,\n      text: 'Low Stock'\n    };\n  } else if (stockPercentage < 50) {\n    return {\n      color: 'bg-yellow-100 text-yellow-800',\n      icon: TrendingDown,\n      text: 'Limited'\n    };\n  } else {\n    return {\n      color: 'bg-green-100 text-green-800',\n      icon: CheckCircle,\n      text: 'In Stock'\n    };\n  }\n};\n\n/**\n * Generate availability badge component\n */\nexport const getAvailabilityBadge = ({ available, totalStock }: AvailabilityBadgeProps) => {\n  const config = getAvailabilityBadgeConfig(available, totalStock);\n  const Icon = config.icon;\n  \n  return (\n    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n      <Icon className=\"w-3 h-3 mr-1\" />\n      {config.text}\n    </span>\n  );\n};\n\n// ============================================================================\n// PRICE BADGES\n// ============================================================================\n\n/**\n * Get price trend badge configuration\n */\nexport const getPriceTrendBadgeConfig = (currentPrice: number, previousPrice: number): BadgeConfig => {\n  const difference = currentPrice - previousPrice;\n  const percentage = previousPrice > 0 ? (difference / previousPrice) * 100 : 0;\n  \n  if (difference > 0) {\n    return {\n      color: 'bg-red-100 text-red-800',\n      icon: TrendingUp,\n      text: `+${percentage.toFixed(1)}%`\n    };\n  } else if (difference < 0) {\n    return {\n      color: 'bg-green-100 text-green-800',\n      icon: TrendingDown,\n      text: `${percentage.toFixed(1)}%`\n    };\n  } else {\n    return {\n      color: 'bg-gray-100 text-gray-800',\n      icon: DollarSign,\n      text: 'No Change'\n    };\n  }\n};\n\n/**\n * Generate price trend badge component\n */\nexport const getPriceTrendBadge = (currentPrice: number, previousPrice: number) => {\n  const config = getPriceTrendBadgeConfig(currentPrice, previousPrice);\n  const Icon = config.icon;\n  \n  return (\n    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n      <Icon className=\"w-3 h-3 mr-1\" />\n      {config.text}\n    </span>\n  );\n};\n\n// ============================================================================\n// CONVENIENCE FUNCTIONS\n// ============================================================================\n\n/**\n * Generate customer status badge (backward compatibility)\n */\nexport const getCustomerStatusBadge = (isActive: boolean) => \n  getStatusBadge({ isActive, entityType: 'entity' });\n\n/**\n * Generate user status badge (backward compatibility)\n */\nexport const getUserStatusBadge = (isActive: boolean) => \n  getStatusBadge({ isActive, entityType: 'entity' });\n\n/**\n * Generate product status badge (backward compatibility)\n */\nexport const getProductStatusBadge = (isActive: boolean) => \n  getStatusBadge({ isActive, entityType: 'availability' });\n","export default {\n  xmlns: 'http://www.w3.org/2000/svg',\n  width: 24,\n  height: 24,\n  viewBox: '0 0 24 24',\n  fill: 'none',\n  stroke: 'currentColor',\n  strokeWidth: 2,\n  strokeLinecap: 'round',\n  strokeLinejoin: 'round',\n};\n","import { forwardRef, createElement, ReactSVG, SVGProps, ForwardRefExoticComponent, RefAttributes } from 'react';\nimport defaultAttributes from './defaultAttributes';\n\nexport type IconNode = [elementName: keyof ReactSVG, attrs: Record<string, string>][]\n\nexport type SVGAttributes = Partial<SVGProps<SVGSVGElement>>\ntype ComponentAttributes = RefAttributes<SVGSVGElement> & SVGAttributes\n\nexport interface LucideProps extends ComponentAttributes {\n  size?: string | number\n  absoluteStrokeWidth?: boolean\n}\n\nexport type LucideIcon = ForwardRefExoticComponent<LucideProps>;\n/**\n * Converts string to KebabCase\n * Copied from scripts/helper. If anyone knows how to properly import it here\n * then please fix it.\n *\n * @param {string} string\n * @returns {string} A kebabized string\n */\nexport const toKebabCase = (string: string) => string.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();\n\nconst createLucideIcon = (iconName: string, iconNode: IconNode): LucideIcon => {\n  const Component = forwardRef<SVGSVGElement, LucideProps>(\n    ({ color = 'currentColor', size = 24, strokeWidth = 2, absoluteStrokeWidth, children, ...rest }, ref) =>\n      createElement(\n        'svg',\n        {\n          ref,\n          ...defaultAttributes,\n          width: size,\n          height: size,\n          stroke: color,\n          strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n          className: `lucide lucide-${toKebabCase(iconName)}`,\n          ...rest,\n        },\n        [\n          ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n          ...(\n            (Array.isArray(children) ? children : [children]) || []\n          )\n        ],\n      ),\n  );\n\n  Component.displayName = `${iconName}`;\n\n  return Component;\n};\n\nexport default createLucideIcon\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name AlertTriangle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjEuNzMgMTgtOC0xNGEyIDIgMCAwIDAtMy40OCAwbC04IDE0QTIgMiAwIDAgMCA0IDIxaDE2YTIgMiAwIDAgMCAxLjczLTNaIiAvPgogIDxwYXRoIGQ9Ik0xMiA5djQiIC8+CiAgPHBhdGggZD0iTTEyIDE3aC4wMSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/alert-triangle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst AlertTriangle = createLucideIcon('AlertTriangle', [\n  [\n    'path',\n    {\n      d: 'm21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z',\n      key: 'c3ski4',\n    },\n  ],\n  ['path', { d: 'M12 9v4', key: 'juzpu7' }],\n  ['path', { d: 'M12 17h.01', key: 'p32p05' }],\n]);\n\nexport default AlertTriangle;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Building2\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNiAyMlY0YTIgMiAwIDAgMSAyLTJoOGEyIDIgMCAwIDEgMiAydjE4WiIgLz4KICA8cGF0aCBkPSJNNiAxMkg0YTIgMiAwIDAgMC0yIDJ2NmEyIDIgMCAwIDAgMiAyaDIiIC8+CiAgPHBhdGggZD0iTTE4IDloMmEyIDIgMCAwIDEgMiAydjlhMiAyIDAgMCAxLTIgMmgtMiIgLz4KICA8cGF0aCBkPSJNMTAgNmg0IiAvPgogIDxwYXRoIGQ9Ik0xMCAxMGg0IiAvPgogIDxwYXRoIGQ9Ik0xMCAxNGg0IiAvPgogIDxwYXRoIGQ9Ik0xMCAxOGg0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/building-2\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Building2 = createLucideIcon('Building2', [\n  ['path', { d: 'M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z', key: '1b4qmf' }],\n  ['path', { d: 'M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2', key: 'i71pzd' }],\n  ['path', { d: 'M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2', key: '10jefs' }],\n  ['path', { d: 'M10 6h4', key: '1itunk' }],\n  ['path', { d: 'M10 10h4', key: 'tcdvrf' }],\n  ['path', { d: 'M10 14h4', key: 'kelpxr' }],\n  ['path', { d: 'M10 18h4', key: '1ulq68' }],\n]);\n\nexport default Building2;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name CheckCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjIgMTEuMDhWMTJhMTAgMTAgMCAxIDEtNS45My05LjE0IiAvPgogIDxwb2x5bGluZSBwb2ludHM9IjIyIDQgMTIgMTQuMDEgOSAxMS4wMSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/check-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CheckCircle = createLucideIcon('CheckCircle', [\n  ['path', { d: 'M22 11.08V12a10 10 0 1 1-5.93-9.14', key: 'g774vq' }],\n  ['polyline', { points: '22 4 12 14.01 9 11.01', key: '6xbx8j' }],\n]);\n\nexport default CheckCircle;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name DollarSign\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8bGluZSB4MT0iMTIiIHgyPSIxMiIgeTE9IjIiIHkyPSIyMiIgLz4KICA8cGF0aCBkPSJNMTcgNUg5LjVhMy41IDMuNSAwIDAgMCAwIDdoNWEzLjUgMy41IDAgMCAxIDAgN0g2IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/dollar-sign\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst DollarSign = createLucideIcon('DollarSign', [\n  ['line', { x1: '12', x2: '12', y1: '2', y2: '22', key: '7eqyqh' }],\n  [\n    'path',\n    { d: 'M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6', key: '1b0p4s' },\n  ],\n]);\n\nexport default DollarSign;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name FileText\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTQuNSAySDZhMiAyIDAgMCAwLTIgMnYxNmEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWNy41TDE0LjUgMnoiIC8+CiAgPHBvbHlsaW5lIHBvaW50cz0iMTQgMiAxNCA4IDIwIDgiIC8+CiAgPGxpbmUgeDE9IjE2IiB4Mj0iOCIgeTE9IjEzIiB5Mj0iMTMiIC8+CiAgPGxpbmUgeDE9IjE2IiB4Mj0iOCIgeTE9IjE3IiB5Mj0iMTciIC8+CiAgPGxpbmUgeDE9IjEwIiB4Mj0iOCIgeTE9IjkiIHkyPSI5IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/file-text\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst FileText = createLucideIcon('FileText', [\n  [\n    'path',\n    {\n      d: 'M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z',\n      key: '1nnpy2',\n    },\n  ],\n  ['polyline', { points: '14 2 14 8 20 8', key: '1ew0cm' }],\n  ['line', { x1: '16', x2: '8', y1: '13', y2: '13', key: '14keom' }],\n  ['line', { x1: '16', x2: '8', y1: '17', y2: '17', key: '17nazh' }],\n  ['line', { x1: '10', x2: '8', y1: '9', y2: '9', key: '1a5vjj' }],\n]);\n\nexport default FileText;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name MapPin\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjAgMTBjMCA2LTggMTItOCAxMnMtOC02LTgtMTJhOCA4IDAgMCAxIDE2IDBaIiAvPgogIDxjaXJjbGUgY3g9IjEyIiBjeT0iMTAiIHI9IjMiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/map-pin\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst MapPin = createLucideIcon('MapPin', [\n  [\n    'path',\n    { d: 'M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z', key: '2oe9fu' },\n  ],\n  ['circle', { cx: '12', cy: '10', r: '3', key: 'ilqhr7' }],\n]);\n\nexport default MapPin;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Package\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYuNSA5LjQgNy41NSA0LjI0IiAvPgogIDxwYXRoIGQ9Ik0yMSAxNlY4YTIgMiAwIDAgMC0xLTEuNzNsLTctNGEyIDIgMCAwIDAtMiAwbC03IDRBMiAyIDAgMCAwIDMgOHY4YTIgMiAwIDAgMCAxIDEuNzNsNyA0YTIgMiAwIDAgMCAyIDBsNy00QTIgMiAwIDAgMCAyMSAxNnoiIC8+CiAgPHBvbHlsaW5lIHBvaW50cz0iMy4yOSA3IDEyIDEyIDIwLjcxIDciIC8+CiAgPGxpbmUgeDE9IjEyIiB4Mj0iMTIiIHkxPSIyMiIgeTI9IjEyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/package\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Package = createLucideIcon('Package', [\n  ['path', { d: 'M16.5 9.4 7.55 4.24', key: '10qotr' }],\n  [\n    'path',\n    {\n      d: 'M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z',\n      key: 'yt0hxn',\n    },\n  ],\n  ['polyline', { points: '3.29 7 12 12 20.71 7', key: 'ousv84' }],\n  ['line', { x1: '12', x2: '12', y1: '22', y2: '12', key: 'a4e8g8' }],\n]);\n\nexport default Package;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Shield\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTIgMjJzOC00IDgtMTBWNWwtOC0zLTggM3Y3YzAgNiA4IDEwIDggMTB6IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/shield\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Shield = createLucideIcon('Shield', [\n  ['path', { d: 'M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z', key: '3xmgem' }],\n]);\n\nexport default Shield;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ShoppingCart\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSI4IiBjeT0iMjEiIHI9IjEiIC8+CiAgPGNpcmNsZSBjeD0iMTkiIGN5PSIyMSIgcj0iMSIgLz4KICA8cGF0aCBkPSJNMi4wNSAyLjA1aDJsMi42NiAxMi40MmEyIDIgMCAwIDAgMiAxLjU4aDkuNzhhMiAyIDAgMCAwIDEuOTUtMS41N2wxLjY1LTcuNDNINS4xMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/shopping-cart\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ShoppingCart = createLucideIcon('ShoppingCart', [\n  ['circle', { cx: '8', cy: '21', r: '1', key: 'jimo8o' }],\n  ['circle', { cx: '19', cy: '21', r: '1', key: '13723u' }],\n  [\n    'path',\n    {\n      d: 'M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12',\n      key: '9zh506',\n    },\n  ],\n]);\n\nexport default ShoppingCart;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Store\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMiA3IDQuNDEtNC40MUEyIDIgMCAwIDEgNy44MyAyaDguMzRhMiAyIDAgMCAxIDEuNDIuNTlMMjIgNyIvPgogIDxwYXRoIGQ9Ik00IDEydjhhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0ydi04Ii8+CiAgPHBhdGggZD0iTTE1IDIydi00YTIgMiAwIDAgMC0yLTJoLTJhMiAyIDAgMCAwLTIgMnY0Ii8+CiAgPHBhdGggZD0iTTIgN2gyMCIvPgogIDxwYXRoIGQ9Ik0yMiA3djNhMiAyIDAgMCAxLTIgMnYwYTIuNyAyLjcgMCAwIDEtMS41OS0uNjMuNy43IDAgMCAwLS44MiAwQTIuNyAyLjcgMCAwIDEgMTYgMTJhMi43IDIuNyAwIDAgMS0xLjU5LS42My43LjcgMCAwIDAtLjgyIDBBMi43IDIuNyAwIDAgMSAxMiAxMmEyLjcgMi43IDAgMCAxLTEuNTktLjYzLjcuNyAwIDAgMC0uODIgMEEyLjcgMi43IDAgMCAxIDggMTJhMi43IDIuNyAwIDAgMS0xLjU5LS42My43LjcgMCAwIDAtLjgyIDBBMi43IDIuNyAwIDAgMSA0IDEydjBhMiAyIDAgMCAxLTItMlY3Ii8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/store\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Store = createLucideIcon('Store', [\n  [\n    'path',\n    {\n      d: 'm2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7',\n      key: 'ztvudi',\n    },\n  ],\n  ['path', { d: 'M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8', key: '1b2hhj' }],\n  ['path', { d: 'M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4', key: '2ebpfo' }],\n  ['path', { d: 'M2 7h20', key: '1fcdvo' }],\n  [\n    'path',\n    {\n      d: 'M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7',\n      key: 'jon5kx',\n    },\n  ],\n]);\n\nexport default Store;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name TrendingDown\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cG9seWxpbmUgcG9pbnRzPSIyMiAxNyAxMy41IDguNSA4LjUgMTMuNSAyIDciIC8+CiAgPHBvbHlsaW5lIHBvaW50cz0iMTYgMTcgMjIgMTcgMjIgMTEiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/trending-down\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst TrendingDown = createLucideIcon('TrendingDown', [\n  ['polyline', { points: '22 17 13.5 8.5 8.5 13.5 2 7', key: '1r2t7k' }],\n  ['polyline', { points: '16 17 22 17 22 11', key: '11uiuu' }],\n]);\n\nexport default TrendingDown;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name TrendingUp\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cG9seWxpbmUgcG9pbnRzPSIyMiA3IDEzLjUgMTUuNSA4LjUgMTAuNSAyIDE3IiAvPgogIDxwb2x5bGluZSBwb2ludHM9IjE2IDcgMjIgNyAyMiAxMyIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/trending-up\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst TrendingUp = createLucideIcon('TrendingUp', [\n  ['polyline', { points: '22 7 13.5 15.5 8.5 10.5 2 17', key: '126l90' }],\n  ['polyline', { points: '16 7 22 7 22 13', key: 'kwv8wd' }],\n]);\n\nexport default TrendingUp;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name UserCheck\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMjF2LTJhNCA0IDAgMCAwLTQtNEg2YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8Y2lyY2xlIGN4PSI5IiBjeT0iNyIgcj0iNCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSIxNiAxMSAxOCAxMyAyMiA5IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/user-check\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst UserCheck = createLucideIcon('UserCheck', [\n  ['path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2', key: '1yyitq' }],\n  ['circle', { cx: '9', cy: '7', r: '4', key: 'nufk8' }],\n  ['polyline', { points: '16 11 18 13 22 9', key: '1pwet4' }],\n]);\n\nexport default UserCheck;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name UserX\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMjF2LTJhNCA0IDAgMCAwLTQtNEg2YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8Y2lyY2xlIGN4PSI5IiBjeT0iNyIgcj0iNCIgLz4KICA8bGluZSB4MT0iMTciIHgyPSIyMiIgeTE9IjgiIHkyPSIxMyIgLz4KICA8bGluZSB4MT0iMjIiIHgyPSIxNyIgeTE9IjgiIHkyPSIxMyIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/user-x\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst UserX = createLucideIcon('UserX', [\n  ['path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2', key: '1yyitq' }],\n  ['circle', { cx: '9', cy: '7', r: '4', key: 'nufk8' }],\n  ['line', { x1: '17', x2: '22', y1: '8', y2: '13', key: '3nzzx3' }],\n  ['line', { x1: '22', x2: '17', y1: '8', y2: '13', key: '1swrse' }],\n]);\n\nexport default UserX;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name User\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTkgMjF2LTJhNCA0IDAgMCAwLTQtNEg5YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/user\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst User = createLucideIcon('User', [\n  ['path', { d: 'M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2', key: '975kel' }],\n  ['circle', { cx: '12', cy: '7', r: '4', key: '17ys0d' }],\n]);\n\nexport default User;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name XCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cGF0aCBkPSJtMTUgOS02IDYiIC8+CiAgPHBhdGggZD0ibTkgOSA2IDYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/x-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst XCircle = createLucideIcon('XCircle', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['path', { d: 'm15 9-6 6', key: '1uzhvr' }],\n  ['path', { d: 'm9 9 6 6', key: 'z0biqf' }],\n]);\n\nexport default XCircle;\n","import React from 'react';\nimport { \n  User, \n  Phone, \n  Mail,\n  Calendar,\n  FileText,\n  Building2,\n  MapPin\n} from 'lucide-react';\nimport type { Customer, CustomerFilters } from '@rentalshop/types';\nimport { getCustomerStatusBadge, getLocationBadge } from './badge-utils';\n\n/**\n * Get customer location badge configuration and component\n * @param city - Customer city\n * @param state - Customer state\n * @returns JSX element for location badge\n */\nexport const getCustomerLocationBadge = (city?: string, state?: string) => {\n  return getLocationBadge({ city, state });\n};\n\n/**\n * Get customer ID type badge configuration and component\n * @param idType - Customer ID type\n * @returns JSX element for ID type badge\n */\nexport const getCustomerIdTypeBadge = (idType?: string) => {\n  if (!idType) {\n    return (\n      <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800\">\n        <FileText className=\"w-3 h-3 mr-1\" />\n        No ID\n      </span>\n    );\n  }\n  \n  const idTypeConfig = {\n    'passport': { color: 'bg-purple-100 text-purple-800', text: 'Passport' },\n    'drivers_license': { color: 'bg-blue-100 text-blue-800', text: 'Driver License' },\n    'national_id': { color: 'bg-green-100 text-green-800', text: 'National ID' },\n    'other': { color: 'bg-gray-100 text-gray-800', text: 'Other' }\n  };\n  \n  const config = idTypeConfig[idType as keyof typeof idTypeConfig] || idTypeConfig.other;\n  \n  return (\n    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n      <FileText className=\"w-3 h-3 mr-1\" />\n      {config.text}\n    </span>\n  );\n};\n\n/**\n * Calculate customer statistics from customer array\n * @param customers - Array of customers\n * @returns Object with calculated statistics\n */\nexport const calculateCustomerStats = (customers: Customer[]) => {\n  const customersArray = customers || [];\n  const totalCustomers = customersArray.length;\n  const activeCustomers = customersArray.filter(c => c.isActive).length;\n  const inactiveCustomers = customersArray.filter(c => !c.isActive).length;\n  const customersWithEmail = customersArray.filter(c => c.email && c.email.trim() !== '').length;\n  const customersWithAddress = customersArray.filter(c => c.address && c.address.trim() !== '').length;\n  \n  // Group by location\n  const locationStats = customersArray.reduce((acc, customer) => {\n    const key = `${customer.city || 'Unknown'}, ${customer.state || 'Unknown'}`;\n    acc[key] = (acc[key] || 0) + 1;\n    return acc;\n  }, {} as Record<string, number>);\n  \n  const topLocation = Object.entries(locationStats).reduce((max, [location, count]) => \n    count > max.count ? { location, count } : max, \n    { location: 'None', count: 0 }\n  );\n  \n  return { \n    totalCustomers, \n    activeCustomers, \n    inactiveCustomers, \n    customersWithEmail,\n    customersWithAddress,\n    topLocation: topLocation.location,\n    topLocationCount: topLocation.count\n  };\n};\n\n/**\n * Filter customers based on search term and filters\n * @param customers - Array of customers to filter\n * @param searchTerm - Search term for name, email, phone\n * @param filters - Customer filters object\n * @returns Filtered array of customers\n */\nexport const filterCustomers = (\n  customers: Customer[], \n  searchTerm: string, \n  filters: CustomerFilters\n): Customer[] => {\n  return (customers || []).filter(customer => {\n    // Safety check to ensure customer object has required properties\n    if (!customer || typeof customer !== 'object') {\n      return false;\n    }\n    \n    const fullName = `${customer.firstName || ''} ${customer.lastName || ''}`.trim();\n    const matchesSearch = fullName.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         (customer.email || '').toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         (customer.phone || '').toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         (customer.address || '').toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesCity = !filters.city || (customer.city || '').toLowerCase().includes(filters.city.toLowerCase());\n    const matchesState = !filters.state || (customer.state || '').toLowerCase().includes(filters.state.toLowerCase());\n    const matchesCountry = !filters.country || (customer.country || '').toLowerCase().includes(filters.country.toLowerCase());\n    const matchesIdType = !filters.idType || customer.idType === filters.idType;\n    const matchesActive = filters.isActive === undefined || customer.isActive === filters.isActive;\n    const matchesMerchant = !filters.merchantId || customer.merchantId === filters.merchantId;\n    const matchesOutlet = !filters.outletId || customer.outletId === filters.outletId;\n    \n    return matchesSearch && matchesCity && matchesState && matchesCountry && \n           matchesIdType && matchesActive && matchesMerchant && matchesOutlet;\n  });\n};\n\n/**\n * Get customer's full name\n * @param customer - Customer object\n * @returns Full name string\n */\nexport const getCustomerFullName = (customer: Customer): string => {\n  return `${customer.firstName || ''} ${customer.lastName || ''}`.trim();\n};\n\n/**\n * Get customer's display address\n * @param customer - Customer object\n * @returns Formatted address string\n */\nexport const getCustomerAddress = (customer: Customer): string => {\n  const parts = [\n    customer.address,\n    customer.city,\n    customer.state,\n    customer.zipCode,\n    customer.country\n  ].filter(Boolean);\n  \n  return parts.join(', ') || 'No address provided';\n};\n\n/**\n * Get customer's contact info\n * @param customer - Customer object\n * @returns Object with contact information\n */\nexport const getCustomerContactInfo = (customer: Customer) => {\n  return {\n    email: customer.email || 'No email',\n    phone: customer.phone || 'No phone',\n    hasEmail: !!(customer.email && customer.email.trim() !== ''),\n    hasPhone: !!(customer.phone && customer.phone.trim() !== ''),\n    hasAddress: !!(customer.address && customer.address.trim() !== '')\n  };\n};\n\n/**\n * Format customer for display in tables/cards\n * @param customer - Customer object\n * @returns Formatted customer object with display properties\n */\nexport const formatCustomerForDisplay = (customer: Customer) => {\n  return {\n    ...customer,\n    fullName: getCustomerFullName(customer),\n    displayAddress: getCustomerAddress(customer),\n    contactInfo: getCustomerContactInfo(customer),\n    statusBadge: getCustomerStatusBadge(customer.isActive),\n    locationBadge: getCustomerLocationBadge(customer.city, customer.state),\n    idTypeBadge: getCustomerIdTypeBadge(customer.idType)\n  };\n};\n\n/**\n * Validate customer data\n * @param customer - Customer object to validate\n * @returns Object with validation results\n */\nexport const validateCustomer = (customer: Partial<Customer>) => {\n  const errors: string[] = [];\n  \n  if (!customer.firstName || customer.firstName.trim() === '') {\n    errors.push('First name is required');\n  }\n  \n  if (!customer.lastName || customer.lastName.trim() === '') {\n    errors.push('Last name is required');\n  }\n  \n  if (!customer.phone || customer.phone.trim() === '') {\n    errors.push('Phone number is required');\n  }\n  \n  if (customer.email && customer.email.trim() !== '') {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(customer.email)) {\n      errors.push('Invalid email format');\n    }\n  }\n  \n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\n/**\n * Get customer age from date of birth\n * @param dateOfBirth - Date of birth string or Date\n * @returns Age in years or null if invalid\n */\nexport const getCustomerAge = (dateOfBirth?: string | Date): number | null => {\n  if (!dateOfBirth) return null;\n  \n  try {\n    const birthDate = new Date(dateOfBirth);\n    const today = new Date();\n    let age = today.getFullYear() - birthDate.getFullYear();\n    const monthDiff = today.getMonth() - birthDate.getMonth();\n    \n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\n      age--;\n    }\n    \n    return age >= 0 ? age : null;\n  } catch {\n    return null;\n  }\n};\n","import React from 'react';\nimport { \n  Package, \n  DollarSign, \n  ShoppingCart,\n  Store,\n  XCircle,\n  AlertTriangle,\n  TrendingDown,\n  CheckCircle\n} from 'lucide-react';\nimport type { Product, ProductWithDetails } from '@rentalshop/types';\nimport { getProductStatusBadge, getAvailabilityBadge, getPriceTrendBadge } from './badge-utils';\n\n/**\n * Get product availability badge configuration and component\n * @param available - Available stock count\n * @param totalStock - Total stock count\n * @returns JSX element for availability badge\n */\nexport const getProductAvailabilityBadge = (available: number, totalStock: number) => {\n  const stockPercentage = totalStock > 0 ? (available / totalStock) * 100 : 0;\n  \n  let config;\n  if (available === 0) {\n    config = { color: 'bg-red-100 text-red-800', icon: XCircle, text: 'Out of Stock' };\n  } else if (stockPercentage < 25) {\n    config = { color: 'bg-orange-100 text-orange-800', icon: AlertTriangle, text: 'Low Stock' };\n  } else if (stockPercentage < 50) {\n    config = { color: 'bg-yellow-100 text-yellow-800', icon: TrendingDown, text: 'Limited Stock' };\n  } else {\n    config = { color: 'bg-green-100 text-green-800', icon: CheckCircle, text: 'In Stock' };\n  }\n  \n  const Icon = config.icon;\n  \n  return (\n    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n      <Icon className=\"w-3 h-3 mr-1\" />\n      {config.text}\n    </span>\n  );\n};\n\n/**\n * Get product type badge configuration and component\n * @param product - Product object\n * @returns JSX element for product type badge\n */\nexport const getProductTypeBadge = (product: Product | ProductWithDetails) => {\n  const hasRentPrice = product.rentPrice && product.rentPrice > 0;\n  const hasSalePrice = product.salePrice && product.salePrice > 0;\n  \n  let config;\n  if (hasRentPrice && hasSalePrice) {\n    config = { color: 'bg-blue-100 text-blue-800', icon: Package, text: 'Rent & Sale' };\n  } else if (hasRentPrice) {\n    config = { color: 'bg-purple-100 text-purple-800', icon: ShoppingCart, text: 'Rental Only' };\n  } else if (hasSalePrice) {\n    config = { color: 'bg-green-100 text-green-800', icon: DollarSign, text: 'Sale Only' };\n  } else {\n    config = { color: 'bg-gray-100 text-gray-800', icon: Package, text: 'No Pricing' };\n  }\n  \n  const Icon = config.icon;\n  \n  return (\n    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n      <Icon className=\"w-3 h-3 mr-1\" />\n      {config.text}\n    </span>\n  );\n};\n\n/**\n * Calculate product statistics from product array\n * @param products - Array of products\n * @returns Object with calculated statistics\n */\nexport const calculateProductStats = (products: Product[] | ProductWithDetails[]) => {\n  const productsArray = products || [];\n  const totalProducts = productsArray.length;\n  const activeProducts = productsArray.filter(p => p.isActive).length;\n  const inactiveProducts = productsArray.filter(p => !p.isActive).length;\n  const inStockProducts = productsArray.filter(p => p.available > 0).length;\n  const outOfStockProducts = productsArray.filter(p => p.available === 0).length;\n  const lowStockProducts = productsArray.filter(p => p.available > 0 && p.available < 5).length;\n  \n  // Calculate total stock value\n  const totalStockValue = productsArray.reduce((sum, product) => {\n    const stockValue = product.available * (product.rentPrice || 0);\n    return sum + stockValue;\n  }, 0);\n  \n  // Calculate average price\n  const productsWithPrice = productsArray.filter(p => p.rentPrice && p.rentPrice > 0);\n  const averagePrice = productsWithPrice.length > 0 \n    ? productsWithPrice.reduce((sum, p) => sum + (p.rentPrice || 0), 0) / productsWithPrice.length\n    : 0;\n  \n  return { \n    totalProducts, \n    activeProducts, \n    inactiveProducts, \n    inStockProducts,\n    outOfStockProducts,\n    lowStockProducts,\n    totalStockValue,\n    averagePrice\n  };\n};\n\n/**\n * Filter products based on search term, category, outlet, and availability\n * @param products - Array of products to filter\n * @param searchTerm - Search term for name, description, barcode\n * @param categoryFilter - Category filter ('all' or specific category ID)\n * @param outletFilter - Outlet filter ('all' or specific outlet ID)\n * @param availabilityFilter - Availability filter ('all', 'in-stock', 'out-of-stock', 'low-stock')\n * @param statusFilter - Status filter ('all', 'active', 'inactive')\n * @returns Filtered array of products\n */\nexport const filterProducts = (\n  products: Product[] | ProductWithDetails[], \n  searchTerm: string, \n  categoryFilter: string,\n  outletFilter: string,\n  availabilityFilter: string,\n  statusFilter: string\n): (Product[] | ProductWithDetails[]) => {\n  return (products || []).filter(product => {\n    // Safety check to ensure product object has required properties\n    if (!product || typeof product !== 'object') {\n      return false;\n    }\n    \n    const matchesSearch = (product.name || '').toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         (product.description || '').toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         (product.barcode || '').toLowerCase().includes(searchTerm.toLowerCase());\n    \n    // Check category - use categoryId for Product, category.id for ProductWithDetails\n    const productCategoryId = 'category' in product ? (product as any).category?.id : product.categoryId;\n    const matchesCategory = categoryFilter === 'all' || \n                           (productCategoryId && productCategoryId.toString() === categoryFilter);\n    \n    // Check outlet - only available in ProductWithDetails\n    const productOutletId = 'outlet' in product ? (product as any).outlet?.id : undefined;\n    const matchesOutlet = outletFilter === 'all' || \n                         (productOutletId && productOutletId.toString() === outletFilter);\n    \n    const matchesAvailability = availabilityFilter === 'all' ||\n                               (availabilityFilter === 'in-stock' && product.available > 0) ||\n                               (availabilityFilter === 'out-of-stock' && product.available === 0) ||\n                               (availabilityFilter === 'low-stock' && product.available > 0 && product.available < 5);\n    \n    const matchesStatus = statusFilter === 'all' || \n                         (statusFilter === 'active' && product.isActive) ||\n                         (statusFilter === 'inactive' && !product.isActive);\n    \n    return matchesSearch && matchesCategory && matchesOutlet && matchesAvailability && matchesStatus;\n  });\n};\n\n/**\n * Format product price for display\n * @param price - Price value\n * @param currency - Currency code (default: USD)\n * @returns Formatted price string\n */\nexport const formatProductPrice = (price: number, currency: string = 'USD'): string => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: currency\n  }).format(price);\n};\n\n/**\n * Get product's primary image URL\n * @param product - Product object\n * @returns Primary image URL or placeholder\n */\nexport const getProductImageUrl = (product: Product | ProductWithDetails): string => {\n  if (product.images && product.images.length > 0) {\n    return product.images[0];\n  }\n  return '/images/product-placeholder.png'; // Default placeholder\n};\n\n/**\n * Calculate product's stock percentage\n * @param available - Available stock\n * @param totalStock - Total stock\n * @returns Stock percentage (0-100)\n */\nexport const calculateStockPercentage = (available: number, totalStock: number): number => {\n  if (totalStock === 0) return 0;\n  return Math.round((available / totalStock) * 100);\n};\n\n/**\n * Get product's stock status text\n * @param available - Available stock\n * @param totalStock - Total stock\n * @returns Stock status text\n */\nexport const getProductStockStatus = (available: number, totalStock: number): string => {\n  if (available === 0) return 'Out of Stock';\n  if (available < 5) return 'Low Stock';\n  if (available < totalStock * 0.5) return 'Limited Stock';\n  return 'In Stock';\n};\n\n/**\n * Check if product can be rented\n * @param product - Product object\n * @returns Boolean indicating if product can be rented\n */\nexport const canRentProduct = (product: Product | ProductWithDetails): boolean => {\n  return product.isActive && product.available > 0 && product.rentPrice > 0;\n};\n\n/**\n * Check if product can be sold\n * @param product - Product object\n * @returns Boolean indicating if product can be sold\n */\nexport const canSellProduct = (product: Product | ProductWithDetails): boolean => {\n  return product.isActive && product.available > 0 && (product as any).salePrice && (product as any).salePrice > 0;\n};\n\n/**\n * Get product's display name with fallback\n * @param product - Product object\n * @returns Product display name\n */\nexport const getProductDisplayName = (product: Product | ProductWithDetails): string => {\n  return product.name || 'Unnamed Product';\n};\n\n/**\n * Get product's category name with fallback\n * @param product - Product object\n * @returns Category name or 'Uncategorized'\n */\nexport const getProductCategoryName = (product: Product | ProductWithDetails): string => {\n  return 'category' in product ? (product.category?.name || 'Uncategorized') : 'Uncategorized';\n};\n\n/**\n * Get product's outlet name with fallback\n * @param product - Product object\n * @returns Outlet name or 'No Outlet'\n */\nexport const getProductOutletName = (product: Product | ProductWithDetails): string => {\n  return 'outlet' in product ? ((product as any).outlet?.name || 'No Outlet') : 'No Outlet';\n};\n\n/**\n * Sort products by various criteria\n * @param products - Array of products\n * @param sortBy - Sort field ('name', 'price', 'stock', 'createdAt', 'updatedAt')\n * @param sortOrder - Sort order ('asc' or 'desc')\n * @returns Sorted array of products\n */\nexport const sortProducts = (\n  products: Product[] | ProductWithDetails[],\n  sortBy: string,\n  sortOrder: 'asc' | 'desc' = 'asc'\n): (Product[] | ProductWithDetails[]) => {\n  return [...products].sort((a, b) => {\n    let aValue: any;\n    let bValue: any;\n    \n    switch (sortBy) {\n      case 'name':\n        aValue = (a.name || '').toLowerCase();\n        bValue = (b.name || '').toLowerCase();\n        break;\n      case 'price':\n        aValue = a.rentPrice || 0;\n        bValue = b.rentPrice || 0;\n        break;\n      case 'stock':\n        aValue = a.available || 0;\n        bValue = b.available || 0;\n        break;\n      case 'createdAt':\n        aValue = new Date(a.createdAt).getTime();\n        bValue = new Date(b.createdAt).getTime();\n        break;\n      case 'updatedAt':\n        aValue = new Date(a.updatedAt).getTime();\n        bValue = new Date(b.updatedAt).getTime();\n        break;\n      default:\n        aValue = a.name || '';\n        bValue = b.name || '';\n    }\n    \n    if (sortOrder === 'asc') {\n      return aValue > bValue ? 1 : -1;\n    } else {\n      return aValue < bValue ? 1 : -1;\n    }\n  });\n};\n","import React from 'react';\nimport type { User } from '@rentalshop/types';\nimport { getRoleBadge, getStatusBadge } from './badge-utils';\n\n/**\n * Get role badge configuration and component\n * @param role - User role string\n * @returns JSX element for role badge\n */\nexport const getUserRoleBadge = (role: string) => {\n  return getRoleBadge({ role });\n};\n\n// getUserStatusBadge is now exported from ./badge-utils.tsx for centralized badge management\n\n/**\n * Calculate user statistics from user array\n * @param users - Array of users\n * @returns Object with calculated statistics\n */\nexport const calculateUserStats = (users: User[]) => {\n  const usersArray = users || [];\n  const totalUsers = usersArray.length;\n  const activeUsers = usersArray.filter(u => u.isActive).length;\n  const inactiveUsers = usersArray.filter(u => !u.isActive).length;\n  const verifiedUsers = usersArray.filter(u => u.emailVerified).length;\n  const unverifiedUsers = usersArray.filter(u => !u.emailVerified).length;\n  \n  return { \n    totalUsers, \n    activeUsers, \n    inactiveUsers, \n    verifiedUsers, \n    unverifiedUsers \n  };\n};\n\n/**\n * Filter users based on search term, role, and status\n * @param users - Array of users to filter\n * @param searchTerm - Search term for name, email, merchant, outlet\n * @param roleFilter - Role filter ('all' or specific role)\n * @param statusFilter - Status filter ('all', 'ACTIVE', 'INACTIVE')\n * @returns Filtered array of users\n */\nexport const filterUsers = (\n  users: User[], \n  searchTerm: string, \n  roleFilter: string, \n  statusFilter: string\n): User[] => {\n  return (users || []).filter(user => {\n    // Safety check to ensure user object has required properties\n    if (!user || typeof user !== 'object') {\n      return false;\n    }\n    \n    const fullName = `${user.firstName || ''} ${user.lastName || ''}`.trim();\n    const matchesSearch = fullName.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         (user.email || '').toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         (user.merchant?.name && user.merchant.name.toLowerCase().includes(searchTerm.toLowerCase())) ||\n                         (user.outlet?.name && user.outlet.name.toLowerCase().includes(searchTerm.toLowerCase()));\n    \n    const matchesRole = roleFilter === 'all' || user.role === roleFilter;\n    const matchesStatus = statusFilter === 'all' || \n                         (statusFilter === 'ACTIVE' && user.isActive) ||\n                         (statusFilter === 'INACTIVE' && !user.isActive);\n    \n    return matchesSearch && matchesRole && matchesStatus;\n  });\n};\n\n/**\n * Get user's full name\n * @param user - User object\n * @returns Full name string\n */\nexport const getUserFullName = (user: User): string => {\n  return `${user.firstName || ''} ${user.lastName || ''}`.trim();\n};\n\n/**\n * Check if user can create other users based on role\n * @param userRole - Current user's role\n * @returns Boolean indicating if user can create other users\n */\nexport const canCreateUsers = (userRole?: string): boolean => {\n  return userRole === 'ADMIN' || \n         userRole === 'MERCHANT' || \n         userRole === 'OUTLET_ADMIN';\n};\n","import { z } from 'zod';\nimport { prisma } from '@rentalshop/database';\nimport { ApiError, ErrorCode } from './errors';\nimport { API, PlanLimits, getPlan, hasWebAccess, hasMobileAccess, getPlanPlatform, hasProductPublicCheck } from '@rentalshop/constants';\nimport { AuthUser } from '@rentalshop/types';\n\n// Auth validation schemas\nexport const loginSchema = z.object({\n  email: z.string().email('Invalid email address'),\n  password: z.string().min(6, 'Password must be at least 6 characters'),\n});\n\nexport const registerSchema = z.object({\n  email: z.string().email('Invalid email address'),\n  password: z.string().min(6, 'Password must be at least 6 characters'),\n  // Support both name formats for flexibility\n  name: z.string().min(2, 'Name must be at least 2 characters').optional(),\n  firstName: z.string().min(1, 'First name is required').optional(),\n  lastName: z.string().min(1, 'Last name is required').optional(),\n  phone: z.string().optional(),\n  role: z.enum(['CLIENT', 'SHOP_OWNER', 'ADMIN', 'MERCHANT', 'OUTLET_ADMIN', 'OUTLET_STAFF']).optional(),\n  // For merchant registration\n  businessName: z.string().optional(),\n  // Business configuration (required for merchants)\n  businessType: z.enum(['CLOTHING', 'VEHICLE', 'EQUIPMENT', 'GENERAL']).optional(),\n  pricingType: z.enum(['FIXED', 'HOURLY', 'DAILY', 'WEEKLY']).optional(),\n  // Address fields for merchant registration\n  address: z.string().optional(),\n  city: z.string().optional(),\n  state: z.string().optional(),\n  zipCode: z.string().optional(),\n  country: z.string().min(2, 'Please select a valid country').optional(),\n  // For outlet staff registration\n  merchantCode: z.string().optional(),\n  outletCode: z.string().optional(),\n}).refine((data) => {\n  // Either 'name' or both 'firstName' and 'lastName' must be provided\n  return data.name || (data.firstName && data.lastName);\n}, {\n  message: \"Either 'name' or both 'firstName' and 'lastName' must be provided\"\n}).refine((data) => {\n  // For MERCHANT role, businessType and pricingType are required\n  if (data.role === 'MERCHANT' || data.businessName) {\n    return data.businessType && data.pricingType;\n  }\n  return true;\n}, {\n  message: \"Business type and pricing type are required for merchant registration\"\n});\n\n// Product validation schemas (aligned with API routes and DB types)\nconst outletStockItemSchema = z.object({\n  outletId: z.coerce.number().int().positive('Outlet is required'),\n  stock: z.number().int().min(0, 'Stock must be non-negative'),\n});\n\nexport const productCreateSchema = z.object({\n  name: z.string().min(1, 'Product name is required'),\n  description: z.string().optional(),\n  barcode: z.string().optional(),\n  rentPrice: z.number().nonnegative('Rent price must be non-negative'),\n  salePrice: z.number().nonnegative('Sale price must be non-negative'),\n  deposit: z.number().nonnegative('Deposit must be non-negative').default(0),\n  categoryId: z.coerce.number().int().positive().optional(), // Optional - will use default category if not provided\n  totalStock: z.number().int().min(0, 'Total stock must be non-negative'),\n  images: z.union([z.string(), z.array(z.string())]).optional(), // Allow both string and array for testing\n  merchantId: z.coerce.number().int().positive().optional(), // Optional - required for ADMIN users, auto-assigned for others\n  outletStock: z.array(outletStockItemSchema).min(1, 'At least one outlet stock entry is required'), // Required - every product must have outlet stock\n});\n\nexport const productUpdateSchema = z.object({\n  name: z.string().min(1).optional(),\n  description: z.string().optional(),\n  rentPrice: z.number().nonnegative().optional(),\n  salePrice: z.number().nonnegative().nullable().optional(),\n  deposit: z.number().nonnegative().optional(),\n  images: z.string().optional(),\n  categoryId: z.coerce.number().int().positive().optional(), // Changed from string to number\n  totalStock: z.number().int().min(0).optional(),\n});\n\nexport const productsQuerySchema = z.object({\n  q: z.string().optional(), // Search query parameter (consistent with orders)\n  search: z.string().optional(), // Keep for backward compatibility\n  categoryId: z.coerce.number().int().positive().optional(), // Changed from string to number\n  outletId: z.coerce.number().int().positive().optional(), // Add outlet filtering\n  available: z.coerce.boolean().optional(), // Add availability filter\n  minPrice: z.coerce.number().nonnegative().optional(), // Add price range filters\n  maxPrice: z.coerce.number().nonnegative().optional(), // Add price range filters\n  page: z.coerce.number().int().min(1).default(1),\n  limit: z.coerce.number().int().min(1).max(100).default(20),\n  offset: z.coerce.number().int().min(0).default(0), // Add offset for pagination consistency\n  sortBy: z.string().optional(), // Add sorting support\n  sortOrder: z.enum(['asc', 'desc']).optional(), // Add sorting support\n});\n\n// Rental validation schemas\nexport const rentalSchema = z.object({\n  productId: z.coerce.number().int().positive('Product is required'), // Changed from string to number\n  startDate: z.date(),\n  endDate: z.date(),\n  notes: z.string().optional(),\n}).refine((data) => data.endDate > data.startDate, {\n  message: 'End date must be after start date',\n  path: ['endDate'],\n});\n\nexport type LoginInput = z.infer<typeof loginSchema>;\nexport type RegisterInput = z.infer<typeof registerSchema>;\nexport type ProductCreateInput = z.infer<typeof productCreateSchema>;\nexport type ProductUpdateInput = z.infer<typeof productUpdateSchema>;\nexport type ProductsQuery = z.infer<typeof productsQuerySchema>;\nexport type RentalInput = z.infer<typeof rentalSchema>; \n\n// Customer validation schemas\nexport const customerCreateSchema = z.object({\n  firstName: z.string().min(1, 'First name is required'),\n  lastName: z.string().min(1, 'Last name is required'),\n  email: z.string().email('Invalid email format').optional().or(z.literal('')),\n  phone: z.string().min(1, 'Phone number is required'),\n  merchantId: z.coerce.number().int().positive().optional(), // Optional - only required for ADMIN users, auto-assigned for MERCHANT/OUTLET from JWT\n  address: z.string().optional(),\n  city: z.string().optional(),\n  state: z.string().optional(),\n  zipCode: z.string().optional(),\n  country: z.string().optional(),\n  dateOfBirth: z.string().optional(),\n  idNumber: z.string().optional(),\n  idType: z.enum(['passport', 'drivers_license', 'national_id', 'other']).optional(),\n  notes: z.string().optional(),\n});\n\nexport const customerUpdateSchema = customerCreateSchema.partial().extend({\n  isActive: z.boolean().optional(),\n  idType: z.enum(['passport', 'drivers_license', 'national_id', 'other']).optional(),\n});\n\nexport const customersQuerySchema = z.object({\n  q: z.string().optional(), // Search query parameter (consistent with orders)\n  search: z.string().optional(), // Keep for backward compatibility\n  merchantId: z.coerce.number().int().positive().optional(), // Changed from string to number\n  isActive: z.union([z.string(), z.boolean()]).transform((v) => {\n    if (typeof v === 'boolean') return v;\n    if (v === undefined) return undefined;\n    return v === 'true';\n  }).optional(),\n  city: z.string().optional(),\n  state: z.string().optional(),\n  country: z.string().optional(),\n  idType: z.enum(['passport', 'drivers_license', 'national_id', 'other']).optional(),\n  page: z.coerce.number().int().min(1).default(1),\n  limit: z.coerce.number().int().min(1).max(100).default(20),\n  offset: z.coerce.number().int().min(0).default(0), // Add offset for pagination consistency\n  sortBy: z.string().optional(), // Add sorting support\n  sortOrder: z.enum(['asc', 'desc']).optional(), // Add sorting support\n});\n\n// ============================================================================\n// Orders validation schemas\n// ============================================================================\n\n// Simplified order types: only RENT and SALE\nconst orderTypeEnum = z.enum(['RENT', 'SALE']);\n\n// Order statuses based on order type:\n// RENT: RESERVED (mới cục), PICKUPED (đang thuê), RETURNED (đã trả), CANCELLED (hủy)\n// SALE: COMPLETED và CANCELLED\nconst orderStatusEnum = z.enum(['RESERVED', 'PICKUPED', 'RETURNED', 'COMPLETED', 'CANCELLED']);\n\nexport const ordersQuerySchema = z.object({\n  q: z.string().optional(),\n  outletId: z.coerce.number().int().positive().optional(), // Changed from string to number\n  customerId: z.coerce.number().int().positive().optional(), // Changed from string to number\n  userId: z.coerce.number().int().positive().optional(), // Changed from string to number\n  productId: z.coerce.number().int().positive().optional(), // Add product filtering support\n  orderType: orderTypeEnum.optional(),\n  status: orderStatusEnum.optional(),\n  startDate: z.coerce.date().optional(),\n  endDate: z.coerce.date().optional(),\n  pickupDate: z.coerce.date().optional(),\n  returnDate: z.coerce.date().optional(),\n  minAmount: z.coerce.number().optional(),\n  maxAmount: z.coerce.number().optional(),\n  limit: z.coerce.number().int().min(1).max(100).default(20),\n  offset: z.coerce.number().int().min(0).default(0),\n});\n\nconst orderItemSchema = z.object({\n  productId: z.coerce.number().int().positive(), // Changed from string to number\n  quantity: z.coerce.number().int().positive(),\n  unitPrice: z.coerce.number().nonnegative().default(0),\n  totalPrice: z.coerce.number().nonnegative().optional(), // Made optional since server calculates it\n  deposit: z.coerce.number().nonnegative().default(0),\n  notes: z.string().optional(),\n  startDate: z.coerce.date().optional(),\n  endDate: z.coerce.date().optional(),\n  daysRented: z.coerce.number().int().nonnegative().optional(),\n});\n\n\n\n// Base order schema for both create and update\nconst baseOrderSchema = z.object({\n  // Optional fields for updates (backend generates if missing)\n  orderId: z.coerce.number().int().positive().optional(),\n  orderNumber: z.string().optional(),\n  \n  // Core order fields\n  orderType: orderTypeEnum,\n  customerId: z.coerce.number().int().positive().optional(),\n  outletId: z.coerce.number().int().positive(),\n  pickupPlanAt: z.coerce.date().optional(),\n  returnPlanAt: z.coerce.date().optional(),\n  rentalDuration: z.coerce.number().int().positive().optional(),\n  subtotal: z.coerce.number().nonnegative(),\n  taxAmount: z.coerce.number().nonnegative().optional(),\n  discountType: z.enum(['amount', 'percentage']).optional(),\n  discountValue: z.coerce.number().nonnegative().optional(),\n  discountAmount: z.coerce.number().nonnegative().optional(),\n  totalAmount: z.coerce.number().nonnegative(),\n  depositAmount: z.coerce.number().nonnegative().optional(),\n  securityDeposit: z.coerce.number().nonnegative().optional(),\n  damageFee: z.coerce.number().nonnegative().optional(),\n  lateFee: z.coerce.number().nonnegative().optional(),\n  collateralType: z.string().optional(),\n  collateralDetails: z.string().optional(),\n  notes: z.string().optional(),\n  pickupNotes: z.string().optional(),\n  returnNotes: z.string().optional(),\n  damageNotes: z.string().optional(),\n  customerName: z.string().optional(),\n  customerPhone: z.string().optional(),\n  customerEmail: z.string().email().optional(),\n  isReadyToDeliver: z.boolean().optional(),\n  \n  // Order items management\n  orderItems: z.array(orderItemSchema),\n});\n\nexport const orderCreateSchema = baseOrderSchema;\n\nexport const orderUpdateSchema = baseOrderSchema.partial().extend({\n  // Update-specific fields (not present in create)\n  status: orderStatusEnum.optional(),\n  pickedUpAt: z.coerce.date().optional(),\n  returnedAt: z.coerce.date().optional(),\n});\n\nexport type OrdersQuery = z.infer<typeof ordersQuerySchema>;\nexport type OrderCreateInput = z.infer<typeof orderCreateSchema>;\nexport type OrderUpdatePayload = z.infer<typeof orderUpdateSchema>;\n\n// ============================================================================\n// Users validation schemas\n// ============================================================================\n\nconst userRoleEnum = z.enum(['ADMIN', 'MERCHANT', 'OUTLET_ADMIN', 'OUTLET_STAFF']);\n\nexport const usersQuerySchema = z.object({\n  role: userRoleEnum.optional(),\n  isActive: z.union([z.string(), z.boolean()]).transform((v) => {\n    if (typeof v === 'boolean') return v;\n    if (v === undefined) return undefined;\n    return v === 'true';\n  }).optional(),\n  search: z.string().optional(),\n  page: z.coerce.number().int().min(1).default(1),\n  limit: z.coerce.number().int().min(1).max(100).default(20),\n  sortBy: z.enum(['firstName', 'lastName', 'email', 'createdAt']).default('createdAt').optional(),\n  sortOrder: z.enum(['asc', 'desc']).default('desc').optional(),\n});\n\nexport const userCreateSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(6),\n  firstName: z.string().min(1),\n  lastName: z.string().min(1).or(z.literal('')), // Allow empty string for lastName\n  phone: z.string().min(1, 'Phone number is required'), // Phone is now required\n  role: userRoleEnum.optional(),\n  merchantId: z.coerce.number().int().positive().optional(),\n  outletId: z.coerce.number().int().positive().optional(),\n});\n\nexport const userUpdateSchema = z.object({\n  firstName: z.string().min(1).optional(),\n  lastName: z.string().min(1).or(z.literal('')).optional(), // Allow empty string for lastName\n  email: z.string().email().optional(),\n  phone: z.string().min(1, 'Phone number is required').optional(), // Phone is required when provided\n  role: userRoleEnum.optional(),\n  isActive: z.boolean().optional(),\n  merchantId: z.coerce.number().int().positive().optional(),\n  outletId: z.coerce.number().int().positive().optional(),\n});\n\nexport type UsersQuery = z.infer<typeof usersQuerySchema>;\nexport type UserCreateInput = z.infer<typeof userCreateSchema>;\nexport type UserUpdateInput = z.infer<typeof userUpdateSchema>;\n\n// ============================================================================\n// Outlets validation schemas\n// ============================================================================\nexport const outletsQuerySchema = z.object({\n  merchantId: z.coerce.number().int().positive().optional(), // Changed from string to number\n  isActive: z.union([z.string(), z.boolean()]).transform((v) => {\n    if (typeof v === 'boolean') return v;\n    if (v === undefined) return undefined;\n    if (v === 'all') return 'all';\n    return v === 'true';\n  }).optional(),\n  search: z.string().optional(),\n  page: z.coerce.number().int().min(1).default(1),\n  limit: z.coerce.number().int().min(1).max(100).default(50),\n});\n\nexport const outletCreateSchema = z.object({\n  name: z.string().min(1, 'Outlet name is required'),\n  address: z.string().optional(),\n  city: z.string().optional(),\n  state: z.string().optional(),\n  zipCode: z.string().optional(),\n  country: z.string().optional(),\n  phone: z.string().optional(),\n  description: z.string().optional(),\n  status: z.enum(['ACTIVE', 'INACTIVE', 'CLOSED', 'SUSPENDED']).default('ACTIVE'),\n});\n\nexport const outletUpdateSchema = z.object({\n  name: z.string().min(1, 'Outlet name is required').optional(),\n  address: z.string().optional(),\n  phone: z.string().optional(),\n  city: z.string().optional(),\n  state: z.string().optional(),\n  zipCode: z.string().optional(),\n  country: z.string().optional(),\n  description: z.string().optional(),\n  isActive: z.boolean().optional(),\n  status: z.enum(['ACTIVE', 'INACTIVE', 'CLOSED', 'SUSPENDED']).optional(),\n});\n\nexport type OutletsQuery = z.infer<typeof outletsQuerySchema>;\nexport type OutletCreateInput = z.infer<typeof outletCreateSchema>;\nexport type OutletUpdateInput = z.infer<typeof outletUpdateSchema>;\n\n// Plan validation schemas\nexport const planCreateSchema = z.object({\n  name: z.string().min(1, 'Plan name is required'),\n  description: z.string().min(1, 'Plan description is required'),\n  basePrice: z.number().nonnegative('Base price must be non-negative'),\n  currency: z.string().default('USD'),\n  trialDays: z.number().int().min(0, 'Trial days must be non-negative'),\n  limits: z.object({\n    outlets: z.number().int().min(-1, 'Max outlets must be -1 (unlimited) or positive'),\n    users: z.number().int().min(-1, 'Max users must be -1 (unlimited) or positive'),\n    products: z.number().int().min(-1, 'Max products must be -1 (unlimited) or positive'),\n    customers: z.number().int().min(-1, 'Max customers must be -1 (unlimited) or positive'),\n  }),\n  features: z.array(z.string()).default([]),\n  isActive: z.boolean().default(true),\n  isPopular: z.boolean().default(false),\n  sortOrder: z.number().int().default(0),\n});\n\nexport const planUpdateSchema = planCreateSchema.partial();\n\nexport const plansQuerySchema = z.object({\n  search: z.string().optional(),\n  isActive: z.coerce.boolean().optional(),\n  isPopular: z.coerce.boolean().optional(),\n  limit: z.coerce.number().int().min(1).max(100).default(50),\n  offset: z.coerce.number().int().min(0).default(0),\n  sortBy: z.enum(['name', 'price', 'basePrice', 'createdAt', 'sortOrder']).default('sortOrder'),  // ✅ Updated to support basePrice\n  sortOrder: z.enum(['asc', 'desc']).default('asc'),\n});\n\nexport type PlanCreateInput = z.infer<typeof planCreateSchema>;\nexport type PlanUpdateInput = z.infer<typeof planUpdateSchema>;\nexport type PlansQuery = z.infer<typeof plansQuerySchema>;\n\n// ============================================================================\n// Plan Variant validation schemas\n// ============================================================================\n\nexport const planVariantCreateSchema = z.object({\n  planId: z.string().min(1, 'Plan ID is required'),\n  name: z.string().min(1, 'Variant name is required'),\n  duration: z.number().int().positive('Duration must be positive'),\n  price: z.number().nonnegative('Price must be non-negative').optional(),\n  basePrice: z.number().nonnegative('Base price must be non-negative').optional(),\n  discount: z.number().min(0).max(100, 'Discount must be between 0 and 100').default(0),\n  isActive: z.boolean().default(true),\n  isPopular: z.boolean().default(false),\n  sortOrder: z.number().int().default(0),\n});\n\nexport const planVariantUpdateSchema = planVariantCreateSchema.partial().extend({\n  planId: z.string().min(1, 'Plan ID is required').optional(), // Optional for updates\n});\n\nexport const planVariantsQuerySchema = z.object({\n  planId: z.string().optional(),\n  search: z.string().optional(),\n  isActive: z.coerce.boolean().optional(),\n  isPopular: z.coerce.boolean().optional(),\n  duration: z.coerce.number().int().positive().optional(),\n  minPrice: z.coerce.number().nonnegative().optional(),\n  maxPrice: z.coerce.number().nonnegative().optional(),\n  limit: z.coerce.number().int().min(1).max(100).default(50),\n  offset: z.coerce.number().int().min(0).default(0),\n  sortBy: z.enum(['name', 'price', 'duration', 'discount', 'createdAt', 'sortOrder']).default('sortOrder'),\n  sortOrder: z.enum(['asc', 'desc']).default('asc'),\n});\n\nexport type PlanVariantCreateInput = z.infer<typeof planVariantCreateSchema>;\nexport type PlanVariantUpdateInput = z.infer<typeof planVariantUpdateSchema>;\nexport type PlanVariantsQuery = z.infer<typeof planVariantsQuerySchema>;\n\n// ============================================================================\n// Subscription validation schemas\n// ============================================================================\n\nexport const subscriptionCreateSchema = z.object({\n  planId: z.string().min(1, 'Plan ID is required'),\n  planVariantId: z.string().min(1, 'Plan variant ID is required'),\n  merchantId: z.coerce.number().int().positive('Merchant ID is required'),\n  status: z.enum(['trial', 'active', 'past_due', 'cancelled', 'paused', 'expired']).default('active'),\n  billingInterval: z.enum(['month', 'quarter', 'semiAnnual', 'year']).default('month'),\n  amount: z.number().nonnegative('Amount must be non-negative'),\n  currency: z.string().default('USD'),\n  trialStartDate: z.coerce.date().optional(),\n  trialEndDate: z.coerce.date().optional(),\n  currentPeriodStart: z.coerce.date().optional(),\n  currentPeriodEnd: z.coerce.date().optional(),\n  cancelAtPeriodEnd: z.boolean().default(false),\n  cancelledAt: z.coerce.date().optional(),\n  notes: z.string().optional(),\n});\n\nexport const subscriptionUpdateSchema = subscriptionCreateSchema.partial().extend({\n  id: z.coerce.number().int().positive().optional(),\n});\n\nexport const subscriptionsQuerySchema = z.object({\n  merchantId: z.coerce.number().int().positive().optional(),\n  status: z.enum(['active', 'inactive', 'cancelled', 'expired', 'suspended', 'past_due', 'paused']).optional(),\n  planId: z.string().optional(),\n  planVariantId: z.string().optional(),\n  search: z.string().optional(),\n  limit: z.coerce.number().int().min(1).max(100).default(50),\n  offset: z.coerce.number().int().min(0).default(0),\n  sortBy: z.enum(['createdAt', 'currentPeriodEnd', 'amount', 'status']).default('createdAt'),\n  sortOrder: z.enum(['asc', 'desc']).default('desc'),\n});\n\nexport type SubscriptionCreateInput = z.infer<typeof subscriptionCreateSchema>;\nexport type SubscriptionUpdateInput = z.infer<typeof subscriptionUpdateSchema>;\nexport type SubscriptionsQuery = z.infer<typeof subscriptionsQuerySchema>;\n\n// ============================================================================\n// PLAN LIMITS VALIDATION (from plan-limits-validation.ts)\n// ============================================================================\n\nexport interface PlanLimitsValidationResult {\n  isValid: boolean;\n  error?: string;\n  currentCount: number;\n  limit: number;\n  entityType: 'outlets' | 'users' | 'products' | 'customers' | 'orders';\n}\n\nexport interface PlanLimitsInfo {\n  planLimits: PlanLimits;\n  platform: 'mobile' | 'mobile+web';\n  currentCounts: {\n    outlets: number;\n    users: number;\n    products: number;\n    customers: number;\n    orders: number;\n  };\n  isUnlimited: {\n    outlets: boolean;\n    users: boolean;\n    products: boolean;\n    customers: boolean;\n    orders: boolean;\n  };\n  platformAccess: {\n    mobile: boolean;\n    web: boolean;\n    productPublicCheck: boolean;\n  };\n}\n\n/**\n * Get current counts for all entities for a merchant\n */\nexport async function getCurrentEntityCounts(merchantId: number): Promise<{\n  outlets: number;\n  users: number;\n  products: number;\n  customers: number;\n  orders: number;\n}> {\n  try {\n    const [outlets, users, products, customers, orders] = await Promise.all([\n      prisma.outlet.count({ where: { merchantId } }),\n      prisma.user.count({ where: { merchantId } }),\n      prisma.product.count({ where: { merchantId } }),\n      prisma.customer.count({ where: { merchantId } }),\n      prisma.order.count({ where: { outlet: { merchantId } } })\n    ]);\n\n    return {\n      outlets,\n      users,\n      products,\n      customers,\n      orders\n    };\n  } catch (error) {\n    console.error('Error getting entity counts:', error);\n    throw new ApiError(ErrorCode.DATABASE_ERROR, 'Failed to get entity counts');\n  }\n}\n\n/**\n * Get comprehensive plan limits information for a merchant\n */\nexport async function getPlanLimitsInfo(merchantId: number): Promise<PlanLimitsInfo> {\n  try {\n    // Get merchant with subscription\n    const merchant = await prisma.merchant.findUnique({\n      where: { id: merchantId },\n      include: {\n        subscription: true\n      }\n    });\n\n    if (!merchant) {\n      throw new ApiError(ErrorCode.MERCHANT_NOT_FOUND, 'Merchant not found');\n    }\n\n    if (!merchant.subscription) {\n      throw new ApiError(ErrorCode.NOT_FOUND, 'No subscription found for merchant');\n    }\n\n    // Get plan information from database\n    const plan = await prisma.plan.findUnique({\n      where: { id: merchant.subscription.planId }\n    });\n    if (!plan) {\n      throw new ApiError(ErrorCode.NOT_FOUND, 'Plan not found');\n    }\n    const planLimits = JSON.parse(plan.limits);\n    const platform = plan.features.includes('Web dashboard access') ? 'mobile+web' : 'mobile';\n\n    // Get current counts\n    const currentCounts = await getCurrentEntityCounts(merchantId);\n\n    // Check unlimited flags\n    const isUnlimited = {\n      outlets: planLimits.outlets === -1,\n      users: planLimits.users === -1,\n      products: planLimits.products === -1,\n      customers: planLimits.customers === -1,\n      orders: planLimits.orders === -1\n    };\n\n    // Check platform access from plan features\n    const features = JSON.parse(plan.features);\n    const platformAccess = {\n      mobile: true, // All plans have mobile access\n      web: features.includes('Web dashboard access'),\n      productPublicCheck: features.includes('Product public check')\n    };\n\n    return {\n      planLimits,\n      platform: platform || 'mobile',\n      currentCounts,\n      isUnlimited,\n      platformAccess\n    };\n  } catch (error) {\n    console.error('Error getting plan limits info:', error);\n    if (error instanceof ApiError) {\n      throw error;\n    }\n    throw new ApiError(ErrorCode.INTERNAL_SERVER_ERROR, 'Failed to get plan limits information');\n  }\n}\n\n/**\n * Validate if merchant can create a new entity\n */\nexport async function validatePlanLimits(\n  merchantId: number,\n  entityType: 'outlets' | 'users' | 'products' | 'customers' | 'orders'\n): Promise<PlanLimitsValidationResult> {\n  try {\n    const planInfo = await getPlanLimitsInfo(merchantId);\n    const currentCount = planInfo.currentCounts[entityType];\n    const limit = planInfo.planLimits[entityType];\n    const isUnlimited = planInfo.isUnlimited[entityType];\n\n    // If unlimited, always allow\n    if (isUnlimited) {\n      return {\n        isValid: true,\n        currentCount,\n        limit: -1,\n        entityType\n      };\n    }\n\n    // Check if limit is exceeded\n    if (currentCount >= limit) {\n      return {\n        isValid: false,\n        error: `${entityType} limit exceeded. Current: ${currentCount}, Limit: ${limit}`,\n        currentCount,\n        limit,\n        entityType\n      };\n    }\n\n    return {\n      isValid: true,\n      currentCount,\n      limit,\n      entityType\n    };\n  } catch (error) {\n    console.error('Error validating plan limits:', error);\n    throw new ApiError(ErrorCode.INTERNAL_SERVER_ERROR, 'Failed to validate plan limits');\n  }\n}\n\n/**\n * Validate platform access for merchant\n */\nexport function validatePlatformAccess(\n  merchantId: number,\n  platform: 'mobile' | 'web',\n  planInfo: PlanLimitsInfo\n): boolean {\n  switch (platform) {\n    case 'mobile':\n      return planInfo.platformAccess.mobile;\n    case 'web':\n      return planInfo.platformAccess.web;\n    default:\n      return false;\n  }\n}\n\n/**\n * Validate product public check access\n */\nexport function validateProductPublicCheckAccess(planInfo: PlanLimitsInfo): boolean {\n  return planInfo.platformAccess.productPublicCheck;\n}\n\n/**\n * Assert plan limits for a specific entity type\n * Throws an error if the plan limit would be exceeded\n */\nexport async function assertPlanLimit(\n  merchantId: number,\n  entityType: 'outlets' | 'users' | 'products' | 'customers' | 'orders'\n): Promise<void> {\n  try {\n    const validation = await validatePlanLimits(merchantId, entityType);\n    \n    if (!validation.isValid) {\n      throw new ApiError(\n        ErrorCode.PLAN_LIMIT_EXCEEDED,\n        validation.error || `Plan limit exceeded for ${entityType}`\n      );\n    }\n  } catch (error) {\n    if (error instanceof ApiError) {\n      throw error;\n    }\n    throw new ApiError(\n      ErrorCode.INTERNAL_SERVER_ERROR,\n      `Failed to validate plan limits for ${entityType}`\n    );\n  }\n}","// ============================================================================\n// CURRENCY UTILITIES\n// ============================================================================\n\nimport { \n  CurrencyCode, \n  Currency, \n  CurrencySettings, \n  CurrencyFormatOptions \n} from '@rentalshop/types';\n\n/**\n * Default currency configuration\n * USD is the base currency (exchangeRate: 1)\n * VND exchange rate is approximate (1 USD ≈ 24,500 VND)\n */\nexport const DEFAULT_CURRENCIES: Currency[] = [\n  {\n    code: 'USD',\n    symbol: '$',\n    name: 'US Dollar',\n    locale: 'en-US',\n    minFractionDigits: 2,\n    maxFractionDigits: 2,\n    symbolBefore: true,\n    exchangeRate: 1,\n  },\n  {\n    code: 'VND',\n    symbol: 'đ',\n    name: 'Vietnamese Dong',\n    locale: 'vi-VN',\n    minFractionDigits: 0,\n    maxFractionDigits: 0,\n    symbolBefore: false,\n    exchangeRate: 24500, // 1 USD ≈ 24,500 VND\n  },\n];\n\n/**\n * Default currency settings\n */\nexport const DEFAULT_CURRENCY_SETTINGS: CurrencySettings = {\n  currentCurrency: 'USD', // Default to USD\n  baseCurrency: 'USD',\n  availableCurrencies: DEFAULT_CURRENCIES,\n  showSymbol: true,\n  showCode: false,\n};\n\n/**\n * Get currency by code\n * @param code - Currency code\n * @returns Currency configuration or undefined if not found\n */\nexport function getCurrency(code: CurrencyCode): Currency | undefined {\n  return DEFAULT_CURRENCIES.find(currency => currency.code === code);\n}\n\n/**\n * Get current currency configuration\n * @param settings - Currency settings (optional, uses default if not provided)\n * @returns Current currency configuration\n */\nexport function getCurrentCurrency(settings?: CurrencySettings): Currency {\n  const currentSettings = settings || DEFAULT_CURRENCY_SETTINGS;\n  const currency = getCurrency(currentSettings.currentCurrency);\n  \n  if (!currency) {\n    // Fallback to USD if current currency not found\n    return DEFAULT_CURRENCIES.find(c => c.code === 'USD')!;\n  }\n  \n  return currency;\n}\n\n/**\n * Convert amount from one currency to another\n * @param amount - Amount to convert\n * @param fromCurrency - Source currency code\n * @param toCurrency - Target currency code\n * @returns Converted amount\n */\nexport function convertCurrency(\n  amount: number, \n  fromCurrency: CurrencyCode, \n  toCurrency: CurrencyCode\n): number {\n  if (fromCurrency === toCurrency) {\n    return amount;\n  }\n\n  const from = getCurrency(fromCurrency);\n  const to = getCurrency(toCurrency);\n\n  if (!from || !to) {\n    throw new Error(`Invalid currency code: ${fromCurrency} or ${toCurrency}`);\n  }\n\n  // Convert to base currency (USD) first, then to target currency\n  const amountInUSD = amount / from.exchangeRate;\n  return amountInUSD * to.exchangeRate;\n}\n\n/**\n * Format amount as currency with advanced options\n * @param amount - Amount to format\n * @param options - Formatting options\n * @param settings - Currency settings (optional)\n * @returns Formatted currency string\n */\nexport function formatCurrencyAdvanced(\n  amount: number | null | undefined,\n  options: CurrencyFormatOptions = {},\n  settings?: CurrencySettings\n): string {\n  if (amount === null || amount === undefined || isNaN(amount)) {\n    return '0';\n  }\n\n  const currentSettings = settings || DEFAULT_CURRENCY_SETTINGS;\n  const currencyCode = options.currency || currentSettings.currentCurrency;\n  const currency = getCurrency(currencyCode);\n  \n  if (!currency) {\n    throw new Error(`Invalid currency code: ${currencyCode}`);\n  }\n\n  const locale = options.locale || currency.locale;\n  const showSymbol = options.showSymbol ?? currentSettings.showSymbol;\n  const showCode = options.showCode ?? currentSettings.showCode;\n  const fractionDigits = options.fractionDigits ?? currency.maxFractionDigits;\n\n  // Format the number - only show decimals when they exist\n  const formattedNumber = new Intl.NumberFormat(locale, {\n    minimumFractionDigits: 0, // Don't force decimal places\n    maximumFractionDigits: fractionDigits, // Allow up to max decimals\n  }).format(amount);\n\n  // Build the result string\n  let result = formattedNumber;\n\n  if (showSymbol) {\n    if (currency.symbolBefore) {\n      result = `${currency.symbol}${result}`;\n    } else {\n      result = `${result}${currency.symbol}`;\n    }\n  }\n\n  if (showCode) {\n    result = `${result} ${currency.code}`;\n  }\n\n  return result;\n}\n\n/**\n * Format amount as currency (simplified version for backward compatibility)\n * @param amount - Amount to format\n * @param currency - Currency code (optional, uses current currency if not provided)\n * @param locale - Locale for formatting (optional)\n * @returns Formatted currency string\n */\nexport function formatCurrency(\n  amount: number | null | undefined, \n  currency: CurrencyCode = 'USD', \n  locale?: string\n): string {\n  return formatCurrencyAdvanced(amount, { currency, locale });\n}\n\n/**\n * Parse currency string to number\n * @param currencyString - Currency string to parse\n * @param currency - Currency code to parse from\n * @returns Parsed number or null if invalid\n */\nexport function parseCurrency(currencyString: string, currency: CurrencyCode = 'USD'): number | null {\n  if (!currencyString || typeof currencyString !== 'string') {\n    return null;\n  }\n\n  const currencyConfig = getCurrency(currency);\n  if (!currencyConfig) {\n    return null;\n  }\n\n  // Remove currency symbol and code\n  let cleanString = currencyString\n    .replace(new RegExp(`[${currencyConfig.symbol}]`, 'g'), '')\n    .replace(new RegExp(currencyConfig.code, 'gi'), '')\n    .trim();\n\n  // Remove thousand separators and convert decimal separator\n  if (currencyConfig.locale === 'vi-VN') {\n    // Vietnamese format: 1.234,56\n    cleanString = cleanString.replace(/\\./g, '').replace(',', '.');\n  } else {\n    // US format: 1,234.56\n    cleanString = cleanString.replace(/,/g, '');\n  }\n\n  const parsed = parseFloat(cleanString);\n  return isNaN(parsed) ? null : parsed;\n}\n\n/**\n * Get currency display string (symbol + code)\n * @param currency - Currency code\n * @returns Display string (e.g., \"$ USD\" or \"đ VND\")\n */\nexport function getCurrencyDisplay(currency: CurrencyCode): string {\n  const currencyConfig = getCurrency(currency);\n  if (!currencyConfig) {\n    return currency;\n  }\n\n  if (currencyConfig.symbolBefore) {\n    return `${currencyConfig.symbol} ${currencyConfig.code}`;\n  } else {\n    return `${currencyConfig.code} ${currencyConfig.symbol}`;\n  }\n}\n\n/**\n * Validate currency code\n * @param code - Currency code to validate\n * @returns True if valid, false otherwise\n */\nexport function isValidCurrencyCode(code: string): code is CurrencyCode {\n  return ['USD', 'VND'].includes(code as CurrencyCode);\n}\n\n/**\n * Get exchange rate between two currencies\n * @param fromCurrency - Source currency code\n * @param toCurrency - Target currency code\n * @returns Exchange rate\n */\nexport function getExchangeRate(fromCurrency: CurrencyCode, toCurrency: CurrencyCode): number {\n  if (fromCurrency === toCurrency) {\n    return 1;\n  }\n\n  const from = getCurrency(fromCurrency);\n  const to = getCurrency(toCurrency);\n\n  if (!from || !to) {\n    throw new Error(`Invalid currency code: ${fromCurrency} or ${toCurrency}`);\n  }\n\n  // Calculate exchange rate through base currency (USD)\n  return to.exchangeRate / from.exchangeRate;\n}\n","// ============================================================================\n// PAYMENT GATEWAY CONFIGURATION\n// ============================================================================\n\nexport interface PaymentGatewayConfig {\n  provider: 'stripe' | 'paypal' | 'square';\n  apiKey: string;\n  webhookSecret?: string;\n  environment: 'sandbox' | 'production';\n  defaultGateway?: string;\n}\n\nexport interface PaymentGatewayManager {\n  createPayment: (amount: number, currency: string, metadata?: any) => Promise<any>;\n  processPayment: (paymentId: string) => Promise<any>;\n  refundPayment: (paymentId: string, amount?: number) => Promise<any>;\n}\n\n/**\n * Create payment gateway manager\n * This is a placeholder implementation\n */\nexport function createPaymentGatewayManager(config: PaymentGatewayConfig): PaymentGatewayManager {\n  return {\n    createPayment: async (amount: number, currency: string, metadata?: any) => {\n      console.log('Creating payment:', { amount, currency, metadata });\n      return { id: 'mock-payment-id', status: 'pending' };\n    },\n    processPayment: async (paymentId: string) => {\n      console.log('Processing payment:', paymentId);\n      return { id: paymentId, status: 'completed' };\n    },\n    refundPayment: async (paymentId: string, amount?: number) => {\n      console.log('Refunding payment:', paymentId, amount);\n      return { id: paymentId, status: 'refunded' };\n    }\n  };\n}\n\nexport default {\n  createPaymentGatewayManager\n};\n","/**\n * Order Number Manager Utilities\n * \n * Utility functions for managing order number generation across the application.\n * Provides easy-to-use functions for different order number formats.\n */\n\nimport { \n  getOutletOrderStats,\n  createOrderNumberWithFormat,\n  type OrderNumberFormat\n} from '@rentalshop/database';\n\n/**\n * Get outlet order statistics\n */\nexport async function getOutletStats(outletId: number) {\n  return await getOutletOrderStats(outletId);\n}\n\n/**\n * Compare different order number formats\n */\nexport async function compareOrderNumberFormats(outletId: number) {\n  const formats: OrderNumberFormat[] = ['sequential', 'date-based', 'random', 'hybrid'];\n  const results: Record<string, any> = {};\n  \n  for (const format of formats) {\n    try {\n      const result = await createOrderNumberWithFormat(outletId, format);\n      results[format] = {\n        orderNumber: result.orderNumber,\n        sequence: result.sequence,\n        generatedAt: result.generatedAt,\n        length: result.orderNumber.length\n      };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      results[format] = {\n        error: errorMessage\n      };\n    }\n  }\n  \n  return results;\n}\n\n/**\n * Format recommendations based on business needs\n */\nexport function getFormatRecommendations() {\n  return {\n    smallBusiness: {\n      recommended: 'sequential',\n      reason: 'Simple, easy to track, low concurrency needs',\n      example: 'ORD-001-0001'\n    },\n    mediumBusiness: {\n      recommended: 'date-based',\n      reason: 'Better organization, daily reporting, moderate security',\n      example: 'ORD-001-20250115-0001'\n    },\n    largeBusiness: {\n      recommended: 'hybrid',\n      reason: 'Balanced security and organization, high volume',\n      example: 'ORD-001-20250115-A7B9'\n    },\n    highSecurity: {\n      recommended: 'random',\n      reason: 'Maximum security, no business intelligence leakage',\n      example: 'ORD-001-A7B9C2'\n    }\n  };\n}\n\n/**\n * Migration helper: Convert existing orders to new format\n */\nexport async function migrateOrderNumbers(\n  outletId: number, \n  newFormat: OrderNumberFormat\n): Promise<{ success: boolean; message: string; affectedOrders: number }> {\n  try {\n    // This would need to be implemented based on your migration strategy\n    // For now, return a placeholder\n    return {\n      success: false,\n      message: 'Migration not implemented - requires careful planning to avoid data conflicts',\n      affectedOrders: 0\n    };\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n    return {\n      success: false,\n      message: `Migration failed: ${errorMessage}`,\n      affectedOrders: 0\n    };\n  }\n}\n\n/**\n * Order number format validator\n */\nexport function validateOrderNumberFormat(orderNumber: string): {\n  isValid: boolean;\n  errors: string[];\n  suggestions: string[];\n} {\n  const errors: string[] = [];\n  const suggestions: string[] = [];\n  \n  if (!orderNumber) {\n    errors.push('Order number cannot be empty');\n    return { isValid: false, errors, suggestions };\n  }\n  \n  if (!orderNumber.startsWith('ORD-')) {\n    errors.push('Order number must start with \"ORD-\"');\n    suggestions.push('Use format: ORD-{outletId}-{sequence}');\n  }\n  \n  const parts = orderNumber.split('-');\n  if (parts.length < 3) {\n    errors.push('Order number must have at least 3 parts separated by hyphens');\n    suggestions.push('Use format: ORD-{outletId}-{sequence}');\n  }\n  \n  if (parts.length >= 2) {\n    const outletId = parseInt(parts[1]);\n    if (isNaN(outletId) || outletId < 1) {\n      errors.push('Outlet ID must be a positive number');\n      suggestions.push('Use format: ORD-001-0001 (where 001 is outlet ID)');\n    }\n  }\n  \n  const isValid = errors.length === 0;\n  \n  if (isValid) {\n    suggestions.push('Order number format is valid');\n  }\n  \n  return { isValid, errors, suggestions };\n}\n","import { format, addDays, differenceInDays, isAfter, isBefore, isValid, parseISO } from 'date-fns';\n\n/**\n * Safely convert any date input to a valid Date object\n */\nconst toDate = (date: Date | string | null | undefined): Date | null => {\n  if (!date) return null;\n  \n  if (date instanceof Date) {\n    return isValid(date) ? date : null;\n  }\n  \n  try {\n    const parsed = parseISO(date);\n    return isValid(parsed) ? parsed : null;\n  } catch {\n    return null;\n  }\n};\n\nexport const formatDate = (date: Date | string | null | undefined, formatString: string = 'dd/MM/yyyy'): string => {\n  const dateObj = toDate(date);\n  if (!dateObj) return 'Invalid Date';\n  \n  try {\n    return format(dateObj, formatString);\n  } catch {\n    return 'Invalid Date';\n  }\n};\n\nexport const formatDateTime = (date: Date | string | null | undefined): string => {\n  const dateObj = toDate(date);\n  if (!dateObj) return 'Invalid Date';\n  \n  try {\n    return format(dateObj, 'dd/MM/yyyy HH:mm');\n  } catch {\n    return 'Invalid Date';\n  }\n};\n\nexport const addDaysToDate = (date: Date, days: number): Date => {\n  return addDays(date, days);\n};\n\nexport const getDaysDifference = (startDate: Date, endDate: Date): number => {\n  return differenceInDays(endDate, startDate);\n};\n\nexport const isDateAfter = (date1: Date, date2: Date): boolean => {\n  return isAfter(date1, date2);\n};\n\nexport const isDateBefore = (date1: Date, date2: Date): boolean => {\n  return isBefore(date1, date2);\n};\n\nexport const getCurrentDate = (): Date => {\n  return new Date();\n};\n\nexport const getTomorrow = (): Date => {\n  return addDaysToDate(getCurrentDate(), 1);\n};\n\n/**\n * Format date in a user-friendly way (e.g., \"January 15, 2025\")\n */\nexport const formatDateLong = (date: Date | string | null | undefined): string => {\n  const dateObj = toDate(date);\n  if (!dateObj) return 'Invalid Date';\n  \n  try {\n    return new Intl.DateTimeFormat('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    }).format(dateObj);\n  } catch {\n    return 'Invalid Date';\n  }\n};\n\n/**\n * Format date and time in a user-friendly way (e.g., \"January 15, 2025 at 3:45 PM\")\n */\nexport const formatDateTimeLong = (date: Date | string | null | undefined): string => {\n  const dateObj = toDate(date);\n  if (!dateObj) return 'Invalid Date';\n  \n  try {\n    return new Intl.DateTimeFormat('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    }).format(dateObj);\n  } catch {\n    return 'Invalid Date';\n  }\n};\n\n/**\n * Format date in short format (e.g., \"Jan 15, 2025\")\n */\nexport const formatDateShort = (date: Date | string | null | undefined): string => {\n  const dateObj = toDate(date);\n  if (!dateObj) return 'Invalid Date';\n  \n  try {\n    return new Intl.DateTimeFormat('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    }).format(dateObj);\n  } catch {\n    return 'Invalid Date';\n  }\n};\n\n/**\n * Format date and time in short format (e.g., \"Jan 15, 2025 3:45 PM\")\n */\nexport const formatDateTimeShort = (date: Date | string | null | undefined): string => {\n  const dateObj = toDate(date);\n  if (!dateObj) return 'Invalid Date';\n  \n  try {\n    return new Intl.DateTimeFormat('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    }).format(dateObj);\n  } catch {\n    return 'Invalid Date';\n  }\n}; ","/**\n * Audit Logging Configuration\n * \n * This module provides a configurable audit logging system with tiered approach\n * and smart filtering to optimize performance while maintaining comprehensive coverage.\n */\n\nexport interface AuditEntityConfig {\n  enabled: boolean;\n  logLevel: 'ALL' | 'CREATE_UPDATE_DELETE' | 'CREATE_DELETE' | 'CRITICAL_ONLY';\n  fields: {\n    include: string[];\n    exclude: string[];\n    sensitive: string[];\n  };\n  sampling: {\n    enabled: boolean;\n    rate: number; // 0.0 to 1.0\n  };\n  async: boolean;\n  severity: 'INFO' | 'WARNING' | 'ERROR' | 'CRITICAL';\n  category: 'GENERAL' | 'SECURITY' | 'BUSINESS' | 'SYSTEM' | 'COMPLIANCE';\n}\n\nexport interface AuditConfig {\n  global: {\n    enabled: boolean;\n    async: boolean;\n    retentionDays: number;\n    maxLogSize: number; // in bytes\n  };\n  entities: Record<string, AuditEntityConfig>;\n  performance: {\n    maxLogTime: number; // max time to spend on audit logging (ms)\n    batchSize: number;\n    queueSize: number;\n  };\n  features: {\n    changeDetection: boolean;\n    fieldLevelTracking: boolean;\n    userContext: boolean;\n    networkContext: boolean;\n  };\n}\n\n// Default configuration\nexport const defaultAuditConfig: AuditConfig = {\n  global: {\n    enabled: process.env.AUDIT_LOGGING_ENABLED === 'true' || \n             process.env.NODE_ENV === 'production' || \n             process.env.NODE_ENV === 'development' || \n             process.env.NODE_ENV === undefined, // Enable by default in development\n    async: true,\n    retentionDays: parseInt(process.env.AUDIT_RETENTION_DAYS || '90'),\n    maxLogSize: parseInt(process.env.AUDIT_MAX_LOG_SIZE || '1048576') // 1MB\n  },\n  entities: {\n    // Tier 1: Critical Business Operations (Always Log)\n    Customer: {\n      enabled: true,\n      logLevel: 'ALL',\n      fields: {\n        include: ['*'], // All fields\n        exclude: ['password', 'token', 'secret'],\n        sensitive: ['email', 'phone', 'idNumber']\n      },\n      sampling: { enabled: false, rate: 1.0 },\n      async: true,\n      severity: 'INFO',\n      category: 'BUSINESS'\n    },\n    Order: {\n      enabled: true,\n      logLevel: 'ALL',\n      fields: {\n        include: ['*'],\n        exclude: ['paymentToken', 'cardNumber'],\n        sensitive: ['customerId', 'totalAmount']\n      },\n      sampling: { enabled: false, rate: 1.0 },\n      async: true,\n      severity: 'INFO',\n      category: 'BUSINESS'\n    },\n    User: {\n      enabled: true,\n      logLevel: 'ALL',\n      fields: {\n        include: ['*'],\n        exclude: ['password', 'passwordHash', 'token'],\n        sensitive: ['email', 'phone']\n      },\n      sampling: { enabled: false, rate: 1.0 },\n      async: true,\n      severity: 'WARNING',\n      category: 'SECURITY'\n    },\n    Payment: {\n      enabled: true,\n      logLevel: 'ALL',\n      fields: {\n        include: ['*'],\n        exclude: ['cardNumber', 'cvv', 'token'],\n        sensitive: ['amount', 'customerId']\n      },\n      sampling: { enabled: false, rate: 1.0 },\n      async: true,\n      severity: 'WARNING',\n      category: 'BUSINESS'\n    },\n\n    // Tier 2: Important Operations (Selective Logging)\n    Product: {\n      enabled: true,\n      logLevel: 'CREATE_UPDATE_DELETE',\n      fields: {\n        include: ['name', 'price', 'stock', 'category', 'isActive'],\n        exclude: ['description', 'images'],\n        sensitive: ['cost', 'margin']\n      },\n      sampling: { enabled: false, rate: 1.0 },\n      async: true,\n      severity: 'INFO',\n      category: 'BUSINESS'\n    },\n    Settings: {\n      enabled: true,\n      logLevel: 'CREATE_UPDATE_DELETE',\n      fields: {\n        include: ['*'],\n        exclude: ['apiKey', 'secret', 'password'],\n        sensitive: ['value']\n      },\n      sampling: { enabled: false, rate: 1.0 },\n      async: true,\n      severity: 'WARNING',\n      category: 'SYSTEM'\n    },\n    Export: {\n      enabled: true,\n      logLevel: 'ALL',\n      fields: {\n        include: ['*'],\n        exclude: ['data', 'content'],\n        sensitive: ['userId', 'filters']\n      },\n      sampling: { enabled: false, rate: 1.0 },\n      async: true,\n      severity: 'INFO',\n      category: 'BUSINESS'\n    },\n    Merchant: {\n      enabled: true,\n      logLevel: 'CREATE_UPDATE_DELETE',\n      fields: {\n        include: ['name', 'status', 'plan', 'settings'],\n        exclude: ['apiKey', 'webhookSecret'],\n        sensitive: ['email', 'phone']\n      },\n      sampling: { enabled: false, rate: 1.0 },\n      async: true,\n      severity: 'WARNING',\n      category: 'BUSINESS'\n    },\n\n    // Tier 3: Low-Value Operations (Skip or Sample)\n    AuditLog: {\n      enabled: false, // Don't log audit logs\n      logLevel: 'CRITICAL_ONLY',\n      fields: { include: [], exclude: ['*'], sensitive: [] },\n      sampling: { enabled: true, rate: 0.01 },\n      async: true,\n      severity: 'INFO',\n      category: 'SYSTEM'\n    },\n    Session: {\n      enabled: false,\n      logLevel: 'CRITICAL_ONLY',\n      fields: { include: [], exclude: ['*'], sensitive: [] },\n      sampling: { enabled: true, rate: 0.05 },\n      async: true,\n      severity: 'INFO',\n      category: 'SECURITY'\n    }\n  },\n  performance: {\n    maxLogTime: 100, // 100ms max\n    batchSize: 50,\n    queueSize: 1000\n  },\n  features: {\n    changeDetection: true,\n    fieldLevelTracking: true,\n    userContext: true,\n    networkContext: true\n  }\n};\n\n// Environment-based configuration override\nexport function getAuditConfig(): AuditConfig {\n  const config = { ...defaultAuditConfig };\n\n  // Override from environment variables\n  if (process.env.AUDIT_ENTITIES) {\n    const enabledEntities = process.env.AUDIT_ENTITIES.split(',');\n    Object.keys(config.entities).forEach(entity => {\n      config.entities[entity].enabled = enabledEntities.includes(entity);\n    });\n  }\n\n  if (process.env.AUDIT_SAMPLING_RATE) {\n    const samplingRate = parseFloat(process.env.AUDIT_SAMPLING_RATE);\n    Object.keys(config.entities).forEach(entity => {\n      config.entities[entity].sampling.rate = samplingRate;\n    });\n  }\n\n  return config;\n}\n\n// Check if entity should be logged\nexport function shouldLogEntity(entityType: string, action: string): boolean {\n  const config = getAuditConfig();\n  \n  console.log('🔍 shouldLogEntity check:', {\n    entityType,\n    action,\n    globalEnabled: config.global.enabled,\n    entityConfig: config.entities[entityType]\n  });\n  \n  if (!config.global.enabled) {\n    console.log('❌ Global audit logging is disabled');\n    return false;\n  }\n  \n  const entityConfig = config.entities[entityType];\n  if (!entityConfig || !entityConfig.enabled) {\n    console.log('❌ Entity not configured or disabled:', entityType);\n    return false;\n  }\n\n  // Check log level\n  switch (entityConfig.logLevel) {\n    case 'ALL':\n      return true;\n    case 'CREATE_UPDATE_DELETE':\n      return ['CREATE', 'UPDATE', 'DELETE'].includes(action);\n    case 'CREATE_DELETE':\n      return ['CREATE', 'DELETE'].includes(action);\n    case 'CRITICAL_ONLY':\n      return ['DELETE', 'LOGIN', 'LOGOUT'].includes(action);\n    default:\n      return false;\n  }\n}\n\n// Check if field should be logged\nexport function shouldLogField(entityType: string, fieldName: string): boolean {\n  const config = getAuditConfig();\n  const entityConfig = config.entities[entityType];\n  \n  if (!entityConfig) return false;\n\n  const { include, exclude } = entityConfig.fields;\n  \n  // Check exclude list first\n  if (exclude.includes('*') || exclude.includes(fieldName)) return false;\n  \n  // Check include list\n  if (include.includes('*')) return true;\n  if (include.includes(fieldName)) return true;\n  \n  return false;\n}\n\n// Check if sampling should be applied\nexport function shouldSample(entityType: string): boolean {\n  const config = getAuditConfig();\n  const entityConfig = config.entities[entityType];\n  \n  if (!entityConfig || !entityConfig.sampling.enabled) return false;\n  \n  return Math.random() < entityConfig.sampling.rate;\n}\n\n// Get entity configuration\nexport function getAuditEntityConfig(entityType: string): AuditEntityConfig | null {\n  const config = getAuditConfig();\n  return config.entities[entityType] || null;\n}\n\n// Sanitize sensitive data\nexport function sanitizeFieldValue(entityType: string, fieldName: string, value: any): any {\n  const config = getAuditConfig();\n  const entityConfig = config.entities[entityType];\n  \n  if (!entityConfig) return value;\n  \n  if (entityConfig.fields.sensitive.includes(fieldName)) {\n    if (typeof value === 'string' && value.length > 4) {\n      return value.substring(0, 2) + '*'.repeat(value.length - 4) + value.substring(value.length - 2);\n    }\n    return '[REDACTED]';\n  }\n  \n  return value;\n}\n\n// Performance monitoring\nexport class AuditPerformanceMonitor {\n  private metrics = {\n    totalLogs: 0,\n    failedLogs: 0,\n    totalTime: 0,\n    averageTime: 0,\n    maxTime: 0\n  };\n\n  startTimer(): () => number {\n    const start = Date.now();\n    return () => {\n      const duration = Date.now() - start;\n      this.updateMetrics(duration);\n      return duration;\n    };\n  }\n\n  private updateMetrics(duration: number) {\n    this.metrics.totalLogs++;\n    this.metrics.totalTime += duration;\n    this.metrics.averageTime = this.metrics.totalTime / this.metrics.totalLogs;\n    this.metrics.maxTime = Math.max(this.metrics.maxTime, duration);\n  }\n\n  recordFailure() {\n    this.metrics.failedLogs++;\n  }\n\n  getMetrics() {\n    return {\n      ...this.metrics,\n      failureRate: this.metrics.failedLogs / this.metrics.totalLogs,\n      performance: {\n        averageTime: this.metrics.averageTime,\n        maxTime: this.metrics.maxTime,\n        isHealthy: this.metrics.averageTime < 100 // 100ms threshold\n      }\n    };\n  }\n\n  reset() {\n    this.metrics = {\n      totalLogs: 0,\n      failedLogs: 0,\n      totalTime: 0,\n      averageTime: 0,\n      maxTime: 0\n    };\n  }\n}\n\n// Global performance monitor\nexport const auditPerformanceMonitor = new AuditPerformanceMonitor();\n","/**\n * Audit Helper Utilities\n * \n * This module provides helper functions to make audit logging easier\n * across all API routes and database operations with selective logging.\n */\n\nimport { PrismaClient } from '@prisma/client';\nimport { AuditLogger } from '@rentalshop/database';\nimport type { AuditContext } from '@rentalshop/database';\nimport { \n  shouldLogEntity, \n  shouldLogField, \n  shouldSample, \n  getAuditEntityConfig,\n  sanitizeFieldValue,\n  auditPerformanceMonitor,\n  type AuditConfig\n} from './audit-config';\n\nexport interface AuditHelperContext {\n  userId?: string;\n  userEmail?: string;\n  userRole?: string;\n  merchantId?: string;\n  outletId?: string;\n  ipAddress?: string;\n  userAgent?: string;\n  sessionId?: string;\n  requestId?: string;\n  metadata?: Record<string, any>;\n}\n\nexport class AuditHelper {\n  private auditLogger: AuditLogger;\n  private prisma: PrismaClient;\n\n  constructor(prisma: PrismaClient) {\n    this.prisma = prisma;\n    this.auditLogger = new AuditLogger(prisma);\n  }\n\n  /**\n   * Log a CREATE operation with selective logging\n   */\n  async logCreate(params: {\n    entityType: string;\n    entityId: string;\n    entityName?: string;\n    newValues: Record<string, any>;\n    description?: string;\n    context: AuditHelperContext;\n    severity?: 'INFO' | 'WARNING' | 'ERROR' | 'CRITICAL';\n    category?: 'GENERAL' | 'SECURITY' | 'BUSINESS' | 'SYSTEM' | 'COMPLIANCE';\n  }) {\n    // Check if we should log this entity\n    if (!shouldLogEntity(params.entityType, 'CREATE')) {\n      return;\n    }\n\n    // Check sampling\n    if (shouldSample(params.entityType)) {\n      return;\n    }\n\n    const timer = auditPerformanceMonitor.startTimer();\n    \n    try {\n      // Sanitize and filter values\n      const sanitizedValues = this.sanitizeValues(params.entityType, params.newValues);\n      \n      // Get entity config for default values\n      const entityConfig = getAuditEntityConfig(params.entityType);\n      \n      await this.auditLogger.log({\n        action: 'CREATE',\n        entityType: params.entityType,\n        entityId: params.entityId,\n        entityName: params.entityName,\n        newValues: sanitizedValues,\n        severity: params.severity || entityConfig?.severity || 'INFO',\n        category: params.category || entityConfig?.category || 'BUSINESS',\n        description: params.description || `${params.entityType} created`,\n        context: this.transformContext(params.context)\n      });\n    } catch (error) {\n      console.error('Failed to log CREATE audit:', error);\n      auditPerformanceMonitor.recordFailure();\n    } finally {\n      timer();\n    }\n  }\n\n  /**\n   * Log an UPDATE operation with selective logging\n   */\n  async logUpdate(params: {\n    entityType: string;\n    entityId: string;\n    entityName?: string;\n    oldValues: Record<string, any>;\n    newValues: Record<string, any>;\n    changes?: Record<string, { old: any; new: any }>;\n    description?: string;\n    context: AuditHelperContext;\n    severity?: 'INFO' | 'WARNING' | 'ERROR' | 'CRITICAL';\n    category?: 'GENERAL' | 'SECURITY' | 'BUSINESS' | 'SYSTEM' | 'COMPLIANCE';\n  }) {\n    console.log('🔍 Audit Helper - logUpdate called:', {\n      entityType: params.entityType,\n      entityId: params.entityId,\n      shouldLog: shouldLogEntity(params.entityType, 'UPDATE'),\n      shouldSample: shouldSample(params.entityType)\n    });\n\n    // Check if we should log this entity\n    if (!shouldLogEntity(params.entityType, 'UPDATE')) {\n      console.log('❌ Audit logging skipped: Entity not configured for logging');\n      return;\n    }\n\n    // Check sampling\n    if (shouldSample(params.entityType)) {\n      console.log('❌ Audit logging skipped: Sampling applied');\n      return;\n    }\n\n    const timer = auditPerformanceMonitor.startTimer();\n    \n    try {\n      // Calculate changes if not provided\n      const changes = params.changes || this.calculateChanges(params.oldValues, params.newValues);\n      \n      // Filter changes to only include significant ones\n      const significantChanges = this.filterSignificantChanges(params.entityType, changes);\n      \n      if (Object.keys(significantChanges).length > 0) {\n        // Sanitize values\n        const sanitizedOldValues = this.sanitizeValues(params.entityType, params.oldValues);\n        const sanitizedNewValues = this.sanitizeValues(params.entityType, params.newValues);\n        \n        // Get entity config for default values\n        const entityConfig = getAuditEntityConfig(params.entityType);\n        \n        await this.auditLogger.log({\n          action: 'UPDATE',\n          entityType: params.entityType,\n          entityId: params.entityId,\n          entityName: params.entityName,\n          oldValues: sanitizedOldValues,\n          newValues: sanitizedNewValues,\n          changes: significantChanges,\n          severity: params.severity || entityConfig?.severity || 'INFO',\n          category: params.category || entityConfig?.category || 'BUSINESS',\n          description: params.description || `${params.entityType} updated`,\n          context: this.transformContext(params.context)\n        });\n      }\n    } catch (error) {\n      console.error('Failed to log UPDATE audit:', error);\n      auditPerformanceMonitor.recordFailure();\n    } finally {\n      timer();\n    }\n  }\n\n  /**\n   * Log a DELETE operation\n   */\n  async logDelete(params: {\n    entityType: string;\n    entityId: string;\n    entityName?: string;\n    oldValues: Record<string, any>;\n    description?: string;\n    context: AuditHelperContext;\n    severity?: 'INFO' | 'WARNING' | 'ERROR' | 'CRITICAL';\n    category?: 'GENERAL' | 'SECURITY' | 'BUSINESS' | 'SYSTEM' | 'COMPLIANCE';\n  }) {\n    try {\n      await this.auditLogger.log({\n        action: 'DELETE',\n        entityType: params.entityType,\n        entityId: params.entityId,\n        entityName: params.entityName,\n        oldValues: params.oldValues,\n        severity: params.severity || 'WARNING',\n        category: params.category || 'BUSINESS',\n        description: params.description || `${params.entityType} deleted`,\n        context: this.transformContext(params.context)\n      });\n    } catch (error) {\n      console.error('Failed to log DELETE audit:', error);\n    }\n  }\n\n  /**\n   * Log a custom action\n   */\n  async logCustom(params: {\n    action: string;\n    entityType: string;\n    entityId: string;\n    entityName?: string;\n    description: string;\n    context: AuditHelperContext;\n    severity?: 'INFO' | 'WARNING' | 'ERROR' | 'CRITICAL';\n    category?: 'GENERAL' | 'SECURITY' | 'BUSINESS' | 'SYSTEM' | 'COMPLIANCE';\n    metadata?: Record<string, any>;\n  }) {\n    try {\n      await this.auditLogger.log({\n        action: params.action as any, // Cast to allowed action type\n        entityType: params.entityType,\n        entityId: params.entityId,\n        entityName: params.entityName,\n        description: params.description,\n        severity: params.severity || 'INFO',\n        category: params.category || 'GENERAL',\n        context: {\n          ...this.transformContext(params.context),\n          metadata: {\n            ...params.context.metadata,\n            ...params.metadata\n          }\n        }\n      });\n    } catch (error) {\n      console.error('Failed to log CUSTOM audit:', error);\n    }\n  }\n\n  /**\n   * Calculate changes between old and new values\n   */\n  private calculateChanges(oldValues: Record<string, any>, newValues: Record<string, any>): Record<string, { old: any; new: any }> {\n    const changes: Record<string, { old: any; new: any }> = {};\n    \n    // Check all fields in newValues\n    for (const key in newValues) {\n      if (key === 'id' || key === 'createdAt' || key === 'updatedAt') continue;\n      \n      if (oldValues[key] !== newValues[key]) {\n        changes[key] = {\n          old: oldValues[key],\n          new: newValues[key]\n        };\n      }\n    }\n\n    // Check for deleted fields\n    for (const key in oldValues) {\n      if (key === 'id' || key === 'createdAt' || key === 'updatedAt') continue;\n      \n      if (!(key in newValues)) {\n        changes[key] = {\n          old: oldValues[key],\n          new: null\n        };\n      }\n    }\n\n    return changes;\n  }\n\n  /**\n   * Sanitize values based on entity configuration\n   */\n  private sanitizeValues(entityType: string, values: Record<string, any>): Record<string, any> {\n    const sanitized: Record<string, any> = {};\n    \n    for (const [key, value] of Object.entries(values)) {\n      if (shouldLogField(entityType, key)) {\n        sanitized[key] = sanitizeFieldValue(entityType, key, value);\n      }\n    }\n    \n    return sanitized;\n  }\n\n  /**\n   * Filter changes to only include significant ones\n   */\n  private filterSignificantChanges(entityType: string, changes: Record<string, { old: any; new: any }>): Record<string, { old: any; new: any }> {\n    const significant: Record<string, { old: any; new: any }> = {};\n    \n    // Fields that are always considered significant\n    const alwaysSignificant = ['name', 'email', 'phone', 'status', 'role', 'amount', 'price'];\n    \n    // Fields that are usually not significant\n    const usuallyInsignificant = ['updatedAt', 'lastLoginAt', 'viewCount', 'accessCount'];\n    \n    for (const [field, change] of Object.entries(changes)) {\n      // Skip if field shouldn't be logged\n      if (!shouldLogField(entityType, field)) continue;\n      \n      // Always include significant fields\n      if (alwaysSignificant.includes(field)) {\n        significant[field] = change;\n        continue;\n      }\n      \n      // Skip insignificant fields\n      if (usuallyInsignificant.includes(field)) continue;\n      \n      // Include other fields\n      significant[field] = change;\n    }\n    \n    return significant;\n  }\n\n  /**\n   * Transform helper context to audit context\n   */\n  private transformContext(context: AuditHelperContext): AuditContext {\n    return {\n      userId: context.userId ? parseInt(context.userId) : undefined,\n      userEmail: context.userEmail,\n      userRole: context.userRole,\n      merchantId: context.merchantId ? parseInt(context.merchantId) : undefined,\n      outletId: context.outletId ? parseInt(context.outletId) : undefined,\n      ipAddress: context.ipAddress,\n      userAgent: context.userAgent,\n      sessionId: context.sessionId,\n      requestId: context.requestId,\n      metadata: context.metadata\n    };\n  }\n}\n\n/**\n * Create an audit helper instance\n */\nexport function createAuditHelper(prisma: PrismaClient): AuditHelper {\n  return new AuditHelper(prisma);\n}\n\n/**\n * Quick audit logging functions for common operations\n */\nexport async function quickAuditLog(\n  prisma: PrismaClient,\n  operation: 'CREATE' | 'UPDATE' | 'DELETE',\n  entityType: string,\n  entityId: string,\n  context: AuditHelperContext,\n  options?: {\n    entityName?: string;\n    oldValues?: Record<string, any>;\n    newValues?: Record<string, any>;\n    description?: string;\n    severity?: 'INFO' | 'WARNING' | 'ERROR' | 'CRITICAL';\n    category?: 'GENERAL' | 'SECURITY' | 'BUSINESS' | 'SYSTEM' | 'COMPLIANCE';\n  }\n) {\n  const auditHelper = new AuditHelper(prisma);\n  \n  switch (operation) {\n    case 'CREATE':\n      await auditHelper.logCreate({\n        entityType,\n        entityId,\n        entityName: options?.entityName,\n        newValues: options?.newValues || {},\n        description: options?.description,\n        context,\n        severity: options?.severity,\n        category: options?.category\n      });\n      break;\n      \n    case 'UPDATE':\n      await auditHelper.logUpdate({\n        entityType,\n        entityId,\n        entityName: options?.entityName,\n        oldValues: options?.oldValues || {},\n        newValues: options?.newValues || {},\n        description: options?.description,\n        context,\n        severity: options?.severity,\n        category: options?.category\n      });\n      break;\n      \n    case 'DELETE':\n      await auditHelper.logDelete({\n        entityType,\n        entityId,\n        entityName: options?.entityName,\n        oldValues: options?.oldValues || {},\n        description: options?.description,\n        context,\n        severity: options?.severity,\n        category: options?.category\n      });\n      break;\n  }\n}\n","import { authenticatedFetch, publicFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\nimport type { User, LoginCredentials, RegisterData } from '@rentalshop/types';\n\n// Local type definitions for missing types\nexport interface AuthResponse {\n  token: string;\n  user: User;\n}\n\n/**\n * Authentication API client\n */\nexport const authApi = {\n  /**\n   * Login user\n   */\n  async login(credentials: LoginCredentials): Promise<ApiResponse<AuthResponse>> {\n    try {\n      const response = await publicFetch(apiUrls.auth.login, {\n        method: 'POST',\n        body: JSON.stringify(credentials),\n      });\n      return await parseApiResponse<AuthResponse>(response);\n    } catch (error) {\n      console.error('Login error:', error);\n      throw new Error('Failed to login');\n    }\n  },\n\n  /**\n   * Register new user\n   */\n  async register(userData: RegisterData): Promise<ApiResponse<AuthResponse>> {\n    const response = await publicFetch(apiUrls.auth.register, {\n      method: 'POST',\n      body: JSON.stringify(userData),\n    });\n    return await parseApiResponse<AuthResponse>(response);\n  },\n\n  /**\n   * Verify authentication token\n   */\n  async verifyToken(): Promise<ApiResponse<User>> {\n    const response = await authenticatedFetch(apiUrls.auth.verify);\n    return await parseApiResponse<User>(response);\n  },\n\n  /**\n   * Refresh authentication token\n   */\n  async refreshToken(): Promise<ApiResponse<{ token: string }>> {\n    const response = await authenticatedFetch(apiUrls.auth.refresh);\n    return await parseApiResponse<{ token: string }>(response);\n  },\n\n  /**\n   * Logout user\n   */\n  async logout(): Promise<ApiResponse<void>> {\n    const response = await authenticatedFetch(apiUrls.auth.logout, {\n      method: 'POST',\n    });\n    return await parseApiResponse<void>(response);\n  },\n\n  /**\n   * Request password reset\n   */\n  async requestPasswordReset(email: string): Promise<ApiResponse<void>> {\n    const response = await fetch(apiUrls.auth.forgotPassword, {\n      method: 'POST',\n      body: JSON.stringify({ email }),\n    });\n    return await parseApiResponse<void>(response);\n  },\n\n  /**\n   * Reset password with token\n   */\n  async resetPassword(token: string, newPassword: string): Promise<ApiResponse<void>> {\n    const response = await fetch(apiUrls.auth.resetPassword, {\n      method: 'POST',\n      body: JSON.stringify({ token, newPassword }),\n    });\n    return await parseApiResponse<void>(response);\n  },\n\n  /**\n   * Change password (authenticated)\n   */\n  async changePassword(currentPassword: string, newPassword: string): Promise<ApiResponse<void>> {\n    const response = await authenticatedFetch(apiUrls.auth.changePassword, {\n      method: 'POST',\n      body: JSON.stringify({ currentPassword, newPassword }),\n    });\n    return await parseApiResponse<void>(response);\n  }\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\nimport type { Product, ProductWithStock, ProductCreateInput, ProductUpdateInput, ProductFilters } from '@rentalshop/types';\n\nexport interface ProductsResponse {\n  products: Product[];\n  total: number;\n  page: number;\n  limit: number;\n  offset: number;\n  hasMore: boolean;\n  totalPages: number;\n}\n\n/**\n * Products API client for product management operations\n */\nexport const productsApi = {\n  /**\n   * Get all products\n   */\n  async getProducts(): Promise<ApiResponse<Product[]>> {\n    const response = await authenticatedFetch(apiUrls.products.list);\n    const result = await parseApiResponse<Product[]>(response);\n    return result;\n  },\n\n  /**\n   * Get products with pagination\n   */\n  async getProductsPaginated(page: number = 1, limit: number = 50): Promise<ApiResponse<ProductsResponse>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString()\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.products.list}?${params.toString()}`);\n    return await parseApiResponse<ProductsResponse>(response);\n  },\n\n  /**\n   * Search products with filters\n   */\n  async searchProducts(filters: ProductFilters): Promise<ApiResponse<Product[]>> {\n    const params = new URLSearchParams();\n    \n    if (filters.search) params.append('q', filters.search); // Use 'q' parameter like orders\n    if (filters.categoryId) params.append('categoryId', filters.categoryId.toString());\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.available !== undefined) params.append('available', filters.available.toString());\n    if (filters.status) params.append('status', filters.status);\n    if (filters.minPrice) params.append('minPrice', filters.minPrice.toString());\n    if (filters.maxPrice) params.append('maxPrice', filters.maxPrice.toString());\n    \n    // Add pagination parameters\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    if (filters.offset) params.append('offset', filters.offset.toString());\n    // Add page parameter for consistency with user/customer search\n    if (filters.page) params.append('page', filters.page.toString());\n    \n    // Add sorting parameters\n    if (filters.sortBy) params.append('sortBy', filters.sortBy);\n    if (filters.sortOrder) params.append('sortOrder', filters.sortOrder);\n    \n    const response = await authenticatedFetch(`${apiUrls.products.list}?${params.toString()}`);\n    return await parseApiResponse<Product[]>(response);\n  },\n\n  /**\n   * Search products for a specific merchant (admin context)\n   */\n  async searchMerchantProducts(merchantId: number, filters: ProductFilters): Promise<ApiResponse<Product[]>> {\n    const params = new URLSearchParams();\n    \n    if (filters.search) params.append('search', filters.search);\n    if (filters.categoryId) params.append('categoryId', filters.categoryId.toString());\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.available !== undefined) params.append('available', filters.available.toString());\n    if (filters.status) params.append('status', filters.status);\n    if (filters.minPrice) params.append('minPrice', filters.minPrice.toString());\n    if (filters.maxPrice) params.append('maxPrice', filters.maxPrice.toString());\n    \n    // Add pagination parameters\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    if (filters.offset) params.append('offset', filters.offset.toString());\n    // Add page parameter for consistency with user/customer search\n    if (filters.page) params.append('page', filters.page.toString());\n    \n    const response = await authenticatedFetch(`${apiUrls.merchants.products.list(merchantId)}?${params.toString()}`);\n    return await parseApiResponse<Product[]>(response);\n  },\n\n  /**\n   * Get product by ID\n   */\n  async getProduct(productId: number): Promise<ApiResponse<ProductWithStock>> {\n    const response = await authenticatedFetch(apiUrls.products.update(productId));\n    return await parseApiResponse<ProductWithStock>(response);\n  },\n\n  /**\n   * Get product by ID (alias for getProduct for backward compatibility)\n   */\n  async getProductById(productId: number): Promise<ApiResponse<ProductWithStock>> {\n    return this.getProduct(productId);\n  },\n\n  /**\n   * Create a new product\n   */\n  async createProduct(productData: ProductCreateInput): Promise<ApiResponse<Product>> {\n    const response = await authenticatedFetch(apiUrls.products.create, {\n      method: 'POST',\n      body: JSON.stringify(productData),\n    });\n    return await parseApiResponse<Product>(response);\n  },\n\n  /**\n   * Update an existing product\n   */\n  async updateProduct(productId: number, productData: ProductUpdateInput): Promise<ApiResponse<Product>> {\n    const response = await authenticatedFetch(apiUrls.products.update(productId), {\n      method: 'PUT',\n      body: JSON.stringify(productData),\n    });\n    return await parseApiResponse<Product>(response);\n  },\n\n  /**\n   * Delete a product\n   */\n  async deleteProduct(productId: number): Promise<ApiResponse<void>> {\n    const response = await authenticatedFetch(apiUrls.products.delete(productId), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<void>(response);\n  },\n\n  /**\n   * Get products by category\n   */\n  async getProductsByCategory(categoryId: number): Promise<ApiResponse<Product[]>> {\n    const response = await authenticatedFetch(`${apiUrls.products.list}?categoryId=${categoryId}`);\n    return await parseApiResponse<Product[]>(response);\n  },\n\n  /**\n   * Get products by outlet\n   */\n  async getProductsByOutlet(outletId: number): Promise<ApiResponse<Product[]>> {\n    const response = await authenticatedFetch(`${apiUrls.products.list}?outletId=${outletId}`);\n    return await parseApiResponse<Product[]>(response);\n  },\n\n  /**\n   * Update product stock\n   */\n  async updateProductStock(productId: number, stock: number): Promise<ApiResponse<Product>> {\n    const response = await authenticatedFetch(apiUrls.products.updateStock(productId), {\n      method: 'PATCH',\n      body: JSON.stringify({ stock }),\n    });\n    return await parseApiResponse<Product>(response);\n  },\n\n  /**\n   * Bulk update products\n   */\n  async bulkUpdateProducts(updates: Array<{ id: number; data: Partial<ProductUpdateInput> }>): Promise<ApiResponse<Product[]>> {\n    const response = await authenticatedFetch(apiUrls.products.bulkUpdate, {\n      method: 'PATCH',\n      body: JSON.stringify({ updates }),\n    });\n    return await parseApiResponse<Product[]>(response);\n  }\n};\n\n\n\n\n","import type { \n  CustomerInput, \n  CustomerUpdateInput, \n  CustomerFilters, \n  CustomerSearchFilter \n} from '@rentalshop/types';\nimport { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\n\n// ============================================================================\n// CUSTOMER API TYPES\n// ============================================================================\n\nexport interface CustomerApiResponse<T = any> {\n  success: boolean;\n  data?: T;\n  message?: string;\n  error?: any;\n}\n\nexport interface CustomerSearchResponse {\n  customers: any[];\n  total: number;\n  limit: number;\n  offset: number;\n  hasMore: boolean;\n}\n\nexport interface CustomerListResponse {\n  customers: any[];\n  total: number;\n  page: number;\n  totalPages: number;\n  hasMore: boolean;\n}\n\n// ============================================================================\n// CUSTOMER API (MERGED FUNCTIONALITY)\n// ============================================================================\n\nexport const customersApi = {\n  // ============================================================================\n  // CUSTOMER CRUD OPERATIONS\n  // ============================================================================\n\n  /**\n   * Get all customers\n   */\n  async getCustomers(): Promise<CustomerApiResponse> {\n    const response = await authenticatedFetch(apiUrls.customers.list);\n    return await parseApiResponse<CustomerApiResponse>(response);\n  },\n\n  /**\n   * Get customers with pagination\n   */\n  async getCustomersPaginated(page: number = 1, limit: number = 50): Promise<CustomerApiResponse<CustomerListResponse>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString(),\n      _t: Date.now().toString() // Cache-busting parameter\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.customers.list}?${params.toString()}`);\n    const result = await parseApiResponse<CustomerListResponse>(response);\n    return result; // Return the ApiResponse directly - let consumers use type guards\n  },\n\n  /**\n   * Get customers with filtering and pagination\n   */\n  async getCustomersWithFilters(\n    filters: CustomerFilters = {}, \n    page = 1, \n    limit = 20\n  ): Promise<CustomerApiResponse<CustomerListResponse>> {\n    const params = new URLSearchParams();\n    \n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    if (filters.isActive !== undefined) params.append('isActive', filters.isActive.toString());\n    if (filters.search) params.append('search', filters.search);\n    if (filters.city) params.append('city', filters.city);\n    if (filters.state) params.append('state', filters.state);\n    if (filters.country) params.append('country', filters.country);\n    if (filters.idType) params.append('idType', filters.idType);\n    \n    params.append('page', page.toString());\n    params.append('limit', limit.toString());\n\n    const response = await authenticatedFetch(`${apiUrls.customers.list}?${params.toString()}`);\n    const result = await parseApiResponse<CustomerListResponse>(response);\n    return result; // Return the ApiResponse directly - let consumers use type guards\n  },\n\n  /**\n   * Search customers with advanced filters\n   */\n  async searchCustomers(filters: CustomerSearchFilter = {}): Promise<CustomerApiResponse<CustomerSearchResponse>> {\n    const params = new URLSearchParams();\n    \n    if (filters.q) params.append('q', filters.q);\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    if (filters.isActive !== undefined) params.append('isActive', filters.isActive.toString());\n    if (filters.city) params.append('city', filters.city);\n    if (filters.state) params.append('state', filters.state);\n    if (filters.country) params.append('country', filters.country);\n    if (filters.idType) params.append('idType', filters.idType);\n    \n    params.append('limit', (filters.limit || 20).toString());\n    params.append('offset', (filters.offset || 0).toString());\n    params.append('_t', Date.now().toString()); // Cache-busting parameter\n\n    const response = await authenticatedFetch(`${apiUrls.customers.list}?${params.toString()}`);\n    const result = await parseApiResponse<CustomerSearchResponse>(response);\n    return result; // Return the ApiResponse directly - let consumers use type guards\n  },\n\n  /**\n   * Get customer by ID\n   */\n  async getCustomerById(customerId: number): Promise<CustomerApiResponse> {\n    const response = await authenticatedFetch(apiUrls.customers.update(customerId));\n    return await parseApiResponse<CustomerApiResponse>(response);\n  },\n\n  /**\n   * Create new customer\n   */\n  async createCustomer(customerData: CustomerInput): Promise<CustomerApiResponse> {\n    const response = await authenticatedFetch(apiUrls.customers.create, {\n      method: 'POST',\n      body: JSON.stringify(customerData),\n    });\n    return await parseApiResponse<CustomerApiResponse>(response);\n  },\n\n  /**\n   * Update customer\n   */\n  async updateCustomer(customerId: number, customerData: CustomerUpdateInput): Promise<CustomerApiResponse> {\n    const response = await authenticatedFetch(`${apiUrls.customers.list}?id=${customerId}`, {\n      method: 'PUT',\n      body: JSON.stringify(customerData),\n    });\n    return await parseApiResponse<CustomerApiResponse>(response);\n  },\n\n  /**\n   * Delete customer\n   */\n  async deleteCustomer(customerId: number): Promise<CustomerApiResponse> {\n    const response = await authenticatedFetch(apiUrls.customers.delete(customerId), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<CustomerApiResponse>(response);\n  },\n\n  // ============================================================================\n  // TESTING AND DEBUG ENDPOINTS\n  // ============================================================================\n\n  /**\n   * Test customer creation payload validation\n   */\n  async testCustomerPayload(customerData: CustomerInput): Promise<CustomerApiResponse> {\n    const response = await authenticatedFetch('/api/customers/test', {\n      method: 'POST',\n      body: JSON.stringify(customerData)\n    });\n    return await parseApiResponse<CustomerApiResponse>(response);\n  },\n\n  /**\n   * Debug customer creation payload\n   */\n  async debugCustomerPayload(customerData: CustomerInput): Promise<CustomerApiResponse> {\n    const response = await authenticatedFetch('/api/customers/debug', {\n      method: 'POST',\n      body: JSON.stringify(customerData)\n    });\n    return await parseApiResponse<CustomerApiResponse>(response);\n  },\n\n  // ============================================================================\n  // UTILITY METHODS\n  // ============================================================================\n\n  /**\n   * Validate customer data before sending to API\n   */\n  validateCustomerData(data: CustomerInput): { isValid: boolean; errors: string[] } {\n    const errors: string[] = [];\n\n    if (!data.firstName?.trim()) errors.push('First name is required');\n    if (!data.lastName?.trim()) errors.push('Last name is required');\n    if (!data.email?.trim()) errors.push('Email is required');\n    if (!data.phone?.trim()) errors.push('Phone is required');\n    if (!data.merchantId) errors.push('Merchant ID is required');\n\n    // Email validation\n    if (data.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(data.email)) {\n      errors.push('Invalid email format');\n    }\n\n    // Phone validation\n    if (data.phone && !/^[0-9+\\-\\s()]+$/.test(data.phone)) {\n      errors.push('Phone number contains invalid characters');\n    }\n\n    if (data.phone && data.phone.length < 8) {\n      errors.push('Phone number must be at least 8 characters');\n    }\n\n    // ID Type validation\n    if (data.idType && !['passport', 'drivers_license', 'national_id', 'other'].includes(data.idType)) {\n      errors.push('Invalid ID type');\n    }\n\n    return {\n      isValid: errors.length === 0,\n      errors\n    };\n  },\n\n  /**\n   * Format customer data for API submission\n   */\n  formatCustomerData(data: CustomerInput): CustomerInput {\n    return {\n      ...data,\n      firstName: data.firstName?.trim(),\n      lastName: data.lastName?.trim(),\n      email: data.email?.toLowerCase().trim(),\n      phone: data.phone?.trim(),\n      address: data.address?.trim(),\n      city: data.city?.trim(),\n      state: data.state?.trim(),\n      zipCode: data.zipCode?.trim(),\n      country: data.country?.trim(),\n      idNumber: data.idNumber?.trim(),\n      notes: data.notes?.trim()\n    };\n  }\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\nimport type { Order, OrderCreateInput, OrderUpdateInput, OrderFilters } from '@rentalshop/types';\n\nexport interface OrdersResponse {\n  orders: Order[];\n  total: number;\n  page: number;\n  limit: number;\n  offset: number;\n  hasMore: boolean;\n  totalPages: number;\n}\n\n/**\n * Orders API client for order management operations\n */\nexport const ordersApi = {\n  /**\n   * Get all orders\n   */\n  async getOrders(): Promise<ApiResponse<Order[]>> {\n    const response = await authenticatedFetch(apiUrls.orders.list);\n    const result = await parseApiResponse<Order[]>(response);\n    return result;\n  },\n\n  /**\n   * Get orders with pagination\n   */\n  async getOrdersPaginated(page: number = 1, limit: number = 50): Promise<ApiResponse<OrdersResponse>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString()\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.orders.list}?${params.toString()}`);\n    return await parseApiResponse<OrdersResponse>(response);\n  },\n\n  /**\n   * Search orders with filters\n   */\n  async searchOrders(filters: OrderFilters): Promise<ApiResponse<OrdersResponse>> {\n    const params = new URLSearchParams();\n    \n    if (filters.search) params.append('q', filters.search);\n    if (filters.status) {\n      // Handle both single status and array of statuses\n      if (Array.isArray(filters.status)) {\n        filters.status.forEach(status => params.append('status', status));\n      } else {\n        params.append('status', filters.status);\n      }\n    }\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.customerId) params.append('customerId', filters.customerId.toString());\n    if (filters.productId) params.append('productId', filters.productId.toString());\n    \n    // Handle date fields - convert to ISO string if it's a Date object\n    if (filters.startDate) {\n      const startDate = filters.startDate instanceof Date ? filters.startDate.toISOString() : filters.startDate;\n      params.append('startDate', startDate);\n    }\n    if (filters.endDate) {\n      const endDate = filters.endDate instanceof Date ? filters.endDate.toISOString() : filters.endDate;\n      params.append('endDate', endDate);\n    }\n    \n    if (filters.orderType) params.append('orderType', filters.orderType);\n    \n    // Add pagination parameters\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    if (filters.offset) params.append('offset', filters.offset.toString());\n    if (filters.page) params.append('page', filters.page.toString());\n    \n    // Add sorting parameters\n    if (filters.sortBy) params.append('sortBy', filters.sortBy);\n    if (filters.sortOrder) params.append('sortOrder', filters.sortOrder);\n    \n    const response = await authenticatedFetch(`${apiUrls.orders.list}?${params.toString()}`);\n    return await parseApiResponse<OrdersResponse>(response);\n  },\n\n  /**\n   * Get order by ID\n   */\n  async getOrder(orderId: number): Promise<ApiResponse<Order>> {\n    const response = await authenticatedFetch(apiUrls.orders.update(orderId));\n    return await parseApiResponse<Order>(response);\n  },\n\n  /**\n   * Get order by order number (e.g., \"ORD-2110\")\n   */\n  async getOrderByNumber(orderNumber: string): Promise<ApiResponse<Order>> {\n    const response = await authenticatedFetch(apiUrls.orders.getByNumber(orderNumber));\n    return await parseApiResponse<Order>(response);\n  },\n\n  /**\n   * Create a new order\n   */\n  async createOrder(orderData: OrderCreateInput): Promise<ApiResponse<Order>> {\n    const response = await authenticatedFetch(apiUrls.orders.create, {\n      method: 'POST',\n      body: JSON.stringify(orderData),\n    });\n    return await parseApiResponse<Order>(response);\n  },\n\n  /**\n   * Update an existing order\n   */\n  async updateOrder(orderId: number, orderData: OrderUpdateInput): Promise<ApiResponse<Order>> {\n    const response = await authenticatedFetch(apiUrls.orders.update(orderId), {\n      method: 'PUT',\n      body: JSON.stringify(orderData),\n    });\n    return await parseApiResponse<Order>(response);\n  },\n\n  /**\n   * Delete an order\n   */\n  async deleteOrder(orderId: number): Promise<ApiResponse<void>> {\n    const response = await authenticatedFetch(apiUrls.orders.delete(orderId), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<void>(response);\n  },\n\n  /**\n   * Get orders by customer\n   */\n  async getOrdersByCustomer(customerId: number): Promise<ApiResponse<Order[]>> {\n    const response = await authenticatedFetch(`${apiUrls.orders.list}?customerId=${customerId}`);\n    return await parseApiResponse<Order[]>(response);\n  },\n\n  /**\n   * Get orders by outlet\n   */\n  async getOrdersByOutlet(outletId: number): Promise<ApiResponse<Order[]>> {\n    const response = await authenticatedFetch(`${apiUrls.orders.list}?outletId=${outletId}`);\n    return await parseApiResponse<Order[]>(response);\n  },\n\n  /**\n   * Get orders by product ID\n   */\n  async getOrdersByProduct(productId: number): Promise<ApiResponse<Order[]>> {\n    const response = await authenticatedFetch(`${apiUrls.orders.list}?productId=${productId}`);\n    return await parseApiResponse<Order[]>(response);\n  },\n\n  /**\n   * Update order status\n   */\n  async updateOrderStatus(orderId: number, status: string): Promise<ApiResponse<Order>> {\n    const response = await authenticatedFetch(apiUrls.orders.updateStatus(orderId), {\n      method: 'PATCH',\n      body: JSON.stringify({ status }),\n    });\n    return await parseApiResponse<Order>(response);\n  },\n\n  /**\n   * Pickup order (change status to PICKUPED)\n   */\n  async pickupOrder(orderId: number): Promise<ApiResponse<Order>> {\n    return this.updateOrderStatus(orderId, 'PICKUPED');\n  },\n\n  /**\n   * Return order (change status to RETURNED)\n   */\n  async returnOrder(orderId: number): Promise<ApiResponse<Order>> {\n    return this.updateOrderStatus(orderId, 'RETURNED');\n  },\n\n  /**\n   * Cancel order (change status to CANCELLED)\n   */\n  async cancelOrder(orderId: number): Promise<ApiResponse<Order>> {\n    return this.updateOrderStatus(orderId, 'CANCELLED');\n  },\n\n  /**\n   * Update order settings (damage fee, security deposit, collateral, notes)\n   */\n  async updateOrderSettings(orderId: number, settings: {\n    damageFee?: number;\n    securityDeposit?: number;\n    collateralType?: string;\n    collateralDetails?: string;\n    notes?: string;\n  }): Promise<ApiResponse<Order>> {\n    const response = await authenticatedFetch(apiUrls.orders.update(orderId), {\n      method: 'PUT',\n      body: JSON.stringify(settings),\n    });\n    return await parseApiResponse<Order>(response);\n  },\n\n  /**\n   * Get order statistics\n   */\n  async getOrderStats(): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.orders.stats);\n    return await parseApiResponse<any>(response);\n  },\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\nimport type { Outlet, OutletCreateInput, OutletUpdateInput } from '@rentalshop/types';\n\nexport interface OutletsResponse {\n  outlets: Outlet[];\n  total: number;\n  page: number;\n  limit: number;\n  hasMore: boolean;\n}\n\n/**\n * Outlets API client for outlet management operations\n */\nexport const outletsApi = {\n  /**\n   * Get all outlets\n   */\n  async getOutlets(): Promise<ApiResponse<OutletsResponse>> {\n    const response = await authenticatedFetch(apiUrls.outlets.list);\n    const result = await parseApiResponse<OutletsResponse>(response);\n    return result;\n  },\n\n  /**\n   * Get outlets with pagination\n   */\n  async getOutletsPaginated(page: number = 1, limit: number = 50): Promise<ApiResponse<OutletsResponse>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString()\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.outlets.list}?${params.toString()}`);\n    return await parseApiResponse<OutletsResponse>(response);\n  },\n\n  /**\n   * Get outlet by ID\n   */\n  async getOutlet(outletId: number): Promise<ApiResponse<Outlet>> {\n    const response = await authenticatedFetch(apiUrls.outlets.get(outletId));\n    return await parseApiResponse<Outlet>(response);\n  },\n\n  /**\n   * Create a new outlet\n   */\n  async createOutlet(outletData: OutletCreateInput): Promise<ApiResponse<Outlet>> {\n    const response = await authenticatedFetch(apiUrls.outlets.create, {\n      method: 'POST',\n      body: JSON.stringify(outletData),\n    });\n    return await parseApiResponse<Outlet>(response);\n  },\n\n  /**\n   * Update an existing outlet\n   */\n  async updateOutlet(outletId: number, outletData: OutletUpdateInput): Promise<ApiResponse<Outlet>> {\n    const response = await authenticatedFetch(apiUrls.outlets.update(outletId), {\n      method: 'PUT',\n      body: JSON.stringify(outletData),\n    });\n    return await parseApiResponse<Outlet>(response);\n  },\n\n  /**\n   * Delete an outlet\n   */\n  async deleteOutlet(outletId: number): Promise<ApiResponse<void>> {\n    const response = await authenticatedFetch(apiUrls.outlets.delete(outletId), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<void>(response);\n  },\n\n  /**\n   * Get outlets by shop\n   */\n  async getOutletsByShop(shopId: number): Promise<ApiResponse<OutletsResponse>> {\n    const response = await authenticatedFetch(`${apiUrls.outlets.list}?shopId=${shopId}`);\n    return await parseApiResponse<OutletsResponse>(response);\n  },\n\n  /**\n   * Get outlets by merchant\n   */\n  async getOutletsByMerchant(merchantId: number): Promise<ApiResponse<OutletsResponse>> {\n    console.log('🔍 Outlets API Client: Calling getOutletsByMerchant with merchantId:', merchantId);\n    console.log('🔍 Outlets API Client: API URL:', apiUrls.merchants.outlets.list(merchantId));\n    \n    const response = await authenticatedFetch(apiUrls.merchants.outlets.list(merchantId));\n    console.log('🔍 Outlets API Client: Raw response:', response);\n    \n    const result = await parseApiResponse<OutletsResponse>(response);\n    console.log('🔍 Outlets API Client: Parsed result:', result);\n    console.log('🔍 Outlets API Client: Result success:', result.success);\n    if (result.success) {\n      console.log('🔍 Outlets API Client: Result data:', result.data);\n      console.log('🔍 Outlets API Client: Result outlets count:', result.data?.outlets?.length || 0);\n    } else {\n      console.log('🔍 Outlets API Client: Error:', result.message);\n    }\n    \n    return result;\n  },\n\n  /**\n   * Get outlet statistics\n   */\n  async getOutletStats(): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.outlets.stats);\n    return await parseApiResponse<any>(response);\n  }\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface Merchant {\n  id: number;\n  name: string;\n  email?: string;\n  phone?: string;\n  address?: string;\n  isActive: boolean;\n  planId?: string;\n  subscriptionStatus?: string;\n  trialEndsAt?: Date | string;\n  totalRevenue?: number;\n  lastActiveAt?: Date | string;\n  createdAt: Date | string;\n  updatedAt: Date | string;\n}\n\nexport interface MerchantsResponse {\n  merchants: Merchant[];\n  total: number;\n  page: number;\n  limit: number;\n  totalPages: number;\n}\n\nexport interface MerchantSearchFilters {\n  q?: string;\n  status?: string;\n  plan?: string;\n  isActive?: boolean;\n  subscriptionStatus?: string;\n  minRevenue?: number;\n  maxRevenue?: number;\n  startDate?: string;\n  endDate?: string;\n  sortBy?: string;\n  sortOrder?: 'asc' | 'desc';\n  limit?: number;\n  offset?: number;\n}\n\n// ============================================================================\n// MERCHANTS API CLIENT\n// ============================================================================\n\n/**\n * Merchants API client for merchant management operations\n */\nexport const merchantsApi = {\n  /**\n   * Get all merchants\n   */\n  async getMerchants(): Promise<ApiResponse<MerchantsResponse>> {\n    const response = await authenticatedFetch(apiUrls.merchants.list);\n    const result = await parseApiResponse<MerchantsResponse>(response);\n    return result;\n  },\n\n  /**\n   * Get merchants with pagination\n   */\n  async getMerchantsPaginated(page: number = 1, limit: number = 50): Promise<ApiResponse<MerchantsResponse>> {\n    const response = await authenticatedFetch(`${apiUrls.merchants.list}?page=${page}&limit=${limit}`);\n    const result = await parseApiResponse<MerchantsResponse>(response);\n    return result;\n  },\n\n  /**\n   * Search merchants with filters\n   */\n  async searchMerchants(filters: MerchantSearchFilters): Promise<ApiResponse<MerchantsResponse>> {\n    const params = new URLSearchParams();\n    \n    if (filters.q) params.append('q', filters.q);\n    if (filters.status) params.append('status', filters.status);\n    if (filters.plan) params.append('plan', filters.plan);\n    if (filters.isActive !== undefined) params.append('isActive', filters.isActive.toString());\n    if (filters.subscriptionStatus) params.append('subscriptionStatus', filters.subscriptionStatus);\n    if (filters.minRevenue !== undefined) params.append('minRevenue', filters.minRevenue.toString());\n    if (filters.maxRevenue !== undefined) params.append('maxRevenue', filters.maxRevenue.toString());\n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.sortBy) params.append('sortBy', filters.sortBy);\n    if (filters.sortOrder) params.append('sortOrder', filters.sortOrder);\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    if (filters.offset) params.append('offset', filters.offset.toString());\n    \n    const response = await authenticatedFetch(`${apiUrls.merchants.list}?${params.toString()}`);\n    return await parseApiResponse<MerchantsResponse>(response);\n  },\n\n  /**\n   * Get merchant by ID\n   */\n  async getMerchantById(id: number): Promise<ApiResponse<Merchant>> {\n    const response = await authenticatedFetch(apiUrls.merchants.get(id));\n    const result = await parseApiResponse<Merchant>(response);\n    return result;\n  },\n\n\n  /**\n   * Get merchant detail with full data (subscriptions, outlets, users, etc.)\n   */\n  async getMerchantDetail(id: number): Promise<ApiResponse<Merchant>> {\n    const response = await authenticatedFetch(apiUrls.merchants.get(id));\n    const result = await parseApiResponse<Merchant>(response);\n    return result;\n  },\n\n  /**\n   * Create new merchant\n   */\n  async createMerchant(merchantData: Partial<Merchant>): Promise<ApiResponse<Merchant>> {\n    const response = await authenticatedFetch(apiUrls.merchants.create, {\n      method: 'POST',\n      body: JSON.stringify(merchantData),\n    });\n    const result = await parseApiResponse<Merchant>(response);\n    return result;\n  },\n\n  /**\n   * Register new merchant (public endpoint)\n   */\n  async register(data: {\n    merchantName: string;\n    merchantEmail: string;\n    merchantPhone: string;\n    merchantDescription: string;\n    userEmail: string;\n    userPassword: string;\n    userFirstName: string;\n    userLastName: string;\n    userPhone: string;\n    outletName: string;\n    outletAddress: string;\n    outletDescription: string;\n  }): Promise<ApiResponse<{ merchant: Merchant; user: any }>> {\n    const response = await fetch(apiUrls.merchants.register, {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n    return await parseApiResponse<{ merchant: Merchant; user: any }>(response);\n  },\n\n  /**\n   * Update merchant\n   */\n  async updateMerchant(id: number, merchantData: Partial<Merchant>): Promise<ApiResponse<Merchant>> {\n    const response = await authenticatedFetch(apiUrls.merchants.update(id), {\n      method: 'PUT',\n      body: JSON.stringify(merchantData),\n    });\n    const result = await parseApiResponse<Merchant>(response);\n    return result;\n  },\n\n  /**\n   * Delete merchant\n   */\n  async deleteMerchant(id: number): Promise<ApiResponse<void>> {\n    const response = await authenticatedFetch(apiUrls.merchants.delete(id), {\n      method: 'DELETE',\n    });\n    const result = await parseApiResponse<void>(response);\n    return result;\n  },\n\n  /**\n   * Get merchant statistics\n   */\n  async getMerchantStats(): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(`${apiUrls.merchants.list}/stats`);\n    const result = await parseApiResponse<any>(response);\n    return result;\n  },\n\n  /**\n   * Update merchant plan\n   */\n  async updateMerchantPlan(merchantId: number, planData: {\n    planId: number;\n    reason?: string;\n    effectiveDate?: string;\n    notifyMerchant?: boolean;\n    billingInterval?: string;\n    duration?: number;\n    discount?: number;\n    totalPrice?: number;\n  }): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.merchants.updatePlan(merchantId), {\n      method: 'PUT',\n      body: JSON.stringify(planData),\n    });\n    const result = await parseApiResponse<any>(response);\n    return result;\n  },\n\n  /**\n   * Get merchant plan history\n   */\n  async getMerchantPlanHistory(merchantId: number): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.merchants.getPlan(merchantId));\n    const result = await parseApiResponse<any>(response);\n    return result;\n  },\n\n  /**\n   * Disable merchant plan\n   */\n  async disableMerchantPlan(merchantId: number, subscriptionId: number, reason: string): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.merchants.extendPlan(merchantId), {\n      method: 'PATCH',\n      body: JSON.stringify({\n        action: 'disable',\n        subscriptionId,\n        reason\n      }),\n    });\n    const result = await parseApiResponse<any>(response);\n    return result;\n  },\n\n  /**\n   * Delete merchant plan\n   */\n  async deleteMerchantPlan(merchantId: number, subscriptionId: number, reason: string): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.merchants.cancelPlan(merchantId), {\n      method: 'PATCH',\n      body: JSON.stringify({\n        action: 'delete',\n        subscriptionId,\n        reason\n      }),\n    });\n    const result = await parseApiResponse<any>(response);\n    return result;\n  },\n\n  // ============================================================================\n  // MERCHANT-SPECIFIC ENDPOINTS\n  // ============================================================================\n\n  /**\n   * Merchant Products\n   */\n  products: {\n    list: async (merchantId: number) => {\n      return authenticatedFetch(apiUrls.merchants.products.list(merchantId));\n    },\n\n    get: async (merchantId: number, productId: number) => {\n      return authenticatedFetch(apiUrls.merchants.products.get(merchantId, productId));\n    },\n\n    create: async (merchantId: number, data: any) => {\n      return authenticatedFetch(apiUrls.merchants.products.create(merchantId), {\n        method: 'POST',\n        body: JSON.stringify(data)\n      });\n    },\n\n    update: async (merchantId: number, productId: number, data: any) => {\n      return authenticatedFetch(apiUrls.merchants.products.update(merchantId, productId), {\n        method: 'PUT',\n        body: JSON.stringify(data)\n      });\n    },\n\n    delete: async (merchantId: number, productId: number) => {\n      return authenticatedFetch(apiUrls.merchants.products.delete(merchantId, productId), {\n        method: 'DELETE'\n      });\n    }\n  },\n\n  /**\n   * Merchant Orders\n   */\n  orders: {\n    list: async (merchantId: number, queryParams?: string) => {\n      const url = queryParams \n        ? `${apiUrls.merchants.orders.list(merchantId)}?${queryParams}`\n        : apiUrls.merchants.orders.list(merchantId);\n      return authenticatedFetch(url);\n    },\n\n    get: async (merchantId: number, orderId: number) => {\n      return authenticatedFetch(apiUrls.merchants.orders.get(merchantId, orderId));\n    },\n\n    create: async (merchantId: number, data: any) => {\n      return authenticatedFetch(apiUrls.merchants.orders.create(merchantId), {\n        method: 'POST',\n        body: JSON.stringify(data)\n      });\n    },\n\n    update: async (merchantId: number, orderId: number, data: any) => {\n      return authenticatedFetch(apiUrls.merchants.orders.update(merchantId, orderId), {\n        method: 'PUT',\n        body: JSON.stringify(data)\n      });\n    },\n\n    delete: async (merchantId: number, orderId: number) => {\n      return authenticatedFetch(apiUrls.merchants.orders.delete(merchantId, orderId), {\n        method: 'DELETE'\n      });\n    }\n  },\n\n  /**\n   * Merchant Users\n   */\n  users: {\n    list: async (merchantId: number) => {\n      return authenticatedFetch(apiUrls.merchants.users.list(merchantId));\n    },\n\n    get: async (merchantId: number, userId: number) => {\n      return authenticatedFetch(apiUrls.merchants.users.get(merchantId, userId));\n    },\n\n    create: async (merchantId: number, data: any) => {\n      return authenticatedFetch(apiUrls.merchants.users.create(merchantId), {\n        method: 'POST',\n        body: JSON.stringify(data)\n      });\n    },\n\n    update: async (merchantId: number, userId: number, data: any) => {\n      return authenticatedFetch(apiUrls.merchants.users.update(merchantId, userId), {\n        method: 'PUT',\n        body: JSON.stringify(data)\n      });\n    },\n\n    delete: async (merchantId: number, userId: number) => {\n      return authenticatedFetch(apiUrls.merchants.users.delete(merchantId, userId), {\n        method: 'DELETE'\n      });\n    }\n  },\n\n  /**\n   * Merchant Outlets\n   */\n  outlets: {\n    list: async (merchantId: number, queryParams?: string) => {\n      const url = queryParams \n        ? `${apiUrls.merchants.outlets.list(merchantId)}?${queryParams}`\n        : apiUrls.merchants.outlets.list(merchantId);\n      return authenticatedFetch(url);\n    },\n\n    get: async (merchantId: number, outletId: number) => {\n      return authenticatedFetch(apiUrls.merchants.outlets.get(merchantId, outletId));\n    },\n\n    create: async (merchantId: number, data: any) => {\n      return authenticatedFetch(apiUrls.merchants.outlets.create(merchantId), {\n        method: 'POST',\n        body: JSON.stringify(data)\n      });\n    },\n\n    update: async (merchantId: number, outletId: number, data: any) => {\n      return authenticatedFetch(apiUrls.merchants.outlets.update(merchantId, outletId), {\n        method: 'PUT',\n        body: JSON.stringify(data)\n      });\n    },\n\n    delete: async (merchantId: number, outletId: number) => {\n      return authenticatedFetch(apiUrls.merchants.outlets.delete(merchantId, outletId), {\n        method: 'DELETE'\n      });\n    }\n  },\n\n  /**\n   * Get merchant pricing configuration\n   */\n  async getPricingConfig(merchantId: number): Promise<ApiResponse<{ merchantId: number; merchantName: string; businessType: string; pricingConfig: any }>> {\n    const response = await authenticatedFetch(apiUrls.merchants.pricing.get(merchantId));\n    const result = await parseApiResponse<{ merchantId: number; merchantName: string; businessType: string; pricingConfig: any }>(response);\n    return result;\n  },\n\n  /**\n   * Update merchant pricing configuration\n   */\n  async updatePricingConfig(merchantId: number, config: any): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.merchants.pricing.update(merchantId), {\n      method: 'PUT',\n      body: JSON.stringify(config),\n    });\n    const result = await parseApiResponse<any>(response);\n    return result;\n  }\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\n\nexport interface AnalyticsFilters {\n  startDate?: string;\n  endDate?: string;\n  outletId?: number;\n  merchantId?: number;\n  groupBy?: 'day' | 'week' | 'month' | 'year';\n}\n\nexport interface RevenueData {\n  date: string;\n  revenue: number;\n  orders: number;\n  averageOrderValue: number;\n}\n\nexport interface ProductAnalytics {\n  productId: number;\n  productName: string;\n  totalRentals: number;\n  totalRevenue: number;\n  averageRentalDuration: number;\n  popularity: number;\n}\n\nexport interface CustomerAnalytics {\n  customerId: number;\n  customerName: string;\n  totalOrders: number;\n  totalSpent: number;\n  averageOrderValue: number;\n  lastOrderDate: string;\n}\n\n/**\n * Analytics API client for business intelligence and reporting\n */\nexport const analyticsApi = {\n  /**\n   * Get revenue analytics\n   */\n  async getRevenueAnalytics(filters: AnalyticsFilters): Promise<ApiResponse<RevenueData[]>> {\n    const params = new URLSearchParams();\n    \n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    if (filters.groupBy) params.append('groupBy', filters.groupBy);\n    \n    const response = await authenticatedFetch(`${apiUrls.analytics.revenue}?${params.toString()}`);\n    return await parseApiResponse<RevenueData[]>(response);\n  },\n\n  /**\n   * Get order analytics\n   */\n  async getOrderAnalytics(filters: AnalyticsFilters): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    \n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    if (filters.groupBy) params.append('groupBy', filters.groupBy);\n    \n    const response = await authenticatedFetch(`${apiUrls.analytics.orders}?${params.toString()}`);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get product analytics\n   */\n  async getProductAnalytics(filters: AnalyticsFilters): Promise<ApiResponse<ProductAnalytics[]>> {\n    const params = new URLSearchParams();\n    \n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    \n    const response = await authenticatedFetch(`${apiUrls.analytics.topProducts}?${params.toString()}`);\n    return await parseApiResponse<ProductAnalytics[]>(response);\n  },\n\n  /**\n   * Get customer analytics\n   */\n  async getCustomerAnalytics(filters: AnalyticsFilters): Promise<ApiResponse<CustomerAnalytics[]>> {\n    const params = new URLSearchParams();\n    \n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    \n    const response = await authenticatedFetch(`${apiUrls.analytics.topCustomers}?${params.toString()}`);\n    return await parseApiResponse<CustomerAnalytics[]>(response);\n  },\n\n  /**\n   * Get inventory analytics\n   */\n  async getInventoryAnalytics(filters: AnalyticsFilters): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    \n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    \n    const response = await authenticatedFetch(`${apiUrls.analytics.inventory}?${params.toString()}`);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get dashboard summary\n   */\n  async getDashboardSummary(): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.analytics.dashboard);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get system analytics (admin only)\n   */\n  async getSystemAnalytics(filters?: AnalyticsFilters): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    if (filters?.startDate) params.append('startDate', filters.startDate);\n    if (filters?.endDate) params.append('endDate', filters.endDate);\n    if (filters?.groupBy) params.append('groupBy', filters.groupBy);\n    params.append('t', Date.now().toString()); // Add timestamp to bypass cache\n    \n    const url = `${apiUrls.analytics.system}?${params.toString()}`;\n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get recent system activities (admin only)\n   */\n  async getRecentActivities(limit?: number, offset?: number): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    if (limit) params.append('limit', limit.toString());\n    if (offset) params.append('offset', offset.toString());\n    params.append('t', Date.now().toString()); // Add timestamp to bypass cache\n    \n    const url = `${apiUrls.analytics.recentActivities}?${params.toString()}`;\n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get income analytics\n   */\n  async getIncomeAnalytics(filters: AnalyticsFilters = {}): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    \n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    if (filters.groupBy) params.append('groupBy', filters.groupBy);\n    \n    const queryString = params.toString();\n    const url = queryString ? `${apiUrls.analytics.income}?${queryString}` : apiUrls.analytics.income;\n    \n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get order analytics summary\n   */\n  async getOrderAnalyticsSummary(): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.analytics.orders);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get top products\n   */\n  async getTopProducts(filters?: AnalyticsFilters): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    if (filters?.startDate) params.append('startDate', filters.startDate);\n    if (filters?.endDate) params.append('endDate', filters.endDate);\n    \n    const url = `${apiUrls.analytics.topProducts}${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get top customers\n   */\n  async getTopCustomers(filters?: AnalyticsFilters): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    if (filters?.startDate) params.append('startDate', filters.startDate);\n    if (filters?.endDate) params.append('endDate', filters.endDate);\n    \n    const url = `${apiUrls.analytics.topCustomers}${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get recent orders\n   */\n  async getRecentOrders(filters?: AnalyticsFilters): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    if (filters?.startDate) params.append('startDate', filters.startDate);\n    if (filters?.endDate) params.append('endDate', filters.endDate);\n    \n    const url = `${apiUrls.analytics.recentOrders}${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get outlet performance comparison\n   */\n  async getOutletPerformance(filters: AnalyticsFilters): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    \n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    \n    const response = await authenticatedFetch(`${apiUrls.analytics.outletPerformance}?${params.toString()}`);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get seasonal trends\n   */\n  async getSeasonalTrends(filters: AnalyticsFilters): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    \n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    \n    const response = await authenticatedFetch(`${apiUrls.analytics.seasonalTrends}?${params.toString()}`);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Export analytics data\n   */\n  async exportAnalytics(filters: AnalyticsFilters, format: 'csv' | 'excel' = 'csv'): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams();\n    \n    if (filters.startDate) params.append('startDate', filters.startDate);\n    if (filters.endDate) params.append('endDate', filters.endDate);\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    if (filters.groupBy) params.append('groupBy', filters.groupBy);\n    params.append('format', format);\n    \n    const response = await authenticatedFetch(`${apiUrls.analytics.export}?${params.toString()}`);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get today's operational metrics\n   */\n  async getTodayMetrics(): Promise<ApiResponse<{\n    todayPickups: number;\n    todayReturns: number;\n    overdueItems: number;\n    productUtilization: number;\n  }>> {\n    // Add timestamp to bypass cache\n    const url = `${apiUrls.analytics.todayMetrics}?t=${Date.now()}`;\n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get growth metrics\n   */\n  async getGrowthMetrics(filters?: AnalyticsFilters): Promise<ApiResponse<{\n    customerGrowth: number;\n    revenueGrowth: number;\n    customerBase: number;\n  }>> {\n    const params = new URLSearchParams();\n    if (filters?.startDate) params.append('startDate', filters.startDate);\n    if (filters?.endDate) params.append('endDate', filters.endDate);\n    params.append('t', Date.now().toString()); // Add timestamp to bypass cache\n    \n    const url = `${apiUrls.analytics.growthMetrics}?${params.toString()}`;\n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get enhanced dashboard summary with all metrics\n   */\n  async getEnhancedDashboardSummary(filters?: AnalyticsFilters): Promise<ApiResponse<{\n    totalRevenue: number;\n    todayRevenue: number;\n    totalOrders: number;\n    futureIncome: number;\n    todayPickups: number;\n    todayReturns: number;\n    overdueItems: number;\n    productUtilization: number;\n    customerGrowth: number;\n    revenueGrowth: number;\n    customerBase: number;\n  }>> {\n    const params = new URLSearchParams();\n    if (filters?.startDate) params.append('startDate', filters.startDate);\n    if (filters?.endDate) params.append('endDate', filters.endDate);\n    params.append('t', Date.now().toString()); // Add timestamp to bypass cache\n    \n    const url = `${apiUrls.analytics.enhancedDashboard}?${params.toString()}`;\n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<any>(response);\n  }\n};\n","import { authenticatedFetch, parseApiResponse, ApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { Category } from '@rentalshop/types';\n\nexport interface CategoriesResponse {\n  categories: Category[];\n  total: number;\n}\n\n/**\n * Categories API client for category management operations\n */\nexport const categoriesApi = {\n  /**\n   * Get all categories\n   */\n  async getCategories(): Promise<ApiResponse<Category[]>> {\n    const response = await authenticatedFetch(apiUrls.categories.list);\n    const result = await parseApiResponse<Category[]>(response);\n    return result;\n  },\n\n  /**\n   * Get categories with pagination\n   */\n  async getCategoriesPaginated(page: number = 1, limit: number = 50): Promise<ApiResponse<CategoriesResponse>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString()\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.categories.list}?${params.toString()}`);\n    return await parseApiResponse<CategoriesResponse>(response);\n  },\n\n  /**\n   * Create a new category\n   */\n  async createCategory(categoryData: Partial<Category>): Promise<ApiResponse<Category>> {\n    const response = await authenticatedFetch(apiUrls.categories.create, {\n      method: 'POST',\n      body: JSON.stringify(categoryData),\n    });\n    return await parseApiResponse<Category>(response);\n  },\n\n  /**\n   * Update an existing category\n   */\n  async updateCategory(categoryId: number, categoryData: Partial<Category>): Promise<ApiResponse<Category>> {\n    const response = await authenticatedFetch(apiUrls.categories.update(categoryId), {\n      method: 'PUT',\n      body: JSON.stringify(categoryData),\n    });\n    return await parseApiResponse<Category>(response);\n  },\n\n  /**\n   * Delete a category\n   */\n  async deleteCategory(categoryId: number): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.categories.delete(categoryId), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<any>(response);\n  }\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\n\nexport interface Notification {\n  id: number;\n  type: 'info' | 'success' | 'warning' | 'error';\n  title: string;\n  message: string;\n  isRead: boolean;\n  createdAt: string;\n  data?: any;\n}\n\nexport interface NotificationFilters {\n  type?: string;\n  isRead?: boolean;\n  page?: number;\n  limit?: number;\n}\n\nexport interface NotificationsResponse {\n  notifications: Notification[];\n  total: number;\n  page: number;\n  limit: number;\n  totalPages: number;\n  unreadCount: number;\n}\n\n/**\n * Notifications API client for notification management\n */\nexport const notificationsApi = {\n  /**\n   * Get all notifications\n   */\n  async getNotifications(): Promise<ApiResponse<Notification[]>> {\n    const response = await authenticatedFetch(apiUrls.notifications.list);\n    const result = await parseApiResponse<Notification[]>(response);\n    return result;\n  },\n\n  /**\n   * Get notifications with pagination\n   */\n  async getNotificationsPaginated(page: number = 1, limit: number = 50): Promise<ApiResponse<NotificationsResponse>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString()\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.notifications.list}?${params.toString()}`);\n    return await parseApiResponse<NotificationsResponse>(response);\n  },\n\n  /**\n   * Search notifications with filters\n   */\n  async searchNotifications(filters: NotificationFilters): Promise<ApiResponse<Notification[]>> {\n    const params = new URLSearchParams();\n    \n    if (filters.type) params.append('type', filters.type);\n    if (filters.isRead !== undefined) params.append('isRead', filters.isRead.toString());\n    if (filters.page) params.append('page', filters.page.toString());\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    \n    const response = await authenticatedFetch(`${apiUrls.notifications.list}?${params.toString()}`);\n    return await parseApiResponse<Notification[]>(response);\n  },\n\n  /**\n   * Get notification by ID\n   */\n  async getNotification(notificationId: number): Promise<ApiResponse<Notification>> {\n    const response = await authenticatedFetch(apiUrls.notifications.get(notificationId));\n    return await parseApiResponse<Notification>(response);\n  },\n\n  /**\n   * Mark notification as read\n   */\n  async markAsRead(notificationId: number): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.notifications.markRead(notificationId), {\n      method: 'PATCH',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Mark notification as unread\n   */\n  async markAsUnread(notificationId: number): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.notifications.markUnread(notificationId), {\n      method: 'PATCH',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Mark all notifications as read\n   */\n  async markAllAsRead(): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.notifications.markAllRead, {\n      method: 'PATCH',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Delete notification\n   */\n  async deleteNotification(notificationId: number): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.notifications.delete(notificationId), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Delete all read notifications\n   */\n  async deleteAllRead(): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.notifications.deleteAllRead, {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Get unread count\n   */\n  async getUnreadCount(): Promise<ApiResponse<{ count: number }>> {\n    const response = await authenticatedFetch(apiUrls.notifications.unreadCount);\n    return await parseApiResponse<{ count: number }>(response);\n  },\n\n  /**\n   * Get notification preferences\n   */\n  async getPreferences(): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.notifications.preferences);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Update notification preferences\n   */\n  async updatePreferences(preferences: any): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.notifications.preferences, {\n      method: 'PUT',\n      body: JSON.stringify(preferences),\n    });\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Send test notification\n   */\n  async sendTestNotification(): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.notifications.test, {\n      method: 'POST',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  }\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\nimport type { User, ProfileUpdateInput } from '@rentalshop/types';\n\n/**\n * Profile API client for user profile management\n */\nexport const profileApi = {\n  /**\n   * Get current user profile\n   */\n  async getProfile(): Promise<ApiResponse<User>> {\n    const response = await authenticatedFetch(apiUrls.settings.user);\n    return await parseApiResponse<User>(response);\n  },\n\n  /**\n   * Update current user profile\n   */\n  async updateProfile(profileData: ProfileUpdateInput): Promise<ApiResponse<User>> {\n    const response = await authenticatedFetch(apiUrls.settings.user, {\n      method: 'PUT',\n      body: JSON.stringify(profileData),\n    });\n    return await parseApiResponse<User>(response);\n  },\n\n  /**\n   * Change current user password\n   */\n  async changePassword(passwordData: {\n    currentPassword: string;\n    newPassword: string;\n    confirmPassword: string;\n  }): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.settings.changePassword, {\n      method: 'PATCH',\n      body: JSON.stringify(passwordData),\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Upload profile picture\n   */\n  async uploadProfilePicture(file: File): Promise<ApiResponse<{ imageUrl: string }>> {\n    const formData = new FormData();\n    formData.append('profilePicture', file);\n\n    const response = await authenticatedFetch(apiUrls.settings.uploadPicture, {\n      method: 'POST',\n      body: formData,\n      // Don't set Content-Type header for FormData\n    });\n    return await parseApiResponse<{ imageUrl: string }>(response);\n  },\n\n  /**\n   * Delete profile picture\n   */\n  async deleteProfilePicture(): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.settings.deletePicture, {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Get user preferences\n   */\n  async getPreferences(): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.settings.preferences);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Update user preferences\n   */\n  async updatePreferences(preferences: any): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.settings.preferences, {\n      method: 'PUT',\n      body: JSON.stringify(preferences),\n    });\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get user activity log\n   */\n  async getActivityLog(page: number = 1, limit: number = 20): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString()\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.settings.activityLog}?${params.toString()}`);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get user notifications\n   */\n  async getNotifications(page: number = 1, limit: number = 20): Promise<ApiResponse<any>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString()\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.settings.profileNotifications}?${params.toString()}`);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Mark notification as read\n   */\n  async markNotificationAsRead(notificationId: number): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.settings.markNotificationRead(notificationId), {\n      method: 'PATCH',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Mark all notifications as read\n   */\n  async markAllNotificationsAsRead(): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(apiUrls.settings.markAllNotificationsRead, {\n      method: 'PATCH',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  }\n};\n","import { User, UserCreateInput } from '@rentalshop/types';\nimport { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\n\n// ============================================================================\n// USER API TYPES\n// ============================================================================\n\nexport interface UserApiResponse {\n  success: boolean;\n  data?: any;\n  message?: string;\n  error?: string;\n}\n\n// ============================================================================\n// USER API (MERGED FUNCTIONALITY)\n// ============================================================================\n\nexport const usersApi = {\n  // ============================================================================\n  // USER CRUD OPERATIONS\n  // ============================================================================\n\n  /**\n   * Get all users\n   */\n  async getUsers(filters: any = {}, options: any = {}): Promise<UserApiResponse> {\n    const params = new URLSearchParams();\n    \n    // Add filters\n    if (filters.search) params.append('search', filters.search);\n    if (filters.role) params.append('role', filters.role);\n    if (filters.isActive !== undefined) params.append('isActive', filters.isActive.toString());\n    if (filters.status) params.append('status', filters.status);\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    \n    // Add options\n    if (options.page) params.append('page', options.page.toString());\n    if (options.limit) params.append('limit', options.limit.toString());\n    if (options.sortBy) params.append('sortBy', options.sortBy);\n    if (options.sortOrder) params.append('sortOrder', options.sortOrder);\n\n    const queryString = params.toString();\n    const url = queryString ? `${apiUrls.users.list}?${queryString}` : apiUrls.users.list;\n    \n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Get users with pagination\n   */\n  async getUsersPaginated(page: number = 1, limit: number = 50): Promise<UserApiResponse> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString()\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.users.list}?${params.toString()}`);\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Search users with filters\n   */\n  async searchUsers(filters: any = {}): Promise<UserApiResponse> {\n    const params = new URLSearchParams();\n    \n    if (filters.search) params.append('search', filters.search);\n    if (filters.role) params.append('role', filters.role);\n    if (filters.status) params.append('status', filters.status);\n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    if (filters.outletId) params.append('outletId', filters.outletId.toString());\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    if (filters.offset) params.append('offset', filters.offset.toString());\n    \n    const queryString = params.toString();\n    const url = queryString ? `${apiUrls.users.list}?${queryString}` : apiUrls.users.list;\n    \n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Get user by ID\n   */\n  async getUserById(userId: number): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(apiUrls.users.update(userId));\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Create new user\n   */\n  async createUser(userData: UserCreateInput): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(apiUrls.users.create, {\n      method: 'POST',\n      body: JSON.stringify(userData),\n    });\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Update user\n   */\n  async updateUser(userId: number, userData: Partial<User>): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(apiUrls.users.update(userId), {\n      method: 'PUT',\n      body: JSON.stringify(userData),\n    });\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Delete user\n   */\n  async deleteUser(userId: number): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(apiUrls.users.delete(userId), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  // ============================================================================\n  // USER MANAGEMENT OPERATIONS\n  // ============================================================================\n\n  /**\n   * Update user by public ID\n   */\n  async updateUserByPublicId(userId: number, userData: Partial<User>): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(apiUrls.users.updateByPublicId(userId), {\n      method: 'PUT',\n      body: JSON.stringify(userData),\n    });\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Activate user by public ID\n   */\n  async activateUserByPublicId(userId: number): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(apiUrls.users.activateByPublicId(userId), {\n      method: 'PUT',\n    });\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Deactivate user by public ID\n   */\n  async deactivateUserByPublicId(userId: number): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(apiUrls.users.deactivateByPublicId(userId), {\n      method: 'PUT',\n    });\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Activate user\n   */\n  async activateUser(userId: number): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(`${apiUrls.users.update(userId)}/activate`, {\n      method: 'PATCH',\n      body: JSON.stringify({ isActive: true }),\n    });\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Deactivate user\n   */\n  async deactivateUser(userId: number): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(`${apiUrls.users.update(userId)}/deactivate`, {\n      method: 'PATCH',\n      body: JSON.stringify({ isActive: false }),\n    });\n    return await parseApiResponse<UserApiResponse>(response);\n  },\n\n  /**\n   * Change user password\n   */\n  async changePassword(userId: number, newPassword: string): Promise<UserApiResponse> {\n    const response = await authenticatedFetch(`${apiUrls.users.update(userId)}/change-password`, {\n      method: 'PATCH',\n      body: JSON.stringify({ newPassword }),\n    });\n    return await parseApiResponse<UserApiResponse>(response);\n  }\n};\n","// ============================================================================\n// PLANS API CLIENT\n// ============================================================================\n\nimport { authenticatedFetch, parseApiResponse, type ApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { Plan, PlanCreateInput, PlanUpdateInput, PlanFilters } from '@rentalshop/types';\n\n/**\n * Public fetch function for unauthenticated requests\n */\nconst publicFetch = async (url: string, options: RequestInit = {}): Promise<Response> => {\n  const headers: Record<string, string> = {\n    'Content-Type': 'application/json',\n    'Accept': 'application/json',\n    ...(options.headers as Record<string, string>),\n  };\n\n  const defaultOptions: RequestInit = {\n    method: 'GET',\n    headers,\n    ...options,\n  };\n\n  return await fetch(url, defaultOptions);\n};\n\nexport interface PlansResponse {\n  plans: Plan[];\n  total: number;\n  hasMore: boolean;\n}\n\nexport interface PlanStats {\n  totalPlans: number;\n  activePlans: number;\n  totalSubscriptions: number;\n  activeSubscriptions: number;\n  totalRevenue: number;\n}\n\n/**\n * Plans API client for plan management operations\n */\nexport const plansApi = {\n  /**\n   * Get all plans with filters and pagination\n   */\n  async getPlans(filters: PlanFilters & { includeInactive?: boolean } = {}): Promise<ApiResponse<PlansResponse>> {\n    const params = new URLSearchParams();\n    \n    if (filters.search) params.append('search', filters.search);\n    if (filters.isActive !== undefined) params.append('isActive', filters.isActive.toString());\n    if (filters.isPopular !== undefined) params.append('isPopular', filters.isPopular.toString());\n    if (filters.includeInactive) params.append('includeInactive', 'true');\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    if (filters.offset) params.append('offset', filters.offset.toString());\n    if (filters.sortBy) params.append('sortBy', filters.sortBy);\n    if (filters.sortOrder) params.append('sortOrder', filters.sortOrder);\n    \n    const queryString = params.toString();\n    const url = queryString ? `${apiUrls.plans.list}?${queryString}` : apiUrls.plans.list;\n    \n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<PlansResponse>(response);\n  },\n\n  /**\n   * Get a specific plan by ID\n   */\n  async getPlanById(planId: number): Promise<ApiResponse<Plan>> {\n    const response = await authenticatedFetch(apiUrls.plans.get(planId));\n    return await parseApiResponse<Plan>(response);\n  },\n\n  /**\n   * Create a new plan\n   */\n  async createPlan(planData: PlanCreateInput): Promise<ApiResponse<Plan>> {\n    const response = await authenticatedFetch(apiUrls.plans.create, {\n      method: 'POST',\n      body: JSON.stringify(planData),\n    });\n    return await parseApiResponse<Plan>(response);\n  },\n\n  /**\n   * Update an existing plan\n   */\n  async updatePlan(planId: number, planData: PlanUpdateInput): Promise<ApiResponse<Plan>> {\n    const response = await authenticatedFetch(apiUrls.plans.update(planId), {\n      method: 'PUT',\n      body: JSON.stringify(planData),\n    });\n    return await parseApiResponse<Plan>(response);\n  },\n\n  /**\n   * Delete a plan (soft delete)\n   */\n  async deletePlan(planId: number): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.plans.delete(planId), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get plan statistics\n   */\n  async getPlanStats(): Promise<ApiResponse<PlanStats>> {\n    const response = await authenticatedFetch(apiUrls.plans.stats);\n    return await parseApiResponse<PlanStats>(response);\n  },\n\n  /**\n   * Get public plans (for display to users)\n   */\n  async getPublicPlans(): Promise<ApiResponse<Plan[]>> {\n    const response = await authenticatedFetch(apiUrls.plans.public);\n    return await parseApiResponse<Plan[]>(response);\n  }\n};\n\n/**\n * Public plans API client (no authentication required)\n */\nexport const publicPlansApi = {\n  /**\n   * Get public plans with variants (no authentication required)\n   */\n  async getPublicPlansWithVariants(): Promise<ApiResponse<Plan[]>> {\n    const response = await publicFetch(apiUrls.plans.public);\n    return await parseApiResponse<Plan[]>(response);\n  }\n};\n","// ============================================================================\n// BILLING CYCLES API CLIENT\n// ============================================================================\n\nimport { authenticatedFetch, parseApiResponse, type ApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\n\n// ============================================================================\n// BILLING CYCLE TYPES\n// ============================================================================\n\nexport interface BillingCycle {\n  id: number;\n  name: string;\n  value: string;\n  months: number;\n  discount: number;\n  description?: string;\n  isActive: boolean;\n  sortOrder: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface BillingCycleCreateInput {\n  name: string;\n  value: string;\n  months: number;\n  discount?: number;\n  description?: string;\n  isActive?: boolean;\n  sortOrder?: number;\n}\n\nexport interface BillingCycleUpdateInput {\n  name?: string;\n  value?: string;\n  months?: number;\n  discount?: number;\n  description?: string;\n  isActive?: boolean;\n  sortOrder?: number;\n}\n\nexport interface BillingCycleFilters {\n  search?: string;\n  isActive?: boolean;\n  limit?: number;\n  offset?: number;\n  sortBy?: 'name' | 'value' | 'months' | 'discount' | 'sortOrder' | 'createdAt';\n  sortOrder?: 'asc' | 'desc';\n}\n\nexport interface BillingCyclesResponse {\n  billingCycles: BillingCycle[];\n  total: number;\n  hasMore: boolean;\n}\n\n/**\n * Billing Cycles API client for billing cycle management operations\n */\nexport const billingCyclesApi = {\n  /**\n   * Get all billing cycles with filtering and pagination\n   */\n  async getBillingCycles(filters: BillingCycleFilters = {}): Promise<ApiResponse<BillingCyclesResponse>> {\n    const params = new URLSearchParams();\n    \n    if (filters.search) params.append('search', filters.search);\n    if (filters.isActive !== undefined) params.append('isActive', filters.isActive.toString());\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    if (filters.offset) params.append('offset', filters.offset.toString());\n    if (filters.sortBy) params.append('sortBy', filters.sortBy);\n    if (filters.sortOrder) params.append('sortOrder', filters.sortOrder);\n    \n    const queryString = params.toString();\n    const url = queryString ? `${apiUrls.billingCycles.list}?${queryString}` : apiUrls.billingCycles.list;\n    \n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<BillingCyclesResponse>(response);\n  },\n\n  /**\n   * Get a specific billing cycle by ID\n   */\n  async getBillingCycle(id: number): Promise<ApiResponse<BillingCycle>> {\n    const response = await authenticatedFetch(apiUrls.billingCycles.get(id));\n    return await parseApiResponse<BillingCycle>(response);\n  },\n\n  /**\n   * Create a new billing cycle\n   */\n  async createBillingCycle(input: BillingCycleCreateInput): Promise<ApiResponse<BillingCycle>> {\n    const response = await authenticatedFetch(apiUrls.billingCycles.create, {\n      method: 'POST',\n      body: JSON.stringify(input),\n    });\n    return await parseApiResponse<BillingCycle>(response);\n  },\n\n  /**\n   * Update an existing billing cycle\n   */\n  async updateBillingCycle(id: number, input: BillingCycleUpdateInput): Promise<ApiResponse<BillingCycle>> {\n    const response = await authenticatedFetch(apiUrls.billingCycles.update(id), {\n      method: 'PUT',\n      body: JSON.stringify(input),\n    });\n    return await parseApiResponse<BillingCycle>(response);\n  },\n\n  /**\n   * Delete a billing cycle\n   */\n  async deleteBillingCycle(id: number): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.billingCycles.delete(id), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Get active billing cycles (for dropdowns and forms)\n   */\n  async getActiveBillingCycles(): Promise<ApiResponse<BillingCyclesResponse>> {\n    const response = await this.getBillingCycles({ \n      isActive: true, \n      sortBy: 'sortOrder', \n      sortOrder: 'asc' \n    });\n    \n    return response; // Return the ApiResponse directly - let consumers use type guards\n  },\n\n  /**\n   * Get billing cycle by value (for internal use)\n   */\n  async getBillingCycleByValue(value: string): Promise<ApiResponse<BillingCycle>> {\n    const response = await this.getBillingCycles({ \n      search: value,\n      isActive: true \n    });\n    \n    if (!response.success || !response.data) {\n      throw new Error('Failed to fetch billing cycles');\n    }\n    \n    const cycle = response.data.billingCycles.find((c: any) => c.value === value);\n    \n    if (!cycle) {\n      throw new Error(`Billing cycle with value '${value}' not found`);\n    }\n\n    return {\n      success: true,\n      data: cycle,\n      message: 'Billing cycle found'\n    };\n  }\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\nimport type { Payment, PaymentInput, PaymentUpdateInput } from '@rentalshop/types';\n\n// Local type definitions for API responses\nexport interface PaymentFilters {\n  search?: string;\n  status?: string;\n  method?: string;\n  limit?: number;\n  offset?: number;\n  sortBy?: string;\n  sortOrder?: 'asc' | 'desc';\n}\n\nexport interface PaymentsResponse {\n  payments: Payment[];\n  total: number;\n  hasMore: boolean;\n}\n\n/**\n * Payments API client for subscription payment management operations\n */\nexport const paymentsApi = {\n  /**\n   * Get all payments with filtering and pagination\n   */\n  async getPayments(filters: PaymentFilters = {}): Promise<ApiResponse<PaymentsResponse>> {\n    const params = new URLSearchParams();\n    \n    if (filters.search) params.append('search', filters.search);\n    if (filters.status) params.append('status', filters.status);\n    if (filters.method) params.append('method', filters.method);\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    if (filters.offset) params.append('offset', filters.offset.toString());\n    if (filters.sortBy) params.append('sortBy', filters.sortBy);\n    if (filters.sortOrder) params.append('sortOrder', filters.sortOrder);\n    \n    const queryString = params.toString();\n    const url = queryString ? `${apiUrls.payments.list}?${queryString}` : apiUrls.payments.list;\n    \n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<PaymentsResponse>(response);\n  },\n\n  /**\n   * Get a specific payment by ID\n   */\n  async getPayment(id: number): Promise<ApiResponse<Payment>> {\n    const response = await authenticatedFetch(apiUrls.payments.get(id));\n    return await parseApiResponse<Payment>(response);\n  },\n\n  /**\n   * Create a new payment\n   */\n  async createPayment(input: PaymentInput): Promise<ApiResponse<Payment>> {\n    const response = await authenticatedFetch(apiUrls.payments.create, {\n      method: 'POST',\n      body: JSON.stringify(input),\n    });\n    return await parseApiResponse<Payment>(response);\n  },\n\n  /**\n   * Update an existing payment\n   */\n  async updatePayment(id: number, input: PaymentUpdateInput): Promise<ApiResponse<Payment>> {\n    const response = await authenticatedFetch(apiUrls.payments.update(id), {\n      method: 'PUT',\n      body: JSON.stringify(input),\n    });\n    return await parseApiResponse<Payment>(response);\n  },\n\n  /**\n   * Create a manual payment\n   */\n  async createManualPayment(input: ManualPaymentCreateInput): Promise<ApiResponse<ManualPayment>> {\n    const response = await authenticatedFetch(apiUrls.payments.manual, {\n      method: 'POST',\n      body: JSON.stringify(input),\n    });\n    return await parseApiResponse<ManualPayment>(response);\n  },\n\n  /**\n   * Delete a payment\n   */\n  async deletePayment(id: number): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.payments.delete(id), {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Process payment\n   */\n  async processPayment(id: number): Promise<ApiResponse<Payment>> {\n    const response = await authenticatedFetch(apiUrls.payments.process(id), {\n      method: 'POST',\n    });\n    return await parseApiResponse<Payment>(response);\n  },\n\n  /**\n   * Refund payment\n   */\n  async refundPayment(id: number, reason?: string): Promise<ApiResponse<Payment>> {\n    const response = await authenticatedFetch(apiUrls.payments.refund(id), {\n      method: 'POST',\n      body: JSON.stringify({ reason }),\n    });\n    return await parseApiResponse<Payment>(response);\n  },\n\n  /**\n   * Get payment statistics\n   */\n  async getPaymentStats(): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.payments.stats);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Export payments\n   */\n  async exportPayments(filters: PaymentFilters = {}): Promise<ApiResponse<{ downloadUrl: string }>> {\n    const params = new URLSearchParams();\n    \n    if (filters.search) params.append('search', filters.search);\n    if (filters.status) params.append('status', filters.status);\n    if (filters.method) params.append('method', filters.method);\n    \n    const queryString = params.toString();\n    const url = queryString ? `${apiUrls.payments.export}?${queryString}` : apiUrls.payments.export;\n    \n    const response = await authenticatedFetch(url);\n    return await parseApiResponse<{ downloadUrl: string }>(response);\n  },\n\n};\n\n// Manual payment types\nexport interface ManualPaymentCreateInput {\n  merchantId: number;\n  planId: number;\n  amount: number;\n  currency: string;\n  method: string;\n  description?: string;\n  extendSubscription?: boolean;\n  monthsToExtend?: number;\n  invoiceNumber?: string;\n  transactionId?: string;\n  startDate?: string;\n  endDate?: string;\n}\n\nexport interface ManualPayment {\n  id: number;\n  amount: number;\n  method: string;\n  type: string;\n  status: string;\n  reference: string;\n  notes?: string;\n  createdAt: string;\n  metadata?: {\n    planId: string;\n    startDate?: string;\n    endDate?: string;\n    extendSubscription?: boolean;\n    monthsToExtend?: number;\n    transactionId?: string;\n    currency: string;\n  };\n}\n","/**\n * Audit Logs API Client\n * \n * This module provides API client functions for audit logs operations.\n * All API requests should be made through these functions, not directly in UI components.\n */\n\nimport { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\n\n// Types\nexport interface AuditLog {\n  id: number;\n  action: string;\n  entityType: string;\n  entityId: string;\n  entityName?: string;\n  user?: {\n    id: number;\n    email: string;\n    name: string;\n    role: string;\n  };\n  merchant?: {\n    id: number;\n    name: string;\n  };\n  outlet?: {\n    id: number;\n    name: string;\n  };\n  oldValues?: Record<string, any>;\n  newValues?: Record<string, any>;\n  changes?: Record<string, { old: any; new: any }>;\n  ipAddress?: string;\n  userAgent?: string;\n  sessionId?: string;\n  requestId?: string;\n  metadata?: Record<string, any>;\n  severity: 'INFO' | 'WARNING' | 'ERROR' | 'CRITICAL';\n  category: 'GENERAL' | 'SECURITY' | 'BUSINESS' | 'SYSTEM' | 'COMPLIANCE';\n  description?: string;\n  createdAt: string;\n}\n\nexport interface AuditLogFilter {\n  action?: string;\n  entityType?: string;\n  entityId?: string;\n  userId?: string;\n  merchantId?: string;\n  outletId?: string;\n  severity?: string;\n  category?: string;\n  startDate?: string;\n  endDate?: string;\n  limit?: number;\n  offset?: number;\n}\n\nexport interface AuditLogResponse {\n  success: boolean;\n  data: AuditLog[];\n  pagination: {\n    total: number;\n    limit: number;\n    offset: number;\n    hasMore: boolean;\n  };\n}\n\nexport interface AuditLogStats {\n  totalLogs: number;\n  logsByAction: Record<string, number>;\n  logsByEntity: Record<string, number>;\n  logsBySeverity: Record<string, number>;\n  logsByCategory: Record<string, number>;\n  recentActivity: number;\n}\n\nexport interface AuditLogStatsResponse {\n  success: boolean;\n  data: AuditLogStats;\n}\n\n\n/**\n * Get audit logs with filtering and pagination\n */\nexport async function getAuditLogs(filter: AuditLogFilter = {}): Promise<ApiResponse<AuditLog[]>> {\n  const params = new URLSearchParams();\n  \n  Object.entries(filter).forEach(([key, value]) => {\n    if (value !== undefined && value !== '') {\n      params.append(key, value.toString());\n    }\n  });\n\n  const queryString = params.toString();\n  const url = queryString ? `${apiUrls.auditLogs.list}?${queryString}` : apiUrls.auditLogs.list;\n  \n  const response = await authenticatedFetch(url);\n  return await parseApiResponse<AuditLog[]>(response);\n}\n\n/**\n * Get audit log statistics\n */\nexport async function getAuditLogStats(filter: Partial<AuditLogFilter> = {}): Promise<ApiResponse<AuditLogStats>> {\n  const params = new URLSearchParams();\n  \n  Object.entries(filter).forEach(([key, value]) => {\n    if (value !== undefined && value !== '') {\n      params.append(key, value.toString());\n    }\n  });\n\n  const queryString = params.toString();\n  const url = queryString ? `${apiUrls.auditLogs.stats}?${queryString}` : apiUrls.auditLogs.stats;\n  \n  const response = await authenticatedFetch(url);\n  return await parseApiResponse<AuditLogStats>(response);\n}\n\n/**\n * Export audit logs (if endpoint exists)\n */\nexport async function exportAuditLogs(filter: AuditLogFilter = {}): Promise<Blob> {\n  const params = new URLSearchParams();\n  \n  Object.entries(filter).forEach(([key, value]) => {\n    if (value !== undefined && value !== '') {\n      params.append(key, value.toString());\n    }\n  });\n\n  const queryString = params.toString();\n  const url = queryString ? `${apiUrls.auditLogs.export}?${queryString}` : apiUrls.auditLogs.export;\n  \n  const response = await authenticatedFetch(url, {\n    headers: {\n      'Accept': 'application/octet-stream',\n    },\n  });\n\n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(`Export failed: ${errorText}`);\n  }\n\n  return response.blob();\n}\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface MerchantSettings {\n  name: string;\n  phone?: string;\n  address?: string;\n  city?: string;\n  state?: string;\n  zipCode?: string;\n  country?: string;\n  businessType?: string;\n  taxId?: string;\n  website?: string;\n  description?: string;\n}\n\nexport interface UserProfile {\n  firstName: string;\n  lastName: string;\n  phone?: string;\n}\n\nexport interface OutletSettings {\n  name: string;\n  phone?: string;\n  address?: string;\n  description?: string;\n}\n\nexport interface BillingInterval {\n  id: string;\n  name: string;\n  duration: number;\n  unit: 'days' | 'weeks' | 'months' | 'years';\n  isActive: boolean;\n}\n\nexport interface BillingSettings {\n  intervals: BillingInterval[];\n  defaultInterval?: string;\n  autoRenewal: boolean;\n  gracePeriod: number; // in days\n}\n\n// ============================================================================\n// SETTINGS API CLIENT\n// ============================================================================\n\n/**\n * Settings API client for user and merchant settings\n */\nexport const settingsApi = {\n  /**\n   * Update merchant settings\n   */\n  async updateMerchantSettings(data: MerchantSettings): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.settings.merchant, {\n      method: 'PUT',\n      body: JSON.stringify(data),\n    });\n    \n    const result = await parseApiResponse<any>(response);\n    return result;\n  },\n\n  /**\n   * Update merchant information (alias for updateMerchantSettings)\n   */\n  async updateMerchantInfo(data: MerchantSettings): Promise<ApiResponse<any>> {\n    return this.updateMerchantSettings(data);\n  },\n\n  /**\n   * Get user profile\n   */\n  async getUserProfile(): Promise<ApiResponse<UserProfile>> {\n    const response = await authenticatedFetch(apiUrls.settings.user);\n    const result = await parseApiResponse<UserProfile>(response);\n    return result;\n  },\n\n  /**\n   * Update user profile\n   */\n  async updateUserProfile(data: UserProfile): Promise<ApiResponse<UserProfile>> {\n    const response = await authenticatedFetch(apiUrls.settings.user, {\n      method: 'PUT',\n      body: JSON.stringify(data),\n    });\n    const result = await parseApiResponse<UserProfile>(response);\n    return result;\n  },\n\n  /**\n   * Update outlet information\n   */\n  async updateOutletInfo(data: OutletSettings): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.settings.outlet, {\n      method: 'PUT',\n      body: JSON.stringify(data),\n    });\n    const result = await parseApiResponse<any>(response);\n    return result;\n  },\n\n  /**\n   * Get billing settings\n   */\n  async getBillingSettings(): Promise<ApiResponse<BillingSettings>> {\n    const response = await authenticatedFetch(apiUrls.settings.billing);\n    return await parseApiResponse<BillingSettings>(response);\n  },\n\n  /**\n   * Update billing settings\n   */\n  async updateBillingSettings(data: BillingSettings): Promise<ApiResponse<BillingSettings>> {\n    const response = await authenticatedFetch(apiUrls.settings.billing, {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n    return await parseApiResponse<BillingSettings>(response);\n  },\n\n  /**\n   * Get billing intervals\n   */\n  async getBillingIntervals(): Promise<ApiResponse<BillingInterval[]>> {\n    const response = await authenticatedFetch(`${apiUrls.settings.billing}/intervals`);\n    return await parseApiResponse<BillingInterval[]>(response);\n  },\n\n  /**\n   * Update billing intervals\n   */\n  async updateBillingIntervals(intervals: BillingInterval[]): Promise<ApiResponse<BillingInterval[]>> {\n    const response = await authenticatedFetch(`${apiUrls.settings.billing}/intervals`, {\n      method: 'POST',\n      body: JSON.stringify({ intervals }),\n    });\n    return await parseApiResponse<BillingInterval[]>(response);\n  }\n};","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\nimport type { \n  Subscription, \n  SubscriptionFilters, \n  SubscriptionsResponse, \n  SubscriptionCreateInput, \n  SubscriptionUpdateInput \n} from '@rentalshop/types';\n\n/**\n * Subscriptions API client for subscription management operations\n */\nexport const subscriptionsApi = {\n  /**\n   * Get all subscriptions\n   */\n  async getSubscriptions(): Promise<ApiResponse<Subscription[]>> {\n    const response = await authenticatedFetch(apiUrls.subscriptions.list);\n    const result = await parseApiResponse<Subscription[]>(response);\n    return result;\n  },\n\n  /**\n   * Get subscriptions with pagination\n   */\n  async getSubscriptionsPaginated(page: number = 1, limit: number = 50): Promise<ApiResponse<SubscriptionsResponse>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString()\n    });\n    \n    const response = await authenticatedFetch(`${apiUrls.subscriptions.list}?${params.toString()}`);\n    return await parseApiResponse<SubscriptionsResponse>(response);\n  },\n\n  /**\n   * Search subscriptions with filters\n   */\n  async search(filters: SubscriptionFilters = {}): Promise<ApiResponse<Subscription[]>> {\n    const params = new URLSearchParams();\n    \n    if (filters.merchantId) params.append('merchantId', filters.merchantId.toString());\n    if (filters.planId) params.append('planId', filters.planId.toString());\n    if (filters.status) params.append('status', filters.status);\n    if (filters.startDate) {\n      const startDate = filters.startDate instanceof Date ? filters.startDate.toISOString() : filters.startDate;\n      params.append('startDate', startDate);\n    }\n    if (filters.endDate) {\n      const endDate = filters.endDate instanceof Date ? filters.endDate.toISOString() : filters.endDate;\n      params.append('endDate', endDate);\n    }\n    if (filters.limit) params.append('limit', filters.limit.toString());\n    if (filters.offset) params.append('offset', filters.offset.toString());\n\n    const response = await authenticatedFetch(`${apiUrls.subscriptions.list}?${params.toString()}`);\n    return await parseApiResponse<Subscription[]>(response);\n  },\n\n  /**\n   * Get subscription by ID\n   */\n  async getById(id: number): Promise<ApiResponse<Subscription>> {\n    const response = await authenticatedFetch(apiUrls.subscriptions.get(id));\n    return await parseApiResponse<Subscription>(response);\n  },\n\n  /**\n   * Create new subscription\n   */\n  async create(data: SubscriptionCreateInput): Promise<ApiResponse<Subscription>> {\n    const response = await authenticatedFetch(apiUrls.subscriptions.create, {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n    return await parseApiResponse<Subscription>(response);\n  },\n\n  /**\n   * Update subscription\n   */\n  async update(id: number, data: SubscriptionUpdateInput): Promise<ApiResponse<Subscription>> {\n    const response = await authenticatedFetch(apiUrls.subscriptions.update(id), {\n      method: 'PUT',\n      body: JSON.stringify(data),\n    });\n    return await parseApiResponse<Subscription>(response);\n  },\n\n  /**\n   * Cancel subscription (soft delete)\n   */\n  async cancel(id: number, reason: string): Promise<ApiResponse<Subscription>> {\n    const response = await authenticatedFetch(`${apiUrls.subscriptions.update(id)}/cancel`, {\n      method: 'POST',\n      body: JSON.stringify({ reason }),\n    });\n    return await parseApiResponse<Subscription>(response);\n  },\n\n  /**\n   * Change subscription plan\n   */\n  async changePlan(id: number, newPlanId: number): Promise<ApiResponse<Subscription>> {\n    const response = await authenticatedFetch(`${apiUrls.subscriptions.update(id)}/change-plan`, {\n      method: 'PATCH',\n      body: JSON.stringify({ newPlanId }),\n    });\n    return await parseApiResponse<Subscription>(response);\n  },\n\n  /**\n   * Extend subscription\n   */\n  async extend(id: number, data: {\n    newEndDate: Date | string;\n    amount: number;\n    method: string;\n    description?: string;\n  }): Promise<ApiResponse<Subscription>> {\n    const response = await authenticatedFetch(apiUrls.subscriptions.extend(id), {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n    return await parseApiResponse<Subscription>(response);\n  },\n\n  /**\n   * Get subscription status for current user\n   * Returns computed subscription status with single source of truth\n   */\n  async getCurrentUserSubscriptionStatus(): Promise<ApiResponse<{\n    // Merchant info\n    merchantId: number;\n    merchantName: string;\n    merchantEmail: string;\n    \n    // Computed status (single source of truth)\n    status: 'CANCELED' | 'EXPIRED' | 'PAST_DUE' | 'PAUSED' | 'TRIAL' | 'ACTIVE' | 'UNKNOWN';\n    statusReason: string;\n    hasAccess: boolean;\n    daysRemaining: number | null;\n    isExpiringSoon: boolean;\n    \n    // Database status (for reference)\n    dbStatus: string;\n    \n    // Subscription details\n    subscriptionId: number;\n    currentPeriodStart: string | null;\n    currentPeriodEnd: string | null;\n    trialStart: string | null;\n    trialEnd: string | null;\n    \n    // Plan info\n    planId: number | null;\n    planName: string;\n    planDescription: string;\n    planPrice: number;\n    planCurrency: string;\n    planTrialDays: number;\n    \n    // Billing info\n    billingAmount: number;\n    billingCurrency: string;\n    billingInterval: string;\n    billingIntervalCount: number;\n    \n    // Cancellation info\n    cancelAtPeriodEnd: boolean;\n    canceledAt: string | null;\n    cancelReason: string | null;\n    \n    // Limits & usage\n    limits: Record<string, number>;\n    usage: {\n      outlets: number;\n      users: number;\n      products: number;\n      customers: number;\n    };\n    \n    // Features\n    features: string[];\n  }>> {\n    const response = await authenticatedFetch(apiUrls.subscriptions.status);\n    return await parseApiResponse(response);\n  },\n\n  /**\n   * Get subscription status by merchant ID\n   */\n  async getSubscriptionStatus(merchantId: number): Promise<ApiResponse<{\n    status: string;\n    planName: string;\n    endDate?: Date | string;\n    nextBillingDate?: Date | string;\n    amount: number;\n    currency: string;\n    autoRenew: boolean;\n  }>> {\n    const response = await authenticatedFetch(`${apiUrls.subscriptions.status}?merchantId=${merchantId}`);\n    return await parseApiResponse(response);\n  },\n\n  /**\n   * Get subscriptions by merchant\n   */\n  async getSubscriptionsByMerchant(merchantId: number): Promise<ApiResponse<Subscription[]>> {\n    const response = await authenticatedFetch(`${apiUrls.subscriptions.list}?merchantId=${merchantId}`);\n    return await parseApiResponse<Subscription[]>(response);\n  },\n\n  /**\n   * Get subscription statistics\n   */\n  async getSubscriptionStats(): Promise<ApiResponse<any>> {\n    const response = await authenticatedFetch(apiUrls.subscriptions.stats);\n    return await parseApiResponse<any>(response);\n  },\n\n  /**\n   * Pause/Suspend subscription\n   */\n  async suspend(id: number, data: { reason?: string } = {}): Promise<ApiResponse<Subscription>> {\n    const response = await authenticatedFetch(`${apiUrls.subscriptions.get(id)}/pause`, {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n    return await parseApiResponse<Subscription>(response);\n  },\n\n  /**\n   * Resume subscription\n   */\n  async resume(id: number, data: { reason?: string } = {}): Promise<ApiResponse<Subscription>> {\n    const response = await authenticatedFetch(`${apiUrls.subscriptions.get(id)}/resume`, {\n      method: 'POST',\n      body: JSON.stringify(data),\n    });\n    return await parseApiResponse<Subscription>(response);\n  },\n\n  /**\n   * Get subscription activities\n   */\n  async getActivities(id: number, limit: number = 20): Promise<ApiResponse<any[]>> {\n    const response = await authenticatedFetch(`${apiUrls.subscriptions.get(id)}/activities?limit=${limit}`);\n    return await parseApiResponse<any[]>(response);\n  },\n\n  /**\n   * Get subscription payments\n   */\n  async getPayments(id: number, limit: number = 20): Promise<ApiResponse<any[]>> {\n    const response = await authenticatedFetch(`${apiUrls.subscriptions.get(id)}/payments?limit=${limit}`);\n    return await parseApiResponse<any[]>(response);\n  }\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\nimport type { ApiResponse } from '../core';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface BackupInfo {\n  id: string;\n  filename: string;\n  size: number;\n  createdAt: string;\n  type: 'full' | 'incremental';\n  status: 'completed' | 'failed' | 'in_progress';\n}\n\nexport interface BackupSchedule {\n  id: string;\n  name: string;\n  frequency: 'daily' | 'weekly' | 'monthly';\n  time: string;\n  enabled: boolean;\n  lastRun?: string;\n  nextRun?: string;\n}\n\nexport interface BackupVerification {\n  id: string;\n  backupId: string;\n  status: 'verified' | 'failed' | 'pending';\n  checksum: string;\n  verifiedAt?: string;\n  error?: string;\n}\n\nexport interface SystemStats {\n  totalBackups: number;\n  totalSize: number;\n  lastBackup?: string;\n  nextScheduledBackup?: string;\n  diskUsage: {\n    used: number;\n    available: number;\n    total: number;\n  };\n}\n\n// ============================================================================\n// SYSTEM API CLIENT\n// ============================================================================\n\n/**\n * System API client for system administration operations\n */\nexport const systemApi = {\n  /**\n   * Get all backups\n   */\n  async getBackups(): Promise<ApiResponse<{ backups: BackupInfo[] }>> {\n    const response = await authenticatedFetch(apiUrls.system?.backup || '/api/system/backup');\n    return await parseApiResponse<{ backups: BackupInfo[] }>(response);\n  },\n\n  /**\n   * Create a new backup\n   */\n  async createBackup(type: 'full' | 'incremental' = 'full'): Promise<ApiResponse<{ backupId: string }>> {\n    const response = await authenticatedFetch(apiUrls.system?.backup || '/api/system/backup', {\n      method: 'POST',\n      body: JSON.stringify({ type }),\n    });\n    return await parseApiResponse<{ backupId: string }>(response);\n  },\n\n  /**\n   * Download a backup\n   */\n  async downloadBackup(backupId: string): Promise<Response> {\n    return await authenticatedFetch(`${apiUrls.system?.backup || '/api/system/backup'}/${backupId}/download`);\n  },\n\n  /**\n   * Delete a backup\n   */\n  async deleteBackup(backupId: string): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(`${apiUrls.system?.backup || '/api/system/backup'}/${backupId}`, {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Get backup schedules\n   */\n  async getBackupSchedules(): Promise<ApiResponse<{ schedules: BackupSchedule[] }>> {\n    const response = await authenticatedFetch(apiUrls.system?.backupSchedule || '/api/system/backup/schedule');\n    return await parseApiResponse<{ schedules: BackupSchedule[] }>(response);\n  },\n\n  /**\n   * Create a backup schedule\n   */\n  async createBackupSchedule(schedule: Omit<BackupSchedule, 'id'>): Promise<ApiResponse<{ scheduleId: string }>> {\n    const response = await authenticatedFetch(apiUrls.system?.backupSchedule || '/api/system/backup/schedule', {\n      method: 'POST',\n      body: JSON.stringify(schedule),\n    });\n    return await parseApiResponse<{ scheduleId: string }>(response);\n  },\n\n  /**\n   * Update a backup schedule\n   */\n  async updateBackupSchedule(scheduleId: string, schedule: Partial<BackupSchedule>): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(`${apiUrls.system?.backupSchedule || '/api/system/backup/schedule'}/${scheduleId}`, {\n      method: 'PUT',\n      body: JSON.stringify(schedule),\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Delete a backup schedule\n   */\n  async deleteBackupSchedule(scheduleId: string): Promise<ApiResponse<{ message: string }>> {\n    const response = await authenticatedFetch(`${apiUrls.system?.backupSchedule || '/api/system/backup/schedule'}/${scheduleId}`, {\n      method: 'DELETE',\n    });\n    return await parseApiResponse<{ message: string }>(response);\n  },\n\n  /**\n   * Verify a backup\n   */\n  async verifyBackup(backupId: string): Promise<ApiResponse<BackupVerification>> {\n    const response = await authenticatedFetch(`${apiUrls.system?.backupVerify || '/api/system/backup/verify'}`, {\n      method: 'POST',\n      body: JSON.stringify({ backupId }),\n    });\n    return await parseApiResponse<BackupVerification>(response);\n  },\n\n  /**\n   * Get system statistics\n   */\n  async getSystemStats(): Promise<ApiResponse<SystemStats>> {\n    const response = await authenticatedFetch(apiUrls.system?.stats || '/api/system/stats');\n    return await parseApiResponse<SystemStats>(response);\n  },\n\n  /**\n   * Get system health status\n   */\n  async getSystemHealth(): Promise<ApiResponse<{\n    status: 'healthy' | 'warning' | 'critical';\n    services: Array<{\n      name: string;\n      status: 'up' | 'down' | 'degraded';\n      lastCheck: string;\n    }>;\n    uptime: number;\n  }>> {\n    const response = await authenticatedFetch(apiUrls.system?.health || '/api/system/health');\n    return await parseApiResponse<{\n      status: 'healthy' | 'warning' | 'critical';\n      services: Array<{\n        name: string;\n        status: 'up' | 'down' | 'degraded';\n        lastCheck: string;\n      }>;\n      uptime: number;\n    }>(response);\n  },\n\n  /**\n   * Get system logs\n   */\n  async getSystemLogs(page: number = 1, limit: number = 50, level?: string): Promise<ApiResponse<{\n    logs: Array<{\n      id: string;\n      level: string;\n      message: string;\n      timestamp: string;\n      source: string;\n    }>;\n    total: number;\n    page: number;\n    limit: number;\n  }>> {\n    const params = new URLSearchParams({\n      page: page.toString(),\n      limit: limit.toString(),\n    });\n    if (level) params.append('level', level);\n\n    const response = await authenticatedFetch(`${apiUrls.system?.logs || '/api/system/logs'}?${params.toString()}`);\n    return await parseApiResponse<{\n      logs: Array<{\n        id: string;\n        level: string;\n        message: string;\n        timestamp: string;\n        source: string;\n      }>;\n      total: number;\n      page: number;\n      limit: number;\n    }>(response);\n  }\n};\n","import { authenticatedFetch, parseApiResponse } from '../core';\nimport { apiUrls } from '../config/api';\n\n// Types for calendar API\nexport interface CalendarOrderSummary {\n  id: number;\n  orderNumber: string;\n  customerName: string;\n  customerPhone?: string;\n  productName: string;\n  productCount?: number;\n  totalAmount: number;\n  status: string;\n  outletName?: string;\n  notes?: string;\n  pickupPlanAt?: string;\n  returnPlanAt?: string;\n  isOverdue?: boolean;\n  duration?: number;\n}\n\nexport interface DayOrders {\n  pickups: CalendarOrderSummary[];\n  total: number;\n}\n\nexport interface CalendarResponse {\n  [dateKey: string]: DayOrders;\n}\n\nexport interface CalendarMeta {\n  month: number;\n  year: number;\n  totalDays: number;\n  stats: {\n    totalPickups: number;\n    totalOrders: number;\n  };\n  dateRange: {\n    start: string;\n    end: string;\n  };\n}\n\nexport interface CalendarApiResponse {\n  success: boolean;\n  data: CalendarResponse;\n  meta: CalendarMeta;\n  message: string;\n}\n\nexport interface CalendarQuery {\n  month: number;\n  year: number;\n  outletId?: number;\n  limit?: number;\n}\n\n/**\n * 🎯 Calendar API Client\n * \n * Specialized API for calendar display\n * - Optimized for monthly calendar views\n * - Groups orders by date\n * - Limits orders per day for performance\n */\nexport const calendarApi = {\n  /**\n   * Get calendar orders for a specific month\n   * \n   * @param query - Calendar query parameters\n   * @returns Promise with calendar data grouped by date\n   */\n  async getCalendarOrders(query: CalendarQuery): Promise<CalendarApiResponse> {\n    const searchParams = new URLSearchParams({\n      month: query.month.toString(),\n      year: query.year.toString(),\n      ...(query.outletId && { outletId: query.outletId.toString() }),\n      ...(query.limit && { limit: query.limit.toString() })\n    });\n\n    const response = await authenticatedFetch(`${apiUrls.calendar.orders}?${searchParams}`);\n    const result = await parseApiResponse<CalendarApiResponse>(response);\n    \n    // Return the calendar response data directly\n    if (result.success && result.data) {\n      return result.data;\n    }\n    \n    // Fallback structure if backend returns different format\n    return {\n      success: result.success,\n      data: {} as CalendarResponse,\n      meta: {\n        month: query.month,\n        year: query.year,\n        totalDays: 30,\n        stats: { totalPickups: 0, totalOrders: 0 },\n        dateRange: { start: '', end: '' }\n      },\n      message: result.message || 'Calendar data loaded'\n    };\n  },\n\n  /**\n   * Get calendar orders for current month\n   */\n  async getCurrentMonthOrders(outletId?: number): Promise<CalendarApiResponse> {\n    const now = new Date();\n    return this.getCalendarOrders({\n      month: now.getMonth() + 1, // JavaScript months are 0-based\n      year: now.getFullYear(),\n      outletId,\n      limit: 4\n    });\n  },\n\n  /**\n   * Get calendar orders for next month\n   */\n  async getNextMonthOrders(outletId?: number): Promise<CalendarApiResponse> {\n    const now = new Date();\n    const nextMonth = new Date(now.getFullYear(), now.getMonth() + 1, 1);\n    return this.getCalendarOrders({\n      month: nextMonth.getMonth() + 1,\n      year: nextMonth.getFullYear(),\n      outletId,\n      limit: 4\n    });\n  },\n\n  /**\n   * Get calendar orders for previous month\n   */\n  async getPreviousMonthOrders(outletId?: number): Promise<CalendarApiResponse> {\n    const now = new Date();\n    const prevMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n    return this.getCalendarOrders({\n      month: prevMonth.getMonth() + 1,\n      year: prevMonth.getFullYear(),\n      outletId,\n      limit: 4\n    });\n  }\n};\n\nexport default calendarApi;\n","import { API } from '@rentalshop/constants';\n\n// ============================================================================\n// TYPES & INTERFACES\n// ============================================================================\n\nexport interface UploadResponse {\n  success: boolean;\n  data?: {\n    url: string;\n    publicId: string;\n    width: number;\n    height: number;\n    format: string;\n    size: number;\n    uploadMethod?: 'cloudinary' | 'local' | 'base64';\n  };\n  message?: string;\n  error?: string;\n}\n\nexport interface UploadProgress {\n  loaded: number;\n  total: number;\n  percentage: number;\n  stage: 'preparing' | 'uploading' | 'processing' | 'complete';\n}\n\nexport interface UploadOptions {\n  onProgress?: (progress: UploadProgress) => void;\n  maxFileSize?: number; // in bytes\n  allowedTypes?: string[];\n  folder?: string;\n  useBase64Fallback?: boolean; // Enable base64 fallback if upload fails\n  quality?: number; // Image quality (0-1)\n  maxWidth?: number; // Max width for client-side resize\n  maxHeight?: number; // Max height for client-side resize\n}\n\nexport interface ImageValidationResult {\n  isValid: boolean;\n  error?: string;\n  warnings?: string[];\n}\n\nexport interface ImageDimensions {\n  width: number;\n  height: number;\n}\n\n// ============================================================================\n// CONSTANTS\n// ============================================================================\n\nconst DEFAULT_MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB\nconst DEFAULT_ALLOWED_TYPES = ['image/jpeg', 'image/jpg', 'image/png', 'image/webp', 'image/gif'];\nconst WARNING_SIZE_THRESHOLD = 2 * 1024 * 1024; // 2MB\nconst MIN_FILE_SIZE = 100; // 100 bytes\n\n// ============================================================================\n// VALIDATION FUNCTIONS\n// ============================================================================\n\n/**\n * Validate image file before upload\n * \n * **Why we validate:**\n * - Prevents uploading malicious files (security)\n * - Ensures quality standards (user experience)\n * - Catches errors early before expensive upload operations\n * - Provides helpful feedback to users about issues\n */\nexport function validateImage(file: File, options: UploadOptions = {}): ImageValidationResult {\n  const {\n    maxFileSize = DEFAULT_MAX_FILE_SIZE,\n    allowedTypes = DEFAULT_ALLOWED_TYPES\n  } = options;\n\n  const warnings: string[] = [];\n  let error: string | undefined;\n\n  // Check file type\n  if (!allowedTypes.includes(file.type)) {\n    error = `Invalid file type \"${file.type}\". Allowed types: ${allowedTypes.join(', ')}`;\n    return { isValid: false, error };\n  }\n\n  // Check file size (reject if too large)\n  if (file.size > maxFileSize) {\n    error = `File size (${(file.size / 1024 / 1024).toFixed(2)}MB) exceeds maximum allowed size of ${(maxFileSize / 1024 / 1024).toFixed(2)}MB`;\n    return { isValid: false, error };\n  }\n\n  // Check if file is too small (likely corrupted)\n  if (file.size < MIN_FILE_SIZE) {\n    error = 'File size is too small. The file may be corrupted or empty.';\n    return { isValid: false, error };\n  }\n\n  // Warn if file is large but still acceptable\n  if (file.size > WARNING_SIZE_THRESHOLD) {\n    warnings.push(`Large file size (${(file.size / 1024 / 1024).toFixed(2)}MB) may slow down page loading. Consider compressing the image.`);\n  }\n\n  return {\n    isValid: true,\n    warnings: warnings.length > 0 ? warnings : undefined\n  };\n}\n\n// ============================================================================\n// IMAGE OPTIMIZATION FUNCTIONS\n// ============================================================================\n\n/**\n * Get image dimensions from file\n */\nexport function getImageDimensions(file: File): Promise<ImageDimensions> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    const url = URL.createObjectURL(file);\n\n    img.onload = () => {\n      URL.revokeObjectURL(url);\n      resolve({\n        width: img.width,\n        height: img.height\n      });\n    };\n\n    img.onerror = () => {\n      URL.revokeObjectURL(url);\n      reject(new Error('Failed to load image'));\n    };\n\n    img.src = url;\n  });\n}\n\n/**\n * Resize image on client-side before upload\n * \n * **Why client-side resize:**\n * - Reduces upload time and bandwidth\n * - Faster user experience\n * - Less server load\n * - Still have server-side optimization as backup\n */\nexport async function resizeImage(\n  file: File,\n  maxWidth: number = 1200,\n  maxHeight: number = 900,\n  quality: number = 0.85\n): Promise<File> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n\n    if (!ctx) {\n      reject(new Error('Canvas not supported'));\n      return;\n    }\n\n    img.onload = () => {\n      let { width, height } = img;\n\n      // Calculate new dimensions while maintaining aspect ratio\n      if (width > maxWidth || height > maxHeight) {\n        const ratio = Math.min(maxWidth / width, maxHeight / height);\n        width = Math.floor(width * ratio);\n        height = Math.floor(height * ratio);\n      }\n\n      canvas.width = width;\n      canvas.height = height;\n\n      // Draw image on canvas\n      ctx.drawImage(img, 0, 0, width, height);\n\n      // Convert canvas to blob\n      canvas.toBlob(\n        (blob) => {\n          if (!blob) {\n            reject(new Error('Failed to create blob'));\n            return;\n          }\n\n          // Create new file from blob\n          const resizedFile = new File([blob], file.name, {\n            type: file.type,\n            lastModified: Date.now()\n          });\n\n          resolve(resizedFile);\n        },\n        file.type,\n        quality\n      );\n    };\n\n    img.onerror = () => {\n      reject(new Error('Failed to load image'));\n    };\n\n    img.src = URL.createObjectURL(file);\n  });\n}\n\n/**\n * Convert file to base64 string\n */\nexport function fileToBase64(file: File): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    \n    reader.onload = () => {\n      resolve(reader.result as string);\n    };\n    \n    reader.onerror = () => {\n      reject(new Error('Failed to read file'));\n    };\n    \n    reader.readAsDataURL(file);\n  });\n}\n\n// ============================================================================\n// UPLOAD FUNCTIONS\n// ============================================================================\n\n/**\n * Upload image with XMLHttpRequest for progress tracking\n * \n * **Why XMLHttpRequest instead of fetch:**\n * - XMLHttpRequest provides native progress events\n * - fetch() doesn't support upload progress tracking\n * - More control over upload lifecycle\n * - Better error handling for network issues\n */\nfunction uploadWithProgress(\n  url: string,\n  formData: FormData,\n  token: string,\n  onProgress?: (progress: UploadProgress) => void\n): Promise<UploadResponse> {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n\n    // Track upload progress\n    xhr.upload.addEventListener('progress', (e) => {\n      if (e.lengthComputable && onProgress) {\n        onProgress({\n          loaded: e.loaded,\n          total: e.total,\n          percentage: Math.round((e.loaded / e.total) * 100),\n          stage: 'uploading'\n        });\n      }\n    });\n\n    // Handle upload complete\n    xhr.addEventListener('load', () => {\n      if (xhr.status >= 200 && xhr.status < 300) {\n        try {\n          const result = JSON.parse(xhr.responseText);\n          \n          if (onProgress) {\n            onProgress({\n              loaded: 100,\n              total: 100,\n              percentage: 100,\n              stage: 'complete'\n            });\n          }\n          \n          resolve(result);\n        } catch (error) {\n          reject(new Error('Invalid response from server'));\n        }\n      } else {\n        try {\n          const error = JSON.parse(xhr.responseText);\n          reject(new Error(error.message || 'Upload failed'));\n        } catch {\n          reject(new Error(`Upload failed with status ${xhr.status}`));\n        }\n      }\n    });\n\n    // Handle network errors\n    xhr.addEventListener('error', () => {\n      reject(new Error('Network error occurred'));\n    });\n\n    // Handle timeout\n    xhr.addEventListener('timeout', () => {\n      reject(new Error('Upload timeout'));\n    });\n\n    // Configure request\n    xhr.open('POST', url);\n    xhr.setRequestHeader('Authorization', `Bearer ${token}`);\n    xhr.timeout = 60000; // 60 second timeout\n\n    // Start upload\n    if (onProgress) {\n      onProgress({\n        loaded: 0,\n        total: 100,\n        percentage: 0,\n        stage: 'preparing'\n      });\n    }\n\n    xhr.send(formData);\n  });\n}\n\n/**\n * Upload image to server with progress tracking, validation, and fallbacks\n * \n * **Complete upload flow:**\n * 1. Validate image (type, size, quality)\n * 2. Optional client-side resize/optimization\n * 3. Upload with progress tracking\n * 4. Automatic fallback to base64 if upload fails (optional)\n * \n * @param file - Image file to upload\n * @param token - Authentication token\n * @param options - Upload configuration options\n */\nexport async function uploadImage(\n  file: File,\n  token: string,\n  options: UploadOptions = {}\n): Promise<UploadResponse> {\n  const {\n    onProgress,\n    maxFileSize = DEFAULT_MAX_FILE_SIZE,\n    allowedTypes = DEFAULT_ALLOWED_TYPES,\n    folder = 'rentalshop/products',\n    useBase64Fallback = true,\n    quality = 0.85,\n    maxWidth,\n    maxHeight\n  } = options;\n\n  try {\n    // Stage 1: Validate image\n    if (onProgress) {\n      onProgress({ loaded: 0, total: 100, percentage: 0, stage: 'preparing' });\n    }\n\n    const validation = validateImage(file, { maxFileSize, allowedTypes });\n    if (!validation.isValid) {\n      return {\n        success: false,\n        error: validation.error || 'Image validation failed'\n      };\n    }\n\n    // Show warnings if any\n    if (validation.warnings && validation.warnings.length > 0) {\n      console.warn('Image upload warnings:', validation.warnings);\n    }\n\n    // Stage 2: Optional client-side resize\n    let fileToUpload = file;\n    if (maxWidth && maxHeight) {\n      try {\n        const dimensions = await getImageDimensions(file);\n        if (dimensions.width > maxWidth || dimensions.height > maxHeight) {\n          console.log(`Resizing image from ${dimensions.width}x${dimensions.height} to fit ${maxWidth}x${maxHeight}`);\n          fileToUpload = await resizeImage(file, maxWidth, maxHeight, quality);\n          console.log(`Image resized. Size reduced from ${(file.size / 1024).toFixed(2)}KB to ${(fileToUpload.size / 1024).toFixed(2)}KB`);\n        }\n      } catch (resizeError) {\n        console.warn('Client-side resize failed, uploading original:', resizeError);\n        // Continue with original file if resize fails\n      }\n    }\n\n    // Stage 3: Upload to server\n    const formData = new FormData();\n    formData.append('image', fileToUpload);\n    formData.append('folder', folder);\n    formData.append('useBase64', useBase64Fallback.toString());\n\n    const apiUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3002';\n    const uploadUrl = `${apiUrl}/api/upload/image`;\n\n    const result = await uploadWithProgress(uploadUrl, formData, token, onProgress);\n\n    return result;\n\n  } catch (error) {\n    console.error('Upload error:', error);\n\n    // Stage 4: Fallback to base64 if enabled\n    if (useBase64Fallback) {\n      try {\n        console.log('Upload failed, attempting base64 fallback...');\n        const base64 = await fileToBase64(file);\n        \n        return {\n          success: true,\n          data: {\n            url: base64,\n            publicId: `base64-${Date.now()}`,\n            width: 0,\n            height: 0,\n            format: file.type.split('/')[1] || 'unknown',\n            size: file.size,\n            uploadMethod: 'base64'\n          },\n          message: 'Image uploaded using base64 fallback'\n        };\n      } catch (base64Error) {\n        console.error('Base64 fallback failed:', base64Error);\n      }\n    }\n\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Upload failed'\n    };\n  }\n}\n\n/**\n * Upload multiple images with individual progress tracking\n * \n * @param files - Array of image files to upload\n * @param token - Authentication token\n * @param options - Upload configuration options\n * @param onFileProgress - Callback for individual file progress (optional)\n */\nexport async function uploadImages(\n  files: File[],\n  token: string,\n  options: UploadOptions = {},\n  onFileProgress?: (fileIndex: number, progress: UploadProgress) => void\n): Promise<UploadResponse[]> {\n  const uploadPromises = files.map((file, index) => {\n    const fileOptions: UploadOptions = {\n      ...options,\n      onProgress: onFileProgress ? (progress) => onFileProgress(index, progress) : undefined\n    };\n    return uploadImage(file, token, fileOptions);\n  });\n\n  return Promise.all(uploadPromises);\n}\n\n/**\n * Cancel ongoing upload (for future implementation with AbortController)\n */\nexport function createUploadController() {\n  const controller = new AbortController();\n  \n  return {\n    signal: controller.signal,\n    cancel: () => controller.abort()\n  };\n}\n","// ============================================================================\n// DATABASE CONFIGURATION\n// ============================================================================\n\nimport { Environment } from './environment';\n\nexport interface DatabaseConfig {\n  url: string;\n  provider: 'sqlite' | 'postgresql';\n}\n\nexport function getDatabaseConfig(): DatabaseConfig {\n  const nodeEnv = (process.env.NODE_ENV || 'local') as 'local' | 'development' | 'production' | 'test';\n  \n  switch (nodeEnv) {\n    case 'local':\n      return {\n        url: process.env.DATABASE_URL_LOCAL || 'file:./dev.db',\n        provider: 'sqlite'\n      };\n    \n    case 'development':\n      return {\n        url: process.env.DATABASE_URL || '',\n        provider: 'postgresql'\n      };\n    \n    case 'production':\n      return {\n        url: process.env.DATABASE_URL || '',\n        provider: 'postgresql'\n      };\n    \n    default:\n      return {\n        url: process.env.DATABASE_URL_LOCAL || 'file:./dev.db',\n        provider: 'sqlite'\n      };\n  }\n}\n\nexport function isLocalEnvironment(): boolean {\n  const nodeEnv = process.env.NODE_ENV;\n  return !nodeEnv || nodeEnv === 'development';\n}\n\nexport function isDevelopmentEnvironment(): boolean {\n  return process.env.NODE_ENV === 'development';\n}\n\nexport function isProductionEnvironment(): boolean {\n  return process.env.NODE_ENV === 'production';\n}\n\n// Export the config instance\nexport const databaseConfig = getDatabaseConfig();\n","// ============================================================================\n// ENVIRONMENT CONFIGURATION\n// ============================================================================\n\nexport type Environment = 'development' | 'production' | 'test' | 'local';\n\n/**\n * Get the appropriate client URL based on environment\n */\nexport const getClientUrl = (): string => {\n  if (process.env.NODE_ENV === 'production') {\n    return process.env.CLIENT_URL_PROD || process.env.NEXT_PUBLIC_CLIENT_URL || 'https://rentalshop.com';\n  }\n  \n  if (process.env.NODE_ENV === 'development') {\n    return process.env.CLIENT_URL_DEV || process.env.NEXT_PUBLIC_CLIENT_URL || 'http://localhost:3000';\n  }\n  \n  return process.env.CLIENT_URL_LOCAL || process.env.NEXT_PUBLIC_CLIENT_URL || 'http://localhost:3000';\n};\n\n/**\n * Get the appropriate admin URL based on environment\n */\nexport const getAdminUrl = (): string => {\n  if (process.env.NODE_ENV === 'production') {\n    return process.env.ADMIN_URL_PROD || process.env.NEXT_PUBLIC_ADMIN_URL || 'https://admin.rentalshop.com';\n  }\n  \n  if (process.env.NODE_ENV === 'development') {\n    return process.env.ADMIN_URL_DEV || process.env.NEXT_PUBLIC_ADMIN_URL || 'http://localhost:3001';\n  }\n  \n  return process.env.ADMIN_URL_LOCAL || process.env.NEXT_PUBLIC_ADMIN_URL || 'http://localhost:3001';\n};\n\n\n\n/**\n * Get the appropriate mobile URL based on environment\n */\nexport const getMobileUrl = (): string => {\n  if (process.env.NODE_ENV === 'production') {\n    return process.env.MOBILE_URL_PROD || process.env.NEXT_PUBLIC_MOBILE_URL || 'https://mobile.rentalshop.com';\n  }\n  \n  if (process.env.NODE_ENV === 'development') {\n    return process.env.MOBILE_URL_DEV || process.env.NEXT_PUBLIC_MOBILE_URL || 'http://localhost:3003';\n  }\n  \n  return process.env.MOBILE_URL_LOCAL || process.env.NEXT_PUBLIC_MOBILE_URL || 'http://localhost:3003';\n};\n\n/**\n * Get all URLs for the current environment\n */\nexport const getEnvironmentUrls = () => ({\n  client: getClientUrl(),\n  admin: getAdminUrl(),\n  mobile: getMobileUrl(),\n});\n\n/**\n * Check if running in browser environment\n */\nexport const isBrowser = (): boolean => {\n  return typeof window !== 'undefined';\n};\n\n/**\n * Check if running in server environment\n */\nexport const isServer = (): boolean => {\n  return typeof window === 'undefined';\n};\n\n/**\n * Check if running in development mode\n */\nexport const isDev = (): boolean => {\n  return process.env.NODE_ENV === 'development';\n};\n\n/**\n * Check if running in production mode\n */\nexport const isProd = (): boolean => {\n  return process.env.NODE_ENV === 'production';\n};\n\n/**\n * Check if running in test mode\n */\nexport const isTest = (): boolean => {\n  return process.env.NODE_ENV === 'test';\n};\n","// ============================================================================\n// PERFORMANCE MONITORING UTILITIES\n// ============================================================================\n// Utilities for monitoring and optimizing database query performance\n\nexport interface PerformanceMetrics {\n  queryName: string;\n  duration: number;\n  timestamp: Date;\n  slowQuery?: boolean;\n  recordCount?: number;\n  error?: string;\n}\n\nclass PerformanceMonitor {\n  private static metrics: PerformanceMetrics[] = [];\n  private static slowQueryThreshold = 1000; // 1 second\n  private static maxMetrics = 1000; // Keep last 1000 metrics\n\n  /**\n   * Measure query performance with automatic logging\n   */\n  static async measureQuery<T>(\n    name: string, \n    query: () => Promise<T>,\n    recordCount?: number\n  ): Promise<T> {\n    const start = Date.now();\n    const timestamp = new Date();\n    \n    try {\n      const result = await query();\n      const duration = Date.now() - start;\n      \n      const metric: PerformanceMetrics = {\n        queryName: name,\n        duration,\n        timestamp,\n        slowQuery: duration > this.slowQueryThreshold,\n        recordCount\n      };\n\n      this.logMetric(metric);\n      return result;\n      \n    } catch (error) {\n      const duration = Date.now() - start;\n      \n      const metric: PerformanceMetrics = {\n        queryName: name,\n        duration,\n        timestamp,\n        slowQuery: true,\n        recordCount,\n        error: error instanceof Error ? error.message : String(error)\n      };\n\n      this.logMetric(metric);\n      throw error;\n    }\n  }\n\n  /**\n   * Log performance metric\n   */\n  private static logMetric(metric: PerformanceMetrics) {\n    // Add to metrics array\n    this.metrics.push(metric);\n    \n    // Keep only last N metrics\n    if (this.metrics.length > this.maxMetrics) {\n      this.metrics = this.metrics.slice(-this.maxMetrics);\n    }\n\n    // Console logging\n    const logLevel = metric.slowQuery ? 'warn' : 'log';\n    const message = metric.error \n      ? `[PERF ERROR] ${metric.queryName}: ${metric.duration}ms - ${metric.error}`\n      : `[PERF] ${metric.queryName}: ${metric.duration}ms${metric.recordCount ? ` (${metric.recordCount} records)` : ''}`;\n\n    console[logLevel](message);\n\n    // Additional warning for very slow queries\n    if (metric.duration > 5000) {\n      console.error(`[CRITICAL SLOW QUERY] ${metric.queryName}: ${metric.duration}ms`);\n    }\n  }\n\n  /**\n   * Get performance statistics\n   */\n  static getStats(queryName?: string): {\n    totalQueries: number;\n    slowQueries: number;\n    averageDuration: number;\n    slowestQuery: PerformanceMetrics | null;\n    recentSlowQueries: PerformanceMetrics[];\n  } {\n    const metrics = queryName \n      ? this.metrics.filter(m => m.queryName === queryName)\n      : this.metrics;\n\n    const slowQueries = metrics.filter(m => m.slowQuery);\n    const averageDuration = metrics.length > 0 \n      ? metrics.reduce((sum, m) => sum + m.duration, 0) / metrics.length \n      : 0;\n\n    const slowestQuery = metrics.length > 0 \n      ? metrics.reduce((prev, current) => prev.duration > current.duration ? prev : current)\n      : null;\n\n    const recentSlowQueries = slowQueries.slice(-10); // Last 10 slow queries\n\n    return {\n      totalQueries: metrics.length,\n      slowQueries: slowQueries.length,\n      averageDuration: Math.round(averageDuration),\n      slowestQuery,\n      recentSlowQueries\n    };\n  }\n\n  /**\n   * Get slow queries for analysis\n   */\n  static getSlowQueries(threshold?: number): PerformanceMetrics[] {\n    const limit = threshold || this.slowQueryThreshold;\n    return this.metrics.filter(m => m.duration > limit);\n  }\n\n  /**\n   * Clear performance metrics\n   */\n  static clearMetrics() {\n    this.metrics = [];\n  }\n\n  /**\n   * Export metrics for analysis\n   */\n  static exportMetrics(): PerformanceMetrics[] {\n    return [...this.metrics];\n  }\n\n  /**\n   * Set slow query threshold\n   */\n  static setSlowQueryThreshold(threshold: number) {\n    this.slowQueryThreshold = threshold;\n  }\n}\n\n/**\n * Database connection monitoring\n */\nexport class DatabaseMonitor {\n  private static connectionCount = 0;\n  private static activeQueries = 0;\n\n  /**\n   * Track database connection\n   */\n  static trackConnection() {\n    this.connectionCount++;\n    console.log(`[DB] Connection opened. Total: ${this.connectionCount}`);\n  }\n\n  /**\n   * Track query start\n   */\n  static trackQueryStart(queryName: string) {\n    this.activeQueries++;\n    console.log(`[DB] Query started: ${queryName}. Active: ${this.activeQueries}`);\n  }\n\n  /**\n   * Track query end\n   */\n  static trackQueryEnd(queryName: string) {\n    this.activeQueries = Math.max(0, this.activeQueries - 1);\n    console.log(`[DB] Query ended: ${queryName}. Active: ${this.activeQueries}`);\n  }\n\n  /**\n   * Get database stats\n   */\n  static getStats() {\n    return {\n      connectionCount: this.connectionCount,\n      activeQueries: this.activeQueries\n    };\n  }\n}\n\n/**\n * Memory usage monitoring\n */\nexport class MemoryMonitor {\n  /**\n   * Get current memory usage\n   */\n  static getMemoryUsage(): {\n    used: number;\n    total: number;\n    percentage: number;\n  } {\n    const usage = process.memoryUsage();\n    const used = usage.heapUsed;\n    const total = usage.heapTotal;\n    const percentage = (used / total) * 100;\n\n    return {\n      used: Math.round(used / 1024 / 1024), // MB\n      total: Math.round(total / 1024 / 1024), // MB\n      percentage: Math.round(percentage)\n    };\n  }\n\n  /**\n   * Log memory usage\n   */\n  static logMemoryUsage(context?: string) {\n    const memory = this.getMemoryUsage();\n    const contextStr = context ? `[${context}] ` : '';\n    console.log(`${contextStr}Memory: ${memory.used}MB / ${memory.total}MB (${memory.percentage}%)`);\n  }\n\n  /**\n   * Check if memory usage is high\n   */\n  static isHighMemoryUsage(threshold = 80): boolean {\n    const memory = this.getMemoryUsage();\n    return memory.percentage > threshold;\n  }\n}\n\n/**\n * API response time monitoring\n */\nexport class APIMonitor {\n  /**\n   * Measure API endpoint performance\n   */\n  static async measureEndpoint<T>(\n    method: string,\n    path: string,\n    handler: () => Promise<T>\n  ): Promise<T> {\n    const start = Date.now();\n    const timestamp = new Date();\n    \n    try {\n      const result = await handler();\n      const duration = Date.now() - start;\n      \n      console.log(`[API] ${method} ${path}: ${duration}ms`);\n      \n      // Warn for slow endpoints\n      if (duration > 3000) {\n        console.warn(`[SLOW API] ${method} ${path}: ${duration}ms`);\n      }\n      \n      return result;\n      \n    } catch (error) {\n      const duration = Date.now() - start;\n      console.error(`[API ERROR] ${method} ${path}: ${duration}ms - ${error}`);\n      throw error;\n    }\n  }\n}\n\nexport { PerformanceMonitor };\nexport default PerformanceMonitor;\n"]}